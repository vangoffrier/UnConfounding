(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1857913,      46138]
NotebookOptionsPosition[   1780956,      45055]
NotebookOutlinePosition[   1781385,      45072]
CellTagsIndexPosition[   1781342,      45069]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\\"}]], "Input",
 CellChangeTimes->{{3.8716216916833353`*^9, 3.871621691751101*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[1]:=",ExpressionUUID->"3e3492a6-b39e-49eb-aa8f-ed8f7183b148"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Remove", "[", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.84570918761133*^9, 3.845709193048901*^9}, {
  3.845718107732422*^9, 3.845718111191244*^9}, {3.845718216988119*^9, 
  3.845718217502162*^9}, {3.852117984620886*^9, 3.852117985402053*^9}, {
  3.857018138830995*^9, 3.8570181394387627`*^9}, {3.857018367986505*^9, 
  3.857018368175085*^9}, {3.858321538598056*^9, 3.858321545747184*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"91d6d697-c0f9-4a55-855d-9f8d3314a6bb"],

Cell[BoxData[
 TemplateBox[{
  "Remove", "rmnsm", 
   "\"There are no symbols matching \\\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Global`*\
\\\\\\\"\\\"}]\\)\\\".\"", 2, 2, 2, 21942966268712677875, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.85832154887575*^9, 3.858321645004731*^9, 3.858325234844392*^9, 
   3.858329540492723*^9, 3.858329605727676*^9, 3.858330128609568*^9, 
   3.858335308789926*^9, {3.8583353773335257`*^9, 3.85833539710188*^9}, {
   3.8583354739814053`*^9, 3.858335481464108*^9}, 3.8583357359661407`*^9, 
   3.858335814695228*^9, 3.8583359138852367`*^9, 3.8595460270104017`*^9, 
   3.859557347013938*^9, 3.859557513230565*^9, 3.8595575439224567`*^9, 
   3.8595586613410807`*^9, 3.8595913093919983`*^9, 3.8595913556685*^9, 
   3.859591581346324*^9, 3.859591705284223*^9, 3.859607766635996*^9, 
   3.859610023863017*^9, 3.8596313623303833`*^9, 3.859701199004343*^9, 
   3.8597012293585777`*^9, 3.85988501626853*^9, 3.859885162790741*^9, 
   3.8598853368993998`*^9, 3.859885561626244*^9, 3.859885595495081*^9, 
   3.859885660442803*^9, 3.8598858580369663`*^9, 3.859886100341425*^9, {
   3.8598862034200068`*^9, 3.8598862499662952`*^9}, 3.8598864110300093`*^9, 
   3.859887261445352*^9, 3.8598877578969584`*^9, 3.859887789976693*^9, 
   3.859887823876239*^9, 3.8599677634495*^9, 3.8599809861534224`*^9, 
   3.860036124535389*^9, 3.86015061781256*^9, 3.860221333904207*^9, 
   3.860222474413859*^9, 3.860222636765847*^9, 3.86022307936611*^9, 
   3.861253991473051*^9, 3.861750744003297*^9, 3.86385628084566*^9, 
   3.864116514623869*^9, 3.864188113306129*^9, 3.8642777857414703`*^9, 
   3.864875709961895*^9, 3.867905642721932*^9, 3.8679058302067623`*^9, 
   3.8691143960863132`*^9, 3.8691149334340553`*^9, 3.869226535472166*^9, 
   3.869292719093298*^9, 3.869305604042613*^9, 3.8693097816854258`*^9, 
   3.869526556530616*^9, 3.8695637303392057`*^9, 3.869692373446107*^9, 
   3.871566444419945*^9, 3.8722468021111507`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"48258500-b651-4802-91f4-b3834067fbbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Estimating Treatment Effects with Confounded Mediators\n",
 StyleBox["Author: Graham Van Goffrier, Tech Research, Spotify\nApril - \
September 2022",
  FontSize->14,
  FontColor->GrayLevel[0.5]]
}], "Subtitle",
 CellChangeTimes->{{3.846916827252787*^9, 3.846916834495102*^9}, 
   3.8469168689824*^9, {3.8470940798046103`*^9, 3.847094098263331*^9}, {
   3.8473756120091553`*^9, 3.8473756121867313`*^9}, {3.858319001591466*^9, 
   3.858319047069528*^9}, {3.8662814802776213`*^9, 3.8662815037441893`*^9}, {
   3.869226488513257*^9, 
   3.86922649241123*^9}},ExpressionUUID->"4c1ca689-9203-4139-b190-\
9cf2efcd4914"],

Cell[TextData[{
 "The purpose of this notebook is to evaluate the bias and variance for a \
collection of front-door criterion (FDC) estimators obtained by either \
generalizing or simplifying the causal graph presented in ",
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 StyleBox[".",
  FontColor->GrayLevel[0]],
 "\n\n",
 StyleBox["First, we reproduce the covariance, bias, and variance for the \
standard FDC estimator for a graph with an observed mediator S and unobserved \
confounder U. The results should match the those in sections B.1,C.2, and D.2 \
of ",
  FontColor->GrayLevel[0]],
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 StyleBox[". ",
  FontColor->GrayLevel[0]],
 StyleBox["IN PROGRESS",
  FontColor->RGBColor[0, 0, 1]],
 "\n\n",
 StyleBox["Next, we will apply the same formalism to an \
\[OpenCurlyDoubleQuote]approximate FDC\[CloseCurlyDoubleQuote] estimator \
obtained by setting P[Y | do(S)] = P[Y | S]. ",
  FontColor->GrayLevel[0]],
 StyleBox["IN PROGRESS\n\n",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Next, we will apply the same formalism to an extended causal graph \
with U\[Rule]S effects, with both the standard and approximate FDC. ",
  FontColor->GrayLevel[0]],
 StyleBox["IN PROGRESS",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["\n\n",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["Next, we will apply the same formalism to a further extended \
causal graph with a pre-treatment covariate X which influences all of W, S, \
and Y, with and without U\[Rule]S effects, and with both the standard and \
approximate FDC. ",
  FontColor->GrayLevel[0]],
 StyleBox["INCOMPLETE",
  FontColor->RGBColor[1, 0, 0]],
 "\n\nFinally, we will perform sample simulations as a cross-check. ",
 StyleBox["IN PROGRESS",
  FontColor->RGBColor[0, 0, 1]]
}], "Text",
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, 3.8583194727420273`*^9, {3.8583225299517107`*^9, 
   3.8583225558740377`*^9}, {3.858327660504786*^9, 3.8583276610094347`*^9}, {
   3.8596087087255*^9, 3.859608730262774*^9}, 
   3.8617507212439117`*^9},ExpressionUUID->"1446b3c6-76b4-44d8-98e9-\
8af1260f8970"],

Cell[CellGroupData[{

Cell["Additive Variance Propagation", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}},ExpressionUUID->"75bc9517-556a-4466-8059-\
1e737c80eed7"],

Cell[TextData[{
 "Here we derive the key result e.g. Eq (20) of ",
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 StyleBox[", that for a sum of i.i.d. Gaussian RVs Z = X+Y, ",
  FontColor->GrayLevel[0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[CapitalEpsilon]", "X"], "[", 
     RowBox[{
      RowBox[{"X", "|", "Z"}], "=", "z"}], "]"}], "=", 
    FractionBox[
     RowBox[{"z", " ", 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "X"], "2"]}], 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "X"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "Y"], "2"]}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3e2a6028-8ac7-4e43-8237-7941c85e9327"],
 " ",
 StyleBox["(check for sign error)",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[". The variance is also shown to be ",
  FontColor->GrayLevel[0]],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["VAR", "X"], "[", 
     RowBox[{
      RowBox[{"X", "|", "Z"}], "=", "z"}], "]"}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "X"], "2"], 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "Y"], "2"]}], 
     RowBox[{
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "X"], "2"], "+", 
      SuperscriptBox[
       SubscriptBox["\[Sigma]", "Y"], "2"]}]]}], TraditionalForm]],
  ExpressionUUID->"4a774823-d3d5-40cf-8e69-02378ae55e95"],
 "."
}], "Text",
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858327667595764*^9, 
   3.858327674742406*^9}},ExpressionUUID->"df50f8d3-e2f5-4f5a-9778-\
61a3a2a221e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xDist", " ", "=", " ", 
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"0", ",", "\[Sigma]x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yDist", " ", "=", " ", 
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"0", ",", "\[Sigma]y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PDF", "[", 
   RowBox[{"xDist", ",", "x"}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"df29d7d5-f772-43c3-971b-41ef594e42a1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"xDist", ",", "x"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{"\[Sigma]x", ">", "0"}], "}"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normZ", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{"xDist", ",", "x"}], "]"}], "*", 
      RowBox[{"PDF", "[", 
       RowBox[{"yDist", ",", 
        RowBox[{"z", "-", "x"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Sigma]x", ">", "0"}], ",", 
        RowBox[{"\[Sigma]y", ">", "0"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"meanXcondZ", "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{"PDF", "[", 
       RowBox[{"xDist", ",", "x"}], "]"}], "*", 
      RowBox[{"PDF", "[", 
       RowBox[{"yDist", ",", 
        RowBox[{"z", "-", "x"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Sigma]x", ">", "0"}], ",", 
        RowBox[{"\[Sigma]y", ">", "0"}]}], "}"}]}]}], "]"}], "/", 
   "normZ"}]}], "\[IndentingNewLine]", 
 RowBox[{"varXcondZ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "-", 
         SuperscriptBox["meanXcondZ", "2"]}], ")"}], "*", 
       RowBox[{"PDF", "[", 
        RowBox[{"xDist", ",", "x"}], "]"}], "*", 
       RowBox[{"PDF", "[", 
        RowBox[{"yDist", ",", 
         RowBox[{"z", "-", "x"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}], ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Sigma]x", ">", "0"}], ",", 
         RowBox[{"\[Sigma]y", ">", "0"}]}], "}"}]}]}], "]"}], "/", "normZ"}], 
   "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stringifySubs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"var_", ",", "sub__"}], "]"}], ":>", 
     RowBox[{"Subscript", "[", 
      RowBox[{"var", ",", 
       RowBox[{"ToString", "[", "sub", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.858253223801854*^9, 3.858253233249765*^9}, {
   3.858253307621861*^9, 3.8582533218341303`*^9}, {3.858254094592751*^9, 
   3.858254126980933*^9}, {3.858254273498124*^9, 3.858254310098398*^9}, {
   3.85825444594135*^9, 3.858254448727231*^9}, {3.8582545483264627`*^9, 
   3.858254548691955*^9}, {3.858254581750565*^9, 3.858254583207653*^9}, {
   3.8582546174903727`*^9, 3.858254657326605*^9}, 3.858327688225945*^9, {
   3.860222471912033*^9, 3.860222472132036*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7c5be982-63ab-45a1-82a6-789088b76943"],

Cell[BoxData[
 FractionBox[
  RowBox[{"z", " ", 
   SuperscriptBox["\[Sigma]x", "2"]}], 
  RowBox[{
   SuperscriptBox["\[Sigma]x", "2"], "+", 
   SuperscriptBox["\[Sigma]y", "2"]}]]], "Output",
 CellChangeTimes->{
  3.8582532361976*^9, 3.858253322167822*^9, {3.858254095696396*^9, 
   3.858254127633691*^9}, {3.8582542993732*^9, 3.858254311312162*^9}, 
   3.858254549344254*^9, 3.858254583861472*^9, {3.858254646501001*^9, 
   3.85825466901716*^9}, 3.8583197463079453`*^9, 3.858321257276157*^9, 
   3.85832147250498*^9, 3.858321548998438*^9, 3.858321645762381*^9, 
   3.858325235017634*^9, 3.858327689099484*^9, 3.858329542129991*^9, 
   3.858329607396276*^9, 3.8583301304937153`*^9, 3.858335310495079*^9, {
   3.858335379047967*^9, 3.8583353988422413`*^9}, {3.858335475745596*^9, 
   3.858335483226239*^9}, 3.8583357378294983`*^9, 3.8583358165703506`*^9, 
   3.858335915763527*^9, 3.859546028642881*^9, 3.8595573494692583`*^9, 
   3.8595575158819237`*^9, 3.8595575467238283`*^9, 3.85955866424398*^9, 
   3.859591311164241*^9, 3.85959135748344*^9, 3.8595915831610126`*^9, 
   3.859591707210122*^9, 3.859607768512066*^9, 3.8596100257249117`*^9, 
   3.859631365252142*^9, 3.8597012034867697`*^9, 3.859701234619413*^9, 
   3.859885018240509*^9, 3.8598851647533913`*^9, 3.859885338874908*^9, 
   3.8598855636278973`*^9, 3.859885597478557*^9, 3.859885662418144*^9, 
   3.859885860116626*^9, 3.859886102381769*^9, {3.85988620561287*^9, 
   3.859886251993841*^9}, 3.859886413124465*^9, 3.859887263772156*^9, 
   3.8598877600970993`*^9, 3.859887792173272*^9, 3.8598878261700277`*^9, 
   3.859967765391168*^9, 3.859980987918412*^9, 3.860036127599744*^9, 
   3.860150619605791*^9, 3.860221336370504*^9, 3.860222476059807*^9, 
   3.8602226384814873`*^9, 3.8602230810441933`*^9, 3.8612539974743347`*^9, 
   3.861750745851695*^9, 3.863856282659644*^9, 3.864116517909315*^9, 
   3.864188115204791*^9, 3.864277787366045*^9, 3.864875711738038*^9, 
   3.867905647885983*^9, 3.8679058352343397`*^9, 3.8691143978487377`*^9, 
   3.869114935185611*^9, 3.8692265384677887`*^9, 3.869292721008522*^9, 
   3.869305605808257*^9, 3.869309783501338*^9, 3.869526558353477*^9, 
   3.869563733265604*^9, 3.8696923752497473`*^9, 3.871566449985693*^9, 
   3.872246803819273*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"91f5444c-38ff-46fd-9022-31d747847a40"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[Sigma]x", "2"], " ", 
   SuperscriptBox["\[Sigma]y", "2"]}], 
  RowBox[{
   SuperscriptBox["\[Sigma]x", "2"], "+", 
   SuperscriptBox["\[Sigma]y", "2"]}]]], "Output",
 CellChangeTimes->{
  3.8582532361976*^9, 3.858253322167822*^9, {3.858254095696396*^9, 
   3.858254127633691*^9}, {3.8582542993732*^9, 3.858254311312162*^9}, 
   3.858254549344254*^9, 3.858254583861472*^9, {3.858254646501001*^9, 
   3.85825466901716*^9}, 3.8583197463079453`*^9, 3.858321257276157*^9, 
   3.85832147250498*^9, 3.858321548998438*^9, 3.858321645762381*^9, 
   3.858325235017634*^9, 3.858327689099484*^9, 3.858329542129991*^9, 
   3.858329607396276*^9, 3.8583301304937153`*^9, 3.858335310495079*^9, {
   3.858335379047967*^9, 3.8583353988422413`*^9}, {3.858335475745596*^9, 
   3.858335483226239*^9}, 3.8583357378294983`*^9, 3.8583358165703506`*^9, 
   3.858335915763527*^9, 3.859546028642881*^9, 3.8595573494692583`*^9, 
   3.8595575158819237`*^9, 3.8595575467238283`*^9, 3.85955866424398*^9, 
   3.859591311164241*^9, 3.85959135748344*^9, 3.8595915831610126`*^9, 
   3.859591707210122*^9, 3.859607768512066*^9, 3.8596100257249117`*^9, 
   3.859631365252142*^9, 3.8597012034867697`*^9, 3.859701234619413*^9, 
   3.859885018240509*^9, 3.8598851647533913`*^9, 3.859885338874908*^9, 
   3.8598855636278973`*^9, 3.859885597478557*^9, 3.859885662418144*^9, 
   3.859885860116626*^9, 3.859886102381769*^9, {3.85988620561287*^9, 
   3.859886251993841*^9}, 3.859886413124465*^9, 3.859887263772156*^9, 
   3.8598877600970993`*^9, 3.859887792173272*^9, 3.8598878261700277`*^9, 
   3.859967765391168*^9, 3.859980987918412*^9, 3.860036127599744*^9, 
   3.860150619605791*^9, 3.860221336370504*^9, 3.860222476059807*^9, 
   3.8602226384814873`*^9, 3.8602230810441933`*^9, 3.8612539974743347`*^9, 
   3.861750745851695*^9, 3.863856282659644*^9, 3.864116517909315*^9, 
   3.864188115204791*^9, 3.864277787366045*^9, 3.864875711738038*^9, 
   3.867905647885983*^9, 3.8679058352343397`*^9, 3.8691143978487377`*^9, 
   3.869114935185611*^9, 3.8692265384677887`*^9, 3.869292721008522*^9, 
   3.869305605808257*^9, 3.869309783501338*^9, 3.869526558353477*^9, 
   3.869563733265604*^9, 3.8696923752497473`*^9, 3.871566449985693*^9, 
   3.872246804936719*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"6d039382-b7e8-4bc6-94e0-ea9d8bca3455"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["OLS Estimators", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.858319960295878*^9, 
  3.858319962580646*^9}},ExpressionUUID->"1550afdd-39e1-4cbd-8ae6-\
c5e37a02f531"],

Cell[TextData[{
 "The linear Gaussian SCM in (1) of ",
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 " has structural equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "c41f93b2-4961-48d4-9611-c04f95bc8444"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "15518162-31c2-45f2-8c69-82e7731b626e"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "332bcb8f-fe3d-4d66-b84b-9645f22f1377"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "15bfc542-771b-4e0b-9f25-38a96243cdd8"],
 ".\n\nTake a general linear causation ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    RowBox[{"X\[Beta]", "+", "e"}]}], TraditionalForm]],ExpressionUUID->
  "5e8f473b-f0ee-4830-b9bb-c8fc329cd2b8"],
 ", where y, e are n-vectors and \[Beta] is a d-vector; there are d \
parameters to be estimated by a dataset composed of n samples.  The OLS \
estimator is:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[Beta]", "^"], "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["X", "T"], "X"}], ")"}], 
       RowBox[{"-", "1"}]], 
      SuperscriptBox["X", "T"], "y"}], " ", "=", 
     RowBox[{"\[Beta]", "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["X", "T"], "X"}], ")"}], 
        RowBox[{"-", "1"}]], 
       SuperscriptBox["X", "T"], "e", "  "}]}]}]}], TraditionalForm]],
  ExpressionUUID->"c1ee1619-3163-43a4-8258-e84a5d75fd75"],
 ".\n\nwith ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CapitalEpsilon]", "[", 
     OverscriptBox["\[Beta]", "^"], "]"}], " ", "=", " ", "\[Beta]"}], 
   TraditionalForm]],ExpressionUUID->"c35e9e9f-2829-49c1-a8e9-60516a268f9a"],
 " and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"VAR", "[", 
     OverscriptBox["\[Beta]", "^"], "]"}], " ", "=", " ", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "e"], "2"], 
     RowBox[{"\[CapitalEpsilon]", "[", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["X", "T"], "X"}], ")"}], 
       RowBox[{"-", "1"}]], "]"}]}]}], TraditionalForm]],ExpressionUUID->
  "c5263786-35e3-488b-8ae6-e860f2768ddb"],
 " (proof completed on paper).\n\nWe mainly care about estimators for a and \
c, as together these form the direct causal treatment effect. In terms of \
only observable variables:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "1603c6b9-aa4b-41c3-bce0-8c4187013061"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      FractionBox["b", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "4c22d1b8-c110-47e5-b1c4-a5c4e0181dcb"],
 ".\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.858327696146021*^9, 3.858327709026256*^9}, {3.8599688791972*^9, 
   3.8599688882107363`*^9}},ExpressionUUID->"5ffd3cd0-17d8-4887-ad91-\
660985f5f854"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Estimator", "[", 
    RowBox[{"Y_", ",", "X_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"Outer", "[", 
        RowBox[{"Dot", ",", "X", ",", "X"}], "]"}], "]"}], ".", 
      RowBox[{"Outer", "[", 
       RowBox[{"Dot", ",", "X", ",", "Y"}], "]"}]}], "]"}], "//", 
    "Simplify"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"m", ",", "x"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     OverscriptBox["bdivd", "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "x", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "m", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["c", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"0acea007-dcdc-46b2-82c6-bba6faa23ace"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"x", ".", "x"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"x", ".", "y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"m", ".", "x"}]}], " ", 
      RowBox[{"x", ".", "m"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "x"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "x"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.858321237814261*^9, 3.858321275556711*^9}, {
   3.858321344765438*^9, 3.858321396977304*^9}, 3.858321475132819*^9, {
   3.85832155157891*^9, 3.858321591751033*^9}, {3.858321648661744*^9, 
   3.8583216881451607`*^9}, {3.858321731193996*^9, 3.858321751305106*^9}, {
   3.858321866961751*^9, 3.858321920747118*^9}, 3.858321995911356*^9, 
   3.8583221315087347`*^9, 3.8583252375286083`*^9, 3.858329543246525*^9, 
   3.858329608511176*^9, 3.858330131643426*^9, 3.858335311642552*^9, {
   3.858335380192464*^9, 3.858335400061833*^9}, {3.8583354769916353`*^9, 
   3.858335484500152*^9}, 3.8583357390720778`*^9, 3.858335817987973*^9, 
   3.8583359171627417`*^9, 3.859546029741191*^9, 3.859557351154875*^9, 
   3.859557517622621*^9, 3.859557548453907*^9, 3.859558666049189*^9, 
   3.859591312386841*^9, 3.859591358689703*^9, 3.859591584416916*^9, 
   3.859591708642069*^9, 3.859607769660883*^9, 3.859610026948154*^9, 
   3.85963136697225*^9, 3.859701206435688*^9, 3.859701237703805*^9, 
   3.859885019448667*^9, 3.859885166029502*^9, 3.859885340197199*^9, 
   3.8598855648989363`*^9, 3.859885598818777*^9, 3.859885663780439*^9, 
   3.8598858614267178`*^9, 3.859886103707241*^9, {3.859886207021199*^9, 
   3.859886253361843*^9}, 3.859886414573346*^9, 3.859887265373901*^9, 
   3.8598877615942373`*^9, 3.8598877937881107`*^9, 3.859887827783927*^9, 
   3.859967766775197*^9, 3.859980989222794*^9, 3.8600361296443453`*^9, 
   3.860150620689313*^9, 3.860221337466201*^9, 3.860222477154893*^9, 
   3.8602226403200207`*^9, 3.860223082183514*^9, 3.8612540016907787`*^9, 
   3.861750746964156*^9, 3.8638562837683764`*^9, 3.8641165201203623`*^9, 
   3.864188116380393*^9, 3.8642777884229307`*^9, 3.8648757129093733`*^9, 
   3.867905650807822*^9, 3.86790583848707*^9, 3.8691143989198637`*^9, 
   3.8691149364105473`*^9, 3.869226540221107*^9, 3.8692927223079777`*^9, 
   3.869305607104968*^9, 3.869309784806391*^9, 3.8695265594900513`*^9, 
   3.869563735355846*^9, 3.8696923764268713`*^9, 3.871566453418482*^9, 
   3.872246805039557*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"e6a840e3-58c8-4935-8271-07c4e4c27c85"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"x", ".", "m"}], 
   RowBox[{"x", ".", "x"}]], "}"}]], "Output",
 CellChangeTimes->{{3.858321237814261*^9, 3.858321275556711*^9}, {
   3.858321344765438*^9, 3.858321396977304*^9}, 3.858321475132819*^9, {
   3.85832155157891*^9, 3.858321591751033*^9}, {3.858321648661744*^9, 
   3.8583216881451607`*^9}, {3.858321731193996*^9, 3.858321751305106*^9}, {
   3.858321866961751*^9, 3.858321920747118*^9}, 3.858321995911356*^9, 
   3.8583221315087347`*^9, 3.8583252375286083`*^9, 3.858329543246525*^9, 
   3.858329608511176*^9, 3.858330131643426*^9, 3.858335311642552*^9, {
   3.858335380192464*^9, 3.858335400061833*^9}, {3.8583354769916353`*^9, 
   3.858335484500152*^9}, 3.8583357390720778`*^9, 3.858335817987973*^9, 
   3.8583359171627417`*^9, 3.859546029741191*^9, 3.859557351154875*^9, 
   3.859557517622621*^9, 3.859557548453907*^9, 3.859558666049189*^9, 
   3.859591312386841*^9, 3.859591358689703*^9, 3.859591584416916*^9, 
   3.859591708642069*^9, 3.859607769660883*^9, 3.859610026948154*^9, 
   3.85963136697225*^9, 3.859701206435688*^9, 3.859701237703805*^9, 
   3.859885019448667*^9, 3.859885166029502*^9, 3.859885340197199*^9, 
   3.8598855648989363`*^9, 3.859885598818777*^9, 3.859885663780439*^9, 
   3.8598858614267178`*^9, 3.859886103707241*^9, {3.859886207021199*^9, 
   3.859886253361843*^9}, 3.859886414573346*^9, 3.859887265373901*^9, 
   3.8598877615942373`*^9, 3.8598877937881107`*^9, 3.859887827783927*^9, 
   3.859967766775197*^9, 3.859980989222794*^9, 3.8600361296443453`*^9, 
   3.860150620689313*^9, 3.860221337466201*^9, 3.860222477154893*^9, 
   3.8602226403200207`*^9, 3.860223082183514*^9, 3.8612540016907787`*^9, 
   3.861750746964156*^9, 3.8638562837683764`*^9, 3.8641165201203623`*^9, 
   3.864188116380393*^9, 3.8642777884229307`*^9, 3.8648757129093733`*^9, 
   3.867905650807822*^9, 3.86790583848707*^9, 3.8691143989198637`*^9, 
   3.8691149364105473`*^9, 3.869226540221107*^9, 3.8692927223079777`*^9, 
   3.869305607104968*^9, 3.869309784806391*^9, 3.8695265594900513`*^9, 
   3.869563735355846*^9, 3.8696923764268713`*^9, 3.871566453418482*^9, 
   3.872246805040895*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"1d195e44-e645-49b3-9655-ae9994315d6e"]
}, Open  ]],

Cell[TextData[{
 "Modifying the structural equations for the approximate FDC means that we \
neglect direct dependence of long-term outcome y on estimator w, removing the \
b coefficient.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1267e8a7-7be9-4362-93dc-806b15a75642"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ff54a71a-c26a-47b1-8fcf-d696b451e698"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "97854a6d-4c12-4377-987c-9d811dcbddce"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "252ab0cc-6850-4c9b-b9d2-a6cf045ce6bd"],
 ".\n\nOur estimator for a simplifies to:\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 
   3.858322500604581*^9}},ExpressionUUID->"bf9e62c9-c085-4469-91bb-\
f2a3ce6eeb5c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", "m", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["approxa", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Ya", ",", "Xa"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.8583247691588697`*^9, 
   3.8583247696480713`*^9}, {3.858326468428941*^9, 3.858326468779766*^9}, {
   3.858329493672307*^9, 3.858329512619833*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"9e849b21-5c9b-44da-9744-3f8d9153876f"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"m", ".", "y"}], 
   RowBox[{"m", ".", "m"}]], "}"}]], "Output",
 CellChangeTimes->{{3.858322473768626*^9, 3.858322490947681*^9}, 
   3.8583252375362263`*^9, 3.858326480073419*^9, {3.858329515618561*^9, 
   3.858329543256625*^9}, 3.858329608521304*^9, 3.858330131655394*^9, 
   3.858335311653891*^9, {3.858335380204446*^9, 3.858335400073502*^9}, {
   3.858335477004875*^9, 3.858335484513026*^9}, 3.858335739081478*^9, 
   3.8583358179984827`*^9, 3.858335917172762*^9, 3.859546029753283*^9, 
   3.859557351348983*^9, 3.8595575177276173`*^9, 3.859557548728692*^9, 
   3.859558666150695*^9, 3.8595913124010887`*^9, 3.8595913587050753`*^9, 
   3.859591584435091*^9, 3.859591708656304*^9, 3.859607769670054*^9, 
   3.8596100269631453`*^9, 3.859631366989128*^9, 3.859701206462923*^9, 
   3.8597012377313013`*^9, 3.8598850194595833`*^9, 3.8598851660426903`*^9, 
   3.859885340208415*^9, 3.859885564910611*^9, 3.859885598830041*^9, 
   3.8598856637925987`*^9, 3.859885861438548*^9, 3.859886103717905*^9, {
   3.8598862070325823`*^9, 3.859886253373713*^9}, 3.859886414585495*^9, 
   3.859887265389132*^9, 3.859887761606275*^9, 3.859887793801695*^9, 
   3.859887827798067*^9, 3.859967766785866*^9, 3.859980989232905*^9, 
   3.860036129663295*^9, 3.860150620700039*^9, 3.860221337476946*^9, 
   3.860222477164364*^9, 3.860222640331573*^9, 3.860223082195101*^9, 
   3.8612540017116823`*^9, 3.861750746975129*^9, 3.8638562837779083`*^9, 
   3.8641165201496143`*^9, 3.864188116393044*^9, 3.864277788435371*^9, 
   3.864875712922477*^9, 3.867905650841531*^9, 3.867905838518753*^9, 
   3.8691143989292507`*^9, 3.869114936420768*^9, 3.8692265402389*^9, 
   3.869292722325091*^9, 3.869305607121347*^9, 3.8693097848234253`*^9, 
   3.869526559500695*^9, 3.869563735380082*^9, 3.8696923764422607`*^9, 
   3.871566453457342*^9, 3.872246805060017*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"42d7a39e-869c-4822-b916-a6fe0254aacc"]
}, Open  ]],

Cell[TextData[{
 "Extending our causal graph to have a dependency W\[Rule]M, linearly \
controlled by \[Epsilon], modifies the structural equations as follows:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "e7fd76df-e3ac-409f-b118-f16770c5f746"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "cb39668e-461f-4800-9b75-adb225867205"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "56de0f36-4459-4c85-9603-3f3a60c2fa73"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "8b26c63f-5e1f-4fd3-8ffe-37358b1c48f9"],
 ".\n\nApplying the standard FDC is not technically permitted, because node X \
no longer blocks all backdoor paths from M to Y; however, since W is \
unobserved, it cannot be a member of the FDC set. Since the intention is to \
evaluate error from violating this very assumption, we apply the FDC with \
{X,M} regardless, and obtain estimators as follows:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f587b5c6-67f2-49dc-91a5-9550827da439"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      FractionBox["b", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f97cb86e-f750-4f0f-8a39-841c4fedc2d7"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "b"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "m"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "9427bfcf-8fab-41dc-9a22-99029c8ff8c9"],
 "\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.859968986249598*^9, 
   3.859969015758976*^9}},ExpressionUUID->"9f44316e-a962-4554-93f7-\
1ab67a3fa689"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"m", ",", "x"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["aplusedivb", "^"], ",", 
     OverscriptBox["bdivd", "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "x", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "m", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["cplusedivd", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.858324779349805*^9, 3.8583247888458023`*^9}, {
   3.8583253078292217`*^9, 3.858325314837751*^9}, {3.858325396607929*^9, 
   3.85832542701947*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"f91c049a-16a4-4a64-9657-c82a9ee2b001"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"x", ".", "x"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"x", ".", "y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"m", ".", "x"}]}], " ", 
      RowBox[{"x", ".", "m"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "x"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "x"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.8595915844518557`*^9, 3.8595917086686*^9, 
   3.85960776967925*^9, 3.8596100269757347`*^9, 3.859631367005549*^9, 
   3.859701206486987*^9, 3.859701237755622*^9, 3.8598850194712267`*^9, 
   3.859885166056237*^9, 3.859885340219635*^9, 3.8598855649221697`*^9, 
   3.859885598840631*^9, 3.859885663804226*^9, 3.8598858614499073`*^9, 
   3.859886103728126*^9, {3.859886207044064*^9, 3.859886253385075*^9}, 
   3.859886414596971*^9, 3.859887265403178*^9, 3.859887761618554*^9, 
   3.859887793814382*^9, 3.859887827811234*^9, 3.85996776679568*^9, 
   3.859980989241984*^9, 3.86003612968116*^9, 3.860150620710956*^9, 
   3.8602213374894447`*^9, 3.860222477173069*^9, 3.860222640342804*^9, 
   3.860223082206503*^9, 3.861254001737699*^9, 3.861750746985394*^9, 
   3.863856283787203*^9, 3.8641165201694183`*^9, 3.864188116405139*^9, 
   3.864277788446969*^9, 3.864875712934051*^9, 3.867905650874506*^9, 
   3.867905838551066*^9, 3.869114398938346*^9, 3.869114936430955*^9, 
   3.8692265402563877`*^9, 3.869292722339633*^9, 3.869305607135138*^9, 
   3.869309784837867*^9, 3.8695265595108023`*^9, 3.8695637354035788`*^9, 
   3.869692376456608*^9, 3.8715664534880133`*^9, 3.872246805079625*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"09e29f42-c063-48c3-a989-0652d7107ce5"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"x", ".", "m"}], 
   RowBox[{"x", ".", "x"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.8595915844518557`*^9, 3.8595917086686*^9, 
   3.85960776967925*^9, 3.8596100269757347`*^9, 3.859631367005549*^9, 
   3.859701206486987*^9, 3.859701237755622*^9, 3.8598850194712267`*^9, 
   3.859885166056237*^9, 3.859885340219635*^9, 3.8598855649221697`*^9, 
   3.859885598840631*^9, 3.859885663804226*^9, 3.8598858614499073`*^9, 
   3.859886103728126*^9, {3.859886207044064*^9, 3.859886253385075*^9}, 
   3.859886414596971*^9, 3.859887265403178*^9, 3.859887761618554*^9, 
   3.859887793814382*^9, 3.859887827811234*^9, 3.85996776679568*^9, 
   3.859980989241984*^9, 3.86003612968116*^9, 3.860150620710956*^9, 
   3.8602213374894447`*^9, 3.860222477173069*^9, 3.860222640342804*^9, 
   3.860223082206503*^9, 3.861254001737699*^9, 3.861750746985394*^9, 
   3.863856283787203*^9, 3.8641165201694183`*^9, 3.864188116405139*^9, 
   3.864277788446969*^9, 3.864875712934051*^9, 3.867905650874506*^9, 
   3.867905838551066*^9, 3.869114398938346*^9, 3.869114936430955*^9, 
   3.8692265402563877`*^9, 3.869292722339633*^9, 3.869305607135138*^9, 
   3.869309784837867*^9, 3.8695265595108023`*^9, 3.8695637354035788`*^9, 
   3.869692376456608*^9, 3.8715664534880133`*^9, 3.872246805080916*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"99dec690-f89a-43d9-9979-45d5d90d5661"]
}, Open  ]],

Cell[TextData[{
 "Extending our causal graph to have a pre-treatment covariate P with arrows \
P\[Rule]X, P\[Rule]M, P\[Rule]Y, linearly controlled by coefficients ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Xi]", "1"], ",", 
    SubscriptBox["\[Xi]", "2"], ",", 
    SubscriptBox["\[Xi]", "3"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "1f83e37e-572d-4c0f-a01a-79d000e25123"],
 ", modifies the structural equations as follows:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c4ce8cb7-0ba6-4949-b5ea-21e548830bcb"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     RowBox[{
      SubscriptBox["\[Xi]", "1"], 
      SubscriptBox["p", "i"]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bda48d24-acfb-407f-9eae-25cb561db1ea"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      SubscriptBox["\[Xi]", "2"], 
      SubscriptBox["p", "i"]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dc200fb0-de34-4d20-879b-d069f11312b0"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      SubscriptBox["\[Xi]", "3"], 
      SubscriptBox["p", "i"]}], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e6d9216e-deec-4555-b0db-4457d0792ff5"],
 ".\n\nApplying the standard FDC is now permitted using nodes {P,X,M}, and we \
obtain estimators as follows:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      SubscriptBox["\[Xi]", "2"], 
      SubscriptBox["p", "i"]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "19556d32-09ba-4130-a851-fce087067ceb"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      FractionBox["b", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     RowBox[{
      SubscriptBox["\[Xi]", "3"], 
      SubscriptBox["p", "i"]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "9040bc4e-622b-4a23-be00-da69d65e334b"],
 ".\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.85832479864642*^9, 
   3.8583248958123207`*^9}, {3.858325064830866*^9, 
   3.858325137224842*^9}},ExpressionUUID->"351b1c0f-ab00-4005-bdaa-\
bae51a7658d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Estimator", "[", 
    RowBox[{"Y_", ",", "X_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Inverse", "[", 
       RowBox[{"Outer", "[", 
        RowBox[{"Dot", ",", "X", ",", "X"}], "]"}], "]"}], ".", 
      RowBox[{"Outer", "[", 
       RowBox[{"Dot", ",", "X", ",", "Y"}], "]"}]}], "]"}], "//", 
    "Simplify"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"m", ",", "x", ",", "p"}], "}"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["aP", "^"], ",", 
     OverscriptBox["bdivdP", "^"], ",", 
     OverscriptBox[
      RowBox[{
       SubscriptBox["\[Xi]", "3"], "P"}], "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "p"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "m", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    OverscriptBox["cP", "^"], ",", 
    OverscriptBox[
     RowBox[{
      SubscriptBox["\[Xi]", "2"], "P"}], "^"]}], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.858325168344387*^9, 
   3.858325212211597*^9}, {3.858329566837508*^9, 3.858329601546784*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"227540ad-76f4-432f-98dd-5408c0d51d4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "x"}]}], " ", 
         RowBox[{"x", ".", "p"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "p"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "y"}], " ", 
         RowBox[{"x", ".", "p"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "p"}], " ", 
         RowBox[{"x", ".", "y"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "p"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "y"}]}], " ", 
         RowBox[{"x", ".", "x"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "x"}], " ", 
         RowBox[{"x", ".", "y"}]}]}], ")"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "p"}]}], " ", 
         RowBox[{"x", ".", "m"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "p"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "p"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "x"}], " ", 
         RowBox[{"x", ".", "m"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "x"}]}], " ", 
         RowBox[{"x", ".", "p"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "p"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "p"}]}], " ", 
         RowBox[{"x", ".", "m"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "p"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "p"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "y"}], " ", 
         RowBox[{"x", ".", "m"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "y"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "y"}]}], " ", 
         RowBox[{"x", ".", "p"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "p"}], " ", 
         RowBox[{"x", ".", "y"}]}]}], ")"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "p"}]}], " ", 
         RowBox[{"x", ".", "m"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "p"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "p"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "x"}], " ", 
         RowBox[{"x", ".", "m"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "x"}]}], " ", 
         RowBox[{"x", ".", "p"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "p"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "y"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "x"}], " ", 
         RowBox[{"x", ".", "m"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "y"}]}], " ", 
         RowBox[{"x", ".", "m"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "y"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "y"}], " ", 
         RowBox[{"x", ".", "x"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "x"}], " ", 
         RowBox[{"x", ".", "y"}]}]}], ")"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "p"}]}], " ", 
         RowBox[{"x", ".", "m"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "p"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "p"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"p", ".", "x"}], " ", 
         RowBox[{"x", ".", "m"}]}], "-", 
        RowBox[{
         RowBox[{"p", ".", "m"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"p", ".", "x"}]}], " ", 
         RowBox[{"x", ".", "p"}]}], "+", 
        RowBox[{
         RowBox[{"p", ".", "p"}], " ", 
         RowBox[{"x", ".", "x"}]}]}], ")"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.858321237814261*^9, 3.858321275556711*^9}, {
   3.858321344765438*^9, 3.858321396977304*^9}, 3.858321475132819*^9, {
   3.85832155157891*^9, 3.858321591751033*^9}, {3.858321648661744*^9, 
   3.8583216881451607`*^9}, {3.858321731193996*^9, 3.858321751305106*^9}, {
   3.858321866961751*^9, 3.858321920747118*^9}, 3.858321995911356*^9, 
   3.8583221315087347`*^9, {3.8583252155703783`*^9, 3.8583252375767307`*^9}, 
   3.858329543304554*^9, 3.8583296085709743`*^9, 3.85833013170802*^9, 
   3.858335311707922*^9, {3.85833538025812*^9, 3.858335400126658*^9}, {
   3.8583354770596447`*^9, 3.858335484567803*^9}, 3.858335739132814*^9, 
   3.858335818050639*^9, 3.8583359172245007`*^9, 3.859546029803203*^9, 
   3.859557351580443*^9, 3.859557518020718*^9, 3.8595575489349203`*^9, 
   3.859558666694817*^9, 3.859591312459209*^9, 3.859591358764349*^9, 
   3.859591584499442*^9, 3.859591708714868*^9, 3.859607769717804*^9, 
   3.859610027020137*^9, 3.8596313670684958`*^9, 3.859701206601701*^9, 
   3.859701237862863*^9, 3.8598850195158453`*^9, 3.8598851661043177`*^9, 
   3.8598853402683687`*^9, 3.8598855649737186`*^9, 3.859885598889328*^9, 
   3.859885663851946*^9, 3.859885861498498*^9, 3.859886103775757*^9, {
   3.859886207093381*^9, 3.859886253434266*^9}, 3.859886414646723*^9, 
   3.859887265459543*^9, 3.8598877616679163`*^9, 3.8598877938684263`*^9, 
   3.859887827866014*^9, 3.8599677668397093`*^9, 3.859980989283312*^9, 
   3.8600361297469587`*^9, 3.860150620748481*^9, 3.860221337528193*^9, 
   3.86022247721246*^9, 3.860222640382732*^9, 3.860223082245542*^9, 
   3.861254001840588*^9, 3.861750747023946*^9, 3.8638562838261642`*^9, 
   3.8641165202504473`*^9, 3.8641881164470787`*^9, 3.864277788485189*^9, 
   3.864875712971628*^9, 3.867905650987505*^9, 3.867905838666507*^9, 
   3.869114398975689*^9, 3.8691149364728003`*^9, 3.8692265403204937`*^9, 
   3.869292722390493*^9, 3.86930560718134*^9, 3.869309784884693*^9, 
   3.869526559549699*^9, 3.869563735477169*^9, 3.869692376498571*^9, 
   3.87156645362748*^9, 3.8722468051230307`*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"dffe5e80-395c-45bf-817e-888fd7b28cee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"p", ".", "p"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"p", ".", "m"}], " ", 
      RowBox[{"x", ".", "p"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"p", ".", "x"}]}], " ", 
      RowBox[{"x", ".", "p"}]}], "+", 
     RowBox[{
      RowBox[{"p", ".", "p"}], " ", 
      RowBox[{"x", ".", "x"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"p", ".", "x"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"p", ".", "m"}], " ", 
      RowBox[{"x", ".", "x"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"p", ".", "x"}], " ", 
      RowBox[{"x", ".", "p"}]}], "-", 
     RowBox[{
      RowBox[{"p", ".", "p"}], " ", 
      RowBox[{"x", ".", "x"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.858321237814261*^9, 3.858321275556711*^9}, {
   3.858321344765438*^9, 3.858321396977304*^9}, 3.858321475132819*^9, {
   3.85832155157891*^9, 3.858321591751033*^9}, {3.858321648661744*^9, 
   3.8583216881451607`*^9}, {3.858321731193996*^9, 3.858321751305106*^9}, {
   3.858321866961751*^9, 3.858321920747118*^9}, 3.858321995911356*^9, 
   3.8583221315087347`*^9, {3.8583252155703783`*^9, 3.8583252375767307`*^9}, 
   3.858329543304554*^9, 3.8583296085709743`*^9, 3.85833013170802*^9, 
   3.858335311707922*^9, {3.85833538025812*^9, 3.858335400126658*^9}, {
   3.8583354770596447`*^9, 3.858335484567803*^9}, 3.858335739132814*^9, 
   3.858335818050639*^9, 3.8583359172245007`*^9, 3.859546029803203*^9, 
   3.859557351580443*^9, 3.859557518020718*^9, 3.8595575489349203`*^9, 
   3.859558666694817*^9, 3.859591312459209*^9, 3.859591358764349*^9, 
   3.859591584499442*^9, 3.859591708714868*^9, 3.859607769717804*^9, 
   3.859610027020137*^9, 3.8596313670684958`*^9, 3.859701206601701*^9, 
   3.859701237862863*^9, 3.8598850195158453`*^9, 3.8598851661043177`*^9, 
   3.8598853402683687`*^9, 3.8598855649737186`*^9, 3.859885598889328*^9, 
   3.859885663851946*^9, 3.859885861498498*^9, 3.859886103775757*^9, {
   3.859886207093381*^9, 3.859886253434266*^9}, 3.859886414646723*^9, 
   3.859887265459543*^9, 3.8598877616679163`*^9, 3.8598877938684263`*^9, 
   3.859887827866014*^9, 3.8599677668397093`*^9, 3.859980989283312*^9, 
   3.8600361297469587`*^9, 3.860150620748481*^9, 3.860221337528193*^9, 
   3.86022247721246*^9, 3.860222640382732*^9, 3.860223082245542*^9, 
   3.861254001840588*^9, 3.861750747023946*^9, 3.8638562838261642`*^9, 
   3.8641165202504473`*^9, 3.8641881164470787`*^9, 3.864277788485189*^9, 
   3.864875712971628*^9, 3.867905650987505*^9, 3.867905838666507*^9, 
   3.869114398975689*^9, 3.8691149364728003`*^9, 3.8692265403204937`*^9, 
   3.869292722390493*^9, 3.86930560718134*^9, 3.869309784884693*^9, 
   3.869526559549699*^9, 3.869563735477169*^9, 3.869692376498571*^9, 
   3.87156645362748*^9, 3.8722468051248207`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"135e086a-0e75-4a0b-9566-5e72d6fdeb60"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biases and Variances", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 
  3.8583294837393723`*^9}},ExpressionUUID->"06c4d03f-5d88-4895-8359-\
cab72b4e9847"],

Cell["\<\
For some reason the linearity property of Dot is not applied by Mathematica \
unless each vector is explicitly defined as a list -- a workaround for this \
may become necessary but using the GenVector function below should work for \
now. Update: workaround found, use TensorExpand with Reals assumptions.\
\>", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.858335532700376*^9, 3.858335564776896*^9}, {3.858335649607807*^9, 
  3.8583356557769747`*^9}, {3.858336399224999*^9, 
  3.8583364056425467`*^9}},ExpressionUUID->"31c7e24e-cdc7-41a6-9bd4-\
d08056299da6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GenVector", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"x", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"av", " ", "=", " ", 
  RowBox[{"GenVector", "[", 
   RowBox[{"\"\<a\>\"", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"bv", " ", "=", " ", 
  RowBox[{"GenVector", "[", 
   RowBox[{"\"\<b\>\"", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"av", ".", 
    RowBox[{"(", 
     RowBox[{"2", "*", "bv"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "*", "av"}], ")"}], ".", "bv"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{"av", ",", 
     RowBox[{"2", "bv"}]}], "]"}], "==", 
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"2", "av"}], ",", "bv"}], "]"}]}], "//", "Expand"}]}], "Input",
 CellChangeTimes->{
  3.858335479639605*^9, {3.8583358012515297`*^9, 3.858335812276731*^9}, {
   3.8583358695595922`*^9, 3.8583358726981697`*^9}, {3.8583359052854347`*^9, 
   3.858335905843792*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"e608f519-4e15-4b60-8173-43b22aaedbe3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\<\"a\"\>", "0"], ",", 
   SubscriptBox["\<\"a\"\>", "1"]}], "}"}]], "Output",
 CellChangeTimes->{{3.858335468471129*^9, 3.858335484581622*^9}, 
   3.858335739144541*^9, 3.858335818062068*^9, 3.8583359172362957`*^9, 
   3.859546029815921*^9, 3.859557351723219*^9, 3.859557518128221*^9, 
   3.859557549126644*^9, 3.85955866679675*^9, 3.8595913124748774`*^9, 
   3.8595913587816143`*^9, 3.859591584517844*^9, 3.859591708729751*^9, 
   3.859607769729137*^9, 3.8596100270390387`*^9, 3.8596313670880136`*^9, 
   3.859701206634202*^9, 3.859701237890781*^9, 3.859885019529757*^9, 
   3.859885166118984*^9, 3.859885340282947*^9, 3.859885564987893*^9, 
   3.859885598902178*^9, 3.859885663865078*^9, 3.8598858615116673`*^9, 
   3.859886103788653*^9, {3.8598862071058273`*^9, 3.859886253447858*^9}, 
   3.8598864146603737`*^9, 3.859887265477705*^9, 3.859887761683137*^9, 
   3.85988779388431*^9, 3.859887827882107*^9, 3.8599677668587093`*^9, 
   3.859980989301384*^9, 3.860036129769638*^9, 3.860150620760791*^9, 
   3.860221337539362*^9, 3.860222477223081*^9, 3.860222640396969*^9, 
   3.8602230822590637`*^9, 3.861254001890463*^9, 3.861750747035521*^9, 
   3.863856283838879*^9, 3.864116520279313*^9, 3.8641881164631863`*^9, 
   3.864277788499289*^9, 3.864875712985777*^9, 3.8679056510242653`*^9, 
   3.867905838702818*^9, 3.8691143989868593`*^9, 3.869114936485406*^9, 
   3.869226540339118*^9, 3.869292722408546*^9, 3.86930560719971*^9, 
   3.8693097849031363`*^9, 3.869526559561557*^9, 3.8695637355043383`*^9, 
   3.86969237651604*^9, 3.871566453656067*^9, 3.872246805144516*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"b86ba64f-22c7-49f5-8a04-73b4e36e663a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["\<\"b\"\>", "0"], ",", 
   SubscriptBox["\<\"b\"\>", "1"]}], "}"}]], "Output",
 CellChangeTimes->{{3.858335468471129*^9, 3.858335484581622*^9}, 
   3.858335739144541*^9, 3.858335818062068*^9, 3.8583359172362957`*^9, 
   3.859546029815921*^9, 3.859557351723219*^9, 3.859557518128221*^9, 
   3.859557549126644*^9, 3.85955866679675*^9, 3.8595913124748774`*^9, 
   3.8595913587816143`*^9, 3.859591584517844*^9, 3.859591708729751*^9, 
   3.859607769729137*^9, 3.8596100270390387`*^9, 3.8596313670880136`*^9, 
   3.859701206634202*^9, 3.859701237890781*^9, 3.859885019529757*^9, 
   3.859885166118984*^9, 3.859885340282947*^9, 3.859885564987893*^9, 
   3.859885598902178*^9, 3.859885663865078*^9, 3.8598858615116673`*^9, 
   3.859886103788653*^9, {3.8598862071058273`*^9, 3.859886253447858*^9}, 
   3.8598864146603737`*^9, 3.859887265477705*^9, 3.859887761683137*^9, 
   3.85988779388431*^9, 3.859887827882107*^9, 3.8599677668587093`*^9, 
   3.859980989301384*^9, 3.860036129769638*^9, 3.860150620760791*^9, 
   3.860221337539362*^9, 3.860222477223081*^9, 3.860222640396969*^9, 
   3.8602230822590637`*^9, 3.861254001890463*^9, 3.861750747035521*^9, 
   3.863856283838879*^9, 3.864116520279313*^9, 3.8641881164631863`*^9, 
   3.864277788499289*^9, 3.864875712985777*^9, 3.8679056510242653`*^9, 
   3.867905838702818*^9, 3.8691143989868593`*^9, 3.869114936485406*^9, 
   3.869226540339118*^9, 3.869292722408546*^9, 3.86930560719971*^9, 
   3.8693097849031363`*^9, 3.869526559561557*^9, 3.8695637355043383`*^9, 
   3.86969237651604*^9, 3.871566453656067*^9, 3.8722468051457644`*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"2c4c3cc5-f9d5-4199-ade0-05dac51d9ff7"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.858335468471129*^9, 3.858335484581622*^9}, 
   3.858335739144541*^9, 3.858335818062068*^9, 3.8583359172362957`*^9, 
   3.859546029815921*^9, 3.859557351723219*^9, 3.859557518128221*^9, 
   3.859557549126644*^9, 3.85955866679675*^9, 3.8595913124748774`*^9, 
   3.8595913587816143`*^9, 3.859591584517844*^9, 3.859591708729751*^9, 
   3.859607769729137*^9, 3.8596100270390387`*^9, 3.8596313670880136`*^9, 
   3.859701206634202*^9, 3.859701237890781*^9, 3.859885019529757*^9, 
   3.859885166118984*^9, 3.859885340282947*^9, 3.859885564987893*^9, 
   3.859885598902178*^9, 3.859885663865078*^9, 3.8598858615116673`*^9, 
   3.859886103788653*^9, {3.8598862071058273`*^9, 3.859886253447858*^9}, 
   3.8598864146603737`*^9, 3.859887265477705*^9, 3.859887761683137*^9, 
   3.85988779388431*^9, 3.859887827882107*^9, 3.8599677668587093`*^9, 
   3.859980989301384*^9, 3.860036129769638*^9, 3.860150620760791*^9, 
   3.860221337539362*^9, 3.860222477223081*^9, 3.860222640396969*^9, 
   3.8602230822590637`*^9, 3.861254001890463*^9, 3.861750747035521*^9, 
   3.863856283838879*^9, 3.864116520279313*^9, 3.8641881164631863`*^9, 
   3.864277788499289*^9, 3.864875712985777*^9, 3.8679056510242653`*^9, 
   3.867905838702818*^9, 3.8691143989868593`*^9, 3.869114936485406*^9, 
   3.869226540339118*^9, 3.869292722408546*^9, 3.86930560719971*^9, 
   3.8693097849031363`*^9, 3.869526559561557*^9, 3.8695637355043383`*^9, 
   3.86969237651604*^9, 3.871566453656067*^9, 3.8722468051468554`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"bc077268-78d9-4ca9-8384-445bc4fd9aaa"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.858335468471129*^9, 3.858335484581622*^9}, 
   3.858335739144541*^9, 3.858335818062068*^9, 3.8583359172362957`*^9, 
   3.859546029815921*^9, 3.859557351723219*^9, 3.859557518128221*^9, 
   3.859557549126644*^9, 3.85955866679675*^9, 3.8595913124748774`*^9, 
   3.8595913587816143`*^9, 3.859591584517844*^9, 3.859591708729751*^9, 
   3.859607769729137*^9, 3.8596100270390387`*^9, 3.8596313670880136`*^9, 
   3.859701206634202*^9, 3.859701237890781*^9, 3.859885019529757*^9, 
   3.859885166118984*^9, 3.859885340282947*^9, 3.859885564987893*^9, 
   3.859885598902178*^9, 3.859885663865078*^9, 3.8598858615116673`*^9, 
   3.859886103788653*^9, {3.8598862071058273`*^9, 3.859886253447858*^9}, 
   3.8598864146603737`*^9, 3.859887265477705*^9, 3.859887761683137*^9, 
   3.85988779388431*^9, 3.859887827882107*^9, 3.8599677668587093`*^9, 
   3.859980989301384*^9, 3.860036129769638*^9, 3.860150620760791*^9, 
   3.860221337539362*^9, 3.860222477223081*^9, 3.860222640396969*^9, 
   3.8602230822590637`*^9, 3.861254001890463*^9, 3.861750747035521*^9, 
   3.863856283838879*^9, 3.864116520279313*^9, 3.8641881164631863`*^9, 
   3.864277788499289*^9, 3.864875712985777*^9, 3.8679056510242653`*^9, 
   3.867905838702818*^9, 3.8691143989868593`*^9, 3.869114936485406*^9, 
   3.869226540339118*^9, 3.869292722408546*^9, 3.86930560719971*^9, 
   3.8693097849031363`*^9, 3.869526559561557*^9, 3.8695637355043383`*^9, 
   3.86969237651604*^9, 3.871566453656067*^9, 3.872246805147683*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"4e66e9d6-0d3a-4d81-aa7f-c0ff03baa2d0"]
}, Open  ]],

Cell[TextData[{
 "Using the structural equations, we can separate estimators into mean and \
variance terms.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a0980573-8580-4d3f-82ba-3fb76c0ebe54"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "cc9e3719-be69-4cfe-8862-963bd408907e"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "bdbf0319-3549-485c-b2cf-cb250d917768"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3b93a3f8-09f0-4c75-8309-797010583c75"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 
  3.858329671361067*^9}},ExpressionUUID->"7eb912d9-fea8-402d-a8e2-\
486f7b51f7e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "m"}], "+", 
       RowBox[{"b", "*", "w"}], "+", "uy"}]}], ",", 
     RowBox[{"w", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "ux"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["a", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aerror", " ", "=", " ", 
  RowBox[{
   RowBox[{"TensorExpand", "[", 
    RowBox[{"aerror", ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "|", "b"}], ")"}], "\[Element]", "Reals"}]}]}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQnVK965vu/jeOJlN4foBoP4lsJj0gXWH2AUzPWxoo
CKJ7RCaJgei6JnN1EB3iwasBovl+5hmB6D//RU1ANPchOysQ/ShruiNYv3+4
N4h+KfXJH0QfLvbabACkfSe+3gKi3wjc2AuiLVp+HwfRLcWzzoHoSyqfr4Fo
k2SzbyA6/d/JfyD6Rvd8VkMgzXXyEpi2izzNCaJ3mwXygehZHVdFQPSEKEZJ
EP0hJt4QRFf/2GMCov08M51ANO/DOg8QXbXV0QdES7GnB4DohH02nSDa64R+
D4j++WL/IxDddeX+ExDNMnPPKxC9YvuWdyB6i20+pxGQrjecC6Y/bTTSBdEb
9B3ANACSTrJV
  "],
 CellLabel->"In[39]:=",ExpressionUUID->"34a58a2a-2bd7-4200-b7a7-52a5977a7ec5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"m", ".", "x"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "b"}], " ", 
       RowBox[{"x", ".", "ux"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"x", ".", "uy"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", 
       RowBox[{"m", ".", "ux"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"m", ".", "uy"}]}]}], ")"}], " ", 
    RowBox[{"x", ".", "x"}]}]}], 
  RowBox[{"d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"m", ".", "x"}], " ", 
      RowBox[{"x", ".", "m"}]}], "-", 
     RowBox[{
      RowBox[{"m", ".", "m"}], " ", 
      RowBox[{"x", ".", "x"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.858336865956822*^9, 3.8583375761249447`*^9, 3.858337623249127*^9, 
   3.858337654441557*^9, 3.858337870502367*^9, 3.859546029843182*^9, 
   3.859557351995117*^9, 3.8595575183198023`*^9, 3.859557549314835*^9, 
   3.8595586672474957`*^9, 3.8595913124935102`*^9, 3.8595913588024282`*^9, 
   3.8595915845390882`*^9, 3.859591708749116*^9, 3.8596077697556667`*^9, 
   3.859610027058093*^9, 3.85963136712085*^9, 3.85970120667914*^9, 
   3.859701237932254*^9, 3.8598850195590487`*^9, 3.859885166137208*^9, 
   3.859885340302559*^9, 3.859885565005795*^9, 3.859885598919283*^9, 
   3.859885663882515*^9, 3.8598858615294027`*^9, 3.859886103806636*^9, {
   3.859886207124082*^9, 3.85988625346449*^9}, 3.859886414678247*^9, 
   3.859887265499103*^9, 3.859887761702176*^9, 3.8598877939053097`*^9, 
   3.859887827904316*^9, 3.8599677668798933`*^9, 3.859980989317531*^9, 
   3.860036129799465*^9, 3.8601506207804747`*^9, 3.86022133755912*^9, 
   3.860222477241563*^9, 3.860222640416177*^9, 3.860223082275943*^9, 
   3.861254001953827*^9, 3.8617507470630493`*^9, 3.863856283866192*^9, 
   3.8641165203138123`*^9, 3.864188116481123*^9, 3.864277788513*^9, 
   3.864875713012891*^9, 3.867905651091051*^9, 3.867905838752288*^9, 
   3.869114399004383*^9, 3.869114936501576*^9, 3.86922654036926*^9, 
   3.8692927224333153`*^9, 3.869305607225737*^9, 3.8693097849289217`*^9, 
   3.869526559579981*^9, 3.869563735540044*^9, 3.869692376534239*^9, 
   3.871566453713519*^9, 3.872246805171783*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"2e241adc-622b-4683-a178-3ec055cea85a"]
}, Open  ]],

Cell[TextData[{
 "This variance term should have E[aerror] = 0 for the estimator to be \
unbiased.\nThe method from eg. (25) of ",
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 " is to expand:\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", 
    RowBox[{"uw", ",", "uy"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "81fd7e9f-9c9a-4f11-bfd0-835bc12f84dc"],
 "[aerror] =",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", 
     RowBox[{"x", ",", "m"}]], "[", 
    RowBox[{
     SubscriptBox["E", 
      RowBox[{"uw", ",", "uy"}]], "[", 
     RowBox[{
      RowBox[{"aerror", "|", "x"}], ",", "m"}], "]"}], "]"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "eb64b60b-9e91-46fe-aa36-7a0198ce80c2"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", 
     RowBox[{"uw", ",", "uy"}]], "[", 
    RowBox[{
     SubscriptBox["E", 
      RowBox[{"x", ",", "m"}]], "[", 
     RowBox[{
      RowBox[{"aerror", "|", "x"}], ",", "m"}], "]"}], "]"}], 
   TraditionalForm]],ExpressionUUID->"07c88433-e6e2-41b3-bea1-9830b0118441"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["E", 
      RowBox[{"x", ",", "m"}]], "[", 
     RowBox[{"ux", "|", "x"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{" ", 
        SuperscriptBox["\[Sigma]ux", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], 
         SuperscriptBox["\[Sigma]uw", "2"]}], "+", 
        SuperscriptBox["\[Sigma]ux", "2"]}]], "x"}], "=", "Fx"}]}], 
   TraditionalForm]],ExpressionUUID->"0390f6ea-5cb7-47c4-aa54-3abc7567eadd"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["E", 
      RowBox[{"x", ",", "m"}]], "[", 
     RowBox[{"uy", "|", "x"}], "]"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"2f671e21-8857-45fd-b11e-37e381a7ecc2"]
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}},ExpressionUUID->"aa00a605-fb10-4ee4-82d4-\
5729c7923811"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"aerror", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ux", "->", 
       RowBox[{"F", "*", "x"}]}], ",", 
      RowBox[{"uy", "->", "0"}]}], "}"}]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"F", " ", "\[Element]", "Reals"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"45eef6f8-8657-4ab8-ab2d-b897e507a758"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029855322*^9, 
   3.859557352010457*^9, 3.859557518503956*^9, 3.8595575494142103`*^9, 
   3.859558667335499*^9, 3.85959131250666*^9, 3.859591358816317*^9, 
   3.859591584554893*^9, 3.859591708761846*^9, 3.859607769765441*^9, 
   3.859610027072476*^9, 3.859631367137671*^9, 3.859701206705348*^9, 
   3.859701237957283*^9, 3.859885019569903*^9, 3.8598851661496763`*^9, 
   3.8598853403142548`*^9, 3.8598855650190353`*^9, 3.859885598930179*^9, 
   3.8598856638931093`*^9, 3.859885861540028*^9, 3.859886103816078*^9, {
   3.859886207136594*^9, 3.859886253475874*^9}, 3.859886414690687*^9, 
   3.859887265512865*^9, 3.859887761713674*^9, 3.8598877939179573`*^9, 
   3.859887827917584*^9, 3.8599677668895817`*^9, 3.859980989326447*^9, 
   3.860036129817053*^9, 3.8601506207916594`*^9, 3.8602213375694637`*^9, 
   3.8602224772503023`*^9, 3.860222640427561*^9, 3.860223082287139*^9, 
   3.861254001974615*^9, 3.861750747073625*^9, 3.863856283877418*^9, 
   3.864116520338513*^9, 3.864188116492796*^9, 3.8642777885248003`*^9, 
   3.864875713025382*^9, 3.867905651124093*^9, 3.867905838780364*^9, 
   3.869114399013624*^9, 3.86911493651158*^9, 3.869226540386001*^9, 
   3.869292722447085*^9, 3.869305607239676*^9, 3.869309784943349*^9, 
   3.869526559588051*^9, 3.869563735564746*^9, 3.869692376548889*^9, 
   3.871566453734283*^9, 3.872246805189245*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"c5be670c-2c4e-45e1-8224-7ee85f0bd5f3"]
}, Open  ]],

Cell["Similarly for c:", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 
  3.85833817346621*^9}},ExpressionUUID->"00966f16-333d-47df-9d51-\
207cd0a9e98a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{
      RowBox[{"c", "*", "x"}], "+", "um"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["c", "^"], "-", "c"}], "//.", "structureEqs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", " ", "=", " ", 
  RowBox[{
   RowBox[{"TensorExpand", "[", 
    RowBox[{"cerror", ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"(", "c", ")"}], "\[Element]", "Reals"}]}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cerror", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ux", "->", 
       RowBox[{"F", "*", "x"}]}], ",", 
      RowBox[{"um", "->", "0"}]}], "}"}]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"F", " ", "\[Element]", "Reals"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQnVK965vu/jeOJlN4foBoP4lsJj0gXWH2AUzPWxoo
CKJ7RCaJgei6JnN1EB3iwasBovl+5hmB6D//RU1ANPchOysQ/ShruiNYv3+4
N4h+KfXJH0QfLvbabACkfSe+3gKi3wjc2AuiLVp+HwfRLcWzzoHoSyqfr4Fo
k2SzbyA6/d/JfyD6Rvd8VkMgzXXyEpi2izzNCaJ3mwXygehZHVdFQPSEKEZJ
EP0hJt4QRFf/2GMCov08M51ANO/DOg8QXbXV0QdES7GnB4DohH02nSDa64R+
D4j++WL/IxDddeX+ExDNMnPPKxC9YvuWdyB6i20+pxGQrjecC6Y/bTTSBdHO
WpXWIBoAkF+yKg==
  "],
 CellLabel->"In[43]:=",ExpressionUUID->"2633dc54-57e1-438c-b753-1f2674f3fd70"],

Cell[BoxData[
 FractionBox[
  RowBox[{"x", ".", "um"}], 
  RowBox[{"x", ".", "x"}]]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029867181*^9, 3.8595573522864437`*^9, 3.85955751860529*^9, 
   3.8595575496145897`*^9, 3.859558667433391*^9, 3.85959131252031*^9, 
   3.859591358830221*^9, 3.859591584571563*^9, 3.8595917087749357`*^9, 
   3.85960776977437*^9, 3.859610027085593*^9, 3.859631367153652*^9, 
   3.859701206731504*^9, 3.859701238000702*^9, 3.859885019580845*^9, 
   3.8598851661629133`*^9, 3.859885340327448*^9, 3.859885565029481*^9, 
   3.859885598941038*^9, 3.859885663904351*^9, 3.859885861551175*^9, 
   3.8598861038267803`*^9, {3.859886207147678*^9, 3.859886253486887*^9}, 
   3.859886414704451*^9, 3.85988726552603*^9, 3.859887761725635*^9, 
   3.859887793931096*^9, 3.859887827931143*^9, 3.859967766900692*^9, 
   3.859980989337861*^9, 3.860036129834036*^9, 3.8601506208019047`*^9, 
   3.860221337580442*^9, 3.8602224772591867`*^9, 3.860222640439334*^9, 
   3.86022308229838*^9, 3.861254001995295*^9, 3.861750747084189*^9, 
   3.86385628388861*^9, 3.864116520363755*^9, 3.864188116504568*^9, 
   3.86427778853631*^9, 3.864875713037533*^9, 3.867905651159774*^9, 
   3.867905838810528*^9, 3.869114399023149*^9, 3.8691149365224123`*^9, 
   3.869226540403267*^9, 3.8692927224614143`*^9, 3.8693056072534323`*^9, 
   3.8693097849585657`*^9, 3.869526559596232*^9, 3.8695637355893927`*^9, 
   3.8696923765644197`*^9, 3.871566453760923*^9, 3.872246805206505*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"25984640-42a0-4632-bdf8-fa89e607815f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029867181*^9, 3.8595573522864437`*^9, 3.85955751860529*^9, 
   3.8595575496145897`*^9, 3.859558667433391*^9, 3.85959131252031*^9, 
   3.859591358830221*^9, 3.859591584571563*^9, 3.8595917087749357`*^9, 
   3.85960776977437*^9, 3.859610027085593*^9, 3.859631367153652*^9, 
   3.859701206731504*^9, 3.859701238000702*^9, 3.859885019580845*^9, 
   3.8598851661629133`*^9, 3.859885340327448*^9, 3.859885565029481*^9, 
   3.859885598941038*^9, 3.859885663904351*^9, 3.859885861551175*^9, 
   3.8598861038267803`*^9, {3.859886207147678*^9, 3.859886253486887*^9}, 
   3.859886414704451*^9, 3.85988726552603*^9, 3.859887761725635*^9, 
   3.859887793931096*^9, 3.859887827931143*^9, 3.859967766900692*^9, 
   3.859980989337861*^9, 3.860036129834036*^9, 3.8601506208019047`*^9, 
   3.860221337580442*^9, 3.8602224772591867`*^9, 3.860222640439334*^9, 
   3.86022308229838*^9, 3.861254001995295*^9, 3.861750747084189*^9, 
   3.86385628388861*^9, 3.864116520363755*^9, 3.864188116504568*^9, 
   3.86427778853631*^9, 3.864875713037533*^9, 3.867905651159774*^9, 
   3.867905838810528*^9, 3.869114399023149*^9, 3.8691149365224123`*^9, 
   3.869226540403267*^9, 3.8692927224614143`*^9, 3.8693056072534323`*^9, 
   3.8693097849585657`*^9, 3.869526559596232*^9, 3.8695637355893927`*^9, 
   3.8696923765644197`*^9, 3.871566453760923*^9, 3.87224680520782*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"da10087c-1d00-43fe-bb03-14ac3bc3f23a"]
}, Open  ]],

Cell[TextData[{
 "To find variances for simple linear estimators, we may directly substitute \
into Eq (17) of ",
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 ":"
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 3.85833817346621*^9}, {
  3.858346841805505*^9, 
  3.8583468867052*^9}},ExpressionUUID->"2ff09b45-dc09-4395-810a-4a7c65bd04a0"],

Cell[TextData[{
 "To find the variance, we follow the general method from eg. (27-28) of ",
 StyleBox[ButtonBox["[Gupta2021]",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/hep-ph/9811350"], None},
  ButtonNote->"https://arxiv.org/abs/hep-ph/9811350"],
  FontColor->GrayLevel[0]],
 ":\nFirst apply the Law of Total Variance: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"VAR", "[", "aerror", "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"VAR", "[", 
      RowBox[{"E", "[", 
       RowBox[{
        RowBox[{"aerror", "|", "x"}], ",", "m"}], "]"}], "]"}], "+", 
     RowBox[{"E", "[", 
      RowBox[{"VAR", "[", 
       RowBox[{
        RowBox[{"aerror", "|", "x"}], ",", "m"}], "]"}], "]"}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a302a133-94ac-40d8-b877-27626e69b201"],
 "\n",
 StyleBox["(prove this, not trivial for two conditioned variable case)\n",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" ",
  FontColor->GrayLevel[0]],
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     RowBox[{"VAR", "[", 
      RowBox[{"E", "[", 
       RowBox[{
        RowBox[{"aerror", "|", "x"}], ",", "m"}], "]"}], "]"}], " ", "=", " ",
      "0"}],
    FontColor->GrayLevel[0]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "346a2d42-09be-4427-80f9-6a28aec04994"],
 " already from E[aerror]=0 proof.\n VAR[aerror|x,m] = ",
 StyleBox["\n",
  FontColor->GrayLevel[0]],
 StyleBox["\n",
  FontColor->RGBColor[1, 0, 0]]
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQnW3xi01v/xvHO72vOUB03/nF8YZAWoSrKxFE31F6
lA+iF60RLALRbcGVVSDa5ueFahAtJr5rP4j+V9R/CEQHVYdeBtF7WJvBtM/2
Q7fA6kVyH4DFy7M/gOiiVo6PIPrXqg9fQPQanbafIDr3/5m/INqM8SyY9vJN
5jEC0gzHZHhB9ISq95IgOunVVzBt03LKEUR/6Ix3BtGvIn28QPQDoUofEH3u
8rMYEK0ioZgEorPrJ2aDaL9X23JA9ImgLxUg+lJXbS2IvrbTqBlEa8yd1AOi
I7ckLADR3/ZrLQTRP72SMs2A9BPPJjANAGseqeQ=
  
  "],ExpressionUUID->"852179da-c38d-4b83-9f27-c4f242931aaf"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.858338164331313*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"53cbc348-32ee-4af5-9903-a722f70c8c1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Automating Everything", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.85946062474669*^9, 
  3.859460627322743*^9}},ExpressionUUID->"84315294-9efc-4788-90ff-\
784e223ac4e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"3", "\[DirectedEdge]", "4"}], ",", 
     RowBox[{"1", "\[DirectedEdge]", "4"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vnames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<W\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\"", ",", "\"\<Y\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweights", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "uW"], ",", 
     SubscriptBox["\[Sigma]", "uX"], ",", 
     SubscriptBox["\[Sigma]", "uM"], ",", 
     SubscriptBox["\[Sigma]", "uY"]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{"#1", ",", "Center"}], "]"}], "&"}], ",", "vnames"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eweights", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", "c", ",", "a", ",", "b"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elabels", " ", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"edges", "\[Rule]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "#1", ",", "18", ",", "Italic", ",", "Bold", ",", "Blue"}], 
             "]"}], ",", 
            RowBox[{"Background", "->", "White"}], ",", 
            RowBox[{"FrameStyle", "->", "White"}]}], "]"}], ",", 
          "\"\<Middle\>\""}], "]"}], "&"}], ",", "eweights"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcoords", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookup", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vnames", "->", "vertices"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupname", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", "vnames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweightsnou", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "W"], ",", 
     SubscriptBox["\[Sigma]", "X"], ",", 
     SubscriptBox["\[Sigma]", "M"], ",", 
     SubscriptBox["\[Sigma]", "Y"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvars", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupweight", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
         "]"}], "->", "vweights"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "#", "]"}], "&"}], ",", "vnames"}], "]"}], 
        "->", "vweightsnou"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"causalgraph", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
      RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
      RowBox[{"3", "\[DirectedEdge]", "4"}], ",", 
      RowBox[{"1", "\[DirectedEdge]", "4"}]}], "}"}], ",", 
    RowBox[{"VertexLabels", "->", "vlabels"}], ",", 
    RowBox[{"EdgeLabels", "->", "elabels"}], ",", 
    RowBox[{"VertexWeight", "\[Rule]", "vweights"}], ",", 
    RowBox[{"EdgeWeight", "\[Rule]", "eweights"}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "\"\<LayeredEmbedding\>\""}], ",", 
    RowBox[{"VertexStyle", "->", "Black"}], ",", 
    RowBox[{"VertexSize", "->", "0.3"}], ",", 
    RowBox[{"VertexLabelStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Italic", ",", "26"}], "]"}]}], ",", 
    RowBox[{"EdgeStyle", "->", "Black"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHR4jVhV68I3j15bwJhDt0Ta7E0QfEro8AUQ3pLhO
A9EpPjc2gmiXD8e2gegtcvO2g+h7vg/3gugAvg/7QPT8vQuPgWiGwuWXQPSN
Vda3QHTNg3NgmmFL7X0Q/ezs0ycgelKUwmsQ/Wh/xTsQ7fXwyk8QXXLlP5gO
6rjFGAakC7b084Jol5UzREC09kFzFRA9+1qRDohWi/hoB6L9/mU4g+j1FWou
IFqzY28XiJ6lKD0BRJeEbt4Moo1uf9wCoqvia79EAelTGot+gGgV8fts0UB6
DctKbhD9ILZDCESvq90vDKLbzBUlQHRQnoI8iL7gMEewBBQOuy4Kg2gD1tvi
IFrqmIk0iAYAiPG/9A==
  "],
 CellLabel->"In[48]:=",ExpressionUUID->"97e356c5-0904-43ac-b548-c2a00ae761b6"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4}, {{{1, 2}, {2, 3}, {3, 4}, {1, 4}}, Null}, {
      EdgeLabels -> {DirectedEdge[1, 4] -> Placed[
           Framed[
            Style[$CellContext`b, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[3, 4] -> Placed[
           Framed[
            Style[$CellContext`a, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[2, 3] -> Placed[
           Framed[
            Style[$CellContext`c, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[1, 2] -> Placed[
           Framed[
            Style[$CellContext`d, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"]}, EdgeStyle -> {
         GrayLevel[0]}, 
       EdgeWeight -> {$CellContext`d, $CellContext`c, $CellContext`a, \
$CellContext`b}, GraphLayout -> "LayeredEmbedding", 
       VertexCoordinates -> {{1, 1}, {0, 0}, {1, 0}, {2, 0}}, 
       VertexLabels -> {
        3 -> Placed["M", Center], 4 -> Placed["Y", Center], 2 -> 
         Placed["X", Center], 1 -> Placed["W", Center]}, 
       VertexLabelStyle -> {
         Directive[
          RGBColor[1, 0, 0], Italic, 26]}, VertexSize -> {0.3}, VertexStyle -> {
         GrayLevel[0]}, VertexWeight -> {
         Subscript[$CellContext`\[Sigma], $CellContext`uW], 
         Subscript[$CellContext`\[Sigma], $CellContext`uX], 
         Subscript[$CellContext`\[Sigma], $CellContext`uM], 
         Subscript[$CellContext`\[Sigma], $CellContext`uY]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {GrayLevel[0], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{1., 1.}, {0., 0.}}, 0.15], InsetBox[
          FrameBox[
           StyleBox["d",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 1.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["b",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{0., 0.}, {1., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["c",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 0.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["a",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{1., 1.}, 0.15], InsetBox[
          StyleBox["\<\"W\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 1.},
          BaseStyle->"Graphics"]}, {DiskBox[{0., 0.}, 0.15], InsetBox[
          StyleBox["\<\"X\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {0., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.15], InsetBox[
          StyleBox["\<\"M\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 0.}, 0.15], InsetBox[
          StyleBox["\<\"Y\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 0.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.8594603171460943`*^9, 3.859460386017805*^9}, {
   3.859460454785201*^9, 3.8594605998876123`*^9}, 3.8594606415257893`*^9, 
   3.859461268058887*^9, 3.859461543872567*^9, 3.859466284866777*^9, 
   3.859470279216584*^9, 3.859470394271792*^9, 3.85947042966777*^9, 
   3.859470494745961*^9, 3.859470536051578*^9, 3.859470585553668*^9, {
   3.859521734023562*^9, 3.859521753987259*^9}, 3.8595229955804377`*^9, 
   3.8595427752146187`*^9, 3.859546029888934*^9, 3.859557352486274*^9, 
   3.859557518895973*^9, 3.859557549725955*^9, 3.859558667544119*^9, 
   3.859591312544767*^9, 3.8595913588584347`*^9, 3.859591584599156*^9, 
   3.8595917088006887`*^9, 3.859607769950779*^9, 3.8596100271108837`*^9, 
   3.859631367390267*^9, 3.859701206784483*^9, 3.859701238054028*^9, 
   3.8598850197516127`*^9, 3.859885166186604*^9, 3.859885340351637*^9, 
   3.859885565050262*^9, 3.859885598963729*^9, 3.859885663926457*^9, 
   3.85988586157339*^9, 3.859886103847467*^9, {3.859886207169689*^9, 
   3.8598862535083923`*^9}, 3.85988641472889*^9, 3.8598872655520487`*^9, 
   3.8598877617507973`*^9, 3.859887793956381*^9, 3.859887827957143*^9, 
   3.859967767080118*^9, 3.8599809893571672`*^9, 3.860036129867569*^9, 
   3.860150620978862*^9, 3.860221337747867*^9, 3.860222477407794*^9, 
   3.86022264061873*^9, 3.860223082320773*^9, 3.8612540025588408`*^9, 
   3.861750747263894*^9, 3.863856284062358*^9, 3.8641165204075403`*^9, 
   3.864188116526772*^9, 3.86427778855816*^9, 3.8648757132057257`*^9, 
   3.867905651549698*^9, 3.86790583887122*^9, 3.869114402696926*^9, 
   3.8691149365422897`*^9, 3.869226540642845*^9, 3.869292722488015*^9, 
   3.869305607279997*^9, 3.869309784986608*^9, 3.8695265597514887`*^9, 
   3.8695637356321783`*^9, 3.8696923767646933`*^9, 3.871566454258912*^9, 
   3.872246805433772*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"0a0cb98d-dbca-4a92-92be-f294166acc9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eweightlookup", "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"ArrayRules", "@", 
      RowBox[{"UpperTriangularize", "@", 
       RowBox[{"WeightedAdjacencyMatrix", "[", "causalgraph", "]"}]}]}]}], 
    ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8594606713535023`*^9, 3.859460687989484*^9}, {
  3.859460757668127*^9, 3.8594607600893993`*^9}, {3.859461892329628*^9, 
  3.859461896820756*^9}, {3.859461939972322*^9, 3.859461952336578*^9}},
 NumberMarks->False,
 CellLabel->"In[62]:=",ExpressionUUID->"7a70d2cc-f879-41a9-bb2b-09368f6af7d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "2"}], "\[Rule]", "d"}], ",", 
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "4"}], "\[Rule]", "b"}], ",", 
   RowBox[{
    RowBox[{"2", "\[DirectedEdge]", "3"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"3", "\[DirectedEdge]", "4"}], "\[Rule]", "a"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591312559327*^9, 
   3.85959135887326*^9, 3.859591584617322*^9, 3.859591708815709*^9, 
   3.8596077699640293`*^9, 3.859610027125308*^9, 3.859631367411478*^9, 
   3.8597012068188057`*^9, 3.859701238086952*^9, 3.8598850197633457`*^9, 
   3.859885166199637*^9, 3.859885340365958*^9, 3.859885565062367*^9, 
   3.859885598976623*^9, 3.8598856639389*^9, 3.859885861585778*^9, 
   3.859886103859186*^9, {3.859886207181542*^9, 3.8598862535215807`*^9}, 
   3.859886414744172*^9, 3.859887265568005*^9, 3.85988776176438*^9, 
   3.859887793971196*^9, 3.859887827972109*^9, 3.85996776709234*^9, 
   3.8599809893692102`*^9, 3.860036129886889*^9, 3.860150620991933*^9, 
   3.8602213377634993`*^9, 3.86022247741975*^9, 3.8602226406382847`*^9, 
   3.860223082334261*^9, 3.861254002736045*^9, 3.8617507472790422`*^9, 
   3.863856284077887*^9, 3.864116520440262*^9, 3.864188116539768*^9, 
   3.864277788571423*^9, 3.864875713224847*^9, 3.8679056515983152`*^9, 
   3.867905838906324*^9, 3.869114402793435*^9, 3.869114936553237*^9, 
   3.8692265406612377`*^9, 3.869292722503921*^9, 3.869305607295773*^9, 
   3.869309785003016*^9, 3.869526559764473*^9, 3.869563735734417*^9, 
   3.869692376781001*^9, 3.871566454549498*^9, 3.872246805461636*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"439e90e0-db4d-4f15-8692-c83b6e4ba61d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ParentNodes", "[", 
    RowBox[{"graph_", ",", "node_"}], "]"}], ":=", 
   RowBox[{"VertexInComponent", "[", 
    RowBox[{"graph", ",", 
     RowBox[{"Replace", "[", 
      RowBox[{"node", ",", "vlookup"}], "]"}], ",", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParentEdges", "[", 
    RowBox[{"graph_", ",", "node_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "\[DirectedEdge]", 
       RowBox[{"Replace", "[", 
        RowBox[{"node", ",", "vlookup"}], "]"}]}], "&"}], ",", 
     RowBox[{"ParentNodes", "[", 
      RowBox[{"graph", ",", "node"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NodeStructure", "[", 
    RowBox[{"graph_", ",", "node_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Symbol", "[", "node", "]"}], "->", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#1", ",", "eweightlookup"}], "]"}], "*", 
           RowBox[{"Symbol", "[", 
            RowBox[{"Replace", "[", 
             RowBox[{"#2", ",", "vlookupname"}], "]"}], "]"}]}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ParentEdges", "[", 
            RowBox[{"graph", ",", "node"}], "]"}], ",", 
           RowBox[{"ParentNodes", "[", 
            RowBox[{"graph", ",", "node"}], "]"}]}], "}"}]}], "]"}], "]"}], 
      "+", 
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<u\>\"", "<>", "node"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NodesStructure", "[", 
    RowBox[{"graph_", ",", "nodes_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"NodeStructure", "[", 
       RowBox[{"graph", ",", "node"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"node", ",", "nodes"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GraphNodeStructure", "[", "graph_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NodeStructure", "[", 
        RowBox[{"graph", ",", "node"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"node", ",", 
         RowBox[{
          RowBox[{"VertexList", "[", "graph", "]"}], "/.", "vlookupname"}]}], 
        "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NodeVariance", "[", 
    RowBox[{"graph_", ",", "node_"}], "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Symbol", "[", "node", "]"}], "2"], "->", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"#1", ",", "eweightlookup"}], "]"}], "*", 
             SuperscriptBox[
              RowBox[{"Symbol", "[", 
               RowBox[{"Replace", "[", 
                RowBox[{"#2", ",", "vlookupname"}], "]"}], "]"}], "2"]}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ParentEdges", "[", 
              RowBox[{"graph", ",", "node"}], "]"}], ",", 
             RowBox[{"ParentNodes", "[", 
              RowBox[{"graph", ",", "node"}], "]"}]}], "}"}]}], "]"}], "]"}], 
        "+", 
        SuperscriptBox[
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<u\>\"", "<>", "node"}], "]"}], "2"]}]}], "}"}], ",", 
     "vlookupweight"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GraphNodeVariance", "[", "graph_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"NodeVariance", "[", 
        RowBox[{"graph", ",", "node"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"node", ",", 
         RowBox[{
          RowBox[{"VertexList", "[", "graph", "]"}], "/.", "vlookupname"}]}], 
        "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvarpairs", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"uvars", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uprodrules", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#1", "*", "#1"}], "->", 
          SuperscriptBox["#2", "2"]}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"uvars", ",", "vweights"}], "}"}]}], "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "->", "0"}], "&"}], ",", 
        "uvarpairs"}], "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NodeCovariance", "[", 
     RowBox[{"graph_", ",", "node1_", ",", "node2_"}], "]"}], ":=", 
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"ReplaceRepeated", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", "node1", "]"}], "*", 
          RowBox[{"Symbol", "[", "node2", "]"}]}], ",", 
         RowBox[{"GraphNodeStructure", "[", "graph", "]"}]}], "]"}], "]"}], 
      ",", "uprodrules"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NodeCovarianceLinComb", "[", 
     RowBox[{
     "graph_", ",", "nodes1_", ",", "coeffs1_", ",", "nodes2_", ",", 
      "coeffs2_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", "coeffs1", ",", "coeffs2"}], "]"}], "*", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"NodeCovariance", "[", 
          RowBox[{"graph", ",", "node1", ",", "node2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"node1", ",", "nodes1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"node2", ",", "nodes2"}], "}"}]}], "]"}]}], ",", "2"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"graph_", ",", "nodes_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"NodeCovariance", "[", 
      RowBox[{"graph", ",", "node1", ",", "node2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"node1", ",", "nodes"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"node2", ",", "nodes"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NodesCovarianceLinComb", "[", 
     RowBox[{"graph_", ",", "lincombs_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"NodeCovarianceLinComb", "[", 
       RowBox[{"graph", ",", 
        RowBox[{"lincomb1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"lincomb1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"lincomb2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"lincomb2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"lincomb1", ",", "lincombs"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"lincomb2", ",", "lincombs"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RCRemove", "[", 
     RowBox[{
      RowBox[{"a_", "?", "MatrixQ"}], ",", 
      RowBox[{"row_", "?", "VectorQ"}], ",", 
      RowBox[{"col_", "?", "VectorQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nr", ",", "nc", ",", "krow", ",", "kcol"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nr", ",", "nc"}], "}"}], "=", 
        RowBox[{"Dimensions", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"krow", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "nr"}], "]"}], ",", "row"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kcol", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "nc"}], "]"}], ",", "col"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{"krow", ",", "kcol"}], "]"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CondMeans", "[", 
    RowBox[{"graph_", ",", "varnodes_", ",", "condnodes_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Sig", ",", "SigA", ",", "SigB", ",", "SigAB", ",", "lA", ",", "lB"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"Sig", "=", 
       RowBox[{"NodesCovariance", "[", 
        RowBox[{"graph", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"varnodes", ",", "condnodes"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lA", "=", 
       RowBox[{"Length", "[", "varnodes", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lB", "=", 
       RowBox[{"Length", "[", "condnodes", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SigA", "=", 
       RowBox[{"Sig", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "lA"}], ",", 
          RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SigB", "=", 
       RowBox[{"Sig", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"lA", "+", "1"}], ";;", 
           RowBox[{"lA", "+", "lB"}]}], ",", 
          RowBox[{
           RowBox[{"lA", "+", "1"}], ";;", 
           RowBox[{"lA", "+", "lB"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SigAB", "=", 
       RowBox[{"Sig", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"lA", "+", "1"}], ";;", 
           RowBox[{"lA", "+", "lB"}]}], ",", 
          RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "SigAB", "]"}], ".", 
        RowBox[{"Inverse", "[", "SigB", "]"}], ".", 
        RowBox[{"Map", "[", 
         RowBox[{"Symbol", ",", "condnodes"}], "]"}]}], "//", 
       "Simplify"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CondMeansLinComb", "[", 
    RowBox[{"graph_", ",", "varlincombs_", ",", "condlincombs_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Sig", ",", "SigA", ",", "SigB", ",", "SigAB", ",", "lA", ",", "lB"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"Sig", "=", 
       RowBox[{"NodesCovarianceLinComb", "[", 
        RowBox[{"graph", ",", 
         RowBox[{"Join", "[", 
          RowBox[{"varlincombs", ",", "condlincombs"}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"lA", "=", 
       RowBox[{"Length", "[", "varlincombs", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lB", "=", 
       RowBox[{"Length", "[", "condlincombs", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SigA", "=", 
       RowBox[{"Sig", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "lA"}], ",", 
          RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SigB", "=", 
       RowBox[{"Sig", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"lA", "+", "1"}], ";;", 
           RowBox[{"lA", "+", "lB"}]}], ",", 
          RowBox[{
           RowBox[{"lA", "+", "1"}], ";;", 
           RowBox[{"lA", "+", "lB"}]}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SigAB", "=", 
       RowBox[{"Sig", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"lA", "+", "1"}], ";;", 
           RowBox[{"lA", "+", "lB"}]}], ",", 
          RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "SigAB", "]"}], ".", 
        RowBox[{"Inverse", "[", "SigB", "]"}]}], "//", "Simplify"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondVar", "[", 
   RowBox[{"graph_", ",", "varnodes_", ",", "condnodes_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Sig", ",", "SigA", ",", "SigB", ",", "SigAB", ",", "lA", ",", "lB"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"Sig", "=", 
      RowBox[{"NodesCovariance", "[", 
       RowBox[{"graph", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"varnodes", ",", "condnodes"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lA", "=", 
      RowBox[{"Length", "[", "varnodes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"lB", "=", 
      RowBox[{"Length", "[", "condnodes", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SigA", "=", 
      RowBox[{"Sig", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "lA"}], ",", 
         RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SigB", "=", 
      RowBox[{"Sig", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"lA", "+", "1"}], ";;", 
          RowBox[{"lA", "+", "lB"}]}], ",", 
         RowBox[{
          RowBox[{"lA", "+", "1"}], ";;", 
          RowBox[{"lA", "+", "lB"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SigAB", "=", 
      RowBox[{"Sig", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"lA", "+", "1"}], ";;", 
          RowBox[{"lA", "+", "lB"}]}], ",", 
         RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SigA", "-", 
       RowBox[{
        RowBox[{"Transpose", "[", "SigAB", "]"}], ".", 
        RowBox[{"Inverse", "[", "SigB", "]"}], ".", "SigAB"}]}], "//", 
      "Simplify"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.859461113825487*^9, 3.859461138339986*^9}, {
   3.8594613108263407`*^9, 3.8594613139025593`*^9}, {3.8594615757014513`*^9, 
   3.859461837032892*^9}, {3.8594619070474*^9, 3.859461935983223*^9}, {
   3.859462051973069*^9, 3.859462092660242*^9}, {3.859462269155611*^9, 
   3.8594622717986403`*^9}, {3.859466124561352*^9, 3.8594661384189034`*^9}, {
   3.8594661736744547`*^9, 3.859466504792272*^9}, {3.859466619117029*^9, 
   3.859466627235433*^9}, {3.859466677119276*^9, 3.859466799866819*^9}, {
   3.85946727708477*^9, 3.8594673148437634`*^9}, {3.85947020756037*^9, 
   3.8594702225661907`*^9}, {3.859470312077155*^9, 3.859470372701082*^9}, {
   3.859470511098226*^9, 3.859470511475675*^9}, {3.859470599529998*^9, 
   3.859470676841042*^9}, {3.859519082372912*^9, 3.85951908249776*^9}, {
   3.85952102427114*^9, 3.859521030456256*^9}, {3.859521187218258*^9, 
   3.8595212116972637`*^9}, {3.859521262173996*^9, 3.859521272989389*^9}, {
   3.8595213092323112`*^9, 3.859521353086606*^9}, {3.859521491917367*^9, 
   3.859521523421887*^9}, {3.8595217591917553`*^9, 3.859521825381011*^9}, {
   3.8595219082097178`*^9, 3.8595219473157988`*^9}, {3.859522248167636*^9, 
   3.859522267729431*^9}, {3.859522640976801*^9, 3.8595226443938704`*^9}, {
   3.859522722313098*^9, 3.8595227774956083`*^9}, {3.859522874709581*^9, 
   3.8595229238494596`*^9}, {3.8595229689197474`*^9, 3.859523023045988*^9}, {
   3.859542767327025*^9, 3.859542791865489*^9}, {3.859542988653442*^9, 
   3.8595430897301617`*^9}, {3.859543421866115*^9, 3.8595434392248173`*^9}, {
   3.859544630994248*^9, 3.8595446315004*^9}, {3.859544959976612*^9, 
   3.8595449605436172`*^9}, {3.859545067885075*^9, 3.859545071015482*^9}, {
   3.859546304304154*^9, 3.859546321953084*^9}, {3.859547416476658*^9, 
   3.859547464839122*^9}, {3.859547586390008*^9, 3.859547663394424*^9}, {
   3.859547701837611*^9, 3.8595477506942577`*^9}, {3.859547783984713*^9, 
   3.8595479444994917`*^9}, {3.859549155223318*^9, 3.859549216464995*^9}, {
   3.859556926272826*^9, 3.8595569324075747`*^9}, {3.859556972291751*^9, 
   3.859556977485198*^9}, {3.859557445071175*^9, 3.859557452406671*^9}, {
   3.859591690363311*^9, 3.8595916996394567`*^9}, 3.8599680705192013`*^9, 
   3.859968101975835*^9, {3.8641090858355427`*^9, 3.864109141276587*^9}, {
   3.8641091727489758`*^9, 3.864109258112496*^9}, {3.864109296575529*^9, 
   3.8641093018134336`*^9}, {3.8641094886923532`*^9, 
   3.8641096176468153`*^9}, {3.864109861901177*^9, 3.864109925946885*^9}, {
   3.864109962310463*^9, 3.864109962434923*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"8ddc0aa2-8b8c-4638-b295-93fc6c7bf41e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["uW", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uX", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uM", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uY", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uY", "2"]}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uX", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uX", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uY"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.859543439575184*^9, {3.85954494273297*^9, 3.859544965790608*^9}, {
   3.859545042106845*^9, 3.859545071340088*^9}, 3.8595460299164658`*^9, 
   3.8595463247390547`*^9, {3.859547660825305*^9, 3.859547663788768*^9}, 
   3.859547722278162*^9, 3.859547834869852*^9, {3.8595478969551773`*^9, 
   3.859547939486804*^9}, {3.859549148124031*^9, 3.859549242334052*^9}, 
   3.859556932895451*^9, 3.8595569782744923`*^9, 3.85955735269086*^9, 
   3.859557453186957*^9, 3.859557519272521*^9, 3.859557550012562*^9, 
   3.8595586687446203`*^9, 3.859591312575432*^9, 3.859591358886801*^9, 
   3.859591584636815*^9, 3.8595917088293123`*^9, 3.859607769975506*^9, 
   3.8596100271414757`*^9, 3.859631367433811*^9, 3.859701206856503*^9, 
   3.859701238114935*^9, 3.859885019777596*^9, 3.8598851662140827`*^9, 
   3.859885340380604*^9, 3.8598855650743837`*^9, 3.859885598989171*^9, 
   3.859885663951705*^9, 3.859885861599518*^9, 3.859886103873139*^9, {
   3.859886207194373*^9, 3.859886253534513*^9}, 3.859886414759544*^9, 
   3.859887265584873*^9, 3.859887761777425*^9, 3.859887793987281*^9, 
   3.859887827989367*^9, 3.859967767108268*^9, 3.85998098938124*^9, 
   3.860036129906528*^9, 3.860150621004541*^9, 3.8602213377794027`*^9, 
   3.860222477431734*^9, 3.860222640656104*^9, 3.860223082346994*^9, 
   3.8612540028087187`*^9, 3.861750747294189*^9, 3.863856284092347*^9, 
   3.8641096199785748`*^9, 3.864110211890458*^9, 3.864116520483446*^9, 
   3.864188116553899*^9, 3.8642777885858583`*^9, 3.864875713244841*^9, 
   3.867905651646647*^9, 3.8679058389484653`*^9, 3.869114402808044*^9, 
   3.869114936566312*^9, 3.869226540683279*^9, 3.869292722519608*^9, 
   3.869305607311219*^9, 3.869309785020335*^9, 3.869526559778405*^9, 
   3.869563735763595*^9, 3.869692376796567*^9, 3.8715664545859423`*^9, 
   3.872246805491239*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"4f5659a1-5250-4757-aafc-915a3ba7e319"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], ",", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "b"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.864109390934698*^9, 3.864109467720006*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"55170268-80ad-47c4-a240-8d2bd6e8fb1c"],

Cell[BoxData["30"], "Output",
 CellChangeTimes->{{3.8641093983179398`*^9, 3.864109468019566*^9}, 
   3.864116520510811*^9, 3.8641881165656223`*^9, 3.8642777885976686`*^9, 
   3.864875713259018*^9, 3.867905651762456*^9, 3.867905838982151*^9, 
   3.869114402818183*^9, 3.8691149365763206`*^9, 3.869226540699214*^9, 
   3.869292722534061*^9, 3.869305607325569*^9, 3.86930978503531*^9, 
   3.869526559790766*^9, 3.8695637357861547`*^9, 3.869692376809886*^9, 
   3.871566454620839*^9, 3.87224680552008*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"f5aed879-0aec-42d6-8919-ac61b63c98cf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "2", "b"},
     {"2", "4", 
      RowBox[{"2", " ", "b"}]},
     {"a", 
      RowBox[{"2", " ", "a"}], 
      RowBox[{"a", " ", "b"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8641093983179398`*^9, 3.864109468019566*^9}, 
   3.864116520510811*^9, 3.8641881165656223`*^9, 3.8642777885976686`*^9, 
   3.864875713259018*^9, 3.867905651762456*^9, 3.867905838982151*^9, 
   3.869114402818183*^9, 3.8691149365763206`*^9, 3.869226540699214*^9, 
   3.869292722534061*^9, 3.869305607325569*^9, 3.86930978503531*^9, 
   3.869526559790766*^9, 3.8695637357861547`*^9, 3.869692376809886*^9, 
   3.871566454620839*^9, 3.872246805521812*^9},
 CellLabel->
  "Out[81]//MatrixForm=",ExpressionUUID->"c396e6ea-9e21-44d4-9a3e-\
1562b28dec3b"]
}, Open  ]],

Cell[TextData[{
 "Now we can apply this! Say we want to evaluate the expectation value \
E[ux*um | X,M]. First, we need to calculate the joint covariance between all \
four variables.",
 StyleBox["\n",
  FontColor->GrayLevel[0]]
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
   3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
   3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
   3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
   3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
   3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
   3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
   3.858337999684861*^9}, {3.858338318328642*^9, 3.858338330985588*^9}, {
   3.858338386385976*^9, 3.858338403783554*^9}, {3.858338535213355*^9, 
   3.858338577034197*^9}, {3.858338652546804*^9, 3.8583386617161016`*^9}, {
   3.858338759635105*^9, 3.858338795923196*^9}, {3.858338841585185*^9, 
   3.858338916581684*^9}, {3.858339075022015*^9, 3.8583390813359327`*^9}, {
   3.858346827071652*^9, 3.85834682807152*^9}, {3.8595435455848227`*^9, 
   3.859543581806551*^9}, 
   3.8595439831394987`*^9},ExpressionUUID->"64593238-bc16-490a-8ce4-\
65dfee0c2887"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraph", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allvariances", "=", 
   RowBox[{"GraphNodeVariance", "[", "causalgraph", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"causalgraph", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Sig", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraph", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondVar", "[", 
   RowBox[{"causalgraph", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.859543456025009*^9, 3.859543464098876*^9}, {
  3.859544443127898*^9, 3.859544505923212*^9}, {3.859544613314905*^9, 
  3.859544614650338*^9}, {3.859544910325439*^9, 3.859544963556361*^9}, {
  3.859545083488456*^9, 3.859545127921324*^9}, {3.8595451601353827`*^9, 
  3.859545237085483*^9}, {3.8595452722968693`*^9, 3.859545273539131*^9}, {
  3.859545457472375*^9, 3.859545516603259*^9}, {3.859549232610675*^9, 
  3.859549252973567*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"b0389f73-589f-4b9e-913c-ad9c6b710da8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"W", "\[Rule]", "uW"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, 3.8595915846544437`*^9, 
   3.859591708843074*^9, 3.8596077699843187`*^9, {3.859610027156913*^9, 
   3.8596100423264923`*^9}, 3.859631367453413*^9, 3.859701206886294*^9, 
   3.859701238147749*^9, 3.85988501979108*^9, 3.8598851662267733`*^9, 
   3.859885340394309*^9, 3.8598855650858*^9, 3.859885599001861*^9, 
   3.859885663964158*^9, 3.85988586161346*^9, 3.859886103884995*^9, {
   3.8598862072069683`*^9, 3.859886253546266*^9}, 3.859886414773395*^9, 
   3.859887265600868*^9, 3.859887761789639*^9, 3.8598877940017138`*^9, 
   3.859887828004078*^9, 3.8599677671253443`*^9, 3.859980989391019*^9, 
   3.860036129922806*^9, 3.860150621015583*^9, 3.860221337795391*^9, 
   3.86022247744525*^9, 3.860222640670439*^9, 3.8602230823588877`*^9, 
   3.861254002849312*^9, 3.8617507473085003`*^9, 3.863856284104212*^9, 
   3.864116520543511*^9, 3.864188116582663*^9, 3.8642777886141787`*^9, 
   3.864875713276677*^9, 3.8679056518310347`*^9, 3.867905839021058*^9, 
   3.869114402832045*^9, 3.869114936589098*^9, 3.869226540722392*^9, 
   3.869292722551999*^9, 3.8693056073436937`*^9, 3.8693097850539722`*^9, 
   3.869526559806155*^9, 3.869563735813437*^9, 3.869692376814899*^9, 
   3.8715664546589127`*^9, 3.8722468055529327`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"4865b29c-6a45-4594-b16b-e6b6cc71b190"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "W", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "X", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
     RowBox[{"d", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "M", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{"c", " ", 
      SubsuperscriptBox["\[Sigma]", "X", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "Y", "2"], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", 
      SubsuperscriptBox["\[Sigma]", "M", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uY", "2"], "+", 
     RowBox[{"b", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, 3.8595915846544437`*^9, 
   3.859591708843074*^9, 3.8596077699843187`*^9, {3.859610027156913*^9, 
   3.8596100423264923`*^9}, 3.859631367453413*^9, 3.859701206886294*^9, 
   3.859701238147749*^9, 3.85988501979108*^9, 3.8598851662267733`*^9, 
   3.859885340394309*^9, 3.8598855650858*^9, 3.859885599001861*^9, 
   3.859885663964158*^9, 3.85988586161346*^9, 3.859886103884995*^9, {
   3.8598862072069683`*^9, 3.859886253546266*^9}, 3.859886414773395*^9, 
   3.859887265600868*^9, 3.859887761789639*^9, 3.8598877940017138`*^9, 
   3.859887828004078*^9, 3.8599677671253443`*^9, 3.859980989391019*^9, 
   3.860036129922806*^9, 3.860150621015583*^9, 3.860221337795391*^9, 
   3.86022247744525*^9, 3.860222640670439*^9, 3.8602230823588877`*^9, 
   3.861254002849312*^9, 3.8617507473085003`*^9, 3.863856284104212*^9, 
   3.864116520543511*^9, 3.864188116582663*^9, 3.8642777886141787`*^9, 
   3.864875713276677*^9, 3.8679056518310347`*^9, 3.867905839021058*^9, 
   3.869114402832045*^9, 3.869114936589098*^9, 3.869226540722392*^9, 
   3.869292722551999*^9, 3.8693056073436937`*^9, 3.8693097850539722`*^9, 
   3.869526559806155*^9, 3.869563735813437*^9, 3.869692376814899*^9, 
   3.8715664546589127`*^9, 3.872246805554686*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"9ee7c473-57ac-4c26-8a75-247400479581"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]},
     {"0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]},
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]},
     {
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, 3.8595915846544437`*^9, 
   3.859591708843074*^9, 3.8596077699843187`*^9, {3.859610027156913*^9, 
   3.8596100423264923`*^9}, 3.859631367453413*^9, 3.859701206886294*^9, 
   3.859701238147749*^9, 3.85988501979108*^9, 3.8598851662267733`*^9, 
   3.859885340394309*^9, 3.8598855650858*^9, 3.859885599001861*^9, 
   3.859885663964158*^9, 3.85988586161346*^9, 3.859886103884995*^9, {
   3.8598862072069683`*^9, 3.859886253546266*^9}, 3.859886414773395*^9, 
   3.859887265600868*^9, 3.859887761789639*^9, 3.8598877940017138`*^9, 
   3.859887828004078*^9, 3.8599677671253443`*^9, 3.859980989391019*^9, 
   3.860036129922806*^9, 3.860150621015583*^9, 3.860221337795391*^9, 
   3.86022247744525*^9, 3.860222640670439*^9, 3.8602230823588877`*^9, 
   3.861254002849312*^9, 3.8617507473085003`*^9, 3.863856284104212*^9, 
   3.864116520543511*^9, 3.864188116582663*^9, 3.8642777886141787`*^9, 
   3.864875713276677*^9, 3.8679056518310347`*^9, 3.867905839021058*^9, 
   3.869114402832045*^9, 3.869114936589098*^9, 3.869226540722392*^9, 
   3.869292722551999*^9, 3.8693056073436937`*^9, 3.8693097850539722`*^9, 
   3.869526559806155*^9, 3.869563735813437*^9, 3.869692376814899*^9, 
   3.8715664546589127`*^9, 3.8722468055564117`*^9},
 CellLabel->
  "Out[85]//MatrixForm=",ExpressionUUID->"8fbc2597-8c29-4f93-becb-\
41bbbdf93d87"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]},
      {
       RowBox[{"M", "-", 
        RowBox[{"c", " ", "X"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, 3.8595915846544437`*^9, 
   3.859591708843074*^9, 3.8596077699843187`*^9, {3.859610027156913*^9, 
   3.8596100423264923`*^9}, 3.859631367453413*^9, 3.859701206886294*^9, 
   3.859701238147749*^9, 3.85988501979108*^9, 3.8598851662267733`*^9, 
   3.859885340394309*^9, 3.8598855650858*^9, 3.859885599001861*^9, 
   3.859885663964158*^9, 3.85988586161346*^9, 3.859886103884995*^9, {
   3.8598862072069683`*^9, 3.859886253546266*^9}, 3.859886414773395*^9, 
   3.859887265600868*^9, 3.859887761789639*^9, 3.8598877940017138`*^9, 
   3.859887828004078*^9, 3.8599677671253443`*^9, 3.859980989391019*^9, 
   3.860036129922806*^9, 3.860150621015583*^9, 3.860221337795391*^9, 
   3.86022247744525*^9, 3.860222640670439*^9, 3.8602230823588877`*^9, 
   3.861254002849312*^9, 3.8617507473085003`*^9, 3.863856284104212*^9, 
   3.864116520543511*^9, 3.864188116582663*^9, 3.8642777886141787`*^9, 
   3.864875713276677*^9, 3.8679056518310347`*^9, 3.867905839021058*^9, 
   3.869114402832045*^9, 3.869114936589098*^9, 3.869226540722392*^9, 
   3.869292722551999*^9, 3.8693056073436937`*^9, 3.8693097850539722`*^9, 
   3.869526559806155*^9, 3.869563735813437*^9, 3.869692376814899*^9, 
   3.8715664546589127`*^9, 3.872246805558195*^9},
 CellLabel->
  "Out[86]//MatrixForm=",ExpressionUUID->"501cd98a-82a5-4850-a37c-\
01494bf1d025"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]], "0"},
     {"0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, 3.8595915846544437`*^9, 
   3.859591708843074*^9, 3.8596077699843187`*^9, {3.859610027156913*^9, 
   3.8596100423264923`*^9}, 3.859631367453413*^9, 3.859701206886294*^9, 
   3.859701238147749*^9, 3.85988501979108*^9, 3.8598851662267733`*^9, 
   3.859885340394309*^9, 3.8598855650858*^9, 3.859885599001861*^9, 
   3.859885663964158*^9, 3.85988586161346*^9, 3.859886103884995*^9, {
   3.8598862072069683`*^9, 3.859886253546266*^9}, 3.859886414773395*^9, 
   3.859887265600868*^9, 3.859887761789639*^9, 3.8598877940017138`*^9, 
   3.859887828004078*^9, 3.8599677671253443`*^9, 3.859980989391019*^9, 
   3.860036129922806*^9, 3.860150621015583*^9, 3.860221337795391*^9, 
   3.86022247744525*^9, 3.860222640670439*^9, 3.8602230823588877`*^9, 
   3.861254002849312*^9, 3.8617507473085003`*^9, 3.863856284104212*^9, 
   3.864116520543511*^9, 3.864188116582663*^9, 3.8642777886141787`*^9, 
   3.864875713276677*^9, 3.8679056518310347`*^9, 3.867905839021058*^9, 
   3.869114402832045*^9, 3.869114936589098*^9, 3.869226540722392*^9, 
   3.869292722551999*^9, 3.8693056073436937`*^9, 3.8693097850539722`*^9, 
   3.869526559806155*^9, 3.869563735813437*^9, 3.869692376814899*^9, 
   3.8715664546589127`*^9, 3.8722468055601883`*^9},
 CellLabel->
  "Out[87]//MatrixForm=",ExpressionUUID->"04eb96db-c3b4-4e8a-91c5-\
b3f698dd592a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"causalgraph", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<uW\>\"", ",", "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}],
       "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sig", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lA", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lB", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SigA", "=", 
   RowBox[{"Sig", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "lA"}], ",", 
      RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SigB", "=", 
   RowBox[{"Sig", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"lA", "+", "1"}], ";;", 
       RowBox[{"lA", "+", "lB"}]}], ",", 
      RowBox[{
       RowBox[{"lA", "+", "1"}], ";;", 
       RowBox[{"lA", "+", "lB"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SigAB", "=", 
   RowBox[{"Sig", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{
       RowBox[{"lA", "+", "1"}], ";;", 
       RowBox[{"lA", "+", "lB"}]}], ",", 
      RowBox[{"1", ";;", "lA"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sig", "//", 
   RowBox[{
    RowBox[{"CharacteristicPolynomial", "[", 
     RowBox[{"#", ",", "x"}], "]"}], "&"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{"Sig", "//", "Det"}]}], "Input",
 CellChangeTimes->{{3.85961000251764*^9, 3.8596101022452497`*^9}, {
  3.859610181670751*^9, 3.859610219301695*^9}, {3.85961028828724*^9, 
  3.859610359312358*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"8ec89eb2-b01f-42da-9836-66c9cfe7f920"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubsuperscriptBox["\[Sigma]", "uW", "2"], "0", "0", "0"},
     {"0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", "0"},
     {"0", "0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "0"},
     {"0", "0", "0", 
      SubsuperscriptBox["\[Sigma]", "uY", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.85961001022295*^9, 3.859610093679949*^9}, {
   3.859610192757585*^9, 3.8596102197425747`*^9}, {3.85961028900459*^9, 
   3.8596103601856422`*^9}, 3.8596313674800873`*^9, 3.859701206929494*^9, 
   3.85970123818441*^9, 3.85988501980836*^9, 3.85988516624461*^9, 
   3.859885340413043*^9, 3.8598855651024427`*^9, 3.85988559901868*^9, 
   3.859885663981956*^9, 3.859885861632597*^9, 3.8598861039023952`*^9, {
   3.859886207224526*^9, 3.859886253563818*^9}, 3.8598864147923937`*^9, 
   3.8598872656232777`*^9, 3.859887761807852*^9, 3.859887794024336*^9, 
   3.859887828025646*^9, 3.859967767144915*^9, 3.8599809894059973`*^9, 
   3.8600361299536533`*^9, 3.860150621039968*^9, 3.860221337815257*^9, 
   3.86022247746095*^9, 3.86022264068834*^9, 3.860223082375586*^9, 
   3.8612540028953657`*^9, 3.8617507473266277`*^9, 3.863856284119396*^9, 
   3.864116520580339*^9, 3.864188116601221*^9, 3.864277788631645*^9, 
   3.86487571329736*^9, 3.8679056518832207`*^9, 3.867905839070822*^9, 
   3.869114402849348*^9, 3.869114936605549*^9, 3.869226540745598*^9, 
   3.869292722577858*^9, 3.869305607370159*^9, 3.869309785081566*^9, 
   3.869526559823414*^9, 3.869563735847773*^9, 3.869692376850759*^9, 
   3.871566454722269*^9, 3.872246805614279*^9},
 CellLabel->
  "Out[89]//MatrixForm=",ExpressionUUID->"c2835759-8750-4718-811e-\
de7a2911629a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"x", "-", 
    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"x", "-", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"x", "-", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"x", "-", 
    SubsuperscriptBox["\[Sigma]", "uY", "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.85961001022295*^9, 3.859610093679949*^9}, {
   3.859610192757585*^9, 3.8596102197425747`*^9}, {3.85961028900459*^9, 
   3.8596103601856422`*^9}, 3.8596313674800873`*^9, 3.859701206929494*^9, 
   3.85970123818441*^9, 3.85988501980836*^9, 3.85988516624461*^9, 
   3.859885340413043*^9, 3.8598855651024427`*^9, 3.85988559901868*^9, 
   3.859885663981956*^9, 3.859885861632597*^9, 3.8598861039023952`*^9, {
   3.859886207224526*^9, 3.859886253563818*^9}, 3.8598864147923937`*^9, 
   3.8598872656232777`*^9, 3.859887761807852*^9, 3.859887794024336*^9, 
   3.859887828025646*^9, 3.859967767144915*^9, 3.8599809894059973`*^9, 
   3.8600361299536533`*^9, 3.860150621039968*^9, 3.860221337815257*^9, 
   3.86022247746095*^9, 3.86022264068834*^9, 3.860223082375586*^9, 
   3.8612540028953657`*^9, 3.8617507473266277`*^9, 3.863856284119396*^9, 
   3.864116520580339*^9, 3.864188116601221*^9, 3.864277788631645*^9, 
   3.86487571329736*^9, 3.8679056518832207`*^9, 3.867905839070822*^9, 
   3.869114402849348*^9, 3.869114936605549*^9, 3.869226540745598*^9, 
   3.869292722577858*^9, 3.869305607370159*^9, 3.869309785081566*^9, 
   3.869526559823414*^9, 3.869563735847773*^9, 3.869692376850759*^9, 
   3.871566454722269*^9, 3.872246805616185*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"28ad1930-f0c4-4649-9f66-6386eaff5914"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
  SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
  SubsuperscriptBox["\[Sigma]", "uX", "2"], " ", 
  SubsuperscriptBox["\[Sigma]", "uY", "2"]}]], "Output",
 CellChangeTimes->{{3.85961001022295*^9, 3.859610093679949*^9}, {
   3.859610192757585*^9, 3.8596102197425747`*^9}, {3.85961028900459*^9, 
   3.8596103601856422`*^9}, 3.8596313674800873`*^9, 3.859701206929494*^9, 
   3.85970123818441*^9, 3.85988501980836*^9, 3.85988516624461*^9, 
   3.859885340413043*^9, 3.8598855651024427`*^9, 3.85988559901868*^9, 
   3.859885663981956*^9, 3.859885861632597*^9, 3.8598861039023952`*^9, {
   3.859886207224526*^9, 3.859886253563818*^9}, 3.8598864147923937`*^9, 
   3.8598872656232777`*^9, 3.859887761807852*^9, 3.859887794024336*^9, 
   3.859887828025646*^9, 3.859967767144915*^9, 3.8599809894059973`*^9, 
   3.8600361299536533`*^9, 3.860150621039968*^9, 3.860221337815257*^9, 
   3.86022247746095*^9, 3.86022264068834*^9, 3.860223082375586*^9, 
   3.8612540028953657`*^9, 3.8617507473266277`*^9, 3.863856284119396*^9, 
   3.864116520580339*^9, 3.864188116601221*^9, 3.864277788631645*^9, 
   3.86487571329736*^9, 3.8679056518832207`*^9, 3.867905839070822*^9, 
   3.869114402849348*^9, 3.869114936605549*^9, 3.869226540745598*^9, 
   3.869292722577858*^9, 3.869305607370159*^9, 3.869309785081566*^9, 
   3.869526559823414*^9, 3.869563735847773*^9, 3.869692376850759*^9, 
   3.871566454722269*^9, 3.872246805617406*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"abba2edd-d024-4156-ba9e-1048cf1ba5cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sig", "=", 
  RowBox[{"NodeCovarianceLinComb", "[", 
   RowBox[{"causalgraph", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uW\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uW\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"C", ",", "D"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.86410971351278*^9, 3.864109781183262*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"2fa1a588-7cbd-4bbb-85e3-81150a0e6e69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", "C", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"B", " ", "D", " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "Output",
 CellChangeTimes->{{3.8641097525880613`*^9, 3.864109775200513*^9}, 
   3.864116520609177*^9, 3.864188116614162*^9, 3.8642777886455307`*^9, 
   3.8648757133136053`*^9, 3.8679056519213467`*^9, 3.867905839110599*^9, 
   3.869114402862548*^9, 3.8691149366179733`*^9, 3.869226540764523*^9, 
   3.869292722596961*^9, 3.8693056073900003`*^9, 3.869309785102572*^9, 
   3.869526559835676*^9, 3.869563735875827*^9, 3.869692376869039*^9, 
   3.87156645475624*^9, 3.872246805639018*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"d12f53ed-91eb-49b1-ac65-036414f3b0e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sig", "=", 
  RowBox[{
   RowBox[{"NodesCovarianceLinComb", "[", 
    RowBox[{"causalgraph", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<uW\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", "B"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<uW\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"C", ",", "D"}], "}"}]}], "}"}]}], "}"}]}], "]"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.864109786554492*^9, 3.864109821243393*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"94625393-8c20-4ea0-bacd-bf5692b38324"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["A", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["B", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], 
      RowBox[{
       RowBox[{"A", " ", "C", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"B", " ", "D", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]},
     {
      RowBox[{
       RowBox[{"A", " ", "C", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"B", " ", "D", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["C", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["D", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.864109809733656*^9, 3.864109821578672*^9}, 
   3.864116520634609*^9, 3.864188116625699*^9, 3.8642777886580763`*^9, 
   3.8648757133275757`*^9, 3.867905651955205*^9, 3.867905839140729*^9, 
   3.8691144028759403`*^9, 3.8691149366278677`*^9, 3.869226540785049*^9, 
   3.869292722611245*^9, 3.8693056074037457`*^9, 3.869309785117524*^9, 
   3.8695265598464413`*^9, 3.8695637358994617`*^9, 3.869692376883951*^9, 
   3.871566454785451*^9, 3.872246805683201*^9},
 CellLabel->
  "Out[98]//MatrixForm=",ExpressionUUID->"60e5c838-9fc3-4c58-b28d-\
94517d64d02f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Sig", "=", 
  RowBox[{
   RowBox[{"NodesCovarianceLinComb", "[", 
    RowBox[{"causalgraph", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\"\<X\>\"", "}"}], ",", 
         RowBox[{"{", "1", "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<uM\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", 
            FractionBox["\[Epsilon]", "d"]}]}], "}"}]}], "}"}]}], "}"}]}], 
    "]"}], "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{"CondMeansLinComb", "[", 
  RowBox[{"causalgraph", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "\"\<X\>\"", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<uM\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", 
         FractionBox["\[Epsilon]", "d"]}]}], "}"}]}], "}"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.864110116216312*^9, 3.8641101387367287`*^9}, {
  3.864110177266685*^9, 3.8641102036263447`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"8cef0432-6661-41b1-8aca-5bb36a3079b4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        SuperscriptBox["d", "2"]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.864110160158152*^9, {3.8641102050938377`*^9, 3.8641102153220663`*^9}, 
   3.864116520664833*^9, 3.864188116637826*^9, 3.8642777886702147`*^9, 
   3.8648757133419113`*^9, 3.867905651991104*^9, 3.867905839173101*^9, 
   3.869114402885419*^9, 3.8691149366388903`*^9, 3.869226540806341*^9, 
   3.869292722625676*^9, 3.869305607418342*^9, 3.86930978513351*^9, 
   3.869526559857904*^9, 3.8695637359250298`*^9, 3.869692376902409*^9, 
   3.871566454816889*^9, 3.8722468057049837`*^9},
 CellLabel->
  "Out[99]//MatrixForm=",ExpressionUUID->"91b64fb3-5fcd-4f78-a228-\
e74c89f6cca3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"d", " ", "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.864110160158152*^9, {3.8641102050938377`*^9, 3.8641102153220663`*^9}, 
   3.864116520664833*^9, 3.864188116637826*^9, 3.8642777886702147`*^9, 
   3.8648757133419113`*^9, 3.867905651991104*^9, 3.867905839173101*^9, 
   3.869114402885419*^9, 3.8691149366388903`*^9, 3.869226540806341*^9, 
   3.869292722625676*^9, 3.869305607418342*^9, 3.86930978513351*^9, 
   3.869526559857904*^9, 3.8695637359250298`*^9, 3.869692376902409*^9, 
   3.871566454816889*^9, 3.872246805706588*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"6c466daa-3c8f-4711-9c40-fb706dd78fcc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biases and Variances for [Gupta], Revisited", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.8595591312578793`*^9}},ExpressionUUID->"6d1561f6-1c63-441b-9ed0-\
fc35c83d329e"],

Cell["\<\
We can now perform the same manipulations as before, but much more \
intelligently. The goal here is to develop an approach which is general \
enough to be applied out of the box to all other conceivable networks. An \
intermediate goal is being able to apply it to the \
\[OpenCurlyDoubleQuote]confounded mediator\[CloseCurlyDoubleQuote] adjustment \
to the [Gupta] network.\
\>", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.858335532700376*^9, 3.858335564776896*^9}, {3.858335649607807*^9, 
  3.8583356557769747`*^9}, {3.858336399224999*^9, 3.8583364056425467`*^9}, {
  3.859545922446866*^9, 
  3.8595460107262383`*^9}},ExpressionUUID->"9cead3f3-9580-4bb0-9dc6-\
a075ff673e9e"],

Cell[TextData[{
 "As a reminder, here are the structural equations and estimators:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "b251ade8-ceeb-48d4-b2ae-63a937f661f7"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "43900356-1299-4359-b503-2368caac39b6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "fadb3607-0e56-462d-b32d-6b6ac033624d"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "c209889f-b60f-4093-b558-d704db5785a8"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}},ExpressionUUID->"7b80321f-322e-467f-90aa-\
50f076e0c52e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"M", ",", "X"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     OverscriptBox["bdivd", "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "M", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["c", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.859546089296102*^9, 3.8595460971681967`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"48be7b45-a1f4-4de7-a825-7868272940dd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.8596077699973783`*^9, 3.859610027191703*^9, 3.85963136749975*^9, 
   3.859701206962082*^9, 3.859701238225834*^9, 3.8598850198239613`*^9, 
   3.859885166259493*^9, 3.859885340427815*^9, 3.8598855651160088`*^9, 
   3.859885599031952*^9, 3.859885663995275*^9, 3.859885861647509*^9, 
   3.859886103915604*^9, {3.859886207238886*^9, 3.859886253577096*^9}, 
   3.859886414807568*^9, 3.85988726564132*^9, 3.859887761823477*^9, 
   3.859887794041802*^9, 3.8598878280421753`*^9, 3.859967767159005*^9, 
   3.859980989417288*^9, 3.860036129976096*^9, 3.860150621053734*^9, 
   3.860221337831584*^9, 3.860222477474022*^9, 3.8602226407023983`*^9, 
   3.860223082389236*^9, 3.8612540029364233`*^9, 3.861750747340432*^9, 
   3.8638562841333103`*^9, 3.864116520693284*^9, 3.864188116650168*^9, 
   3.8642777886830883`*^9, 3.86487571335436*^9, 3.8679056520296297`*^9, 
   3.86790583920891*^9, 3.869114402895726*^9, 3.869114936650614*^9, 
   3.869226540827489*^9, 3.869292722644053*^9, 3.869305607436253*^9, 
   3.869309785152619*^9, 3.8695265598701963`*^9, 3.869563735953265*^9, 
   3.869692376919945*^9, 3.871566454852818*^9, 3.87224680574327*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"4a646367-b1bf-4814-93c8-fcbe67726cad"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.8596077699973783`*^9, 3.859610027191703*^9, 3.85963136749975*^9, 
   3.859701206962082*^9, 3.859701238225834*^9, 3.8598850198239613`*^9, 
   3.859885166259493*^9, 3.859885340427815*^9, 3.8598855651160088`*^9, 
   3.859885599031952*^9, 3.859885663995275*^9, 3.859885861647509*^9, 
   3.859886103915604*^9, {3.859886207238886*^9, 3.859886253577096*^9}, 
   3.859886414807568*^9, 3.85988726564132*^9, 3.859887761823477*^9, 
   3.859887794041802*^9, 3.8598878280421753`*^9, 3.859967767159005*^9, 
   3.859980989417288*^9, 3.860036129976096*^9, 3.860150621053734*^9, 
   3.860221337831584*^9, 3.860222477474022*^9, 3.8602226407023983`*^9, 
   3.860223082389236*^9, 3.8612540029364233`*^9, 3.861750747340432*^9, 
   3.8638562841333103`*^9, 3.864116520693284*^9, 3.864188116650168*^9, 
   3.8642777886830883`*^9, 3.86487571335436*^9, 3.8679056520296297`*^9, 
   3.86790583920891*^9, 3.869114402895726*^9, 3.869114936650614*^9, 
   3.869226540827489*^9, 3.869292722644053*^9, 3.869305607436253*^9, 
   3.869309785152619*^9, 3.8695265598701963`*^9, 3.869563735953265*^9, 
   3.869692376919945*^9, 3.871566454852818*^9, 3.8722468057447968`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"ca5fb867-7ad7-4211-9d7f-2e83be73595d"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["a", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy08oQwEAx/FZpJktq9E2UsraLjab10gsTw4zthnKhpr8afmTHXaRMVoj
f3ZAShZ2Uo5kUoyFA4skod1kOfjz0iLLIrzfO3z7nL4FnY7GHjaLxcqlg92u
vURRmCKJxcwvaBT1sxW0Q5o449q6WQB9woUc6PaUymCzjieH/OSgGv78ZROQ
e6wth7G+JZL5TS118FnyboInTv12Ma1h/jUIqazoASzzfp9Cr9N/Ca8LP+4g
0aVJQPtv5BdGZwNpKtqMyDWj1nrOgfsaMx/6p26FcK41RQzj7TYVdH2FCGis
7a2GvAe3Dg7vkPVQkm5vgB2HFdNQf6b0weRTOAZnbu4fYepy6AVu7AbfYLDS
wVHTjqlWGd+31EVwU1nF6CtRcMaPKDLwmS2A8iZLHpQa2vKhxEpJoUXXJoNX
NYnRCVquaMUDBy5soknaEWpFDP8BOmfZgA==
  "],
 CellLabel->
  "In[107]:=",ExpressionUUID->"18d8d8f4-fa4b-4984-bc3a-92128754d852"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"72d0df97-d647-4bf9-b725-2525dd5fea8f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.8596077700081367`*^9, 3.859610027208755*^9, 
   3.859631367522325*^9, 3.859701206998219*^9, 3.859701238265183*^9, 
   3.859885019843472*^9, 3.85988516627533*^9, 3.859885340443709*^9, 
   3.859885565130596*^9, 3.859885599046155*^9, 3.859885664010501*^9, 
   3.8598858616636267`*^9, 3.859886103929531*^9, {3.85988620725454*^9, 
   3.859886253592938*^9}, 3.859886414822341*^9, 3.85988726566147*^9, 
   3.859887761838647*^9, 3.859887794059349*^9, 3.859887828060644*^9, 
   3.859967767178075*^9, 3.8599809894297667`*^9, 3.860036129999679*^9, 
   3.8601506210721493`*^9, 3.8602213378473186`*^9, 3.860222477491358*^9, 
   3.860222640717808*^9, 3.860223082409175*^9, 3.861254003003841*^9, 
   3.861750747355083*^9, 3.863856284148069*^9, 3.864116520728077*^9, 
   3.8641881166642437`*^9, 3.8642777886976*^9, 3.864875713368252*^9, 
   3.8679056520761213`*^9, 3.867905839250451*^9, 3.8691144029076843`*^9, 
   3.869114936663177*^9, 3.869226540849568*^9, 3.869292722663291*^9, 
   3.869305607455729*^9, 3.8693097851730633`*^9, 3.8695265598846073`*^9, 
   3.869563735981703*^9, 3.869692376935574*^9, 3.871566454954492*^9, 
   3.8722468057698402`*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"71aac00b-7d44-4830-877a-4c2da40cc7c4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{"M", "-", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.8596077700081367`*^9, 3.859610027208755*^9, 
   3.859631367522325*^9, 3.859701206998219*^9, 3.859701238265183*^9, 
   3.859885019843472*^9, 3.85988516627533*^9, 3.859885340443709*^9, 
   3.859885565130596*^9, 3.859885599046155*^9, 3.859885664010501*^9, 
   3.8598858616636267`*^9, 3.859886103929531*^9, {3.85988620725454*^9, 
   3.859886253592938*^9}, 3.859886414822341*^9, 3.85988726566147*^9, 
   3.859887761838647*^9, 3.859887794059349*^9, 3.859887828060644*^9, 
   3.859967767178075*^9, 3.8599809894297667`*^9, 3.860036129999679*^9, 
   3.8601506210721493`*^9, 3.8602213378473186`*^9, 3.860222477491358*^9, 
   3.860222640717808*^9, 3.860223082409175*^9, 3.861254003003841*^9, 
   3.861750747355083*^9, 3.863856284148069*^9, 3.864116520728077*^9, 
   3.8641881166642437`*^9, 3.8642777886976*^9, 3.864875713368252*^9, 
   3.8679056520761213`*^9, 3.867905839250451*^9, 3.8691144029076843`*^9, 
   3.869114936663177*^9, 3.869226540849568*^9, 3.869292722663291*^9, 
   3.869305607455729*^9, 3.8693097851730633`*^9, 3.8695265598846073`*^9, 
   3.869563735981703*^9, 3.869692376935574*^9, 3.871566454954492*^9, 
   3.87224680577133*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"a2b7e7b4-12e8-46bb-87dc-6b3d997185db"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.8596077700081367`*^9, 3.859610027208755*^9, 
   3.859631367522325*^9, 3.859701206998219*^9, 3.859701238265183*^9, 
   3.859885019843472*^9, 3.85988516627533*^9, 3.859885340443709*^9, 
   3.859885565130596*^9, 3.859885599046155*^9, 3.859885664010501*^9, 
   3.8598858616636267`*^9, 3.859886103929531*^9, {3.85988620725454*^9, 
   3.859886253592938*^9}, 3.859886414822341*^9, 3.85988726566147*^9, 
   3.859887761838647*^9, 3.859887794059349*^9, 3.859887828060644*^9, 
   3.859967767178075*^9, 3.8599809894297667`*^9, 3.860036129999679*^9, 
   3.8601506210721493`*^9, 3.8602213378473186`*^9, 3.860222477491358*^9, 
   3.860222640717808*^9, 3.860223082409175*^9, 3.861254003003841*^9, 
   3.861750747355083*^9, 3.863856284148069*^9, 3.864116520728077*^9, 
   3.8641881166642437`*^9, 3.8642777886976*^9, 3.864875713368252*^9, 
   3.8679056520761213`*^9, 3.867905839250451*^9, 3.8691144029076843`*^9, 
   3.869114936663177*^9, 3.869226540849568*^9, 3.869292722663291*^9, 
   3.869305607455729*^9, 3.8693097851730633`*^9, 3.8695265598846073`*^9, 
   3.869563735981703*^9, 3.869692376935574*^9, 3.871566454954492*^9, 
   3.8722468057725363`*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"5b57094d-20f6-4b51-9768-7015cb207004"]
}, Open  ]],

Cell["Similarly for c:", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 
  3.85833817346621*^9}},ExpressionUUID->"2fd0ce14-ca71-455e-93b7-\
3b4d53263732"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", 
     RowBox[{
      RowBox[{"c", "*", "X"}], "+", "uM"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["c", "^"], "-", "c"}], "//.", 
   "structureEqs"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<uM\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noises", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanreplace", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"noises", ",", "condmeans"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy08oQwEAx/FZxLBFbeIdFClSw9teMxvLuMw2m0lpUjS0UHbYBaupteTP
DkjJCgcpjtqTYjZ/DizlsNBusnbw56U1tbZovN87fPucvjU2R/8En8fjEWxw
3HWWloYZLbVZmoGmyml+E+usIsm5e2Aphz7xRgV0e1rr4YBO2ABF2RkZ/P2T
ULDkWqOC8aktLfebBw3wnUiZ4Y1TH2hh7V3/pCFTFruASu/PLfQ6/Q8wWvf9
DKkxRRrac5EcjK3uFZCsxZEop8Z6L4DnCosI+peexHBtKK8KJodHSOjKBClo
6pnsgsJXtw7On2iNkCi098HRUPsy1N81+2D2LRyHK48vCZi/HfyAh6f0F6Q7
HAIZ6wK5w5k6lklhd+OcGgptl8TiFaM1KrPVUFx7REKDmqEgLfG0wYR1XwVD
8oAGxuVFnfAfGb3SRQ==
  "],
 CellLabel->
  "In[114]:=",ExpressionUUID->"94181819-8c49-4d07-bee2-fa2ca5909853"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}]}], ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.859591312659512*^9, 3.859591358967806*^9, 3.859591584736274*^9, 
   3.859591708913746*^9, 3.8596077700283213`*^9, 3.859610027234254*^9, 
   3.859631367553928*^9, 3.8597012070516853`*^9, 3.8597012383333807`*^9, 
   3.8598850198653803`*^9, 3.8598851662993*^9, 3.859885340469726*^9, 
   3.8598855651524687`*^9, 3.8598855990694237`*^9, 3.859885664033375*^9, 
   3.8598858616886177`*^9, 3.8598861039504223`*^9, {3.859886207279212*^9, 
   3.8598862536166897`*^9}, 3.859886414846919*^9, 3.859887265692418*^9, 
   3.859887761861946*^9, 3.85988779408731*^9, 3.859887828088656*^9, 
   3.859967767203684*^9, 3.859980989448257*^9, 3.860036130036292*^9, 
   3.860150621095475*^9, 3.860221337872877*^9, 3.860222477502269*^9, 
   3.8602226407460957`*^9, 3.860223082431902*^9, 3.861254003064156*^9, 
   3.861750747381624*^9, 3.863856284176448*^9, 3.864116520783215*^9, 
   3.864188116687161*^9, 3.86427778871983*^9, 3.864875713393009*^9, 
   3.867905652141449*^9, 3.867905839319745*^9, 3.869114402925033*^9, 
   3.869114936683112*^9, 3.869226540884203*^9, 3.869292722683518*^9, 
   3.8693056074768667`*^9, 3.869309785195528*^9, 3.869526559904634*^9, 
   3.869563736029286*^9, 3.869692376963654*^9, 3.871566455017082*^9, 
   3.8722468057929363`*^9},
 CellLabel->
  "Out[115]=",ExpressionUUID->"01935de9-81d7-4640-b7ce-3d5b980bd91a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.859591312659512*^9, 3.859591358967806*^9, 3.859591584736274*^9, 
   3.859591708913746*^9, 3.8596077700283213`*^9, 3.859610027234254*^9, 
   3.859631367553928*^9, 3.8597012070516853`*^9, 3.8597012383333807`*^9, 
   3.8598850198653803`*^9, 3.8598851662993*^9, 3.859885340469726*^9, 
   3.8598855651524687`*^9, 3.8598855990694237`*^9, 3.859885664033375*^9, 
   3.8598858616886177`*^9, 3.8598861039504223`*^9, {3.859886207279212*^9, 
   3.8598862536166897`*^9}, 3.859886414846919*^9, 3.859887265692418*^9, 
   3.859887761861946*^9, 3.85988779408731*^9, 3.859887828088656*^9, 
   3.859967767203684*^9, 3.859980989448257*^9, 3.860036130036292*^9, 
   3.860150621095475*^9, 3.860221337872877*^9, 3.860222477502269*^9, 
   3.8602226407460957`*^9, 3.860223082431902*^9, 3.861254003064156*^9, 
   3.861750747381624*^9, 3.863856284176448*^9, 3.864116520783215*^9, 
   3.864188116687161*^9, 3.86427778871983*^9, 3.864875713393009*^9, 
   3.867905652141449*^9, 3.867905839319745*^9, 3.869114402925033*^9, 
   3.869114936683112*^9, 3.869226540884203*^9, 3.869292722683518*^9, 
   3.8693056074768667`*^9, 3.869309785195528*^9, 3.869526559904634*^9, 
   3.869563736029286*^9, 3.869692376963654*^9, 3.871566455017082*^9, 
   3.872246805794178*^9},
 CellLabel->
  "Out[120]=",ExpressionUUID->"f9da76c7-c31d-4686-815e-a2bc40042b88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimate", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "*", "cerror"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimatesimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"covestimate", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8595579821985483`*^9, 3.859558061814584*^9}, {
  3.859558655476707*^9, 3.859558658433288*^9}, {3.8595590766617002`*^9, 
  3.859559108103771*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"2c216537-6554-44f2-a3ef-d9574b6cd24d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861254003110179*^9, 
   3.861750747395502*^9, 3.863856284193775*^9, 3.86411652081185*^9, 
   3.8641881167005863`*^9, 3.864277788732482*^9, 3.864875713405527*^9, 
   3.867905652158955*^9, 3.8679058393616667`*^9, 3.869114402935286*^9, 
   3.869114936694273*^9, 3.8692265409034147`*^9, 3.8692927227019997`*^9, 
   3.869305607494156*^9, 3.869309785214671*^9, 3.869526559917665*^9, 
   3.869563736057815*^9, 3.869692376979107*^9, 3.871566455088519*^9, 
   3.872246805815555*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"d30a1176-019c-44b9-88ec-c995727a9a92"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{"M", "-", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861254003110179*^9, 
   3.861750747395502*^9, 3.863856284193775*^9, 3.86411652081185*^9, 
   3.8641881167005863`*^9, 3.864277788732482*^9, 3.864875713405527*^9, 
   3.867905652158955*^9, 3.8679058393616667`*^9, 3.869114402935286*^9, 
   3.869114936694273*^9, 3.8692265409034147`*^9, 3.8692927227019997`*^9, 
   3.869305607494156*^9, 3.869309785214671*^9, 3.869526559917665*^9, 
   3.869563736057815*^9, 3.869692376979107*^9, 3.871566455088519*^9, 
   3.872246805817004*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"fe9f6a58-1b89-4af7-b6e4-baf77278c1fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "c"}], "+", 
    FractionBox[
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"uM", "+", 
        RowBox[{"c", " ", "X"}]}], ")"}]}], 
     RowBox[{"X", ".", "X"}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "a"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"M", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          FractionBox[
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}], " ", 
       
       RowBox[{"X", ".", "X"}]}], "-", 
      RowBox[{
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"X", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          FractionBox[
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861254003110179*^9, 
   3.861750747395502*^9, 3.863856284193775*^9, 3.86411652081185*^9, 
   3.8641881167005863`*^9, 3.864277788732482*^9, 3.864875713405527*^9, 
   3.867905652158955*^9, 3.8679058393616667`*^9, 3.869114402935286*^9, 
   3.869114936694273*^9, 3.8692265409034147`*^9, 3.8692927227019997`*^9, 
   3.869305607494156*^9, 3.869309785214671*^9, 3.869526559917665*^9, 
   3.869563736057815*^9, 3.869692376979107*^9, 3.871566455088519*^9, 
   3.872246805818368*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"6a44bb03-bf60-4f7c-9bbd-f04d024b572b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861254003110179*^9, 
   3.861750747395502*^9, 3.863856284193775*^9, 3.86411652081185*^9, 
   3.8641881167005863`*^9, 3.864277788732482*^9, 3.864875713405527*^9, 
   3.867905652158955*^9, 3.8679058393616667`*^9, 3.869114402935286*^9, 
   3.869114936694273*^9, 3.8692265409034147`*^9, 3.8692927227019997`*^9, 
   3.869305607494156*^9, 3.869309785214671*^9, 3.869526559917665*^9, 
   3.869563736057815*^9, 3.869692376979107*^9, 3.871566455088519*^9, 
   3.8722468058407907`*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"093c8606-5bbe-4240-9597-c05f4336738b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biases and Variances for Approximate FDC [Gupta], Revisited", \
"Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
   3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
   3.8583190781426697`*^9}, {3.8583294810528927`*^9, 
   3.8583294837393723`*^9}, {3.859545918605206*^9, 3.859545920301775*^9}, {
   3.859559128455942*^9, 3.8595591312578793`*^9}, {3.859607171952083*^9, 
   3.859607174094486*^9}, 
   3.859885062037899*^9},ExpressionUUID->"1333173b-516b-4f58-b710-\
f846f770e7ad"],

Cell[TextData[{
 "In this case, the structural equations are unchanged, but the estimator for \
a is simplified.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "aff98c10-1675-4d78-8a12-6502ef4747c8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "bd2c8383-cea2-4141-8c8d-bceaa4877221"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "826f492d-9b2e-4e81-812e-344706ac9b64"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "cc1f94ff-1f35-4d88-ae4e-62da070acb6b"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.859607187882019*^9, 3.859607195870319*^9}, {
  3.859607409379047*^9, 
  3.859607413066949*^9}},ExpressionUUID->"70bc763c-6fcd-4d9b-bfe4-\
02c5753bd298"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", "M", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["approxa", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "M", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["c", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.859546089296102*^9, 3.8595460971681967`*^9}, {
  3.859607716759109*^9, 3.8596077201953297`*^9}, {3.859608069554517*^9, 
  3.859608079649106*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"51848f12-4455-40e1-8e20-e17c2aecc138"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"M", ".", "Y"}], 
   RowBox[{"M", ".", "M"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.859607770089818*^9, {3.859608072043679*^9, 3.859608080187748*^9}, 
   3.8596100272861757`*^9, 3.859631367625342*^9, 3.8597012071750393`*^9, 
   3.859701238459065*^9, 3.859885019921348*^9, 3.8598851663524723`*^9, 
   3.859885340524213*^9, 3.859885565206126*^9, 3.859885599122307*^9, 
   3.859885664086697*^9, 3.8598858617415857`*^9, 3.8598861040005093`*^9, {
   3.85988620733501*^9, 3.859886253668955*^9}, 3.859886414901938*^9, 
   3.859887265756473*^9, 3.859887761915132*^9, 3.8598877941475163`*^9, 
   3.859887828149646*^9, 3.859967767261508*^9, 3.8599809894916897`*^9, 
   3.860036130109704*^9, 3.860150621145862*^9, 3.860221337919187*^9, 
   3.86022247754154*^9, 3.860222640800056*^9, 3.8602230824788218`*^9, 
   3.861254003212434*^9, 3.861750747431798*^9, 3.8638562842336817`*^9, 
   3.8641165208893223`*^9, 3.864188116734795*^9, 3.8642777887645483`*^9, 
   3.864875713438568*^9, 3.867905652293577*^9, 3.867905839497489*^9, 
   3.8691144029622593`*^9, 3.869114936725651*^9, 3.869226540955966*^9, 
   3.869292722736268*^9, 3.8693056075359898`*^9, 3.869309785251218*^9, 
   3.869526559946163*^9, 3.869563736128398*^9, 3.8696923770268707`*^9, 
   3.87156645519543*^9, 3.872246805862628*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"8e8a9f7b-9b28-48bb-a021-8d1817a60081"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.859607770089818*^9, {3.859608072043679*^9, 3.859608080187748*^9}, 
   3.8596100272861757`*^9, 3.859631367625342*^9, 3.8597012071750393`*^9, 
   3.859701238459065*^9, 3.859885019921348*^9, 3.8598851663524723`*^9, 
   3.859885340524213*^9, 3.859885565206126*^9, 3.859885599122307*^9, 
   3.859885664086697*^9, 3.8598858617415857`*^9, 3.8598861040005093`*^9, {
   3.85988620733501*^9, 3.859886253668955*^9}, 3.859886414901938*^9, 
   3.859887265756473*^9, 3.859887761915132*^9, 3.8598877941475163`*^9, 
   3.859887828149646*^9, 3.859967767261508*^9, 3.8599809894916897`*^9, 
   3.860036130109704*^9, 3.860150621145862*^9, 3.860221337919187*^9, 
   3.86022247754154*^9, 3.860222640800056*^9, 3.8602230824788218`*^9, 
   3.861254003212434*^9, 3.861750747431798*^9, 3.8638562842336817`*^9, 
   3.8641165208893223`*^9, 3.864188116734795*^9, 3.8642777887645483`*^9, 
   3.864875713438568*^9, 3.867905652293577*^9, 3.867905839497489*^9, 
   3.8691144029622593`*^9, 3.869114936725651*^9, 3.869226540955966*^9, 
   3.869292722736268*^9, 3.8693056075359898`*^9, 3.869309785251218*^9, 
   3.869526559946163*^9, 3.869563736128398*^9, 3.8696923770268707`*^9, 
   3.87156645519543*^9, 3.8722468058639507`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"17b40d0b-d531-4908-97d8-eed888bf4e24"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["approxa", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, 3.859607725650403*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"b805ede3-7563-44d9-bd74-6b89b4038c41"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<X\>\"", ",", "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<M\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"abias", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
  3.85960814159554*^9, 3.8596081641830873`*^9}, {3.859885313241066*^9, 
  3.85988531358348*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"44e44ce1-7c55-4300-9740-8c9b138993ff"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"X", ",", "uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.859607770107766*^9, 3.859608084635017*^9, {
   3.859608142494143*^9, 3.859608164864297*^9}, 3.8596100273029337`*^9, 
   3.8596313676480827`*^9, 3.859701207208246*^9, 3.859701238496211*^9, 
   3.859885019940786*^9, 3.859885166368373*^9, 3.85988534054128*^9, 
   3.859885565221838*^9, 3.859885599137776*^9, 3.859885664101749*^9, 
   3.8598858617564573`*^9, 3.8598861040151243`*^9, {3.85988620734933*^9, 
   3.859886253684342*^9}, 3.859886414917755*^9, 3.859887265776305*^9, 
   3.859887761931094*^9, 3.85988779416593*^9, 3.8598878281689*^9, 
   3.859967767275693*^9, {3.859980989503793*^9, 3.859981015787676*^9}, 
   3.860036130133264*^9, 3.860150621159931*^9, 3.860221337931327*^9, 
   3.8602224775536757`*^9, 3.860222640816318*^9, 3.860223082493391*^9, 
   3.861254003255129*^9, 3.861750747444808*^9, 3.863856284249621*^9, 
   3.8641165209266567`*^9, 3.8641881167493563`*^9, 3.864277788778532*^9, 
   3.864875713452623*^9, 3.867905652342581*^9, 3.86790583954081*^9, 
   3.869114402974206*^9, 3.869114936738381*^9, 3.8692265409798193`*^9, 
   3.869292722756016*^9, 3.8693056075553923`*^9, 3.8693097852723837`*^9, 
   3.86952655995754*^9, 3.869563736158762*^9, 3.86969237704638*^9, 
   3.871566455249424*^9, 3.872246805886773*^9},
 CellLabel->
  "Out[137]=",ExpressionUUID->"9fc7f245-dad5-4134-b4d1-c8690e813e23"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", "M", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"c", " ", "M", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{"M", " ", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]}], 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.859607770107766*^9, 3.859608084635017*^9, {
   3.859608142494143*^9, 3.859608164864297*^9}, 3.8596100273029337`*^9, 
   3.8596313676480827`*^9, 3.859701207208246*^9, 3.859701238496211*^9, 
   3.859885019940786*^9, 3.859885166368373*^9, 3.85988534054128*^9, 
   3.859885565221838*^9, 3.859885599137776*^9, 3.859885664101749*^9, 
   3.8598858617564573`*^9, 3.8598861040151243`*^9, {3.85988620734933*^9, 
   3.859886253684342*^9}, 3.859886414917755*^9, 3.859887265776305*^9, 
   3.859887761931094*^9, 3.85988779416593*^9, 3.8598878281689*^9, 
   3.859967767275693*^9, {3.859980989503793*^9, 3.859981015787676*^9}, 
   3.860036130133264*^9, 3.860150621159931*^9, 3.860221337931327*^9, 
   3.8602224775536757`*^9, 3.860222640816318*^9, 3.860223082493391*^9, 
   3.861254003255129*^9, 3.861750747444808*^9, 3.863856284249621*^9, 
   3.8641165209266567`*^9, 3.8641881167493563`*^9, 3.864277788778532*^9, 
   3.864875713452623*^9, 3.867905652342581*^9, 3.86790583954081*^9, 
   3.869114402974206*^9, 3.869114936738381*^9, 3.8692265409798193`*^9, 
   3.869292722756016*^9, 3.8693056075553923`*^9, 3.8693097852723837`*^9, 
   3.86952655995754*^9, 3.869563736158762*^9, 3.86969237704638*^9, 
   3.871566455249424*^9, 3.8722468058890963`*^9},
 CellLabel->
  "Out[139]=",ExpressionUUID->"8f7b767a-ee1e-40a6-9c84-e95ecc597d90"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "c", " ", "d", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
  RowBox[{
   SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
   RowBox[{
    SuperscriptBox["c", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.859607770107766*^9, 3.859608084635017*^9, {
   3.859608142494143*^9, 3.859608164864297*^9}, 3.8596100273029337`*^9, 
   3.8596313676480827`*^9, 3.859701207208246*^9, 3.859701238496211*^9, 
   3.859885019940786*^9, 3.859885166368373*^9, 3.85988534054128*^9, 
   3.859885565221838*^9, 3.859885599137776*^9, 3.859885664101749*^9, 
   3.8598858617564573`*^9, 3.8598861040151243`*^9, {3.85988620734933*^9, 
   3.859886253684342*^9}, 3.859886414917755*^9, 3.859887265776305*^9, 
   3.859887761931094*^9, 3.85988779416593*^9, 3.8598878281689*^9, 
   3.859967767275693*^9, {3.859980989503793*^9, 3.859981015787676*^9}, 
   3.860036130133264*^9, 3.860150621159931*^9, 3.860221337931327*^9, 
   3.8602224775536757`*^9, 3.860222640816318*^9, 3.860223082493391*^9, 
   3.861254003255129*^9, 3.861750747444808*^9, 3.863856284249621*^9, 
   3.8641165209266567`*^9, 3.8641881167493563`*^9, 3.864277788778532*^9, 
   3.864875713452623*^9, 3.867905652342581*^9, 3.86790583954081*^9, 
   3.869114402974206*^9, 3.869114936738381*^9, 3.8692265409798193`*^9, 
   3.869292722756016*^9, 3.8693056075553923`*^9, 3.8693097852723837`*^9, 
   3.86952655995754*^9, 3.869563736158762*^9, 3.86969237704638*^9, 
   3.871566455249424*^9, 3.872246805890564*^9},
 CellLabel->
  "Out[140]=",ExpressionUUID->"cebac037-c641-4e59-a01f-555f35a7c15c"]
}, Open  ]],

Cell["Similarly for c:", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 
  3.85833817346621*^9}},ExpressionUUID->"fa7c1f65-6a36-40d1-8ea4-\
c14a2f0c4eaf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", 
     RowBox[{
      RowBox[{"c", "*", "X"}], "+", "uM"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["c", "^"], "-", "c"}], "//.", 
   "structureEqs"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<uM\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noises", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanreplace", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"noises", ",", "condmeans"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cbias", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy08oQwEAx/FZxLBFbYspRURq2Paa2VgeqdlmMykNRUMLZYddsJpakj87
ICUrHKQ4apPyZ2MOLLWD0G6ydvDnpTW1tmi83zt8+5y+FRZb7zibxWKV0cEx
x1lSHKBIYrMwBQ0lU+x62hl5nHH3wFQM3fwNIXS6mmpgn4ZbC3npaSn8/RMQ
sCCoVsLo5BbJ/MZ+HXwXJYzwxq71NtJ2r3/6IFUUuYSKhZ9buGD3hOFD1fcz
JEblSWjNhDIwsrqXI6HNDz0wqs33HHguN/GgZ+mJD9cGskphfGhYAh2pCwIa
uibaIffVqYFzJ6QeinKtPXDE37IMtXcNbph+C0ThyuNLDGZvX3zAw1PfF/S1
2jhS2nnJDmPiWCqGHXWzKsi1XIkWrylSr0iXQ37lkQTqVBQBfQJXM4yZ95XQ
L/OqYVSW1wY9ncG96iBFDgrDjP+GydqM
  "],
 CellLabel->
  "In[141]:=",ExpressionUUID->"ae1fa19a-7e0b-40db-8b22-d02e9615ca90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}]}], ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.859591312659512*^9, 3.859591358967806*^9, 3.859591584736274*^9, 
   3.859591708913746*^9, 3.8596077701201468`*^9, 3.859610027335052*^9, 
   3.859631367694577*^9, 3.8597012072860937`*^9, 3.859701238599616*^9, 
   3.8598850199670267`*^9, 3.8598851663931828`*^9, 3.859885340577806*^9, 
   3.859885565249938*^9, 3.859885599172029*^9, 3.8598856641288767`*^9, 
   3.859885861790379*^9, 3.859886104044561*^9, {3.85988620738233*^9, 
   3.859886253715617*^9}, 3.859886414944605*^9, 3.8598872658074627`*^9, 
   3.8598877619644337`*^9, 3.8598877941946793`*^9, 3.8598878281981087`*^9, 
   3.8599677672978067`*^9, {3.85998098952833*^9, 3.859981018913327*^9}, 
   3.8600361301671762`*^9, 3.860150621181532*^9, 3.860221337951441*^9, 
   3.8602224775756483`*^9, 3.860222640840424*^9, 3.860223082516583*^9, 
   3.8612540033301563`*^9, 3.861750747470151*^9, 3.863856284263357*^9, 
   3.864116520981905*^9, 3.864188116773776*^9, 3.864277788801386*^9, 
   3.8648757134760513`*^9, 3.8679056524150057`*^9, 3.867905839605504*^9, 
   3.869114402992474*^9, 3.869114936759166*^9, 3.8692265410162373`*^9, 
   3.869292722786666*^9, 3.869305607585807*^9, 3.8693097853048887`*^9, 
   3.869526559982375*^9, 3.8695637362112617`*^9, 3.8696923770779867`*^9, 
   3.8715664553451*^9, 3.872246805908286*^9},
 CellLabel->
  "Out[142]=",ExpressionUUID->"59e92d0e-5cd8-4e45-abe3-fd25ef57e56d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.859591312659512*^9, 3.859591358967806*^9, 3.859591584736274*^9, 
   3.859591708913746*^9, 3.8596077701201468`*^9, 3.859610027335052*^9, 
   3.859631367694577*^9, 3.8597012072860937`*^9, 3.859701238599616*^9, 
   3.8598850199670267`*^9, 3.8598851663931828`*^9, 3.859885340577806*^9, 
   3.859885565249938*^9, 3.859885599172029*^9, 3.8598856641288767`*^9, 
   3.859885861790379*^9, 3.859886104044561*^9, {3.85988620738233*^9, 
   3.859886253715617*^9}, 3.859886414944605*^9, 3.8598872658074627`*^9, 
   3.8598877619644337`*^9, 3.8598877941946793`*^9, 3.8598878281981087`*^9, 
   3.8599677672978067`*^9, {3.85998098952833*^9, 3.859981018913327*^9}, 
   3.8600361301671762`*^9, 3.860150621181532*^9, 3.860221337951441*^9, 
   3.8602224775756483`*^9, 3.860222640840424*^9, 3.860223082516583*^9, 
   3.8612540033301563`*^9, 3.861750747470151*^9, 3.863856284263357*^9, 
   3.864116520981905*^9, 3.864188116773776*^9, 3.864277788801386*^9, 
   3.8648757134760513`*^9, 3.8679056524150057`*^9, 3.867905839605504*^9, 
   3.869114402992474*^9, 3.869114936759166*^9, 3.8692265410162373`*^9, 
   3.869292722786666*^9, 3.869305607585807*^9, 3.8693097853048887`*^9, 
   3.869526559982375*^9, 3.8695637362112617`*^9, 3.8696923770779867`*^9, 
   3.8715664553451*^9, 3.872246805909567*^9},
 CellLabel->
  "Out[147]=",ExpressionUUID->"ead88ab7-508a-4e64-aa77-68cfec757e77"]
}, Open  ]],

Cell[TextData[{
 "To calculate the covariance between a and c, we can take advantage of \
smoothing over conditional variables X and M, since the term ",
 Cell[BoxData[
  FractionBox[
   RowBox[{"X", ".", "uM"}], 
   RowBox[{"X", ".", "X"}]]], "Input",
  CellChangeTimes->{{3.8595579821985483`*^9, 3.859558061814584*^9}, {
   3.859558655476707*^9, 3.859558658433288*^9}, {3.8595590766617002`*^9, 
   3.859559108103771*^9}, {3.859608839331168*^9, 3.859608846824729*^9}, {
   3.859609283803321*^9, 3.859609284583967*^9}, {3.859885155954644*^9, 
   3.859885160400764*^9}, {3.859885326423717*^9, 3.859885333034583*^9}, {
   3.8598855428556213`*^9, 3.859885559498519*^9}, {3.859885591138982*^9, 
   3.8598855939173737`*^9}, {3.859885648020773*^9, 3.859885658144165*^9}, {
   3.8598858175832167`*^9, 3.859885855433182*^9}, {3.859886016369603*^9, 
   3.859886016484169*^9}, {3.859886069876629*^9, 3.85988609785605*^9}, {
   3.859886196437707*^9, 3.85988624482609*^9}, {3.859886393867383*^9, 
   3.859886403718696*^9}, {3.859887253296261*^9, 3.8598872536090107`*^9}},
  ExpressionUUID->"3491a148-30d0-4b52-a89c-404423ac9e2a"],
 " is fixed in this case."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
   3.859547300907641*^9}, {3.859559164128237*^9, 3.859559167825494*^9}, {
   3.859609320521247*^9, 3.859609370990651*^9}, {3.859609481962452*^9, 
   3.8596094958618298`*^9}, 3.859610531394795*^9, {3.8598875332943*^9, 
   3.8598875409369173`*^9}, {3.8598875829068537`*^9, 
   3.859887622098201*^9}},ExpressionUUID->"eb65eb2f-2e33-46e7-9d68-\
714185c37d19"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanreplace", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"noises", ",", "condmeans"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covestimate", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"aerror", "-", "abias"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"cerror", "-", "cbias"}], ")"}]}], "//.", "structureEqs"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"covestimate", "=", 
  RowBox[{
   RowBox[{"covestimate", "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covestimateInside", " ", "=", 
   RowBox[{
    RowBox[{"covestimate", "/", 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"X", ".", "uM"}], 
       RowBox[{"X", ".", "X"}]], ")"}]}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8595579821985483`*^9, 3.859558061814584*^9}, {
  3.859558655476707*^9, 3.859558658433288*^9}, {3.8595590766617002`*^9, 
  3.859559108103771*^9}, {3.859608839331168*^9, 3.859608846824729*^9}, {
  3.859609283803321*^9, 3.859609284583967*^9}, {3.859885155954644*^9, 
  3.859885160400764*^9}, {3.859885326423717*^9, 3.859885333034583*^9}, {
  3.8598855428556213`*^9, 3.859885559498519*^9}, {3.859885591138982*^9, 
  3.8598855939173737`*^9}, {3.859885648020773*^9, 3.859885658144165*^9}, {
  3.8598858175832167`*^9, 3.859885855433182*^9}, {3.859886016369603*^9, 
  3.859886016484169*^9}, {3.859886069876629*^9, 3.85988609785605*^9}, {
  3.859886196437707*^9, 3.85988624482609*^9}, {3.859886393867383*^9, 
  3.859886403718696*^9}, {3.859887253296261*^9, 3.8598872536090107`*^9}, {
  3.85988777169659*^9, 3.8598878032688303`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"ac2fbb6b-8391-4dab-b597-55ead479331a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770130826*^9, 3.8596087932023153`*^9, 
   3.8596089812098837`*^9, 3.859609306694684*^9, 3.8596100273498287`*^9, 
   3.859631367712901*^9, {3.859701193139887*^9, 3.859701207318664*^9}, 
   3.8597012386764717`*^9, 3.859885019980394*^9, {3.859885157507757*^9, 
   3.859885166406562*^9}, {3.85988533355352*^9, 3.859885340593305*^9}, 
   3.859885565261746*^9, 3.859885599184289*^9, 3.859885664141926*^9, {
   3.8598858371037292`*^9, 3.8598858618043127`*^9}, 3.859886104057732*^9, {
   3.8598862073961887`*^9, 3.859886253729114*^9}, {3.8598863990245237`*^9, 
   3.859886414960573*^9}, 3.859887265824211*^9, 3.859887761979117*^9, 
   3.859887794210518*^9, 3.8598878282146387`*^9, 3.859967767311408*^9, 
   3.8599809895390368`*^9, 3.8599810207921743`*^9, 3.860036130188519*^9, 
   3.8601506211930513`*^9, 3.860221337961937*^9, 3.860222477585327*^9, 
   3.860222640853244*^9, 3.860223082529603*^9, 3.8612540033643837`*^9, 
   3.861750747485216*^9, 3.8638562842826967`*^9, 3.8641165210061293`*^9, 
   3.864188116787754*^9, 3.864277788814356*^9, 3.864875713488364*^9, 
   3.8679056524563217`*^9, 3.86790583964502*^9, 3.8691144030024557`*^9, 
   3.869114936771082*^9, 3.869226541035204*^9, 3.8692927228044357`*^9, 
   3.8693056076032543`*^9, 3.869309785323489*^9, 3.8695265599929237`*^9, 
   3.8695637362384453`*^9, 3.8696923770947638`*^9, 3.871566455400054*^9, 
   3.8722468059318733`*^9},
 CellLabel->
  "Out[150]=",ExpressionUUID->"b91c3f05-1b3d-4bbf-b70c-89b6f7b0b695"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"X", ".", "uM"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], " ", 
        RowBox[{"M", ".", "uX"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "uY"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"M", ".", "X"}]}]}], 
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}]], "-", 
     FractionBox[
      RowBox[{"b", " ", "c", " ", "d", " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ")"}]}], 
  RowBox[{"X", ".", "X"}]]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770130826*^9, 3.8596087932023153`*^9, 
   3.8596089812098837`*^9, 3.859609306694684*^9, 3.8596100273498287`*^9, 
   3.859631367712901*^9, {3.859701193139887*^9, 3.859701207318664*^9}, 
   3.8597012386764717`*^9, 3.859885019980394*^9, {3.859885157507757*^9, 
   3.859885166406562*^9}, {3.85988533355352*^9, 3.859885340593305*^9}, 
   3.859885565261746*^9, 3.859885599184289*^9, 3.859885664141926*^9, {
   3.8598858371037292`*^9, 3.8598858618043127`*^9}, 3.859886104057732*^9, {
   3.8598862073961887`*^9, 3.859886253729114*^9}, {3.8598863990245237`*^9, 
   3.859886414960573*^9}, 3.859887265824211*^9, 3.859887761979117*^9, 
   3.859887794210518*^9, 3.8598878282146387`*^9, 3.859967767311408*^9, 
   3.8599809895390368`*^9, 3.8599810207921743`*^9, 3.860036130188519*^9, 
   3.8601506211930513`*^9, 3.860221337961937*^9, 3.860222477585327*^9, 
   3.860222640853244*^9, 3.860223082529603*^9, 3.8612540033643837`*^9, 
   3.861750747485216*^9, 3.8638562842826967`*^9, 3.8641165210061293`*^9, 
   3.864188116787754*^9, 3.864277788814356*^9, 3.864875713488364*^9, 
   3.8679056524563217`*^9, 3.86790583964502*^9, 3.8691144030024557`*^9, 
   3.869114936771082*^9, 3.869226541035204*^9, 3.8692927228044357`*^9, 
   3.8693056076032543`*^9, 3.869309785323489*^9, 3.8695265599929237`*^9, 
   3.8695637362384453`*^9, 3.8696923770947638`*^9, 3.871566455400054*^9, 
   3.872246805961131*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"ab9f4f94-941e-4a66-b31e-e93902168d3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"covinside", " ", "=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", 
      RowBox[{"M", ".", "uX"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "uY"}]}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"M", ".", "X"}]}]}], 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "M"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covinsidesimp", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"covinside", "/.", "condmeanreplace"}], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]",
             "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"covestimatesimp", "=", 
  RowBox[{
   RowBox[{"(", 
    FractionBox[
     RowBox[{"X", ".", "uM"}], 
     RowBox[{"X", ".", "X"}]], ")"}], 
   RowBox[{"(", 
    RowBox[{"covinsidesimp", "-", 
     FractionBox[
      RowBox[{"b", " ", "c", " ", "d", " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
    ")"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.859887373561132*^9, 3.859887381048478*^9}, {
  3.859887674260283*^9, 3.85988771492019*^9}, {3.859887810026907*^9, 
  3.859887811733827*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"c8562925-333c-47e8-ba95-9e696f1fc838"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"X", ".", "uM"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"b", " ", "d", " ", 
       RowBox[{"M", ".", "X"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]], "-", 
     FractionBox[
      RowBox[{"b", " ", "c", " ", "d", " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ")"}]}], 
  RowBox[{"X", ".", "X"}]]], "Output",
 CellChangeTimes->{3.8598872659204884`*^9, 3.859887385227512*^9, 
  3.859887716113875*^9, 3.859887762050725*^9, 3.8598877942810297`*^9, 
  3.8598878282855864`*^9, 3.859967767372306*^9, 3.859980989597237*^9, 
  3.859981023487753*^9, 3.860036130277712*^9, 3.860150621238887*^9, 
  3.8602213380073853`*^9, 3.860222477634926*^9, 3.860222640902567*^9, 
  3.8602230825874434`*^9, 3.861254003508857*^9, 3.861750747532805*^9, 
  3.863856284329344*^9, 3.864116521155754*^9, 3.864188116840197*^9, 
  3.864277788859373*^9, 3.8648757135342913`*^9, 3.867905652748352*^9, 
  3.867905839798462*^9, 3.869114403049574*^9, 3.869114936822515*^9, 
  3.8692265411131268`*^9, 3.86929272286966*^9, 3.869305607665778*^9, 
  3.869309785388588*^9, 3.869526560038549*^9, 3.869563736349931*^9, 
  3.869692377152179*^9, 3.87156645568976*^9, 3.872246806025194*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"7539e1bf-1455-40df-845c-291f3d127db8"]
}, Open  ]],

Cell[TextData[{
 "This is quite an interesting expression. If we only desired the expectation \
value of the term inside the large braces, we could smooth with conditional \
variable M and arrive at 0, which is checked below, and expected anyway since \
we have used the correct bias for estimator a. However, now the outside term \
comes into play. Since uM is composed of an X part and an M part, and the \
expectation of the bracketed expression is 0, we can disregard the X part. \n\
\nThe two types of expectation values to consider are : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "M"}], ")"}], "2"], 
     RowBox[{
      SuperscriptBox["X", "2"], 
      SuperscriptBox["M", "2"]}]], "]"}], TraditionalForm]],ExpressionUUID->
  "03fd1dee-6cce-4c98-8fbc-6eabee851c17"],
 ", which is hard, and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    FractionBox[
     RowBox[{"X", ".", "M"}], 
     SuperscriptBox["M", "2"]], "]"}], TraditionalForm]],ExpressionUUID->
  "346e6a97-229f-4b91-93c3-402922071b2c"],
 ", which is easy. If X and M are taken to be independent, the former reduces \
to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    RowBox[{
     SuperscriptBox["cos", "2"], "\[Theta]"}], "]"}], TraditionalForm]],
  ExpressionUUID->"281d3688-9d9d-4a79-b061-29d53c77deae"],
 " where \[Theta] is the angle between X and M."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
   3.859547300907641*^9}, {3.859559164128237*^9, 3.859559167825494*^9}, {
   3.859609320521247*^9, 3.859609370990651*^9}, {3.859609481962452*^9, 
   3.8596094958618298`*^9}, 3.859610531394795*^9, {3.8598875332943*^9, 
   3.8598875409369173`*^9}, {3.8598875829068537`*^9, 3.859887622098201*^9}, {
   3.859887832663463*^9, 3.859887914050651*^9}, {3.859888689958066*^9, 
   3.859888813629125*^9}, {3.859967351061068*^9, 3.859967371929195*^9}, {
   3.859967775489496*^9, 
   3.8599678075757008`*^9}},ExpressionUUID->"c1693a58-63c8-40f6-8369-\
d2a957c3ee63"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"norms", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sin", "[", "x", "]"}], "n"], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Sin", "[", "x", "]"}], "n"], "*", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "x", "]"}], "2"]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "20"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"normvals", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "/", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"vals", ",", "norms"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"normvals", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.859609393560586*^9, 3.859609547515603*^9}, {
  3.8596104786321163`*^9, 3.859610478722381*^9}, {3.859701088105875*^9, 
  3.85970112628469*^9}, {3.8597012240626097`*^9, 3.859701224144661*^9}, {
  3.859967375356327*^9, 3.8599674376486998`*^9}, {3.859967484754448*^9, 
  3.8599676866479187`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"c824d810-9878-42ae-8689-3b5b5fcd1057"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", 
   FractionBox["1", "3"], ",", 
   FractionBox["1", "4"], ",", 
   FractionBox["1", "5"], ",", 
   FractionBox["1", "6"], ",", 
   FractionBox["1", "7"], ",", 
   FractionBox["1", "8"], ",", 
   FractionBox["1", "9"], ",", 
   FractionBox["1", "10"], ",", 
   FractionBox["1", "11"], ",", 
   FractionBox["1", "12"], ",", 
   FractionBox["1", "13"], ",", 
   FractionBox["1", "14"], ",", 
   FractionBox["1", "15"], ",", 
   FractionBox["1", "16"], ",", 
   FractionBox["1", "17"], ",", 
   FractionBox["1", "18"], ",", 
   FractionBox["1", "19"], ",", 
   FractionBox["1", "20"], ",", 
   FractionBox["1", "21"], ",", 
   FractionBox["1", "22"]}], "}"}]], "Output",
 CellChangeTimes->{{3.8596094049637413`*^9, 3.85960941004678*^9}, {
   3.859609441452512*^9, 3.859609535809498*^9}, 3.859610027368894*^9, 
   3.8596104790892344`*^9, 3.859631367737589*^9, {3.859701104935185*^9, 
   3.8597011266362543`*^9}, {3.8597012073841667`*^9, 3.859701238783092*^9}, 
   3.859885020002904*^9, 3.859885166431697*^9, 3.859885340656592*^9, 
   3.859885565322218*^9, 3.8598855992436123`*^9, 3.859885664237824*^9, 
   3.859885861900592*^9, 3.859886104242559*^9, {3.859886207536605*^9, 
   3.859886253836424*^9}, 3.8598864150849457`*^9, 3.859887265967031*^9, 
   3.859887762085162*^9, 3.859887794314355*^9, 3.859887828311861*^9, {
   3.85996741714082*^9, 3.859967438085639*^9}, {3.859967488511558*^9, 
   3.859967687778016*^9}, 3.8599677744355497`*^9, 3.8599809962696238`*^9, 
   3.8600361394610777`*^9, 3.8601506275293493`*^9, 3.860221344146954*^9, 
   3.860222483862488*^9, 3.8602226470217133`*^9, 3.8602230889786797`*^9, 
   3.861254016985045*^9, 3.86175075381289*^9, 3.863856290464888*^9, 
   3.8641165313093443`*^9, 3.864188123646393*^9, 3.864277795014781*^9, 
   3.864875719753543*^9, 3.8679056645144463`*^9, 3.867905851792288*^9, 
   3.869114409127653*^9, 3.869114940557974*^9, 3.869226549509674*^9, 
   3.869292726517145*^9, 3.869305611422853*^9, 3.86930978915674*^9, 
   3.869526566147534*^9, 3.869563742934762*^9, 3.869692383588901*^9, 
   3.8715664699238*^9, 3.872246812274905*^9},
 CellLabel->
  "Out[161]=",ExpressionUUID->"45e053d1-243a-4817-b88a-15f92e39c209"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQDQEf7CH0AyjN4BAKBlehfA4HCH0ByhdwmDUTBE5C
+SJQ9UehfAmHSSqeQHQIypeB6j8A5Ss4yBwvBKI9UL4S1LydUL6Kg5t4bMlF
1+1QvhrU/K1QvoaDiPVGYeuNm6F8Lah9m6B8HQdBMNgI5etB7d8A5Rs4yIHB
OijfEOqeNVC+kYPG+oV72j6tgvKNoe5bCeWbOEi0JQLRCijfFOre5fYAvJBG
cg==
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.5833333333333348, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0.5833333333333348, 21}, {0, 0.5}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8596094049637413`*^9, 3.85960941004678*^9}, {
   3.859609441452512*^9, 3.859609535809498*^9}, 3.859610027368894*^9, 
   3.8596104790892344`*^9, 3.859631367737589*^9, {3.859701104935185*^9, 
   3.8597011266362543`*^9}, {3.8597012073841667`*^9, 3.859701238783092*^9}, 
   3.859885020002904*^9, 3.859885166431697*^9, 3.859885340656592*^9, 
   3.859885565322218*^9, 3.8598855992436123`*^9, 3.859885664237824*^9, 
   3.859885861900592*^9, 3.859886104242559*^9, {3.859886207536605*^9, 
   3.859886253836424*^9}, 3.8598864150849457`*^9, 3.859887265967031*^9, 
   3.859887762085162*^9, 3.859887794314355*^9, 3.859887828311861*^9, {
   3.85996741714082*^9, 3.859967438085639*^9}, {3.859967488511558*^9, 
   3.859967687778016*^9}, 3.8599677744355497`*^9, 3.8599809962696238`*^9, 
   3.8600361394610777`*^9, 3.8601506275293493`*^9, 3.860221344146954*^9, 
   3.860222483862488*^9, 3.8602226470217133`*^9, 3.8602230889786797`*^9, 
   3.861254016985045*^9, 3.86175075381289*^9, 3.863856290464888*^9, 
   3.8641165313093443`*^9, 3.864188123646393*^9, 3.864277795014781*^9, 
   3.864875719753543*^9, 3.8679056645144463`*^9, 3.867905851792288*^9, 
   3.869114409127653*^9, 3.869114940557974*^9, 3.869226549509674*^9, 
   3.869292726517145*^9, 3.869305611422853*^9, 3.86930978915674*^9, 
   3.869526566147534*^9, 3.869563742934762*^9, 3.869692383588901*^9, 
   3.8715664699238*^9, 3.872246812310979*^9},
 CellLabel->
  "Out[162]=",ExpressionUUID->"5a85a6f2-9dd0-4d02-8700-45c4643f7dcf"]
}, Open  ]],

Cell[TextData[{
 "If we impose the true causal dependence M = cX + uM, the expectation value \
can be reduced geometrically to the following integral, where X is the \
magnitude of sample vector X (rotated by symmetry to the ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["z", "^"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b3e915fd-962c-424d-9dfe-a95fdd89b9f4"],
 " direction), Z is the z-component of sample vector uM, and R is the radial \
component of uM in cylindrical coordinates about z. A constant factor on the \
front will depend on the dimensionality n of the sample vectors, but by \
symmetry the integral itself is three-dimensional:"
}], "Text",
 CellChangeTimes->{{3.860151416017765*^9, 
  3.8601515706745567`*^9}},ExpressionUUID->"60d483d1-5674-45f4-b23e-\
a68e6544190e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cos2integrand", "[", 
    RowBox[{"Cx_", ",", "X_", ",", "R_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"R", "*", 
     SuperscriptBox["X", "2"], 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cx", "*", "X"}], "+", "Z"}], ")"}], "2"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cx", "*", "X"}], "+", "Z"}], ")"}], "2"], "+", 
       SuperscriptBox["R", "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox["X", "2"], 
         RowBox[{"2", 
          SuperscriptBox[
           SubscriptBox["\[Sigma]", "X"], "2"]}]]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["R", "2"], "+", 
         SuperscriptBox["Z", "2"]}], 
        RowBox[{"2", 
         SuperscriptBox[
          SubscriptBox["\[Sigma]", "uM"], "2"]}]]}], "]"}]}], "/.", 
    "stringifySubs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"cos2int", "=", 
  RowBox[{"Defer", "[", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"R", "*", 
      SuperscriptBox["X", "2"], 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cx", "*", "X"}], "+", "Z"}], ")"}], "2"], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cx", "*", "X"}], "+", "Z"}], ")"}], "2"], "+", 
        SuperscriptBox["R", "2"]}]], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["X", "2"], 
          RowBox[{"2", 
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "X"], "2"]}]]}], "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["R", "2"], "+", 
          SuperscriptBox["Z", "2"]}], 
         RowBox[{"2", 
          SuperscriptBox[
           SubscriptBox["\[Sigma]", "uM"], "2"]}]]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"R", ",", "0", ",", "\[Infinity]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Z", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.860151634245089*^9, 3.86015175013083*^9}, {
   3.860151864119014*^9, 3.860151880317363*^9}, {3.86015218785258*^9, 
   3.860152222930141*^9}, {3.860152268810296*^9, 3.860152272864604*^9}, {
   3.860152490861301*^9, 3.860152539564612*^9}, {3.8602222744549427`*^9, 
   3.860222275866125*^9}, {3.860222341199497*^9, 3.860222351900119*^9}, 
   3.860222388299273*^9, {3.8602224205867357`*^9, 3.860222432581208*^9}, {
   3.860222535311289*^9, 3.860222577200676*^9}, {3.860223101096146*^9, 
   3.8602231114233*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"8df836b0-eac2-41d8-946c-b2838cad7f8c"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
    RowBox[{
     FractionBox[
      RowBox[{"R", " ", 
       SuperscriptBox["X", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cx", " ", "X"}], "+", "Z"}], ")"}], "2"], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["X", "2"], 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[Sigma]", "X", "2"]}]]}], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["R", "2"], "+", 
           SuperscriptBox["Z", "2"]}], 
          RowBox[{"2", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}]]}], "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cx", " ", "X"}], "+", "Z"}], ")"}], "2"], "+", 
       SuperscriptBox["R", "2"]}]], 
     RowBox[{"\[DifferentialD]", "Z"}], 
     RowBox[{"\[DifferentialD]", "R"}], 
     RowBox[{"\[DifferentialD]", "X"}]}]}]}]}]], "Output",
 CellChangeTimes->{{3.860151643061801*^9, 3.860151644916119*^9}, {
   3.860151862436616*^9, 3.860151880628357*^9}, 3.860152215618186*^9, 
   3.860152273174025*^9, {3.860152509008071*^9, 3.860152540316441*^9}, 
   3.860221344363529*^9, 3.8602222762978287`*^9, 3.8602223640497427`*^9, 
   3.8602224334106283`*^9, {3.8602224840410233`*^9, 3.860222567871908*^9}, 
   3.860222647251419*^9, 3.860223089028997*^9, 3.861254017563981*^9, 
   3.8617507540486183`*^9, 3.8638562906880083`*^9, 3.8641165313912497`*^9, 
   3.864188123836111*^9, 3.8642777952252283`*^9, 3.864875719976125*^9, 
   3.8679056649942408`*^9, 3.867905852048307*^9, 3.8691144093240643`*^9, 
   3.8691149406254873`*^9, 3.869226549806789*^9, 3.8692927265984898`*^9, 
   3.8693056114770813`*^9, 3.86930978921376*^9, 3.869526566360231*^9, 
   3.869563743053536*^9, 3.869692383809621*^9, 3.871566470356773*^9, 
   3.872246812371759*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"24f58454-3f88-4e43-bfea-33d3bcd9bde8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cos2integrand", "/.", "stringifySubs"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"X", "->", 
      RowBox[{"X", "*", 
       SubscriptBox["\[Sigma]", "\"\<X\>\""]}]}], ",", 
     RowBox[{"R", "->", 
      RowBox[{"R", "*", 
       SubscriptBox["\[Sigma]", "\"\<uM\>\""]}]}], ",", 
     RowBox[{"Z", "->", 
      RowBox[{"Z", "*", 
       SubscriptBox["\[Sigma]", "\"\<uM\>\""]}]}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.860222278498826*^9, 3.860222326684725*^9}, {
  3.86022236717332*^9, 3.860222375202241*^9}, {3.860222439672241*^9, 
  3.8602224441478243`*^9}, {3.860222487025661*^9, 3.860222488503251*^9}, {
  3.860222668274688*^9, 3.860222704805479*^9}, {3.860222765965929*^9, 
  3.8602227842470617`*^9}, {3.860222814583721*^9, 3.8602228647508793`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"6adf52a4-fc6e-4172-9daf-55df1b513fb2"],

Cell[BoxData["cos2integrand"], "Output",
 CellChangeTimes->{{3.860222287903578*^9, 3.8602222953205633`*^9}, {
   3.860222329591982*^9, 3.860222330445753*^9}, {3.8602223679909782`*^9, 
   3.860222375536515*^9}, {3.8602224367079573`*^9, 3.860222444437873*^9}, {
   3.860222484061421*^9, 3.860222539078082*^9}, 3.860222647272603*^9, {
   3.860222678399761*^9, 3.86022270513315*^9}, 3.8602227847339907`*^9, {
   3.8602228156754932`*^9, 3.860222865152401*^9}, 3.860223089048915*^9, 
   3.861254017603552*^9, 3.861750754060535*^9, 3.863856290698029*^9, 
   3.864116531412795*^9, 3.864188123849813*^9, 3.864277795238432*^9, 
   3.864875719987609*^9, 3.867905665024707*^9, 3.86790585208998*^9, 
   3.869114409333033*^9, 3.869114940635014*^9, 3.8692265498224792`*^9, 
   3.869292726612596*^9, 3.869305611490407*^9, 3.8693097892289248`*^9, 
   3.8695265663715563`*^9, 3.869563743080235*^9, 3.869692383823851*^9, 
   3.8715664703866796`*^9, 3.872246812382896*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"de327b63-56d6-41e2-8eb9-deefac4057c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fixConsts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sigma]", "X"], "\[Rule]", "1"}], ",", 
     RowBox[{
      SubscriptBox["\[Sigma]", "uM"], "\[Rule]", "2"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"top", "=", "Infinity"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CxMax", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CxStep", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normXM", "=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SuperscriptBox["R", "4"], "*", 
       SuperscriptBox["X", "5"], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           SuperscriptBox["X", "2"], 
           RowBox[{"2", 
            SuperscriptBox[
             SubscriptBox["\[Sigma]", "X"], "2"]}]]}], "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["R", "2"], "+", 
           SuperscriptBox["Z", "2"]}], 
          RowBox[{"2", 
           SuperscriptBox[
            SubscriptBox["\[Sigma]", "uM"], "2"]}]]}], "]"}]}], "/.", 
      "fixConsts"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", "0", ",", "top"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"R", ",", "0", ",", "top"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Z", ",", "0", ",", "top"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expcos2XM", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["R", "4"], 
         SuperscriptBox["X", "5"], 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cx", "*", "X"}], "+", "Z"}], ")"}], "2"], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cx", "*", "X"}], "+", "Z"}], ")"}], "2"], "+", 
           SuperscriptBox["R", "2"]}]], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["X", "2"], 
             RowBox[{"2", 
              SuperscriptBox[
               SubscriptBox["\[Sigma]", "X"], "2"]}]]}], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["R", "2"], "+", 
             SuperscriptBox["Z", "2"]}], 
            RowBox[{"2", 
             SuperscriptBox[
              SubscriptBox["\[Sigma]", "uM"], "2"]}]]}], "]"}]}], "/.", 
        "fixConsts"}], ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "0", ",", "top"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"R", ",", "0", ",", "top"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Z", ",", "0", ",", "top"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"Cx", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "*", "CxMax"}], ",", "CxMax", ",", "CxStep"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normExpCos2XM", "=", 
   RowBox[{"expcos2XM", "/", "normXM"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8602217078614473`*^9, 3.860221774384465*^9}, {
   3.860221821305085*^9, 3.8602219458327723`*^9}, {3.860222393751556*^9, 
   3.860222406729753*^9}, {3.860222587550972*^9, 3.8602226248331947`*^9}, {
   3.860223007848057*^9, 3.860223058063241*^9}, {3.8602231168081827`*^9, 
   3.860223203618834*^9}, {3.860223242656575*^9, 3.860223381962133*^9}, {
   3.86022342643445*^9, 3.860223426515952*^9}, 3.8602236097368183`*^9, {
   3.860224972113038*^9, 3.860224974235742*^9}, {3.860225136885786*^9, 
   3.8602251461685867`*^9}, {3.860225184781712*^9, 3.860225224150679*^9}, {
   3.860225294413946*^9, 3.8602252977550592`*^9}, {3.860225421188705*^9, 
   3.860225421565235*^9}, {3.8602255589292393`*^9, 3.8602255610270567`*^9}, {
   3.860225629088645*^9, 3.8602256392040653`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"176a2ba7-1367-4f51-89d1-546609772e0f"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", 2, 171, 3, 21942966268712677875,
    "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.860222647707184*^9, {3.860223039650338*^9, 3.8602230590154753`*^9}, 
   3.8602230892833776`*^9, {3.8602231228276253`*^9, 3.860223187980413*^9}, 
   3.860223288172566*^9, 3.860223377814789*^9, 3.8602234295129957`*^9, 
   3.8602236126455917`*^9, 3.860224975213909*^9, 3.86022530338426*^9, 
   3.860225426257908*^9, 3.860225563043779*^9, 3.860225640316921*^9, 
   3.86125402005656*^9, 3.861750754980789*^9, 3.863856291553447*^9, 
   3.864116532841762*^9, 3.864188124782482*^9, 3.864277796079603*^9, 
   3.8648757208293858`*^9, 3.8679056668304377`*^9, 3.867905854686634*^9, 
   3.8691144101628942`*^9, 3.869114941404252*^9, 3.869226551082602*^9, 
   3.8692927273820667`*^9, 3.869305612271555*^9, 3.869309789995541*^9, 
   3.86952656721227*^9, 3.869563744355361*^9, 3.8696923846579113`*^9, 
   3.8715664732853317`*^9, 3.872246813202935*^9},
 CellLabel->
  "During evaluation of \
In[166]:=",ExpressionUUID->"adb552c9-c039-48b6-b5b0-c6c238b8fe11"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", 2, 171, 4, 21942966268712677875,
    "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.860222647707184*^9, {3.860223039650338*^9, 3.8602230590154753`*^9}, 
   3.8602230892833776`*^9, {3.8602231228276253`*^9, 3.860223187980413*^9}, 
   3.860223288172566*^9, 3.860223377814789*^9, 3.8602234295129957`*^9, 
   3.8602236126455917`*^9, 3.860224975213909*^9, 3.86022530338426*^9, 
   3.860225426257908*^9, 3.860225563043779*^9, 3.860225640316921*^9, 
   3.86125402005656*^9, 3.861750754980789*^9, 3.863856291553447*^9, 
   3.864116532841762*^9, 3.864188124782482*^9, 3.864277796079603*^9, 
   3.8648757208293858`*^9, 3.8679056668304377`*^9, 3.867905854686634*^9, 
   3.8691144101628942`*^9, 3.869114941404252*^9, 3.869226551082602*^9, 
   3.8692927273820667`*^9, 3.869305612271555*^9, 3.869309789995541*^9, 
   3.86952656721227*^9, 3.869563744355361*^9, 3.8696923846579113`*^9, 
   3.8715664732853317`*^9, 3.872246813504793*^9},
 CellLabel->
  "During evaluation of \
In[166]:=",ExpressionUUID->"29cc546f-4aaf-4d24-a335-e710df3ebf32"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", 2, 171, 5, 21942966268712677875,
    "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.860222647707184*^9, {3.860223039650338*^9, 3.8602230590154753`*^9}, 
   3.8602230892833776`*^9, {3.8602231228276253`*^9, 3.860223187980413*^9}, 
   3.860223288172566*^9, 3.860223377814789*^9, 3.8602234295129957`*^9, 
   3.8602236126455917`*^9, 3.860224975213909*^9, 3.86022530338426*^9, 
   3.860225426257908*^9, 3.860225563043779*^9, 3.860225640316921*^9, 
   3.86125402005656*^9, 3.861750754980789*^9, 3.863856291553447*^9, 
   3.864116532841762*^9, 3.864188124782482*^9, 3.864277796079603*^9, 
   3.8648757208293858`*^9, 3.8679056668304377`*^9, 3.867905854686634*^9, 
   3.8691144101628942`*^9, 3.869114941404252*^9, 3.869226551082602*^9, 
   3.8692927273820667`*^9, 3.869305612271555*^9, 3.869309789995541*^9, 
   3.86952656721227*^9, 3.869563744355361*^9, 3.8696923846579113`*^9, 
   3.8715664732853317`*^9, 3.872246813889678*^9},
 CellLabel->
  "During evaluation of \
In[166]:=",ExpressionUUID->"d5aef531-68dd-4b38-aa39-02e26dc18fc4"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"slwcon\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 171, 6, 21942966268712677875, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.860222647707184*^9, {3.860223039650338*^9, 3.8602230590154753`*^9}, 
   3.8602230892833776`*^9, {3.8602231228276253`*^9, 3.860223187980413*^9}, 
   3.860223288172566*^9, 3.860223377814789*^9, 3.8602234295129957`*^9, 
   3.8602236126455917`*^9, 3.860224975213909*^9, 3.86022530338426*^9, 
   3.860225426257908*^9, 3.860225563043779*^9, 3.860225640316921*^9, 
   3.86125402005656*^9, 3.861750754980789*^9, 3.863856291553447*^9, 
   3.864116532841762*^9, 3.864188124782482*^9, 3.864277796079603*^9, 
   3.8648757208293858`*^9, 3.8679056668304377`*^9, 3.867905854686634*^9, 
   3.8691144101628942`*^9, 3.869114941404252*^9, 3.869226551082602*^9, 
   3.8692927273820667`*^9, 3.869305612271555*^9, 3.869309789995541*^9, 
   3.86952656721227*^9, 3.869563744355361*^9, 3.8696923846579113`*^9, 
   3.8715664732853317`*^9, 3.8722468138943367`*^9},
 CellLabel->
  "During evaluation of \
In[166]:=",ExpressionUUID->"c7ed41ce-042c-4d5a-acb8-f5adcf6a360e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "*", "CxMax"}], ",", "CxMax", ",", "CxStep"}], 
       "]"}], ",", "normExpCos2XM"}], "}"}]}], ",", 
   RowBox[{"PlotRange", "->", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8602233134795237`*^9, 3.860223322596504*^9}, 
   3.8602233752616262`*^9, {3.860223566189227*^9, 3.860223569543776*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"027d89fc-bb6f-4916-9973-02da6c4bcdf3"],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQEqB5SlFvNlOb2zh/CVDzBwJVXzCsP4SgfezFgs
wXXnLZSveGDqzCMXtsyG8RUOLBT7Mv+tP4wvd+AJt9XNH1/fQPkyB26lXsvy
6oLxpQ78Ca9JteWA8SUOfHE7VL0+8zWUL3YgJL26qmLZKyhf5MCfG7f1N29+
CeULHdi/LdXoWtMLKF/gwNRg1S1bGZ5D+TwHTsZsj7gp8hTK5ziQccBwfd2i
R1A+ywH/tTdUDsjeh/IZDqj36S5bteo6lP9j/8OpP3/sfXIOyv+wP+U3qzdj
wwEo/8H+6B/WBkV522D6Gba284SEhh6FydtrV0jvflRzBabffus0oylKR+/C
zLc/+oAjUK8d5h4Gh1UGRWujnWHuZXFQWxmxJsMf5h8Oh0imBbHHbsP8y+Og
EWx/jp0HFj4CDjvO8rI4/ITxhRzUdBJDmLbCwlPEITfRWHKHNyy8xRyMYk5u
cDwGD3+H3Ye3Wwpow+JPyqHirX3MwzoYX8Zh1anqs/ZH4fHrwC5bse8mAyx9
KDhYfsoP22sM4ys65G1YtqEpHp5+HG5PnfkwsxWevhw8bCa3FyyD8VUcpFz4
ahIPv7MHALsPw38=
     "]]}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{-10., 10.}, {0, 0.9613501952136432}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.860223314349202*^9, 3.860223322910068*^9}, 
   3.8602234111811447`*^9, {3.860223553198195*^9, 3.860223569919715*^9}, 
   3.860223908674384*^9, 3.860225029701766*^9, 3.8602253898973494`*^9, 
   3.860225511270608*^9, 3.860225591333168*^9, 3.860225665332028*^9, 
   3.861750775532568*^9, 3.863856310936063*^9, 3.864875739823526*^9, 
   3.867905710845903*^9, 3.869114429065263*^9, 3.869114960826462*^9, 
   3.8692265804161367`*^9, 3.869292747062687*^9, 3.869305631575889*^9, 
   3.8693098090363817`*^9, 3.869526586155677*^9, 3.869563772569807*^9, 
   3.8696924035447903`*^9, 3.871566522478573*^9, 3.87224683202325*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"5bb7f2fe-6595-43fc-b886-d2fd860d5da1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", "+", "Z"}], ")"}], "2"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", "+", "Z"}], ")"}], "2"], "+", 
      SuperscriptBox["R", "2"]}]], ",", 
    RowBox[{"{", 
     RowBox[{"Z", ",", "0", ",", "10"}], "}"}]}], "]"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["Z", "n"], 
    RowBox[{"Exp", "[", 
     FractionBox[
      SuperscriptBox["Z", "2"], 
      RowBox[{"-", "2"}]], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"Z", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.86022200167343*^9, 3.860222138235403*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"ef47b9d6-1d18-4aeb-a08c-792ce8fe9b36"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    SuperscriptBox["X", "2"], 
    RowBox[{
     SuperscriptBox["R", "2"], "+", 
     SuperscriptBox["X", "2"]}]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["R", "2"], " ", "X", " ", "Z"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "2"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "4"], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "2"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "3"]], "+", 
   FractionBox[
    RowBox[{"4", " ", 
     SuperscriptBox["R", "2"], " ", "X", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["R", "2"]}], "+", 
       SuperscriptBox["X", "2"]}], ")"}], " ", 
     SuperscriptBox["Z", "3"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "4"]], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["R", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "4"], "-", 
       RowBox[{"10", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "2"]}], "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["X", "4"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "4"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "5"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6", " ", 
        SuperscriptBox["R", "6"], " ", "X"}], "-", 
       RowBox[{"20", " ", 
        SuperscriptBox["R", "4"], " ", 
        SuperscriptBox["X", "3"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "5"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "5"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "6"]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "8"], "-", 
       RowBox[{"21", " ", 
        SuperscriptBox["R", "6"], " ", 
        SuperscriptBox["X", "2"]}], "+", 
       RowBox[{"35", " ", 
        SuperscriptBox["R", "4"], " ", 
        SuperscriptBox["X", "4"]}], "-", 
       RowBox[{"7", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "6"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "6"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "7"]], "+", 
   FractionBox[
    RowBox[{"8", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["R", "8"]}], " ", "X"}], "+", 
       RowBox[{"7", " ", 
        SuperscriptBox["R", "6"], " ", 
        SuperscriptBox["X", "3"]}], "-", 
       RowBox[{"7", " ", 
        SuperscriptBox["R", "4"], " ", 
        SuperscriptBox["X", "5"]}], "+", 
       RowBox[{
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "7"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "7"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "8"]], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["R", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "8"], "-", 
       RowBox[{"36", " ", 
        SuperscriptBox["R", "6"], " ", 
        SuperscriptBox["X", "2"]}], "+", 
       RowBox[{"126", " ", 
        SuperscriptBox["R", "4"], " ", 
        SuperscriptBox["X", "4"]}], "-", 
       RowBox[{"84", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "6"]}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["X", "8"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "8"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "9"]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["R", "2"], " ", "X", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"5", " ", 
        SuperscriptBox["R", "8"]}], "-", 
       RowBox[{"60", " ", 
        SuperscriptBox["R", "6"], " ", 
        SuperscriptBox["X", "2"]}], "+", 
       RowBox[{"126", " ", 
        SuperscriptBox["R", "4"], " ", 
        SuperscriptBox["X", "4"]}], "-", 
       RowBox[{"60", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "6"]}], "+", 
       RowBox[{"5", " ", 
        SuperscriptBox["X", "8"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "9"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "10"]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["R", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "10"], "-", 
       RowBox[{"55", " ", 
        SuperscriptBox["R", "8"], " ", 
        SuperscriptBox["X", "2"]}], "+", 
       RowBox[{"330", " ", 
        SuperscriptBox["R", "6"], " ", 
        SuperscriptBox["X", "4"]}], "-", 
       RowBox[{"462", " ", 
        SuperscriptBox["R", "4"], " ", 
        SuperscriptBox["X", "6"]}], "+", 
       RowBox[{"165", " ", 
        SuperscriptBox["R", "2"], " ", 
        SuperscriptBox["X", "8"]}], "-", 
       RowBox[{"11", " ", 
        SuperscriptBox["X", "10"]}]}], ")"}], " ", 
     SuperscriptBox["Z", "10"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["R", "2"], "+", 
       SuperscriptBox["X", "2"]}], ")"}], "11"]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "Z", "]"}], "11"],
    SeriesData[$CellContext`Z, 0, {}, 0, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`Z, 
   0, {$CellContext`X^2/($CellContext`R^2 + $CellContext`X^2), 
    2 $CellContext`R^2 $CellContext`X ($CellContext`R^2 + \
$CellContext`X^2)^(-2), ($CellContext`R^2 + $CellContext`X^2)^(-3) \
($CellContext`R^4 - 3 $CellContext`R^2 $CellContext`X^2), 
    4 $CellContext`R^2 $CellContext`X (-$CellContext`R^2 + $CellContext`X^2) \
($CellContext`R^2 + $CellContext`X^2)^(-4), -$CellContext`R^2 \
($CellContext`R^2 + $CellContext`X^2)^(-5) ($CellContext`R^4 - 
     10 $CellContext`R^2 $CellContext`X^2 + 
     5 $CellContext`X^4), ($CellContext`R^2 + $CellContext`X^2)^(-6) (
     6 $CellContext`R^6 $CellContext`X - 20 $CellContext`R^4 $CellContext`X^3 + 
     6 $CellContext`R^2 $CellContext`X^5), ($CellContext`R^2 + \
$CellContext`X^2)^(-7) ($CellContext`R^8 - 
     21 $CellContext`R^6 $CellContext`X^2 + 
     35 $CellContext`R^4 $CellContext`X^4 - 
     7 $CellContext`R^2 $CellContext`X^6), 
    8 ($CellContext`R^2 + $CellContext`X^2)^(-8) (-$CellContext`R^8 \
$CellContext`X + 7 $CellContext`R^6 $CellContext`X^3 - 
     7 $CellContext`R^4 $CellContext`X^5 + $CellContext`R^2 \
$CellContext`X^7), -$CellContext`R^2 ($CellContext`R^2 + \
$CellContext`X^2)^(-9) ($CellContext`R^8 - 
     36 $CellContext`R^6 $CellContext`X^2 + 
     126 $CellContext`R^4 $CellContext`X^4 - 
     84 $CellContext`R^2 $CellContext`X^6 + 9 $CellContext`X^8), 
    2 $CellContext`R^2 $CellContext`X ($CellContext`R^2 + \
$CellContext`X^2)^(-10) (5 $CellContext`R^8 - 
     60 $CellContext`R^6 $CellContext`X^2 + 
     126 $CellContext`R^4 $CellContext`X^4 - 
     60 $CellContext`R^2 $CellContext`X^6 + 
     5 $CellContext`X^8), $CellContext`R^2 ($CellContext`R^2 + \
$CellContext`X^2)^(-11) ($CellContext`R^10 - 
     55 $CellContext`R^8 $CellContext`X^2 + 
     330 $CellContext`R^6 $CellContext`X^4 - 
     462 $CellContext`R^4 $CellContext`X^6 + 
     165 $CellContext`R^2 $CellContext`X^8 - 11 $CellContext`X^10)}, 0, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.8602220241536903`*^9, {3.860222058419651*^9, 3.860222138624799*^9}, 
   3.8602224850417356`*^9, 3.860222647812983*^9, 3.8602230893927*^9, 
   3.86175077557192*^9, 3.863856310973713*^9, 3.864875739865991*^9, 
   3.8679057109627733`*^9, 3.869114429108282*^9, 3.8691149608641167`*^9, 
   3.869226580477412*^9, 3.869292747103986*^9, 3.869305631616621*^9, 
   3.869309809078915*^9, 3.869526586192575*^9, 3.8695637726378307`*^9, 
   3.86969240359676*^9, 3.872246832061223*^9},
 CellLabel->
  "Out[174]=",ExpressionUUID->"7313086d-8e7c-4517-8567-b4a335cf3383"],

Cell[BoxData[
 TemplateBox[{
   RowBox[{
     SuperscriptBox["2", 
      RowBox[{
        FractionBox["1", "2"], " ", 
        RowBox[{"(", 
          RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]], " ", 
     RowBox[{"Gamma", "[", 
       FractionBox[
        RowBox[{"1", "+", "n"}], "2"], "]"}]}], 
   RowBox[{
     RowBox[{"Re", "[", "n", "]"}], ">", 
     RowBox[{"-", "1"}]}]},
  "ConditionalExpression"]], "Output",
 CellChangeTimes->{
  3.8602220241536903`*^9, {3.860222058419651*^9, 3.860222138624799*^9}, 
   3.8602224850417356`*^9, 3.860222647812983*^9, 3.8602230893927*^9, 
   3.86175077557192*^9, 3.863856310973713*^9, 3.864875739865991*^9, 
   3.8679057109627733`*^9, 3.869114429108282*^9, 3.8691149608641167`*^9, 
   3.869226580477412*^9, 3.869292747103986*^9, 3.869305631616621*^9, 
   3.869309809078915*^9, 3.869526586192575*^9, 3.8695637726378307`*^9, 
   3.86969240359676*^9, 3.872246833695384*^9},
 CellLabel->
  "Out[175]=",ExpressionUUID->"659782c0-b86a-4408-a2c1-dcd87d02ef2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"R", "*", 
      SuperscriptBox["X", "2"], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox["X", "2"], "2"]}], "-", 
        FractionBox[
         SuperscriptBox["R", "2"], "2"]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Z", ",", "0", ",", "\[Infinity]"}], "}"}]}], "]"}], ",", 
   RowBox[{"Assumptions", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"X", ",", "R"}], "}"}], "\[Element]", "Reals"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8601541609154053`*^9, 3.860154178702694*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"2ea30e5e-191c-42cb-bb89-4e9cad9d19cd"],

Cell[BoxData[
 TemplateBox[{
  "Integrate", "idiv", 
   "\"Integral of \\!\\(\\*RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{RowBox[{\\\"-\\\", FractionBox[SuperscriptBox[\\\"R\\\", \\\"2\\\"], \
\\\"2\\\"]}], \\\"-\\\", FractionBox[SuperscriptBox[\\\"X\\\", \\\"2\\\"], \\\
\"2\\\"]}]], \\\" \\\", \\\"R\\\", \\\" \\\", SuperscriptBox[\\\"X\\\", \\\"2\
\\\"]}]\\) does not converge on \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", \\\"\[Infinity]\\\"}], \\\"}\\\"}]\\).\"", 2, 
   176, 7, 21942966268712677875, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.860154184765921*^9, 3.860222486735992*^9, 
  3.860222649511047*^9, 3.860223091072652*^9, 3.8617507772844887`*^9, 
  3.863856312665443*^9, 3.864875741557671*^9, 3.867905713048327*^9, 
  3.8691144308048677`*^9, 3.869114962656568*^9, 3.869226582311763*^9, 
  3.869292748873334*^9, 3.869305633392049*^9, 3.8693098108548737`*^9, 
  3.8695265878828783`*^9, 3.8695637747167463`*^9, 3.869692405321713*^9, 
  3.8715665246673517`*^9, 3.872246833755608*^9},
 CellLabel->
  "During evaluation of \
In[176]:=",ExpressionUUID->"859e364a-667b-4ba0-84dc-f8e554636843"],

Cell[BoxData[
 TemplateBox[{
  "Integrate", "idiv", 
   "\"Integral of \\!\\(\\*RowBox[{\\\"1\\\"}]\\) does not converge on \\!\\(\
\\*RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"\[Infinity]\\\"}], \\\
\"}\\\"}]\\).\"", 2, 176, 8, 21942966268712677875, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.860154184765921*^9, 3.860222486735992*^9, 
  3.860222649511047*^9, 3.860223091072652*^9, 3.8617507772844887`*^9, 
  3.863856312665443*^9, 3.864875741557671*^9, 3.867905713048327*^9, 
  3.8691144308048677`*^9, 3.869114962656568*^9, 3.869226582311763*^9, 
  3.869292748873334*^9, 3.869305633392049*^9, 3.8693098108548737`*^9, 
  3.8695265878828783`*^9, 3.8695637747167463`*^9, 3.869692405321713*^9, 
  3.8715665246673517`*^9, 3.872246833760456*^9},
 CellLabel->
  "During evaluation of \
In[176]:=",ExpressionUUID->"405817e5-3eef-46b9-a3df-064d66ca8706"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["R", "2"], "2"]}], "-", 
    FractionBox[
     SuperscriptBox["X", "2"], "2"]}]], " ", "R", " ", 
  SuperscriptBox["X", "2"], " ", 
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
   RowBox[{"1", 
    RowBox[{"\[DifferentialD]", "Z"}]}]}]}]], "Output",
 CellChangeTimes->{3.860154184861368*^9, 3.860222486744063*^9, 
  3.86022264951894*^9, 3.8602230910803223`*^9, 3.8617507773879213`*^9, 
  3.8638563126723223`*^9, 3.864875741565341*^9, 3.867905713199753*^9, 
  3.8691144308121843`*^9, 3.869114962664089*^9, 3.869226582345951*^9, 
  3.8692927488854923`*^9, 3.869305633408531*^9, 3.869309810868643*^9, 
  3.869526587890527*^9, 3.869563774732196*^9, 3.869692405332061*^9, 
  3.871566524696885*^9, 3.8722468337643538`*^9},
 CellLabel->
  "Out[176]=",ExpressionUUID->"514164c2-9bc7-4065-93b6-89bab985c11d"]
}, Open  ]],

Cell[TextData[{
 "Another direction is to apply the Cauchy-Schwarz Inequality: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", ".", "M"}], ")"}], "2"], 
      RowBox[{
       SuperscriptBox["X", "2"], 
       SuperscriptBox["M", "2"]}]], "]"}], " ", "\[LessEqual]", 
    SqrtBox[
     RowBox[{
      RowBox[{"E", "[", 
       FractionBox[
        RowBox[{"X", ".", "M"}], 
        SuperscriptBox["X", "2"]], "]"}], 
      RowBox[{"E", "[", 
       FractionBox[
        RowBox[{"X", ".", "M"}], 
        SuperscriptBox["M", "2"]], "]"}]}]]}], TraditionalForm]],
  ExpressionUUID->"2ff2bd16-4e5f-4305-8dcf-ca851a7efacb"],
 "= ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{
     SubscriptBox["F", "XM"], 
     SubscriptBox["F", "MX"]}]], TraditionalForm]],ExpressionUUID->
  "6bf51d35-06e8-4dfb-a1b5-a2e417a135f0"],
 ", establishing an explicit upper bound on the covariance (which is positive \
by the positivity of both components of ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"X", ".", "M"}], ")"}], "2"], 
    RowBox[{
     SuperscriptBox["X", "2"], 
     SuperscriptBox["M", "2"]}]], TraditionalForm]],ExpressionUUID->
  "28fc2b63-6476-43c4-a3de-0d768710d1bb"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
   3.859547300907641*^9}, {3.859559164128237*^9, 3.859559167825494*^9}, {
   3.859609320521247*^9, 3.859609370990651*^9}, {3.859609481962452*^9, 
   3.8596094958618298`*^9}, 3.859610531394795*^9, {3.8598875332943*^9, 
   3.8598875409369173`*^9}, {3.8598875829068537`*^9, 3.859887622098201*^9}, {
   3.859887832663463*^9, 3.859887914050651*^9}, {3.859888689958066*^9, 
   3.859888813629125*^9}, {3.859967351061068*^9, 3.859967371929195*^9}, {
   3.859967775489496*^9, 3.8599678075757008`*^9}, {3.8599776803532248`*^9, 
   3.8599777565943193`*^9}, {3.8599778871908207`*^9, 3.859978015811314*^9}, {
   3.859978066444913*^9, 3.859978074796298*^9}, {3.8599785486628036`*^9, 
   3.859978582643045*^9}, {3.859978869353269*^9, 3.859978883653344*^9}, 
   3.860151407042264*^9},ExpressionUUID->"f8b63a61-0764-4d68-865d-\
a705715fc2fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<X\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanXonM", "=", 
   RowBox[{
    RowBox[{"CondMeans", "[", 
     RowBox[{"causalgraph", ",", "noisenames", ",", 
      RowBox[{"{", "\"\<M\>\"", "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<M\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanMonX", "=", 
   RowBox[{
    RowBox[{"CondMeans", "[", 
     RowBox[{"causalgraph", ",", "noisenames", ",", 
      RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CSUpperBound", "=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{"condmeanMonX", "*", 
     RowBox[{"condmeanXonM", "/", 
      RowBox[{"(", 
       RowBox[{"X", "*", "M"}], ")"}]}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.859978720747216*^9, 3.859978774551093*^9}, {
   3.8599789840606203`*^9, 3.859979033320346*^9}, 3.859979327653256*^9, 
   3.8599800257062397`*^9, {3.859980762567403*^9, 3.859980762976289*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"be5e2b77-9aa9-4c4b-a317-14c80188caac"],

Cell[BoxData[
 SqrtBox[
  FractionBox[
   RowBox[{
    SuperscriptBox["c", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]]], "Output",
 CellChangeTimes->{{3.859978771657337*^9, 3.859978774981525*^9}, {
   3.859978993327135*^9, 3.8599790336261673`*^9}, 3.8599793280359583`*^9, 
   3.859980026128358*^9, 3.8599807655244837`*^9, 3.8599809963286467`*^9, 
   3.859981026493774*^9, 3.8600361395390778`*^9, 3.860150627767847*^9, 
   3.860222486753866*^9, 3.860222649531033*^9, 3.86022309109197*^9, 
   3.8617507773984413`*^9, 3.8638563126817217`*^9, 3.864875741577622*^9, 
   3.867905713236784*^9, 3.869114430821155*^9, 3.869114962681773*^9, 
   3.8692265823667927`*^9, 3.869292748902413*^9, 3.869305633427807*^9, 
   3.869309810886743*^9, 3.869526587900115*^9, 3.869563774759383*^9, 
   3.869692405347375*^9, 3.871566524736104*^9, 3.872246833776711*^9},
 CellLabel->
  "Out[183]=",ExpressionUUID->"ca8fd3dd-b271-4201-b727-47cabff8a7ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"covestimateterms", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"covestimatesimp", "/.", "stringifySubs"}], "/.", 
     RowBox[{"{", 
      RowBox[{"uM", "->", 
       RowBox[{"M", "-", 
        RowBox[{"c", "*", "X"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covtermslist", "=", 
   RowBox[{"List", "@@", "covestimateterms"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8599809655325193`*^9, 3.859980982377356*^9}, {
  3.859981036410494*^9, 3.859981041946168*^9}, {3.859981134293586*^9, 
  3.859981176856553*^9}, {3.859981228875888*^9, 3.859981317330821*^9}, {
  3.8602224651005707`*^9, 3.860222465423552*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"ebb6adcd-f8dc-48fa-8305-8bd12fa5f663"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"M", ".", "X"}], " ", 
     SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], 
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "\<\"uX\"\>", "2"]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{"b", " ", "d", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}], " ", 
    SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], 
   RowBox[{
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "\<\"uX\"\>", "2"]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"b", " ", 
    SuperscriptBox["c", "2"], " ", "d", " ", 
    SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "\<\"uM\"\>", "2"], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "\<\"uX\"\>", "2"]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"b", " ", "c", " ", "d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], 
   RowBox[{
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "\<\"uM\"\>", "2"], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "\<\"uX\"\>", "2"]}], ")"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.8599810422604847`*^9, {3.859981137858642*^9, 3.859981177210478*^9}, {
   3.859981229756925*^9, 3.8599813178518744`*^9}, 3.8599813797222357`*^9, 
   3.860036139555159*^9, 3.8601506277797127`*^9, 3.860222486764512*^9, 
   3.860222649543601*^9, 3.860223091104259*^9, 3.861750777433272*^9, 
   3.8638563126916513`*^9, 3.864875741589444*^9, 3.8679057132732563`*^9, 
   3.8691144308312387`*^9, 3.8691149626965637`*^9, 3.8692265824202538`*^9, 
   3.869292748917109*^9, 3.8693056334414587`*^9, 3.869309810900696*^9, 
   3.8695265879095*^9, 3.8695637748215523`*^9, 3.869692405363535*^9, 
   3.8715665247738028`*^9, 3.8722468337890253`*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"979bc7a8-b674-4770-9382-a1330c5a1a75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"covExact", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covtermslist", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"X", "->", "condmeanXonM"}], "}"}]}], ")"}], " ", "+", " ", 
      RowBox[{"covtermslist", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", 
      RowBox[{"covtermslist", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"covtermslist", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"M", "->", "condmeanMonX"}], "}"}]}], ")"}]}], "/.", 
     "stringifySubs"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Expand"}]}]], "Input",
 CellChangeTimes->{{3.859980786541285*^9, 3.859980792232885*^9}, {
  3.859981204945516*^9, 3.859981206172879*^9}, {3.85998132138195*^9, 
  3.859981403418189*^9}, {3.859981503898325*^9, 3.85998150497892*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"93c1f14e-a4fb-468d-b942-59072288a49b"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"b", " ", "d", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}], " ", 
    SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], 
   RowBox[{
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "\<\"uX\"\>", "2"]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"b", " ", 
    SuperscriptBox["c", "2"], " ", "d", " ", 
    SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "\<\"uM\"\>", "2"], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "\<\"uW\"\>", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "\<\"uX\"\>", "2"]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.8599813769391327`*^9, 3.85998140391785*^9}, 
   3.859981506089877*^9, 3.860036139574*^9, 3.860150627792996*^9, 
   3.860222486775689*^9, 3.860222649556774*^9, 3.860223091116888*^9, 
   3.861750777444516*^9, 3.863856312701231*^9, 3.864875741601347*^9, 
   3.867905713312422*^9, 3.869114430841485*^9, 3.869114962711315*^9, 
   3.869226582438655*^9, 3.869292748931858*^9, 3.8693056334551373`*^9, 
   3.869309810915001*^9, 3.8695265879199038`*^9, 3.869563774848865*^9, 
   3.8696924053808613`*^9, 3.871566524813243*^9, 3.872246833801248*^9},
 CellLabel->
  "Out[186]=",ExpressionUUID->"8b8e992c-463e-43f7-8b16-140f61f2e109"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biases and Variances for Approximate Approximate FDC [Gupta]", \
"Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
   3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
   3.8583190781426697`*^9}, {3.8583294810528927`*^9, 
   3.8583294837393723`*^9}, {3.859545918605206*^9, 3.859545920301775*^9}, {
   3.859559128455942*^9, 3.8595591312578793`*^9}, {3.859607171952083*^9, 
   3.859607174094486*^9}, 3.859885062037899*^9, {3.860221274708756*^9, 
   3.860221294528968*^9}},ExpressionUUID->"1ca2d76d-4ceb-4284-b53f-\
881365cee286"],

Cell[TextData[{
 "In this case, the structural equations are again unchanged, but the \
estimator for ac is made directly from X\[Rule]Y:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "4978f145-c27a-4926-a275-6036c2978c9a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "da3e7a93-024f-4652-9984-e56bc1f26db6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "8c6fb4c8-b20c-43f8-bd42-c6ca156458fa"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "7cf347a1-7d66-474f-8fe5-c4bf39ffa69e"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.859607187882019*^9, 3.859607195870319*^9}, {
  3.859607409379047*^9, 3.859607413066949*^9}, {3.860221302032886*^9, 
  3.8602213157433577`*^9}},ExpressionUUID->"44d4db92-1bf3-4e31-8788-\
f9eee3e305a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xac", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yac", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["approxac", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yac", ",", "Xac"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.859546089296102*^9, 3.8595460971681967`*^9}, {
  3.859607716759109*^9, 3.8596077201953297`*^9}, {3.859608069554517*^9, 
  3.859608079649106*^9}, {3.860221319776534*^9, 3.86022133060106*^9}, {
  3.860221366102922*^9, 3.860221366814101*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"30df783b-79a3-4828-9d01-0b5d102eccd6"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "Y"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.859607770089818*^9, {3.859608072043679*^9, 3.859608080187748*^9}, 
   3.8596100272861757`*^9, 3.859631367625342*^9, 3.8597012071750393`*^9, 
   3.859701238459065*^9, 3.859885019921348*^9, 3.8598851663524723`*^9, 
   3.859885340524213*^9, 3.859885565206126*^9, 3.859885599122307*^9, 
   3.859885664086697*^9, 3.8598858617415857`*^9, 3.8598861040005093`*^9, {
   3.85988620733501*^9, 3.859886253668955*^9}, 3.859886414901938*^9, 
   3.859887265756473*^9, 3.859887761915132*^9, 3.8598877941475163`*^9, 
   3.859887828149646*^9, 3.859967767261508*^9, 3.8599809894916897`*^9, 
   3.860036130109704*^9, 3.860150621145862*^9, 3.860221331674815*^9, 
   3.860221367425432*^9, 3.860222486786297*^9, 3.860222649569235*^9, 
   3.860223091129031*^9, 3.861750777455266*^9, 3.863856312710174*^9, 
   3.864875741612617*^9, 3.867905713346509*^9, 3.869114430851235*^9, 
   3.869114962725428*^9, 3.869226582457753*^9, 3.869292748946169*^9, 
   3.869305633467751*^9, 3.869309810928753*^9, 3.8695265879292994`*^9, 
   3.869563774871998*^9, 3.869692405396997*^9, 3.87156652485119*^9, 
   3.8722468338128*^9},
 CellLabel->
  "Out[189]=",ExpressionUUID->"03162438-f05a-4f91-aaec-eeeae001aaff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"acerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["approxac", "^"], "-", 
    RowBox[{"a", "*", "c"}]}], "//.", "structureEqs"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, 3.859607725650403*^9, {3.860221339523831*^9, 
   3.860221378221032*^9}, 3.8602214295082006`*^9},
 CellLabel->
  "In[190]:=",ExpressionUUID->"8fd3fc4a-b635-4dcd-913d-21acd26f6187"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "a"}], " ", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "M"}], "+", "uY", "+", 
      FractionBox[
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{3.860221378543272*^9, 3.8602214323804817`*^9, 
  3.860222486796151*^9, 3.860222649581517*^9, 3.8602230911401978`*^9, 
  3.861750777466443*^9, 3.863856312719069*^9, 3.864875741623666*^9, 
  3.867905713381019*^9, 3.8691144308606043`*^9, 3.869114962738826*^9, 
  3.869226582474066*^9, 3.8692927489603233`*^9, 3.869305633480934*^9, 
  3.869309810941791*^9, 3.869526587938394*^9, 3.8695637748951807`*^9, 
  3.869692405411787*^9, 3.871566524886374*^9, 3.8722468338237457`*^9},
 CellLabel->
  "Out[191]=",ExpressionUUID->"5c592d55-abd4-4c60-b0f9-0b74ebd7ddb7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<M\>\"", ",", "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"acbias", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"acerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
  3.85960814159554*^9, 3.8596081641830873`*^9}, {3.859885313241066*^9, 
  3.85988531358348*^9}, {3.860221404719603*^9, 3.860221431295601*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"0f49ba2d-daeb-4d2c-af43-31d740d873f6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"M", ",", "uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.859607770107766*^9, 3.859608084635017*^9, {
   3.859608142494143*^9, 3.859608164864297*^9}, 3.8596100273029337`*^9, 
   3.8596313676480827`*^9, 3.859701207208246*^9, 3.859701238496211*^9, 
   3.859885019940786*^9, 3.859885166368373*^9, 3.85988534054128*^9, 
   3.859885565221838*^9, 3.859885599137776*^9, 3.859885664101749*^9, 
   3.8598858617564573`*^9, 3.8598861040151243`*^9, {3.85988620734933*^9, 
   3.859886253684342*^9}, 3.859886414917755*^9, 3.859887265776305*^9, 
   3.859887761931094*^9, 3.85988779416593*^9, 3.8598878281689*^9, 
   3.859967767275693*^9, {3.859980989503793*^9, 3.859981015787676*^9}, 
   3.860036130133264*^9, 3.860150621159931*^9, {3.860221409709474*^9, 
   3.8602214331245317`*^9}, 3.8602224868074617`*^9, 3.860222649594056*^9, 
   3.860223091152102*^9, 3.861750777478372*^9, 3.863856312728106*^9, 
   3.864875741634954*^9, 3.8679057134199142`*^9, 3.869114430870777*^9, 
   3.869114962752759*^9, 3.869226582492082*^9, 3.8692927489748898`*^9, 
   3.869305633493918*^9, 3.8693098109561234`*^9, 3.8695265879478188`*^9, 
   3.869563774921055*^9, 3.8696924054291687`*^9, 3.871566524919986*^9, 
   3.872246833835503*^9},
 CellLabel->
  "Out[193]=",ExpressionUUID->"ac2a8f7e-353b-4908-bce4-33cf7bf5ce66"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"M", "\[Rule]", 
    RowBox[{"c", " ", "X"}]}], ",", 
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", "0"}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.859607770107766*^9, 3.859608084635017*^9, {
   3.859608142494143*^9, 3.859608164864297*^9}, 3.8596100273029337`*^9, 
   3.8596313676480827`*^9, 3.859701207208246*^9, 3.859701238496211*^9, 
   3.859885019940786*^9, 3.859885166368373*^9, 3.85988534054128*^9, 
   3.859885565221838*^9, 3.859885599137776*^9, 3.859885664101749*^9, 
   3.8598858617564573`*^9, 3.8598861040151243`*^9, {3.85988620734933*^9, 
   3.859886253684342*^9}, 3.859886414917755*^9, 3.859887265776305*^9, 
   3.859887761931094*^9, 3.85988779416593*^9, 3.8598878281689*^9, 
   3.859967767275693*^9, {3.859980989503793*^9, 3.859981015787676*^9}, 
   3.860036130133264*^9, 3.860150621159931*^9, {3.860221409709474*^9, 
   3.8602214331245317`*^9}, 3.8602224868074617`*^9, 3.860222649594056*^9, 
   3.860223091152102*^9, 3.861750777478372*^9, 3.863856312728106*^9, 
   3.864875741634954*^9, 3.8679057134199142`*^9, 3.869114430870777*^9, 
   3.869114962752759*^9, 3.869226582492082*^9, 3.8692927489748898`*^9, 
   3.869305633493918*^9, 3.8693098109561234`*^9, 3.8695265879478188`*^9, 
   3.869563774921055*^9, 3.8696924054291687`*^9, 3.871566524919986*^9, 
   3.87224683383685*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"8c65a133-0dd8-4a5e-a53c-05288b92f07f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "d", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.859607770107766*^9, 3.859608084635017*^9, {
   3.859608142494143*^9, 3.859608164864297*^9}, 3.8596100273029337`*^9, 
   3.8596313676480827`*^9, 3.859701207208246*^9, 3.859701238496211*^9, 
   3.859885019940786*^9, 3.859885166368373*^9, 3.85988534054128*^9, 
   3.859885565221838*^9, 3.859885599137776*^9, 3.859885664101749*^9, 
   3.8598858617564573`*^9, 3.8598861040151243`*^9, {3.85988620734933*^9, 
   3.859886253684342*^9}, 3.859886414917755*^9, 3.859887265776305*^9, 
   3.859887761931094*^9, 3.85988779416593*^9, 3.8598878281689*^9, 
   3.859967767275693*^9, {3.859980989503793*^9, 3.859981015787676*^9}, 
   3.860036130133264*^9, 3.860150621159931*^9, {3.860221409709474*^9, 
   3.8602214331245317`*^9}, 3.8602224868074617`*^9, 3.860222649594056*^9, 
   3.860223091152102*^9, 3.861750777478372*^9, 3.863856312728106*^9, 
   3.864875741634954*^9, 3.8679057134199142`*^9, 3.869114430870777*^9, 
   3.869114962752759*^9, 3.869226582492082*^9, 3.8692927489748898`*^9, 
   3.869305633493918*^9, 3.8693098109561234`*^9, 3.8695265879478188`*^9, 
   3.869563774921055*^9, 3.8696924054291687`*^9, 3.871566524919986*^9, 
   3.872246833838073*^9},
 CellLabel->
  "Out[196]=",ExpressionUUID->"b7c64446-1820-40cd-a151-feea1af7f1f5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biases and Variances for [Gupta] NEW, Revisited", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.8595591312578793`*^9}, {3.861251380500149*^9, 
  3.861251380976762*^9}},ExpressionUUID->"01666397-10ec-4231-8f0a-\
4e0e11ead2b3"],

Cell[TextData[{
 "We now adjust the approach by considering ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "m"], TraditionalForm]],ExpressionUUID->
  "49af0e4f-3f05-4d67-ac3c-7fe4299b174e"],
 " to be an instrumental variable"
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.858335532700376*^9, 3.858335564776896*^9}, {3.858335649607807*^9, 
  3.8583356557769747`*^9}, {3.858336399224999*^9, 3.8583364056425467`*^9}, {
  3.859545922446866*^9, 3.8595460107262383`*^9}, {3.8612513937763243`*^9, 
  3.861251443808839*^9}},ExpressionUUID->"e30e6357-feb6-4ca5-89d4-\
55018ec64e92"],

Cell[TextData[{
 "As a reminder, here are the structural equations and estimators:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "e23c7bcf-e410-4be5-b8b6-8d3b9852f240"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "a55dcaff-a9bf-4b4e-a1de-24149c84132c"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f039d52b-cec6-4fb1-b121-edca6f9cc755"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f20c7914-8212-41c5-92aa-d761d2fb2ef3"],
 ".\n\nLet "
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.8612514154663754`*^9, 3.8612514163742743`*^9}, {
  3.8612516780064363`*^9, 
  3.861251679081395*^9}},ExpressionUUID->"3ef0156a-a016-4e37-8ec9-\
5023d8e2e1da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"M", ",", "X"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["a", "^"], ",", 
     OverscriptBox["bdivd", "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "M", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["c", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.859546089296102*^9, 3.8595460971681967`*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"59039328-20dc-4e75-870c-817bfb4ad206"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.8596077699973783`*^9, 3.859610027191703*^9, 3.85963136749975*^9, 
   3.859701206962082*^9, 3.859701238225834*^9, 3.8598850198239613`*^9, 
   3.859885166259493*^9, 3.859885340427815*^9, 3.8598855651160088`*^9, 
   3.859885599031952*^9, 3.859885663995275*^9, 3.859885861647509*^9, 
   3.859886103915604*^9, {3.859886207238886*^9, 3.859886253577096*^9}, 
   3.859886414807568*^9, 3.85988726564132*^9, 3.859887761823477*^9, 
   3.859887794041802*^9, 3.8598878280421753`*^9, 3.859967767159005*^9, 
   3.859980989417288*^9, 3.860036129976096*^9, 3.860150621053734*^9, 
   3.860221337831584*^9, 3.860222477474022*^9, 3.8602226407023983`*^9, 
   3.860223082389236*^9, 3.8617507774926367`*^9, 3.8638563127387466`*^9, 
   3.864875741648205*^9, 3.867905713462335*^9, 3.8691144308822317`*^9, 
   3.869114962768742*^9, 3.869226582513995*^9, 3.869292748995667*^9, 
   3.8693056335141087`*^9, 3.86930981097705*^9, 3.8695265879587917`*^9, 
   3.869563774952573*^9, 3.8696924054481373`*^9, 3.871566524965447*^9, 
   3.872246833849802*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"6f6e6637-f559-4222-a96a-35279caab4b6"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8595460977313757`*^9, 3.8595573534082527`*^9, 3.859557519652845*^9, 
   3.859557550311898*^9, 3.859558668954091*^9, 3.85959131261147*^9, 
   3.8595913589213057`*^9, 3.859591584679617*^9, 3.859591708864615*^9, 
   3.8596077699973783`*^9, 3.859610027191703*^9, 3.85963136749975*^9, 
   3.859701206962082*^9, 3.859701238225834*^9, 3.8598850198239613`*^9, 
   3.859885166259493*^9, 3.859885340427815*^9, 3.8598855651160088`*^9, 
   3.859885599031952*^9, 3.859885663995275*^9, 3.859885861647509*^9, 
   3.859886103915604*^9, {3.859886207238886*^9, 3.859886253577096*^9}, 
   3.859886414807568*^9, 3.85988726564132*^9, 3.859887761823477*^9, 
   3.859887794041802*^9, 3.8598878280421753`*^9, 3.859967767159005*^9, 
   3.859980989417288*^9, 3.860036129976096*^9, 3.860150621053734*^9, 
   3.860221337831584*^9, 3.860222477474022*^9, 3.8602226407023983`*^9, 
   3.860223082389236*^9, 3.8617507774926367`*^9, 3.8638563127387466`*^9, 
   3.864875741648205*^9, 3.867905713462335*^9, 3.8691144308822317`*^9, 
   3.869114962768742*^9, 3.869226582513995*^9, 3.869292748995667*^9, 
   3.8693056335141087`*^9, 3.86930981097705*^9, 3.8695265879587917`*^9, 
   3.869563774952573*^9, 3.8696924054481373`*^9, 3.871566524965447*^9, 
   3.8722468338511257`*^9},
 CellLabel->
  "Out[202]=",ExpressionUUID->"05913b35-a32f-4cee-9155-bc1fbac42115"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["a", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy08oQwEAx/FZpJktq9E2UsraLjab10gsTw4zthnKhpr8afmTHXaRMVoj
f3ZAShZ2Uo5kUoyFA4skod1kOfjz0iLLIrzfO3z7nL4FnY7GHjaLxcqlg92u
vURRmCKJxcwvaBT1sxW0Q5o449q6WQB9woUc6PaUymCzjieH/OSgGv78ZROQ
e6wth7G+JZL5TS118FnyboInTv12Ma1h/jUIqazoASzzfp9Cr9N/Ca8LP+4g
0aVJQPtv5BdGZwNpKtqMyDWj1nrOgfsaMx/6p26FcK41RQzj7TYVdH2FCGis
7a2GvAe3Dg7vkPVQkm5vgB2HFdNQf6b0weRTOAZnbu4fYepy6AVu7AbfYLDS
wVHTjqlWGd+31EVwU1nF6CtRcMaPKDLwmS2A8iZLHpQa2vKhxEpJoUXXJoNX
NYnRCVquaMUDBy5soknaEWpFDP8BOmfZgA==
  "],
 CellLabel->
  "In[203]:=",ExpressionUUID->"768a7334-3e9b-4fc9-a5a1-400a7e9dfdd6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"46295a90-b2be-4911-ae9a-341127a689ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.8596077700081367`*^9, 3.859610027208755*^9, 
   3.859631367522325*^9, 3.859701206998219*^9, 3.859701238265183*^9, 
   3.859885019843472*^9, 3.85988516627533*^9, 3.859885340443709*^9, 
   3.859885565130596*^9, 3.859885599046155*^9, 3.859885664010501*^9, 
   3.8598858616636267`*^9, 3.859886103929531*^9, {3.85988620725454*^9, 
   3.859886253592938*^9}, 3.859886414822341*^9, 3.85988726566147*^9, 
   3.859887761838647*^9, 3.859887794059349*^9, 3.859887828060644*^9, 
   3.859967767178075*^9, 3.8599809894297667`*^9, 3.860036129999679*^9, 
   3.8601506210721493`*^9, 3.8602213378473186`*^9, 3.860222477491358*^9, 
   3.860222640717808*^9, 3.860223082409175*^9, 3.8617507775064363`*^9, 
   3.863856312750017*^9, 3.86487574166221*^9, 3.8679057135100317`*^9, 
   3.869114430894421*^9, 3.869114962788164*^9, 3.8692265825355797`*^9, 
   3.869292749015663*^9, 3.869305633533246*^9, 3.8693098109969263`*^9, 
   3.869526587970318*^9, 3.869563774983482*^9, 3.869692405469035*^9, 
   3.871566525028851*^9, 3.8722468338644447`*^9},
 CellLabel->
  "Out[206]=",ExpressionUUID->"19a3ebdd-7461-46a4-9718-9aae0ba45988"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{"M", "-", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.8596077700081367`*^9, 3.859610027208755*^9, 
   3.859631367522325*^9, 3.859701206998219*^9, 3.859701238265183*^9, 
   3.859885019843472*^9, 3.85988516627533*^9, 3.859885340443709*^9, 
   3.859885565130596*^9, 3.859885599046155*^9, 3.859885664010501*^9, 
   3.8598858616636267`*^9, 3.859886103929531*^9, {3.85988620725454*^9, 
   3.859886253592938*^9}, 3.859886414822341*^9, 3.85988726566147*^9, 
   3.859887761838647*^9, 3.859887794059349*^9, 3.859887828060644*^9, 
   3.859967767178075*^9, 3.8599809894297667`*^9, 3.860036129999679*^9, 
   3.8601506210721493`*^9, 3.8602213378473186`*^9, 3.860222477491358*^9, 
   3.860222640717808*^9, 3.860223082409175*^9, 3.8617507775064363`*^9, 
   3.863856312750017*^9, 3.86487574166221*^9, 3.8679057135100317`*^9, 
   3.869114430894421*^9, 3.869114962788164*^9, 3.8692265825355797`*^9, 
   3.869292749015663*^9, 3.869305633533246*^9, 3.8693098109969263`*^9, 
   3.869526587970318*^9, 3.869563774983482*^9, 3.869692405469035*^9, 
   3.871566525028851*^9, 3.872246833874323*^9},
 CellLabel->
  "Out[208]=",ExpressionUUID->"b81dc32c-96f2-4565-99b2-6d8a065db5dd"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.859591312630527*^9, 3.859591358939747*^9, 3.8595915847014837`*^9, 
   3.8595917088837023`*^9, 3.8596077700081367`*^9, 3.859610027208755*^9, 
   3.859631367522325*^9, 3.859701206998219*^9, 3.859701238265183*^9, 
   3.859885019843472*^9, 3.85988516627533*^9, 3.859885340443709*^9, 
   3.859885565130596*^9, 3.859885599046155*^9, 3.859885664010501*^9, 
   3.8598858616636267`*^9, 3.859886103929531*^9, {3.85988620725454*^9, 
   3.859886253592938*^9}, 3.859886414822341*^9, 3.85988726566147*^9, 
   3.859887761838647*^9, 3.859887794059349*^9, 3.859887828060644*^9, 
   3.859967767178075*^9, 3.8599809894297667`*^9, 3.860036129999679*^9, 
   3.8601506210721493`*^9, 3.8602213378473186`*^9, 3.860222477491358*^9, 
   3.860222640717808*^9, 3.860223082409175*^9, 3.8617507775064363`*^9, 
   3.863856312750017*^9, 3.86487574166221*^9, 3.8679057135100317`*^9, 
   3.869114430894421*^9, 3.869114962788164*^9, 3.8692265825355797`*^9, 
   3.869292749015663*^9, 3.869305633533246*^9, 3.8693098109969263`*^9, 
   3.869526587970318*^9, 3.869563774983482*^9, 3.869692405469035*^9, 
   3.871566525028851*^9, 3.872246833875865*^9},
 CellLabel->
  "Out[209]=",ExpressionUUID->"1837759d-521f-48d1-bbc6-b58560e84324"]
}, Open  ]],

Cell["Similarly for c:", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 
  3.85833817346621*^9}},ExpressionUUID->"b83a6ba6-84a6-4cac-ad8e-\
68a26373eeb1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{"M", "\[Rule]", 
     RowBox[{
      RowBox[{"c", "*", "X"}], "+", "uM"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["c", "^"], "-", "c"}], "//.", 
   "structureEqs"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<uM\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noises", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanreplace", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"noises", ",", "condmeans"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy08oQwEAx/FZxLBFbeIdFClSw9teMxvLuMw2m0lpUjS0UHbYBaupteTP
DkjJCgcpjtqTYjZ/DizlsNBusnbw56U1tbZovN87fPucvjU2R/8En8fjEWxw
3HWWloYZLbVZmoGmyml+E+usIsm5e2Aphz7xRgV0e1rr4YBO2ABF2RkZ/P2T
ULDkWqOC8aktLfebBw3wnUiZ4Y1TH2hh7V3/pCFTFruASu/PLfQ6/Q8wWvf9
DKkxRRrac5EcjK3uFZCsxZEop8Z6L4DnCosI+peexHBtKK8KJodHSOjKBClo
6pnsgsJXtw7On2iNkCi098HRUPsy1N81+2D2LRyHK48vCZi/HfyAh6f0F6Q7
HAIZ6wK5w5k6lklhd+OcGgptl8TiFaM1KrPVUFx7REKDmqEgLfG0wYR1XwVD
8oAGxuVFnfAfGb3SRQ==
  "],
 CellLabel->
  "In[210]:=",ExpressionUUID->"c9d8ddf0-ece0-4e84-9caa-7c29d8feb5bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}]}], ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.859591312659512*^9, 3.859591358967806*^9, 3.859591584736274*^9, 
   3.859591708913746*^9, 3.8596077700283213`*^9, 3.859610027234254*^9, 
   3.859631367553928*^9, 3.8597012070516853`*^9, 3.8597012383333807`*^9, 
   3.8598850198653803`*^9, 3.8598851662993*^9, 3.859885340469726*^9, 
   3.8598855651524687`*^9, 3.8598855990694237`*^9, 3.859885664033375*^9, 
   3.8598858616886177`*^9, 3.8598861039504223`*^9, {3.859886207279212*^9, 
   3.8598862536166897`*^9}, 3.859886414846919*^9, 3.859887265692418*^9, 
   3.859887761861946*^9, 3.85988779408731*^9, 3.859887828088656*^9, 
   3.859967767203684*^9, 3.859980989448257*^9, 3.860036130036292*^9, 
   3.860150621095475*^9, 3.860221337872877*^9, 3.860222477502269*^9, 
   3.8602226407460957`*^9, 3.860223082431902*^9, 3.8617507775309067`*^9, 
   3.8638563127677794`*^9, 3.864875741684759*^9, 3.8679057135581503`*^9, 
   3.869114430913066*^9, 3.869114962815151*^9, 3.8692265825715733`*^9, 
   3.869292749036647*^9, 3.869305633556109*^9, 3.869309811018189*^9, 
   3.8695265879893427`*^9, 3.8695637750364847`*^9, 3.8696924054997177`*^9, 
   3.871566525097747*^9, 3.8722468338871927`*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"180def75-0b20-4a73-8b9c-b60e0692dc23"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.859591312659512*^9, 3.859591358967806*^9, 3.859591584736274*^9, 
   3.859591708913746*^9, 3.8596077700283213`*^9, 3.859610027234254*^9, 
   3.859631367553928*^9, 3.8597012070516853`*^9, 3.8597012383333807`*^9, 
   3.8598850198653803`*^9, 3.8598851662993*^9, 3.859885340469726*^9, 
   3.8598855651524687`*^9, 3.8598855990694237`*^9, 3.859885664033375*^9, 
   3.8598858616886177`*^9, 3.8598861039504223`*^9, {3.859886207279212*^9, 
   3.8598862536166897`*^9}, 3.859886414846919*^9, 3.859887265692418*^9, 
   3.859887761861946*^9, 3.85988779408731*^9, 3.859887828088656*^9, 
   3.859967767203684*^9, 3.859980989448257*^9, 3.860036130036292*^9, 
   3.860150621095475*^9, 3.860221337872877*^9, 3.860222477502269*^9, 
   3.8602226407460957`*^9, 3.860223082431902*^9, 3.8617507775309067`*^9, 
   3.8638563127677794`*^9, 3.864875741684759*^9, 3.8679057135581503`*^9, 
   3.869114430913066*^9, 3.869114962815151*^9, 3.8692265825715733`*^9, 
   3.869292749036647*^9, 3.869305633556109*^9, 3.869309811018189*^9, 
   3.8695265879893427`*^9, 3.8695637750364847`*^9, 3.8696924054997177`*^9, 
   3.871566525097747*^9, 3.872246833888514*^9},
 CellLabel->
  "Out[216]=",ExpressionUUID->"49db4374-d8e9-4eb7-a27f-84cac5e6a7f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimate", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "*", "cerror"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimatesimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"covestimate", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "\[Element]", 
           "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8595579821985483`*^9, 3.859558061814584*^9}, {
  3.859558655476707*^9, 3.859558658433288*^9}, {3.8595590766617002`*^9, 
  3.859559108103771*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"a8b43178-58fe-472b-b9bc-437623ed0786"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861750777542452*^9, 
   3.863856312778186*^9, 3.864875741697377*^9, 3.867905713628023*^9, 
   3.869114430923696*^9, 3.869114962830409*^9, 3.869226582592346*^9, 
   3.8692927490548067`*^9, 3.869305633575637*^9, 3.869309811035874*^9, 
   3.869526587999976*^9, 3.869563775065284*^9, 3.8696924055171213`*^9, 
   3.871566525139516*^9, 3.872246833901287*^9},
 CellLabel->
  "Out[219]=",ExpressionUUID->"7be4fbf2-64f5-490e-80cf-f649ac1ae65d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{"M", "-", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861750777542452*^9, 
   3.863856312778186*^9, 3.864875741697377*^9, 3.867905713628023*^9, 
   3.869114430923696*^9, 3.869114962830409*^9, 3.869226582592346*^9, 
   3.8692927490548067`*^9, 3.869305633575637*^9, 3.869309811035874*^9, 
   3.869526587999976*^9, 3.869563775065284*^9, 3.8696924055171213`*^9, 
   3.871566525139516*^9, 3.872246833902708*^9},
 CellLabel->
  "Out[221]=",ExpressionUUID->"a452c07f-b793-48dc-9fdc-0c1cbb003b9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "c"}], "+", 
    FractionBox[
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"uM", "+", 
        RowBox[{"c", " ", "X"}]}], ")"}]}], 
     RowBox[{"X", ".", "X"}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "a"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"M", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          FractionBox[
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}], " ", 
       
       RowBox[{"X", ".", "X"}]}], "-", 
      RowBox[{
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"X", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          FractionBox[
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861750777542452*^9, 
   3.863856312778186*^9, 3.864875741697377*^9, 3.867905713628023*^9, 
   3.869114430923696*^9, 3.869114962830409*^9, 3.869226582592346*^9, 
   3.8692927490548067`*^9, 3.869305633575637*^9, 3.869309811035874*^9, 
   3.869526587999976*^9, 3.869563775065284*^9, 3.8696924055171213`*^9, 
   3.871566525139516*^9, 3.872246833913363*^9},
 CellLabel->
  "Out[222]=",ExpressionUUID->"2ae23eb7-1f4d-4294-b8ed-11c514510195"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.859591312676503*^9, 3.85959135898389*^9, 3.859591584758177*^9, 
   3.859591708930635*^9, 3.859607770041925*^9, 3.859610027250064*^9, 
   3.859631367573065*^9, 3.859701207083242*^9, 3.859701238364876*^9, 
   3.859885019877087*^9, 3.859885166313115*^9, 3.859885340485099*^9, 
   3.8598855651653013`*^9, 3.85988559908316*^9, 3.8598856640466833`*^9, 
   3.8598858617027483`*^9, 3.859886103962718*^9, {3.859886207293577*^9, 
   3.859886253630433*^9}, 3.8598864148611*^9, 3.859887265708806*^9, 
   3.859887761875651*^9, 3.8598877941032543`*^9, 3.859887828104903*^9, 
   3.8599677672200747`*^9, 3.8599809894594173`*^9, 3.860036130056035*^9, 
   3.860150621107419*^9, 3.860221337886907*^9, 3.860222477511972*^9, 
   3.8602226407605*^9, 3.860223082445657*^9, 3.861750777542452*^9, 
   3.863856312778186*^9, 3.864875741697377*^9, 3.867905713628023*^9, 
   3.869114430923696*^9, 3.869114962830409*^9, 3.869226582592346*^9, 
   3.8692927490548067`*^9, 3.869305633575637*^9, 3.869309811035874*^9, 
   3.869526587999976*^9, 3.869563775065284*^9, 3.8696924055171213`*^9, 
   3.871566525139516*^9, 3.8722468339226007`*^9},
 CellLabel->
  "Out[223]=",ExpressionUUID->"98dbd3a3-e32d-4aaa-b00d-e093672d4d81"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Biases and Variances with Confounded Mediator, Revisited", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.859559150645014*^9}},ExpressionUUID->"e8e79363-e6d6-4b07-9ed2-\
693a16617628"],

Cell[TextData[{
 "As a reminder, here are the structural equations and estimators:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "912cd727-04f9-4809-9b79-4872a1cfef2d"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "7bf0b58b-f716-4837-b18c-563d37880bc2"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "66406ce3-baa6-48b5-985e-3b9e3de53fc5"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "6ec581cb-3ab8-4a1f-bba4-5d35579f9b51"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.859559164128237*^9, 
  3.859559167825494*^9}},ExpressionUUID->"6ab97049-a272-45e3-b56a-\
c28fd1fbe654"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"3", "\[DirectedEdge]", "4"}], ",", 
     RowBox[{"1", "\[DirectedEdge]", "4"}], ",", 
     RowBox[{"1", "\[DirectedEdge]", "3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vnames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<W\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\"", ",", "\"\<Y\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweights", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "uW"], ",", 
     SubscriptBox["\[Sigma]", "uX"], ",", 
     SubscriptBox["\[Sigma]", "uM"], ",", 
     SubscriptBox["\[Sigma]", "uY"]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{"#1", ",", "Center"}], "]"}], "&"}], ",", "vnames"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eweights", "=", 
   RowBox[{"{", 
    RowBox[{"d", ",", "c", ",", "a", ",", "b", ",", "\[Epsilon]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elabels", " ", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"edges", "\[Rule]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "#1", ",", "18", ",", "Italic", ",", "Bold", ",", "Blue"}], 
             "]"}], ",", 
            RowBox[{"Background", "->", "White"}], ",", 
            RowBox[{"FrameStyle", "->", "White"}]}], "]"}], ",", 
          "\"\<Middle\>\""}], "]"}], "&"}], ",", "eweights"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcoords", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookup", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vnames", "->", "vertices"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupname", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", "vnames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweightsnou", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "W"], ",", 
     SubscriptBox["\[Sigma]", "X"], ",", 
     SubscriptBox["\[Sigma]", "M"], ",", 
     SubscriptBox["\[Sigma]", "Y"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvars", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupweight", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
         "]"}], "->", "vweights"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "#", "]"}], "&"}], ",", "vnames"}], "]"}], "->",
         "vweightsnou"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"causalgraphcm", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"edges", ",", 
    RowBox[{"VertexLabels", "->", "vlabels"}], ",", 
    RowBox[{"EdgeLabels", "->", "elabels"}], ",", 
    RowBox[{"VertexWeight", "\[Rule]", "vweights"}], ",", 
    RowBox[{"EdgeWeight", "\[Rule]", "eweights"}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "\"\<LayeredEmbedding\>\""}], ",", 
    RowBox[{"VertexStyle", "->", "Black"}], ",", 
    RowBox[{"VertexSize", "->", "0.3"}], ",", 
    RowBox[{"VertexLabelStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Italic", ",", "26"}], "]"}]}], ",", 
    RowBox[{"EdgeStyle", "->", "Black"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQHR4jVhV68I3j15bwJhDt0Ta7E0QfEro8AUQ3pLhO
A9EpPjc2gmiXD8e2gegtcvO2g+h7vg/3gugAvg/7QPT8vQuPgWiGwuWXQPSN
Vda3QHTNg3NgmmFL7X0Q/ezs0ycgelKUwmsQ/Wh/xTsQ7fXwyk8QXXLlP5gO
6rjFGAakC7b084Jol5UzREC09kFzFRA9+1qRDohWi/hoB6L9/mU4g+j1FWou
IFqzY28XiJ6lKD0BRJeEbt4Moo1uf9wCoqvia79EAelTGot+gGgV8fts0UB6
DctKbhD9ILZDCESvq90vDKLbzBUlQHRQnoI8iL7gMEewBBQOuy4Kg2gD1tvi
IFrqmIk0iC44e5xrGii8nsrwgujz+l7CIFqn0QdMlxQVSoPoT38bwTQA8rPZ
Qw==
  "],
 CellLabel->
  "In[224]:=",ExpressionUUID->"9c789cc0-8a84-46a7-89d4-a7f2cccc6f54"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4}, {{{1, 2}, {2, 3}, {3, 4}, {1, 4}, {1, 3}}, Null}, {
      EdgeLabels -> {DirectedEdge[1, 4] -> Placed[
           Framed[
            Style[$CellContext`b, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[3, 4] -> Placed[
           Framed[
            Style[$CellContext`a, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[1, 3] -> Placed[
           Framed[
            Style[$CellContext`\[Epsilon], 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[2, 3] -> Placed[
           Framed[
            Style[$CellContext`c, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[1, 2] -> Placed[
           Framed[
            Style[$CellContext`d, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"]}, EdgeStyle -> {
         GrayLevel[0]}, 
       EdgeWeight -> {$CellContext`d, $CellContext`c, $CellContext`a, \
$CellContext`b, $CellContext`\[Epsilon]}, GraphLayout -> "LayeredEmbedding", 
       VertexCoordinates -> {{1, 1}, {0, 0}, {1, 0}, {2, 0}}, 
       VertexLabels -> {
        3 -> Placed["M", Center], 4 -> Placed["Y", Center], 2 -> 
         Placed["X", Center], 1 -> Placed["W", Center]}, 
       VertexLabelStyle -> {
         Directive[
          RGBColor[1, 0, 0], Italic, 26]}, VertexSize -> {0.3}, VertexStyle -> {
         GrayLevel[0]}, VertexWeight -> {
         Subscript[$CellContext`\[Sigma], $CellContext`uW], 
         Subscript[$CellContext`\[Sigma], $CellContext`uX], 
         Subscript[$CellContext`\[Sigma], $CellContext`uM], 
         Subscript[$CellContext`\[Sigma], $CellContext`uY]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {GrayLevel[0], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{1., 1.}, {0., 0.}}, 0.15], InsetBox[
          FrameBox[
           StyleBox["d",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 1.}, {1., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["\[Epsilon]",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1., 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 1.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["b",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{0., 0.}, {1., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["c",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 0.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["a",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{1., 1.}, 0.15], InsetBox[
          StyleBox["\<\"W\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 1.},
          BaseStyle->"Graphics"]}, {DiskBox[{0., 0.}, 0.15], InsetBox[
          StyleBox["\<\"X\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {0., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.15], InsetBox[
          StyleBox["\<\"M\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 0.}, 0.15], InsetBox[
          StyleBox["\<\"Y\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 0.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.8594603171460943`*^9, 3.859460386017805*^9}, {
   3.859460454785201*^9, 3.8594605998876123`*^9}, 3.8594606415257893`*^9, 
   3.859461268058887*^9, 3.859461543872567*^9, 3.859466284866777*^9, 
   3.859470279216584*^9, 3.859470394271792*^9, 3.85947042966777*^9, 
   3.859470494745961*^9, 3.859470536051578*^9, 3.859470585553668*^9, {
   3.859521734023562*^9, 3.859521753987259*^9}, 3.8595229955804377`*^9, 
   3.8595427752146187`*^9, 3.859546029888934*^9, 3.859557352486274*^9, 
   3.859557518895973*^9, 3.859557549725955*^9, 3.859558667544119*^9, 
   3.859591278099156*^9, 3.859591312709568*^9, {3.859591359015799*^9, 
   3.859591388708403*^9}, 3.8595915848026648`*^9, 3.859591708969687*^9, 
   3.85960777014734*^9, 3.859610027389793*^9, 3.859631367762354*^9, 
   3.8597012074244337`*^9, 3.859701238831704*^9, 3.859885020025416*^9, 
   3.859885166451066*^9, 3.85988534067631*^9, 3.859885565340048*^9, 
   3.859885599261207*^9, 3.859885664256173*^9, 3.859885861916664*^9, 
   3.859886104261126*^9, {3.8598862075558357`*^9, 3.859886253854308*^9}, 
   3.859886415104455*^9, 3.859887265987966*^9, 3.8598877621058617`*^9, 
   3.8598877943368883`*^9, 3.859887828331506*^9, 3.859967774529307*^9, 
   3.859980996384199*^9, 3.8600361395965853`*^9, 3.860150627811681*^9, 
   3.8602224868258743`*^9, 3.860222649614502*^9, 3.86022309117213*^9, 
   3.861254042574033*^9, 3.861750777581769*^9, 3.863856312811172*^9, 
   3.864116567098157*^9, 3.86487574173529*^9, 3.867905713758708*^9, 
   3.867905894815896*^9, 3.869114430960305*^9, 3.869114853653515*^9, 
   3.869114962877307*^9, 3.869226582652356*^9, 3.869292749096011*^9, 
   3.8693056336217337`*^9, 3.869309811083144*^9, 3.8695265880344963`*^9, 
   3.86956377514878*^9, 3.8696924055567293`*^9, 3.871566525321385*^9, 
   3.87224683393956*^9},
 CellLabel->
  "Out[237]=",ExpressionUUID->"284ea8e7-2bb8-4754-b6c5-fc80010d1403"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eweightlookup", "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"ArrayRules", "@", 
      RowBox[{"UpperTriangularize", "@", 
       RowBox[{"WeightedAdjacencyMatrix", "[", "causalgraphcm", "]"}]}]}]}], 
    ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8594606713535023`*^9, 3.859460687989484*^9}, {
  3.859460757668127*^9, 3.8594607600893993`*^9}, {3.859461892329628*^9, 
  3.859461896820756*^9}, {3.859461939972322*^9, 3.859461952336578*^9}, {
  3.85959134581249*^9, 3.8595913458676977`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[238]:=",ExpressionUUID->"02668223-e9f6-419f-bdf9-4d8f613dc8fb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "2"}], "\[Rule]", "d"}], ",", 
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "4"}], "\[Rule]", "b"}], ",", 
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "3"}], "\[Rule]", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"2", "\[DirectedEdge]", "3"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"3", "\[DirectedEdge]", "4"}], "\[Rule]", "a"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591313069002*^9, 
   3.859591359276739*^9, 3.859591394007164*^9, 3.859591584820829*^9, 
   3.859591708977866*^9, 3.8596077701534157`*^9, 3.8596100273978577`*^9, 
   3.8596313677717524`*^9, 3.859701207482258*^9, 3.859701238853579*^9, 
   3.859885020056724*^9, 3.859885166459116*^9, 3.8598853406844263`*^9, 
   3.8598855653471327`*^9, 3.8598855992688427`*^9, 3.859885664263939*^9, 
   3.859885861923909*^9, 3.859886104268804*^9, {3.8598862075637407`*^9, 
   3.859886253862501*^9}, 3.859886415113274*^9, 3.8598872659976*^9, 
   3.859887762115253*^9, 3.859887794346856*^9, 3.8598878283404713`*^9, 
   3.859967774535819*^9, 3.859980996397859*^9, 3.8600361396149063`*^9, 
   3.8601506278258142`*^9, 3.860222486832569*^9, 3.860222649621842*^9, 
   3.860223091179274*^9, 3.8612540734485893`*^9, 3.861750777600848*^9, 
   3.8638563128221292`*^9, 3.864116569569106*^9, 3.8648757417484303`*^9, 
   3.867905713795025*^9, 3.867905898285527*^9, 3.869114430971211*^9, 
   3.869114855462866*^9, 3.869114962893188*^9, 3.869226582672536*^9, 
   3.869292749111846*^9, 3.8693056336359262`*^9, 3.8693098110981894`*^9, 
   3.869526588045249*^9, 3.8695637751859627`*^9, 3.869692405574154*^9, 
   3.8715665253579483`*^9, 3.872246833951943*^9},
 CellLabel->
  "Out[238]=",ExpressionUUID->"a4163e44-5b02-4da1-ac1b-fb6839a6caa0"]
}, Open  ]],

Cell[TextData[{
 "Now we can apply this! Say we want to evaluate the expectation value \
E[ux*um | X,M]. First, we need to calculate the joint covariance between all \
four variables.",
 StyleBox["\n",
  FontColor->GrayLevel[0]]
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
   3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
   3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
   3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
   3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
   3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
   3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
   3.858337999684861*^9}, {3.858338318328642*^9, 3.858338330985588*^9}, {
   3.858338386385976*^9, 3.858338403783554*^9}, {3.858338535213355*^9, 
   3.858338577034197*^9}, {3.858338652546804*^9, 3.8583386617161016`*^9}, {
   3.858338759635105*^9, 3.858338795923196*^9}, {3.858338841585185*^9, 
   3.858338916581684*^9}, {3.858339075022015*^9, 3.8583390813359327`*^9}, {
   3.858346827071652*^9, 3.85834682807152*^9}, {3.8595435455848227`*^9, 
   3.859543581806551*^9}, 
   3.8595439831394987`*^9},ExpressionUUID->"87ee5079-490b-4ee6-929e-\
e462586d68cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphcm", "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"allvariances", "=", 
   RowBox[{"GraphNodeVariance", "[", "causalgraphcm", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"causalgraphcm", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Sig", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphcm", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondVar", "[", 
   RowBox[{"causalgraphcm", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.859543456025009*^9, 3.859543464098876*^9}, {
  3.859544443127898*^9, 3.859544505923212*^9}, {3.859544613314905*^9, 
  3.859544614650338*^9}, {3.859544910325439*^9, 3.859544963556361*^9}, {
  3.859545083488456*^9, 3.859545127921324*^9}, {3.8595451601353827`*^9, 
  3.859545237085483*^9}, {3.8595452722968693`*^9, 3.859545273539131*^9}, {
  3.859545457472375*^9, 3.859545516603259*^9}, {3.859549232610675*^9, 
  3.859549252973567*^9}, {3.8595915589354477`*^9, 3.8595915663511972`*^9}, {
  3.864118320826148*^9, 3.864118331584223*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"55d07a13-42d6-4fd1-be0b-ffc79023da17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"W", "\[Rule]", "uW"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.8648757417599077`*^9, 
   3.8679057138313437`*^9, 3.867905900376814*^9, 3.869114430981435*^9, 
   3.869114857306285*^9, 3.869114962907586*^9, 3.869226582690007*^9, 
   3.8692927491264277`*^9, 3.8693056336503057`*^9, 3.869309811112855*^9, 
   3.8695265880544863`*^9, 3.8695637752125807`*^9, 3.869692405590303*^9, 
   3.87156652540061*^9, 3.872246833964859*^9},
 CellLabel->
  "Out[239]=",ExpressionUUID->"51f281f6-49df-4d7e-be3f-12b1f3a98e8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "W", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "X", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
     RowBox[{"d", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "M", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{"\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}], "+", 
     RowBox[{"c", " ", 
      SubsuperscriptBox["\[Sigma]", "X", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "Y", "2"], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", 
      SubsuperscriptBox["\[Sigma]", "M", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uY", "2"], "+", 
     RowBox[{"b", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.8648757417599077`*^9, 
   3.8679057138313437`*^9, 3.867905900376814*^9, 3.869114430981435*^9, 
   3.869114857306285*^9, 3.869114962907586*^9, 3.869226582690007*^9, 
   3.8692927491264277`*^9, 3.8693056336503057`*^9, 3.869309811112855*^9, 
   3.8695265880544863`*^9, 3.8695637752125807`*^9, 3.869692405590303*^9, 
   3.87156652540061*^9, 3.872246833966395*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"611fe19a-a27e-4173-8eed-bed3489aeed0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]},
     {"0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]},
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]},
     {
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"2", " ", "c", " ", "d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.8648757417599077`*^9, 
   3.8679057138313437`*^9, 3.867905900376814*^9, 3.869114430981435*^9, 
   3.869114857306285*^9, 3.869114962907586*^9, 3.869226582690007*^9, 
   3.8692927491264277`*^9, 3.8693056336503057`*^9, 3.869309811112855*^9, 
   3.8695265880544863`*^9, 3.8695637752125807`*^9, 3.869692405590303*^9, 
   3.87156652540061*^9, 3.8722468339679832`*^9},
 CellLabel->
  "Out[242]//MatrixForm=",ExpressionUUID->"ade0b7c0-501d-43f0-b7c1-\
3a7c6dd7c573"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", "M"}], "+", 
              RowBox[{"c", " ", "d", " ", "X"}], "+", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]},
      {
       FractionBox[
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"M", "-", 
                 RowBox[{"c", " ", "X"}]}], ")"}]}], "-", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M", "-", 
              RowBox[{"c", " ", "X"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.8648757417599077`*^9, 
   3.8679057138313437`*^9, 3.867905900376814*^9, 3.869114430981435*^9, 
   3.869114857306285*^9, 3.869114962907586*^9, 3.869226582690007*^9, 
   3.8692927491264277`*^9, 3.8693056336503057`*^9, 3.869309811112855*^9, 
   3.8695265880544863`*^9, 3.8695637752125807`*^9, 3.869692405590303*^9, 
   3.87156652540061*^9, 3.87224683397894*^9},
 CellLabel->
  "Out[243]//MatrixForm=",ExpressionUUID->"ee2a4b6d-47ef-41b6-8709-\
7d677eed76f2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]},
     {
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.8648757417599077`*^9, 
   3.8679057138313437`*^9, 3.867905900376814*^9, 3.869114430981435*^9, 
   3.869114857306285*^9, 3.869114962907586*^9, 3.869226582690007*^9, 
   3.8692927491264277`*^9, 3.8693056336503057`*^9, 3.869309811112855*^9, 
   3.8695265880544863`*^9, 3.8695637752125807`*^9, 3.869692405590303*^9, 
   3.87156652540061*^9, 3.872246833988845*^9},
 CellLabel->
  "Out[244]//MatrixForm=",ExpressionUUID->"d56c66d8-109f-4d35-b49a-\
c58bc2d7db7f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CharacteristicPolynomial", "[", 
   RowBox[{"Sig", ",", "x"}], "]"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.8596098299897203`*^9, 3.859609945111977*^9}, 
   3.859609976972699*^9},
 CellLabel->
  "In[245]:=",ExpressionUUID->"b8c8e021-7746-41bf-86fe-2a103b0de24d"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["x", "3"], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
    RowBox[{"2", " ", "c", " ", "d", " ", 
     SuperscriptBox["x", "2"], " ", "\[Epsilon]", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox["d", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
    RowBox[{"2", " ", "c", " ", "d", " ", "x", " ", "\[Epsilon]", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
    RowBox[{"x", " ", 
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"4", " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox["d", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"2", " ", "c", " ", "d", " ", "x", " ", "\[Epsilon]", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"2", " ", "x", " ", 
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox["d", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{"2", " ", "c", " ", "d", " ", "\[Epsilon]", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.859609843520874*^9, 3.859609855048254*^9}, {
   3.859609889687147*^9, 3.859609945404512*^9}, 3.859609977439784*^9, 
   3.8596100274509497`*^9, 3.859631367844215*^9, 3.859701207599634*^9, 
   3.859701238974517*^9, 3.8598850201147823`*^9, 3.85988516651187*^9, 
   3.8598853407384567`*^9, 3.859885565395042*^9, 3.859885599320858*^9, 
   3.859885664314855*^9, 3.859885861974718*^9, 3.859886104319315*^9, {
   3.859886207614677*^9, 3.859886253915251*^9}, 3.8598864151713333`*^9, 
   3.8598872660601788`*^9, 3.859887762173218*^9, 3.85988779440408*^9, 
   3.859887828399729*^9, 3.8599677745842867`*^9, 3.859980996445022*^9, 
   3.860036139685253*^9, 3.860150627874468*^9, 3.8602224868734283`*^9, 
   3.860222649663681*^9, 3.8602230912187862`*^9, 3.861750777649396*^9, 
   3.8638563128639708`*^9, 3.864116573465136*^9, 3.864875741788189*^9, 
   3.8679057139911747`*^9, 3.869114431015891*^9, 3.869114861695891*^9, 
   3.8691149629497643`*^9, 3.869226582752425*^9, 3.86929274916529*^9, 
   3.869305633688773*^9, 3.869309811152519*^9, 3.869526588088407*^9, 
   3.86956377527273*^9, 3.8696924056299667`*^9, 3.871566525541053*^9, 
   3.8722468340033216`*^9},
 CellLabel->
  "Out[245]=",ExpressionUUID->"9169e82c-1ced-466a-9d5d-4a53f3784320"]
}, Open  ]],

Cell[TextData[{
 "Extending our causal graph to have a dependency W\[Rule]M, linearly \
controlled by \[Epsilon], modifies the structural equations as follows:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "f6cf9f27-a603-4c8b-858f-713dc3040526"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "356301d2-79ca-4e0f-ab85-4f9563bf7efd"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "1109e4d2-c25f-4bc8-bd40-703cb6c89217"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "72946daa-199e-46c2-b570-cb687912cbe7"],
 ".\n\nApplying the standard FDC is not technically permitted, because node X \
no longer blocks all backdoor paths from M to Y; however, since W is \
unobserved, it cannot be a member of the FDC set. Since the intention is to \
evaluate error from violating this very assumption, we apply the FDC with \
{X,M} regardless, and obtain estimators as follows:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "356e6f27-ee8c-4cf2-9273-a586c4256adc"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      FractionBox["b", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "b"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "m"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "02e782fc-bc65-442b-8456-4492a05cab54"],
 ".\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 
   3.858325388127117*^9}},ExpressionUUID->"d5b40735-65a5-4ecb-91fe-\
fd3f33181d33"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"M", ",", "X"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["aplusedivb", "^"], ",", 
     OverscriptBox["bdivd", "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "M", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["cplusedivd", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.858324779349805*^9, 3.8583247888458023`*^9}, {
   3.8583253078292217`*^9, 3.858325314837751*^9}, {3.858325396607929*^9, 
   3.85832542701947*^9}, {3.860036107824605*^9, 3.860036115763649*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"2017e8dd-40a9-481b-bdd2-032db35785c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.864116577398624*^9, 3.864117114340075*^9, 3.864875741800159*^9, 
   3.8679057140292797`*^9, 3.8679059046615353`*^9, 3.869114431026194*^9, 
   3.8691148640981417`*^9, 3.8691149629649563`*^9, 3.869226582771634*^9, 
   3.8692927491808147`*^9, 3.869305633704115*^9, 3.8693098111674633`*^9, 
   3.869526588110606*^9, 3.869563775295917*^9, 3.869692405646686*^9, 
   3.8715665255771646`*^9, 3.8722468340150623`*^9},
 CellLabel->
  "Out[248]=",ExpressionUUID->"62b412ea-854d-477c-8c49-f842e3f91587"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.864116577398624*^9, 3.864117114340075*^9, 3.864875741800159*^9, 
   3.8679057140292797`*^9, 3.8679059046615353`*^9, 3.869114431026194*^9, 
   3.8691148640981417`*^9, 3.8691149629649563`*^9, 3.869226582771634*^9, 
   3.8692927491808147`*^9, 3.869305633704115*^9, 3.8693098111674633`*^9, 
   3.869526588110606*^9, 3.869563775295917*^9, 3.869692405646686*^9, 
   3.8715665255771646`*^9, 3.872246834016391*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"ac1924fc-5ff0-41b2-b6db-f28fb78e46b5"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aplusedivb", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy0sowwEAx/ERaR6LMs08Spm52Mu/WUL+cpgx72Km5pk8ssMKmVdrxLYD
EtHYSTmSSXmGA0PSGu0ikYPHPy2y5hH+v//h2+f0TWnSV7YGs1isJDrYYtzy
Z+xTJDETGYClvM5gEW2f3Me4tFwRA22x03FwyJQlhNXKqHTI+eyWwZ8/LgEj
DvOy4X3HHMn8ZTXF8In/VgaPDKp1Ca166sUJqWjvLlSYv4+h2bBwAd2p79eQ
aJb7Yduv6xd6rY5QKW24y82Ypzljw215BQcujF/Fwsm6oHjoq9dJoTGwQ8DS
ovYCGHU3pIT9G2QJ5Ie1lcOGvZwJqDoR2+Dn4/49tHhuH2DI/M4zXNl0vkJn
rp4tox2WLjK+rcky4Ko4n9GWKWKPHFCk44MbA9OrahOhQK1NhnwNJYC1Sq0Q
Xhb6B0dpI3h2E+w61/HGaAcoezzs7UkQzNLKJOdp0PO1a1GcUuRm440V/gN9
lur+
  "],
 CellLabel->
  "In[252]:=",ExpressionUUID->"876dffc5-ba07-4858-9653-93e0f4ba8f25"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphcm", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
  RowBox[{
   RowBox[{"TensorExpand", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}],
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
   3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
   3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
   3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
   3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
   3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
   3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
   3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
   3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
   3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
   3.860036875204605*^9}, 3.869309766608726*^9, {3.8695266060247383`*^9, 
   3.869526628979938*^9}},
 CellLabel->
  "In[254]:=",ExpressionUUID->"dcf53729-6479-494e-b016-52d932c6f5e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, 3.869309767437174*^9, 
   3.869309811191708*^9, {3.8695265881263227`*^9, 3.869526629478321*^9}, 
   3.869563775327162*^9, 3.86969240566711*^9, 3.871566525649108*^9, 
   3.8722468340295687`*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"baad8935-0836-446c-9810-69b7e0517213"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"M", "-", 
             RowBox[{"c", " ", "X"}]}], ")"}]}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, 3.869309767437174*^9, 
   3.869309811191708*^9, {3.8695265881263227`*^9, 3.869526629478321*^9}, 
   3.869563775327162*^9, 3.86969240566711*^9, 3.871566525649108*^9, 
   3.872246834040806*^9},
 CellLabel->
  "Out[256]=",ExpressionUUID->"d373ba30-5f4e-4757-8339-9618e388e905"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"M", "-", 
              RowBox[{"c", " ", "X"}]}], ")"}]}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, 3.869309767437174*^9, 
   3.869309811191708*^9, {3.8695265881263227`*^9, 3.869526629478321*^9}, 
   3.869563775327162*^9, 3.86969240566711*^9, 3.871566525649108*^9, 
   3.872246834042877*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"31ca83d2-6bc8-492f-a970-7d6cfea276d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "-", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}]}]], "-", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, 3.869309767437174*^9, 
   3.869309811191708*^9, {3.8695265881263227`*^9, 3.869526629478321*^9}, 
   3.869563775327162*^9, 3.86969240566711*^9, 3.871566525649108*^9, 
   3.872246834402302*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"d3498a18-205b-4d2c-bd64-3f49f46d4f1b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, 3.869309767437174*^9, 
   3.869309811191708*^9, {3.8695265881263227`*^9, 3.869526629478321*^9}, 
   3.869563775327162*^9, 3.86969240566711*^9, 3.871566525649108*^9, 
   3.872246834772687*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"d11d1cce-ac85-4b70-a582-2844043fbe06"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.863856380066532*^9, 3.8638563950769453`*^9}, {
  3.8641165213663473`*^9, 3.8641165231740637`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"8d7ce9c7-4bd8-4e43-b9e3-596e268d13ad"],

Cell[BoxData["0.2222222222222222`"], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.864875742205983*^9, 
   3.867905715127293*^9, 3.8679059098399754`*^9, 3.8691144314287853`*^9, 
   3.869114963468628*^9, 3.86922658340546*^9, 3.869292749605777*^9, 
   3.869305634127384*^9, 3.869309811594751*^9, 3.869526588512285*^9, 
   3.8695637765457487`*^9, 3.8696924064695044`*^9, 3.8715665276978493`*^9, 
   3.872246834791224*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"65eead37-af0b-47d0-a37a-54ba2a1ddf34"],

Cell[BoxData["0.04975124378109454`"], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.864875742205983*^9, 
   3.867905715127293*^9, 3.8679059098399754`*^9, 3.8691144314287853`*^9, 
   3.869114963468628*^9, 3.86922658340546*^9, 3.869292749605777*^9, 
   3.869305634127384*^9, 3.869309811594751*^9, 3.869526588512285*^9, 
   3.8695637765457487`*^9, 3.8696924064695044`*^9, 3.8715665276978493`*^9, 
   3.872246834792807*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"3493b1ce-1350-47e4-aee5-f16fbd32c276"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"b", " ", "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "-", 
    FractionBox["b", "\[Epsilon]"]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], "}"}],
           "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8612536672031307`*^9, 3.8612536799745626`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"c9bde5ab-5dd2-468a-90b4-e0bf94bbf79a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["b", "\[Epsilon]"]}], "+", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.8612536806018353`*^9, 3.861254086272423*^9, 
  3.86385631329045*^9, 3.8648757422186127`*^9, 3.867905715165472*^9, 
  3.8679059135913477`*^9, 3.869114431439637*^9, 3.8691149634841843`*^9, 
  3.869226583426828*^9, 3.8692927496234903`*^9, 3.869305634145587*^9, 
  3.8693098116143417`*^9, 3.869526588525016*^9, 3.86956377657377*^9, 
  3.869692406488463*^9, 3.871566527748557*^9, 3.872246834804956*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"7c71d9a3-8f83-4124-a60b-6ad75500ba13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<X\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphcm", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<M\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8638671588478518`*^9, 3.863867216342785*^9}, {
  3.863867261316597*^9, 3.8638672618028812`*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"32578c67-7a8e-4ec3-8df5-126e0195d90c"],

Cell[BoxData[
 RowBox[{"{", "X", "}"}]], "Output",
 CellChangeTimes->{{3.863867170909947*^9, 3.863867216650784*^9}, 
   3.863867262517476*^9, 3.864875742230568*^9, 3.867905715209951*^9, 
   3.867905916304337*^9, 3.8691144314498158`*^9, 3.8691149634992228`*^9, 
   3.869226583448062*^9, 3.869292749639168*^9, 3.869305634159811*^9, 
   3.8693098116295633`*^9, 3.869526588536592*^9, 3.869563776599496*^9, 
   3.869692406506352*^9, 3.871566527792054*^9, 3.8722468348181963`*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"71bce419-7365-4b08-bbe6-2e98007e3e27"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"X", "\[Rule]", 
   FractionBox[
    RowBox[{"M", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.863867170909947*^9, 3.863867216650784*^9}, 
   3.863867262517476*^9, 3.864875742230568*^9, 3.867905715209951*^9, 
   3.867905916304337*^9, 3.8691144314498158`*^9, 3.8691149634992228`*^9, 
   3.869226583448062*^9, 3.869292749639168*^9, 3.869305634159811*^9, 
   3.8693098116295633`*^9, 3.869526588536592*^9, 3.869563776599496*^9, 
   3.869692406506352*^9, 3.871566527792054*^9, 3.872246834819808*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"aa9da237-59f3-464d-b948-c48e685091a8"],

Cell[BoxData[
 TemplateBox[{
  "Power", "infy", 
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0\\\"]\\) \
encountered.\"", 2, 267, 9, 21942966268712677875, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.869114431603101*^9, 3.869114963658313*^9, 
  3.869226583682684*^9, 3.869292749781898*^9, 3.869305634305519*^9, 
  3.869309811775465*^9, 3.8695265886909037`*^9, 3.869563776829214*^9, 
  3.8696924066660357`*^9, 3.8715665281538563`*^9, 3.872246834970152*^9},
 CellLabel->
  "During evaluation of \
In[263]:=",ExpressionUUID->"3d3d1619-e608-45da-aeb4-77e89cc3ba8f"],

Cell[BoxData["ComplexInfinity"], "Output",
 CellChangeTimes->{{3.863867170909947*^9, 3.863867216650784*^9}, 
   3.863867262517476*^9, 3.864875742230568*^9, 3.867905715209951*^9, 
   3.867905916304337*^9, 3.8691144314498158`*^9, 3.8691149634992228`*^9, 
   3.869226583448062*^9, 3.869292749639168*^9, 3.869305634159811*^9, 
   3.8693098116295633`*^9, 3.869526588536592*^9, 3.869563776599496*^9, 
   3.869692406506352*^9, 3.871566527792054*^9, 3.872246834974881*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"fab9ea30-56a3-4f12-983c-b8f313ae8617"]
}, Open  ]],

Cell["Similarly for c:", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 
  3.85833817346621*^9}},ExpressionUUID->"9073d606-5392-4317-b5db-\
82e56e4e9fe2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "\[Rule]", 
      RowBox[{
       RowBox[{"c", "*", "X"}], "+", 
       RowBox[{"\[Epsilon]", "*", "W"}], "+", "uM"}]}], ",", " ", 
     RowBox[{"W", "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["cplusedivd", "^"], "-", "c"}], "//.", "structureEqs"}], "//",
    "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uM\>\"", ",", "\"\<uX\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noises", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphcm", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanreplace", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"noises", ",", "condmeans"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "/.", "condmeanreplace"}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338267786409*^9}, {
   3.859558614011969*^9, 3.859558647788122*^9}, {3.85955879728541*^9, 
   3.859558823382238*^9}, {3.8595588600651493`*^9, 3.859558869104723*^9}, {
   3.859558901600066*^9, 3.8595589122563334`*^9}, {3.860036194108721*^9, 
   3.86003619421777*^9}, {3.860036883849634*^9, 3.860036883936343*^9}, 
   3.860038282842125*^9, {3.860038533209559*^9, 3.8600385704905977`*^9}, {
   3.861253286929769*^9, 3.861253287988051*^9}, {3.8612540943031816`*^9, 
   3.861254105159108*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"e313791c-1647-4ce2-bb22-fc3bb1a2f732"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "uX"}], "+", "X"}], ")"}], " ", "\[Epsilon]"}], "d"]}],
      ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.85959131545763*^9, 3.859591359351385*^9, 3.859591584932322*^9, 
   3.859591709078452*^9, 3.859607770232106*^9, 3.859610027512891*^9, 
   3.85963136796106*^9, 3.859701207722165*^9, 3.859701239097814*^9, 
   3.8598850201698923`*^9, 3.859885166568738*^9, 3.859885340795495*^9, 
   3.859885565449551*^9, 3.859885599377165*^9, 3.859885664369411*^9, 
   3.85988586202808*^9, 3.85988610437422*^9, {3.859886207669685*^9, 
   3.859886253969054*^9}, 3.859886415232485*^9, 3.859887266126856*^9, 
   3.859887762238892*^9, 3.859887794466033*^9, 3.859887828468302*^9, 
   3.8599677746291122`*^9, 3.859980996491336*^9, 3.8600361404766293`*^9, 
   3.860036195497006*^9, 3.8600368848132467`*^9, 3.860038284147812*^9, {
   3.860038556092149*^9, 3.860038571466565*^9}, 3.860150628371627*^9, 
   3.860222487301791*^9, 3.8602226500932217`*^9, 3.860223091652135*^9, 
   3.86125397216308*^9, {3.861254088259173*^9, 3.861254105574132*^9}, 
   3.863856313300393*^9, 3.864875742399173*^9, 3.867905715662628*^9, 
   3.8679059192114973`*^9, 3.869114431630267*^9, 3.8691148476143913`*^9, 
   3.86911496370566*^9, 3.869226583709778*^9, 3.869292749804196*^9, 
   3.869305634327009*^9, 3.8693098117981243`*^9, 3.8695265887071877`*^9, 
   3.8695637768645363`*^9, 3.869692406687716*^9, 3.871566528222389*^9, 
   3.872246834988316*^9},
 CellLabel->
  "Out[269]=",ExpressionUUID->"9b869fe7-17ee-4ac1-8176-d468edbc4a7a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "X"}], "+", 
      FractionBox[
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{"X", "-", 
          FractionBox[
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ")"}]}], "d"]}], 
     ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.85959131545763*^9, 3.859591359351385*^9, 3.859591584932322*^9, 
   3.859591709078452*^9, 3.859607770232106*^9, 3.859610027512891*^9, 
   3.85963136796106*^9, 3.859701207722165*^9, 3.859701239097814*^9, 
   3.8598850201698923`*^9, 3.859885166568738*^9, 3.859885340795495*^9, 
   3.859885565449551*^9, 3.859885599377165*^9, 3.859885664369411*^9, 
   3.85988586202808*^9, 3.85988610437422*^9, {3.859886207669685*^9, 
   3.859886253969054*^9}, 3.859886415232485*^9, 3.859887266126856*^9, 
   3.859887762238892*^9, 3.859887794466033*^9, 3.859887828468302*^9, 
   3.8599677746291122`*^9, 3.859980996491336*^9, 3.8600361404766293`*^9, 
   3.860036195497006*^9, 3.8600368848132467`*^9, 3.860038284147812*^9, {
   3.860038556092149*^9, 3.860038571466565*^9}, 3.860150628371627*^9, 
   3.860222487301791*^9, 3.8602226500932217`*^9, 3.860223091652135*^9, 
   3.86125397216308*^9, {3.861254088259173*^9, 3.861254105574132*^9}, 
   3.863856313300393*^9, 3.864875742399173*^9, 3.867905715662628*^9, 
   3.8679059192114973`*^9, 3.869114431630267*^9, 3.8691148476143913`*^9, 
   3.86911496370566*^9, 3.869226583709778*^9, 3.869292749804196*^9, 
   3.869305634327009*^9, 3.8693098117981243`*^9, 3.8695265887071877`*^9, 
   3.8695637768645363`*^9, 3.869692406687716*^9, 3.871566528222389*^9, 
   3.872246834989769*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"e365b123-0d37-4696-a6cd-a5fafe28f1a8"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.85959131545763*^9, 3.859591359351385*^9, 3.859591584932322*^9, 
   3.859591709078452*^9, 3.859607770232106*^9, 3.859610027512891*^9, 
   3.85963136796106*^9, 3.859701207722165*^9, 3.859701239097814*^9, 
   3.8598850201698923`*^9, 3.859885166568738*^9, 3.859885340795495*^9, 
   3.859885565449551*^9, 3.859885599377165*^9, 3.859885664369411*^9, 
   3.85988586202808*^9, 3.85988610437422*^9, {3.859886207669685*^9, 
   3.859886253969054*^9}, 3.859886415232485*^9, 3.859887266126856*^9, 
   3.859887762238892*^9, 3.859887794466033*^9, 3.859887828468302*^9, 
   3.8599677746291122`*^9, 3.859980996491336*^9, 3.8600361404766293`*^9, 
   3.860036195497006*^9, 3.8600368848132467`*^9, 3.860038284147812*^9, {
   3.860038556092149*^9, 3.860038571466565*^9}, 3.860150628371627*^9, 
   3.860222487301791*^9, 3.8602226500932217`*^9, 3.860223091652135*^9, 
   3.86125397216308*^9, {3.861254088259173*^9, 3.861254105574132*^9}, 
   3.863856313300393*^9, 3.864875742399173*^9, 3.867905715662628*^9, 
   3.8679059192114973`*^9, 3.869114431630267*^9, 3.8691148476143913`*^9, 
   3.86911496370566*^9, 3.869226583709778*^9, 3.869292749804196*^9, 
   3.869305634327009*^9, 3.8693098117981243`*^9, 3.8695265887071877`*^9, 
   3.8695637768645363`*^9, 3.869692406687716*^9, 3.871566528222389*^9, 
   3.872246834991021*^9},
 CellLabel->
  "Out[275]=",ExpressionUUID->"9bc5de82-97be-48e9-b22e-c49caf3a74cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"cerrorsimpg", " ", "=", " ", 
  RowBox[{"cerrorsimp", "/.", 
   RowBox[{"{", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox["g", "2"], 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimpg", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "1"}], ",", 
    RowBox[{"g", "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uV", "2"], "->", "1"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.8638563392567997`*^9, 3.863856368808345*^9}, {
  3.869114391749621*^9, 3.869114392227377*^9}, {3.869114813231819*^9, 
  3.869114838496749*^9}, {3.869114971623494*^9, 3.86911497924542*^9}},
 CellLabel->
  "In[276]:=",ExpressionUUID->"2df0c537-405b-4ac1-bf85-34d82783797f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]], "Output",
 CellChangeTimes->{{3.863856363167431*^9, 3.8638563692670603`*^9}, 
   3.8648757424124603`*^9, 3.867905715698003*^9, 3.867905921941718*^9, 
   3.869114431642314*^9, 3.869114844341508*^9, {3.869114963723063*^9, 
   3.869114979622951*^9}, 3.869226583729652*^9, 3.8692927498248663`*^9, 
   3.869305634347809*^9, 3.869309811820033*^9, 3.869526588712542*^9, 
   3.869563776894319*^9, 3.869692406707334*^9, 3.871566528272437*^9, 
   3.872246835002008*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"a22da0d9-c7e1-417b-834e-b30685731083"],

Cell[BoxData[
 FractionBox["1", "3"]], "Output",
 CellChangeTimes->{{3.863856363167431*^9, 3.8638563692670603`*^9}, 
   3.8648757424124603`*^9, 3.867905715698003*^9, 3.867905921941718*^9, 
   3.869114431642314*^9, 3.869114844341508*^9, {3.869114963723063*^9, 
   3.869114979622951*^9}, 3.869226583729652*^9, 3.8692927498248663`*^9, 
   3.869305634347809*^9, 3.869309811820033*^9, 3.869526588712542*^9, 
   3.869563776894319*^9, 3.869692406707334*^9, 3.871566528272437*^9, 
   3.872246835003345*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"dd491d17-e077-49c3-bc7d-aa974b58e72b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimate", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "*", "cerror"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimatesimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"covestimate", "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
             "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
     "Simplify"}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.8595579821985483`*^9, 3.859558061814584*^9}, {
  3.859558655476707*^9, 3.859558658433288*^9}, {3.8595590766617002`*^9, 
  3.859559108103771*^9}, {3.860036889983594*^9, 3.860036890328168*^9}, {
  3.860037064690646*^9, 3.860037079570932*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"7dc41a57-323d-434c-9b3e-2fa312e923fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.864875742424205*^9, 
   3.867905715734292*^9, 3.86790592378992*^9, 3.869114431651539*^9, 
   3.869114963737966*^9, 3.869226583757164*^9, 3.869292749842547*^9, 
   3.86930563437047*^9, 3.869309811838871*^9, 3.8695265887244473`*^9, 
   3.8695637769249477`*^9, 3.869692406726201*^9, 3.871566528326294*^9, 
   3.8722468350167227`*^9},
 CellLabel->
  "Out[280]=",ExpressionUUID->"3ada4ffe-9fdb-4b83-b508-04744ea82b3c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{"M", "-", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.864875742424205*^9, 
   3.867905715734292*^9, 3.86790592378992*^9, 3.869114431651539*^9, 
   3.869114963737966*^9, 3.869226583757164*^9, 3.869292749842547*^9, 
   3.86930563437047*^9, 3.869309811838871*^9, 3.8695265887244473`*^9, 
   3.8695637769249477`*^9, 3.869692406726201*^9, 3.871566528326294*^9, 
   3.8722468350182753`*^9},
 CellLabel->
  "Out[282]=",ExpressionUUID->"686d871f-25ae-477b-830e-a705d9bafc0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "a"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"M", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          FractionBox[
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}], " ", 
       
       RowBox[{"X", ".", "X"}]}], "-", 
      RowBox[{
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"X", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          FractionBox[
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "uX"}], "+", "X"}], ")"}]}], "d"]}], ")"}]}]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "c"}], "+", 
    FractionBox[
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"uM", "+", 
        RowBox[{"c", " ", "X"}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "uX"}], "+", "X"}], ")"}], " ", "\[Epsilon]"}], 
         "d"]}], ")"}]}], 
     RowBox[{"X", ".", "X"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.864875742424205*^9, 
   3.867905715734292*^9, 3.86790592378992*^9, 3.869114431651539*^9, 
   3.869114963737966*^9, 3.869226583757164*^9, 3.869292749842547*^9, 
   3.86930563437047*^9, 3.869309811838871*^9, 3.8695265887244473`*^9, 
   3.8695637769249477`*^9, 3.869692406726201*^9, 3.871566528326294*^9, 
   3.872246835019824*^9},
 CellLabel->
  "Out[283]=",ExpressionUUID->"fa7f2565-4547-4f37-a4e2-1d228ffe9224"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"b", " ", 
     RowBox[{"M", ".", "uX"}], " ", 
     RowBox[{"X", ".", "uM"}]}], 
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"M", ".", "X"}]}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"X", ".", "X"}]}]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"M", ".", "uY"}], " ", 
    RowBox[{"X", ".", "uM"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}]}]], "+", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    RowBox[{"M", ".", "uX"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"M", ".", "uY"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "uY"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"b", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"X", ".", "uX"}], ")"}], "2"]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", "uY"}]}], 
   RowBox[{
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "uX"}], " ", 
    RowBox[{"X", ".", "uY"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    RowBox[{"M", ".", "uX"}], " ", 
    RowBox[{"X", ".", "X"}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"M", ".", "uY"}], " ", 
    RowBox[{"X", ".", "X"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"M", ".", "X"}]}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.864875742424205*^9, 
   3.867905715734292*^9, 3.86790592378992*^9, 3.869114431651539*^9, 
   3.869114963737966*^9, 3.869226583757164*^9, 3.869292749842547*^9, 
   3.86930563437047*^9, 3.869309811838871*^9, 3.8695265887244473`*^9, 
   3.8695637769249477`*^9, 3.869692406726201*^9, 3.871566528326294*^9, 
   3.87224683808295*^9},
 CellLabel->
  "Out[284]=",ExpressionUUID->"c93bf409-d5dc-4bc0-a5f1-fab96b25ff9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"R", ",", "X"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ya", " ", "=", " ", 
   RowBox[{"{", "y", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    OverscriptBox["a", "^"], ",", 
    OverscriptBox["bdivd", "^"]}], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Ya", ",", "Xa"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.864875689558272*^9, 3.864875706220563*^9}, {
  3.8648757501542473`*^9, 3.8648757563861837`*^9}, {3.864876854197703*^9, 
  3.8648768682536697`*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"02bf7984-3dda-4401-ad14-780f27874596"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"R", ".", "y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"R", ".", "X"}], " ", 
      RowBox[{"X", ".", "y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"R", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "R"}]}], "+", 
     RowBox[{
      RowBox[{"R", ".", "R"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"R", ".", "y"}], " ", 
      RowBox[{"X", ".", "R"}]}], "-", 
     RowBox[{
      RowBox[{"R", ".", "R"}], " ", 
      RowBox[{"X", ".", "y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"R", ".", "X"}], " ", 
      RowBox[{"X", ".", "R"}]}], "-", 
     RowBox[{
      RowBox[{"R", ".", "R"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8648756979315777`*^9, 3.864875706572605*^9}, 
   3.864875745620558*^9, {3.864876840501852*^9, 3.864876868431744*^9}, 
   3.867905722906714*^9, 3.867905927910281*^9, 3.869114434755764*^9, 
   3.869114967503859*^9, 3.869226588476118*^9, 3.869292753977103*^9, 
   3.869305638431818*^9, 3.869309815804781*^9, 3.869563783204612*^9, 
   3.8696924098873863`*^9, 3.8715665356048107`*^9, 3.872246838102749*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"9e22520f-eacd-4f84-9918-7cbffdaea045"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"covRX", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], "*", 
     RowBox[{"X", ".", "uX"}]}], " ", "+", " ", 
    FractionBox[
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "uX"}]}], 
     RowBox[{"X", ".", "X"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<M\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphcm", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<uX\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covRXsimp", "=", 
  RowBox[{"covRX", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covRXsimp2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"covRXsimp", "//", 
      RowBox[{
       RowBox[{"TensorExpand", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Assumptions", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
              "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
      "Simplify"}], "//", "Expand"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<uX\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphcm", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covRXsimp3", "=", 
  RowBox[{"covRXsimp2", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"covRXsimp4", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"covRXsimp3", "//", 
      RowBox[{
       RowBox[{"TensorExpand", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Assumptions", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
              "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
      "Simplify"}], "//", "Expand"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.86790565250249*^9, 3.8679057095985317`*^9}, {
  3.867905783513115*^9, 3.86790580409763*^9}, {3.867905931326497*^9, 
  3.8679059584105463`*^9}, {3.8679060165471487`*^9, 3.86790613482549*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"bcbe896d-85a5-4303-9469-6cda93a44f32"],

Cell[BoxData[
 RowBox[{"{", "M", "}"}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838115952*^9},
 CellLabel->
  "Out[290]=",ExpressionUUID->"5538466f-5fce-487d-b22f-68b9f8c7e74e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"M", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"c", " ", "d", " ", "X"}], "-", 
     RowBox[{"uX", " ", "\[Epsilon]"}], "+", 
     RowBox[{"X", " ", "\[Epsilon]"}]}], "d"]}], "}"}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838117462*^9},
 CellLabel->
  "Out[292]=",ExpressionUUID->"264950b9-990b-4e52-9685-a822ee171e1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "c"}], " ", 
   RowBox[{"X", ".", "uX"}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"X", ".", "uX"}], " ", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"c", " ", "d", " ", "X"}], "-", 
       RowBox[{"uX", " ", "\[Epsilon]"}], "+", 
       RowBox[{"X", " ", "\[Epsilon]"}]}], "d"], ".", "X"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838118794*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"14b24cc1-e964-4285-a828-b6bd4efe7c76"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "uX"}]}], "d"], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"uX", ".", "X"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "X"}]}]]}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838119937*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"31c36011-936b-424d-8df8-3f417dd9669e"],

Cell[BoxData[
 RowBox[{"{", "uX", "}"}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.87224683812101*^9},
 CellLabel->
  "Out[296]=",ExpressionUUID->"dff0ad87-15cc-430a-a2df-af63bf376287"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", "\[Rule]", 
   FractionBox[
    RowBox[{"X", " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838122027*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"813d2a73-1a6b-405d-b7c0-db33bd0110c9"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", 
     FractionBox[
      RowBox[{"X", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}]}], "d"], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", 
     FractionBox[
      RowBox[{"X", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], " ", 
    RowBox[{
     FractionBox[
      RowBox[{"X", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]], ".", "X"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "X"}]}]]}]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838123164*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"f25a8d8f-2eba-4cc4-a49e-521d65ecab02"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "X"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{{3.86790593190952*^9, 3.867906089329054*^9}, {
   3.867906129117652*^9, 3.867906135279057*^9}, 3.869114434768505*^9, 
   3.8691149675189333`*^9, 3.869226588495144*^9, 3.869292753992209*^9, 
   3.869305638448488*^9, 3.8693098158203287`*^9, 3.86956378323053*^9, 
   3.869692409904359*^9, 3.871566535654483*^9, 3.872246838124353*^9},
 CellLabel->
  "Out[300]=",ExpressionUUID->"1f495d2a-ba4d-4495-b341-f0357310f5ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Confounded Mediator, Instrumental Variable Approach", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.859559150645014*^9}, {3.864110439756019*^9, 
  3.8641104485366793`*^9}},ExpressionUUID->"73631730-2574-465c-90aa-\
fe6dde59bc3a"],

Cell[TextData[{
 "Once again we recall the confounded-mediator structure equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "6d0a2309-bc3d-4439-ba94-2269f4be40f5"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "83d4fb67-90a0-42f9-ba75-731915882480"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "323605f4-2ace-47d7-925f-0073a129e08e"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "840a59cc-7bb7-4646-ac8c-0ff2e0f97fde"],
 ".\n\nIn a standard instrumental variable (IV) approach, an observable \
variable V is identified which independently causes M with coefficient a: V\
\[Rule]M, where the dependence coefficient a: M\[Rule]Y is to be estimated. \
Assuming that V is independent of any other causes of M or Y, it can be \
called an instrumental variable, and it is possible to define the sequence of \
estimators:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["ca", "^"], "=", 
    FractionBox[
     RowBox[{"V", ".", "Y"}], 
     RowBox[{"V", ".", "V"}]]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5a89305b-17bf-448d-9f23-6a1336e655b3"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["c", "^"], "=", 
    FractionBox[
     RowBox[{"V", ".", "M"}], 
     RowBox[{"V", ".", "V"}]]}], TraditionalForm]],ExpressionUUID->
  "2d194bfd-201e-4956-a7dd-1fb153eff5e0"],
 "\nand finally\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["a", "^"], "=", 
    RowBox[{
     FractionBox[
      OverscriptBox["ca", "^"], 
      OverscriptBox["c", "^"]], "."}]}], TraditionalForm]],ExpressionUUID->
  "3b274301-9ef6-44aa-9130-94a5d250456c"],
 "\n",
 Cell[BoxData[
  FormBox[
   OverscriptBox["a", "^"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "de283cf2-71c3-4fc2-b1a3-de4ce6562070"],
 " is unbiased, even if some confounding variable W directly influences both \
M and Y.\n\nOur approach to the confounded-mediator graph is to use ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "M"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e8bd7851-ffa8-4a50-ab42-27fb89e67fc2"],
 " as an IV for a: M\[Rule]Y. Of course, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "M"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "c958cceb-83a6-4083-b807-f44f84d57814"],
 " is not itself observable, but it can be unbiasedly estimated as the \
residual of M on X. That is,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["u", "M"], " ", "=", " ", 
    RowBox[{"M", "-", 
     RowBox[{
      FractionBox[
       RowBox[{"X", ".", "M"}], 
       RowBox[{"X", ".", "X"}]], "X"}]}]}], TraditionalForm]],ExpressionUUID->
  "ef0bfe88-694a-49dd-8db6-79f299dafe66"],
 " = M - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["c", "^"], "X"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "4f6ba19a-2f12-4b42-a834-c45bb0699f4b"],
 ".\nThis expression is exact if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Epsilon]", "=", "0"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8d510de9-a856-453e-8de3-1b1a0129c97d"],
 ", in which case the IV approach gives an unbiased estimator for a which is \
an alternative to the FDC. However, for nonzero \[Epsilon], the residual of M \
on X is found:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "758151c6-a34c-4d95-8364-f5e3d19052f8"],
 " = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "+", 
       FractionBox["\[Epsilon]", "d"]}], ")"}], 
     SubscriptBox["x", "i"]}], "+", 
    SubscriptBox[
     SuperscriptBox["u", "m"], 
     RowBox[{"i", " "}]], "-", 
    RowBox[{
     FractionBox["\[Epsilon]", "d"], 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "37550939-3646-4128-84ec-13c92efc38f3"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      SuperscriptBox["u", "m"], 
      RowBox[{"i", " "}]], "-", 
     RowBox[{
      FractionBox["\[Epsilon]", "d"], 
      SubscriptBox[
       SuperscriptBox["u", "x"], "i"]}]}], " ", "=", " "}], TraditionalForm]],
  
  FormatType->TraditionalForm,ExpressionUUID->
  "700bea83-eb4b-409c-81d6-7911c1517e22"],
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "-", 
    RowBox[{
     FractionBox[
      RowBox[{"X", ".", "M"}], 
      RowBox[{"X", ".", "X"}]], "X"}]}], TraditionalForm]],ExpressionUUID->
  "8b3b3159-4530-4da2-a38b-ff0894b33f3c"],
 "\n\nThe relevant combined structure equations for these estimators are:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "8bb32b9c-3b8a-4245-96df-d88195049c22"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}], 
      SubscriptBox["x", "i"]}], "+", 
     SubscriptBox["bw", "i"], "+", 
     RowBox[{"a", "(", 
      RowBox[{
       SubscriptBox[
        SuperscriptBox["u", "m"], "i"], "-", 
       RowBox[{
        FractionBox["\[Epsilon]", "d"], 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}]}], ")"}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "7220a02d-a474-4f3f-a66e-b9762026721e"],
 "\n\n\n"
}], "Text",
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864110536487227*^9, 3.86411054857936*^9}, {3.86411062411454*^9, 
   3.864110732717017*^9}, {3.8641107828874083`*^9, 3.864110936803849*^9}, {
   3.8641109991499033`*^9, 3.864111012214192*^9}, {3.864111055614129*^9, 
   3.8641110763851223`*^9}, {3.8641111665810547`*^9, 
   3.8641111711552553`*^9}, {3.864111477449679*^9, 3.864111486681368*^9}, {
   3.864111596430975*^9, 3.864111641074067*^9}, {3.864111672312172*^9, 
   3.864111767307096*^9}, {3.864111798055182*^9, 3.86411184022626*^9}, {
   3.8641118825650806`*^9, 3.864111946278564*^9}, {3.864111989787813*^9, 
   3.8641120112656393`*^9}, {3.86411217277103*^9, 3.864112173035397*^9}, {
   3.8641122243536787`*^9, 3.864112234076226*^9}, {3.864112293854643*^9, 
   3.8641123021742983`*^9}, {3.864112495699565*^9, 
   3.8641125803724403`*^9}},ExpressionUUID->"47393b17-4f09-4646-bb47-\
5f9f4d20d034"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"M", ",", "X"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["aplusedivb", "^"], ",", 
     OverscriptBox["bdivd", "^"]}], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "M", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["cplusedivd", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{"Yc", ",", "Xc"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["residual", "^"], " ", "=", " ", 
   RowBox[{"X", "-", 
    RowBox[{
     OverscriptBox["cplusedivd", "^"], "M"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["a", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{
    RowBox[{"{", "Y", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox["\[Epsilon]", "d"], "M"}], "+", "uM", "-", 
      RowBox[{
       FractionBox["\[Epsilon]", "d"], "uX"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["apre", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{
    RowBox[{"{", "M", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox["\[Epsilon]", "d"], "M"}], "+", "uM", "-", 
      RowBox[{
       FractionBox["\[Epsilon]", "d"], "uX"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["a", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{
    RowBox[{"{", "Y", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"uM", "-", 
      RowBox[{
       FractionBox["\[Epsilon]", "d"], "uX"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["apre", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{
    RowBox[{"{", "M", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"uM", "-", 
      RowBox[{
       FractionBox["\[Epsilon]", "d"], "uX"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.858324779349805*^9, 3.8583247888458023`*^9}, {
   3.8583253078292217`*^9, 3.858325314837751*^9}, {3.858325396607929*^9, 
   3.85832542701947*^9}, {3.860036107824605*^9, 3.860036115763649*^9}, {
   3.8641120783204927`*^9, 3.864112136320907*^9}, {3.8641128126746073`*^9, 
   3.864112834173751*^9}, {3.864113251481452*^9, 3.864113252056465*^9}, {
   3.8641137746492767`*^9, 3.8641137806033297`*^9}, {3.8641157011966963`*^9, 
   3.864115708200124*^9}, {3.864117697504759*^9, 3.864117702535822*^9}},
 CellLabel->
  "In[301]:=",ExpressionUUID->"acb2a25b-fcc0-4d95-8ad9-5db2af322cc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.8722468381369057`*^9},
 CellLabel->
  "Out[303]=",ExpressionUUID->"dea9af8f-6e20-480f-9fb9-6566cc9d81f3"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.872246838138341*^9},
 CellLabel->
  "Out[306]=",ExpressionUUID->"549e1522-946e-4103-bf62-28f83554ec30"],

Cell[BoxData[
 RowBox[{"X", "-", 
  FractionBox[
   RowBox[{"M", " ", 
    RowBox[{"X", ".", "M"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.872246838139539*^9},
 CellLabel->
  "Out[307]=",ExpressionUUID->"f71f1ba0-ada7-4b18-8407-40720ac20899"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"d", " ", "uM"}], "+", 
      RowBox[{"M", " ", "\[Epsilon]"}], "-", 
      RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"], ".", "Y"}], 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"d", " ", "uM"}], "+", 
      RowBox[{"M", " ", "\[Epsilon]"}], "-", 
      RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"], ".", 
    FractionBox[
     RowBox[{
      RowBox[{"d", " ", "uM"}], "+", 
      RowBox[{"M", " ", "\[Epsilon]"}], "-", 
      RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"]}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.872246838140637*^9},
 CellLabel->
  "Out[308]=",ExpressionUUID->"8ea24740-8a65-48c7-9012-62c6b59ed81e"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"d", " ", "uM"}], "+", 
      RowBox[{"M", " ", "\[Epsilon]"}], "-", 
      RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"], ".", "M"}], 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"d", " ", "uM"}], "+", 
      RowBox[{"M", " ", "\[Epsilon]"}], "-", 
      RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"], ".", 
    FractionBox[
     RowBox[{
      RowBox[{"d", " ", "uM"}], "+", 
      RowBox[{"M", " ", "\[Epsilon]"}], "-", 
      RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"]}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.87224683814172*^9},
 CellLabel->
  "Out[309]=",ExpressionUUID->"16522ddc-ad55-4aee-a6d6-ae47a5617960"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "-", 
      FractionBox[
       RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], ")"}], ".", "Y"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "-", 
      FractionBox[
       RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"uM", "-", 
      FractionBox[
       RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], ")"}]}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.872246838142807*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"cd1c71c3-7991-4de7-bda2-d5ca2faa8361"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "-", 
      FractionBox[
       RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], ")"}], ".", "M"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "-", 
      FractionBox[
       RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"uM", "-", 
      FractionBox[
       RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], ")"}]}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.8641121367460327`*^9, 3.864112834673264*^9, 3.864113254252555*^9, 
   3.864113781253799*^9, 3.864116189498624*^9, 3.864117129348569*^9, 
   3.864117703200597*^9, 3.864875745633629*^9, 3.867905722938842*^9, 
   3.8691144347888947`*^9, 3.869114967543976*^9, 3.869226588525792*^9, 
   3.869292754026558*^9, 3.8693056384845552`*^9, 3.869309815860908*^9, 
   3.8695637832806273`*^9, 3.8696924099308033`*^9, 3.87156653570439*^9, 
   3.872246838143895*^9},
 CellLabel->
  "Out[311]=",ExpressionUUID->"d1cf3604-e067-4edc-9ac0-b20b83187b18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{"Y", "\[Rule]", 
     RowBox[{
      RowBox[{"a", "*", 
       RowBox[{"(", 
        RowBox[{"uM", "-", 
         FractionBox[
          RowBox[{"\[Epsilon]", " ", "uX"}], "d"]}], ")"}]}], "+", 
      RowBox[{"a", 
       RowBox[{"(", 
        RowBox[{"c", "+", 
         FractionBox["\[Epsilon]", "d"]}], ")"}], "X"}], "+", 
      RowBox[{"b", "*", "W"}], "+", "uY"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aerrorIV", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["a", "^"], "-", "a"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", "uM"}], "+", 
        RowBox[{"M", " ", "\[Epsilon]"}], "-", 
        RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"], "->", "eMX"}], ",", 
     RowBox[{
      RowBox[{"uM", "-", 
       FractionBox[
        RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], "->", "eMX2"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"apreerrorIV", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["apre", "^"], "-", "1"}], "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"d", " ", "uM"}], "+", 
        RowBox[{"M", " ", "\[Epsilon]"}], "-", 
        RowBox[{"uX", " ", "\[Epsilon]"}]}], "d"], "->", "eMX"}], ",", 
     RowBox[{
      RowBox[{"uM", "-", 
       FractionBox[
        RowBox[{"uX", " ", "\[Epsilon]"}], "d"]}], "->", "eMX2"}]}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy28o3HEAx/HzLx1OFDpHSu2cFOfOORLy27TOmePONLfTDiMNjSgO52xC
/tyDTZomo6wVUiwntdm0KeNcQvPnCebyb/zSRQ4Rvp/fg3evR+/g/DJVoSOL
xQohwYK6b/bwaZqSdHlcQgW3xDGCqJPaGPu+KL2h0afTDxoaYwTwqYwTCj2v
XovhzZ2vBLr/ToyD1uJuivnTn6XC/7zTdDhTKR+PJKa9PzZB2mvjB4xtuv4D
myp7FuHKg7M1KHkptcOi2/lbuNHR7yIius2vMCaqF9jwu1TpCXtaV33gu+cO
/tCWoxXBusspCVSkvHoIOTsGGaydoJ5AnmtRBsz9Gd8G5XNCI7w6nLbC9r/b
u9D549QRHJw0nUBTQhlbTGwQfWI8/SoOh2PCJEZjVAT7zS+a6j/39YahmdmB
kJ+mCYI8Nc2H2TKNAC4l2+ubie7c3kZYatFyW4h6utcfVlcF8D8QxZGWEGjQ
f96KNtPUyPrwAXzxeNwOy5eNF9A24MCREivCuhkNKUoBVC9qGPdHnTKgTleq
hK3WPSqGKM+yPILRecG1UDWUWg9rhA1HUOcxyajYFMTFEme83sZD879ZLdSb
E3LhPUKjM+Q=
  "],
 CellLabel->
  "In[312]:=",ExpressionUUID->"032cd3d5-5013-449d-8b0e-87924056a856"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{"eMX2", ".", "Y"}], 
   RowBox[{"eMX2", ".", "eMX2"}]]}]], "Output",
 CellChangeTimes->{
  3.864112909072144*^9, 3.864112957776824*^9, 3.8641130848571787`*^9, 
   3.86411326092944*^9, 3.864113467224625*^9, 3.864113803731861*^9, 
   3.8641158720317297`*^9, {3.864116191360867*^9, 3.864116202994523*^9}, 
   3.8641171313392763`*^9, 3.864117732344873*^9, 3.864118018704607*^9, 
   3.864118382045617*^9, 3.8648757456516123`*^9, 3.8679057229916162`*^9, 
   3.86911443480589*^9, 3.869114967566676*^9, 3.869226588551783*^9, 
   3.869292754057646*^9, 3.869305638517315*^9, 3.869309815897134*^9, 
   3.869563783325375*^9, 3.869692409953607*^9, 3.871566535766852*^9, 
   3.872246838155349*^9},
 CellLabel->
  "Out[314]=",ExpressionUUID->"3859f7f7-3ddc-4dd9-a138-285c6d9c5129"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  FractionBox[
   RowBox[{"eMX2", ".", "M"}], 
   RowBox[{"eMX2", ".", "eMX2"}]]}]], "Output",
 CellChangeTimes->{
  3.864112909072144*^9, 3.864112957776824*^9, 3.8641130848571787`*^9, 
   3.86411326092944*^9, 3.864113467224625*^9, 3.864113803731861*^9, 
   3.8641158720317297`*^9, {3.864116191360867*^9, 3.864116202994523*^9}, 
   3.8641171313392763`*^9, 3.864117732344873*^9, 3.864118018704607*^9, 
   3.864118382045617*^9, 3.8648757456516123`*^9, 3.8679057229916162`*^9, 
   3.86911443480589*^9, 3.869114967566676*^9, 3.869226588551783*^9, 
   3.869292754057646*^9, 3.869305638517315*^9, 3.869309815897134*^9, 
   3.869563783325375*^9, 3.869692409953607*^9, 3.871566535766852*^9, 
   3.872246838156732*^9},
 CellLabel->
  "Out[315]=",ExpressionUUID->"ab478763-4e76-49fa-b3bf-ed0e6ab70de6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\"", ",", "\"\<uY\>\"", ",", 
     "\"\<Y\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeansLinComb", "[", 
   RowBox[{"causalgraphcm", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<uX\>\"", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<X\>\"", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<M\>\"", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<uY\>\"", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "\"\<Y\>\"", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<M\>\"", ",", "\"\<uM\>\"", ",", "\"\<uX\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", 
         FractionBox[
          RowBox[{"-", "\[Epsilon]"}], "d"]}], "}"}]}], "}"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimpIV", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerrorIV", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"apreerrorsimpIV", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"apreerrorIV", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzk0og3EAx/ElxMxLyoQUkiEm87IdtrLSLsRoQ1xYNi8HQ5jMQXlJYxPm
5eJghgsi8hqL2saTiCxLipTVZlFIicz/9xy+fa7fRIW6XOnHYDDiSfC0IJDJ
s3jFFXueCDi30hEFf5Kc0dCyY+f2HXvFCVNnWdDlatD2E1nOmBHYrAtlDxI/
N+S0YV32OGhsKcqCLFGnEKp6TRJ4dGWVwmXNihJe9Dyr4ZdtsQ1e57R2Qln9
sBYGh0gG4N9B+xCUfAcYYHGhwQj3zVucIaKHaciEXSkezjSxcM1Lm71UO68+
If+jKtr0N6s7j/KKdTXSD1jJO/NBtiY3IJ946T+WBl2l0gwoX/eVw2qHRAYp
/baMTxRGCuTQ//ahCTJS3bT83/gXuHBYRnt6Z36Het0jLZcaFwmI9933tAdP
4XXQqeYqoD52ZgIyqaBJ2Jh8Y4OsklUKKlRVDrg5e077mr/thqaMXQ/8B83V
+bE=
  "],
 CellLabel->
  "In[316]:=",ExpressionUUID->"7dd404ad-9ca9-4623-aeba-a0d0f5e1b73c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "X", ",", "M", ",", "uY", ",", "Y"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, {3.864113022656909*^9, 3.8641130509201593`*^9}, 
   3.864113091662335*^9, {3.864113151478883*^9, 3.864113193965681*^9}, 
   3.86411326613708*^9, {3.864113495164551*^9, 3.8641135068329983`*^9}, 
   3.8641138271186943`*^9, 3.8641158853601427`*^9, 3.864116048322282*^9, 
   3.8641162079028463`*^9, {3.864117136485196*^9, 3.86411714759251*^9}, 
   3.864117743402158*^9, {3.8641180260343246`*^9, 3.864118033827281*^9}, 
   3.864118424509171*^9, {3.8641188393794823`*^9, 3.864118869885597*^9}, 
   3.864118964162941*^9, 3.864119125964829*^9, 3.864875745666103*^9, 
   3.867905723037285*^9, 3.869114434820032*^9, 3.869114967583959*^9, 
   3.869226588570719*^9, 3.8692927540759172`*^9, 3.869305638535162*^9, 
   3.869309815917006*^9, 3.869563783355748*^9, 3.8696924099714613`*^9, 
   3.871566535815889*^9, 3.872246838169703*^9},
 CellLabel->
  "Out[317]=",ExpressionUUID->"a30fc68e-4e1f-4f7c-ace8-6734c70cbb45"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"d", " ", "\[Epsilon]", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"d", " ", "\[Epsilon]", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    FractionBox[
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
        RowBox[{"c", " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    FractionBox[
     RowBox[{"a", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
        RowBox[{"c", " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, {3.864113022656909*^9, 3.8641130509201593`*^9}, 
   3.864113091662335*^9, {3.864113151478883*^9, 3.864113193965681*^9}, 
   3.86411326613708*^9, {3.864113495164551*^9, 3.8641135068329983`*^9}, 
   3.8641138271186943`*^9, 3.8641158853601427`*^9, 3.864116048322282*^9, 
   3.8641162079028463`*^9, {3.864117136485196*^9, 3.86411714759251*^9}, 
   3.864117743402158*^9, {3.8641180260343246`*^9, 3.864118033827281*^9}, 
   3.864118424509171*^9, {3.8641188393794823`*^9, 3.864118869885597*^9}, 
   3.864118964162941*^9, 3.864119125964829*^9, 3.864875745666103*^9, 
   3.867905723037285*^9, 3.869114434820032*^9, 3.869114967583959*^9, 
   3.869226588570719*^9, 3.8692927540759172`*^9, 3.869305638535162*^9, 
   3.869309815917006*^9, 3.869563783355748*^9, 3.8696924099714613`*^9, 
   3.871566535815889*^9, 3.872246838181327*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"53ebab3d-857d-4f8f-972d-7c52ad47ecfc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}]}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"{", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "}"}]}], ",", 
   RowBox[{"uY", "\[Rule]", 
    RowBox[{"{", "0", "}"}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{"{", 
     FractionBox[
      RowBox[{"a", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, {3.864113022656909*^9, 3.8641130509201593`*^9}, 
   3.864113091662335*^9, {3.864113151478883*^9, 3.864113193965681*^9}, 
   3.86411326613708*^9, {3.864113495164551*^9, 3.8641135068329983`*^9}, 
   3.8641138271186943`*^9, 3.8641158853601427`*^9, 3.864116048322282*^9, 
   3.8641162079028463`*^9, {3.864117136485196*^9, 3.86411714759251*^9}, 
   3.864117743402158*^9, {3.8641180260343246`*^9, 3.864118033827281*^9}, 
   3.864118424509171*^9, {3.8641188393794823`*^9, 3.864118869885597*^9}, 
   3.864118964162941*^9, 3.864119125964829*^9, 3.864875745666103*^9, 
   3.867905723037285*^9, 3.869114434820032*^9, 3.869114967583959*^9, 
   3.869226588570719*^9, 3.8692927540759172`*^9, 3.869305638535162*^9, 
   3.869309815917006*^9, 3.869563783355748*^9, 3.8696924099714613`*^9, 
   3.871566535815889*^9, 3.872246838183448*^9},
 CellLabel->
  "Out[319]=",ExpressionUUID->"6dbab24c-dbc3-405b-86f5-12b7a2df9c35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{"eMX2", ".", 
    RowBox[{"{", 
     FractionBox[
      RowBox[{"a", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "}"}]}], 
   RowBox[{"eMX2", ".", "eMX2"}]]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, {3.864113022656909*^9, 3.8641130509201593`*^9}, 
   3.864113091662335*^9, {3.864113151478883*^9, 3.864113193965681*^9}, 
   3.86411326613708*^9, {3.864113495164551*^9, 3.8641135068329983`*^9}, 
   3.8641138271186943`*^9, 3.8641158853601427`*^9, 3.864116048322282*^9, 
   3.8641162079028463`*^9, {3.864117136485196*^9, 3.86411714759251*^9}, 
   3.864117743402158*^9, {3.8641180260343246`*^9, 3.864118033827281*^9}, 
   3.864118424509171*^9, {3.8641188393794823`*^9, 3.864118869885597*^9}, 
   3.864118964162941*^9, 3.864119125964829*^9, 3.864875745666103*^9, 
   3.867905723037285*^9, 3.869114434820032*^9, 3.869114967583959*^9, 
   3.869226588570719*^9, 3.8692927540759172`*^9, 3.869305638535162*^9, 
   3.869309815917006*^9, 3.869563783355748*^9, 3.8696924099714613`*^9, 
   3.871566535815889*^9, 3.8722468381852293`*^9},
 CellLabel->
  "Out[320]=",ExpressionUUID->"571120de-3c81-4a26-94fa-e650a12b08f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  FractionBox[
   RowBox[{"eMX2", ".", 
    RowBox[{"{", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "}"}]}], 
   RowBox[{"eMX2", ".", "eMX2"}]]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, {3.864113022656909*^9, 3.8641130509201593`*^9}, 
   3.864113091662335*^9, {3.864113151478883*^9, 3.864113193965681*^9}, 
   3.86411326613708*^9, {3.864113495164551*^9, 3.8641135068329983`*^9}, 
   3.8641138271186943`*^9, 3.8641158853601427`*^9, 3.864116048322282*^9, 
   3.8641162079028463`*^9, {3.864117136485196*^9, 3.86411714759251*^9}, 
   3.864117743402158*^9, {3.8641180260343246`*^9, 3.864118033827281*^9}, 
   3.864118424509171*^9, {3.8641188393794823`*^9, 3.864118869885597*^9}, 
   3.864118964162941*^9, 3.864119125964829*^9, 3.864875745666103*^9, 
   3.867905723037285*^9, 3.869114434820032*^9, 3.869114967583959*^9, 
   3.869226588570719*^9, 3.8692927540759172`*^9, 3.869305638535162*^9, 
   3.869309815917006*^9, 3.869563783355748*^9, 3.8696924099714613`*^9, 
   3.871566535815889*^9, 3.8722468381865*^9},
 CellLabel->
  "Out[321]=",ExpressionUUID->"718cfa60-7b6d-47fc-be69-d4cab61b8105"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"numerics", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "->", "1"}], ",", 
     RowBox[{"b", "->", "1"}], ",", 
     RowBox[{"c", "->", 
      RowBox[{"-", "2"}]}], ",", 
     RowBox[{"d", "->", "1"}], ",", 
     RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerrorsimpIV", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"a", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
        RowBox[{"c", " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "-", "a"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"apreerrorsimpIV", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
        RowBox[{"c", " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimpIV", "/.", "numerics"}], "\[IndentingNewLine]", 
 RowBox[{"apreerrorsimpIV", "/.", "numerics"}]}], "Input",
 CellChangeTimes->{{3.864116228751912*^9, 3.864116272621709*^9}, {
  3.864117016137493*^9, 3.864117025554537*^9}, {3.864117088131096*^9, 
  3.864117095306233*^9}, {3.864117472969655*^9, 3.864117473035152*^9}, {
  3.8641175199847116`*^9, 3.864117537705325*^9}, {3.864117577813774*^9, 
  3.864117578240612*^9}, {3.864118737441332*^9, 3.864118749955001*^9}, {
  3.8641188932927637`*^9, 3.864118903508202*^9}, {3.8641191500681257`*^9, 
  3.864119163855809*^9}, {3.86411934370286*^9, 3.864119355360126*^9}, {
  3.864119420491365*^9, 3.8641194474046707`*^9}, {3.8641195669673634`*^9, 
  3.864119568018169*^9}},
 CellLabel->
  "In[322]:=",ExpressionUUID->"cc82193b-ce8d-49ef-88a6-93fba5080006"],

Cell[BoxData["0.6000000000000001`"], "Output",
 CellChangeTimes->{{3.864116249094777*^9, 3.864116272820882*^9}, {
   3.864117022564393*^9, 3.864117025953425*^9}, 3.864117152087448*^9, 
   3.864117473319861*^9, {3.864117520598768*^9, 3.864117537941269*^9}, 
   3.864117578836165*^9, 3.864117746391261*^9, 3.86411843899688*^9, {
   3.8641187385680647`*^9, 3.8641187502259073`*^9}, {3.864118897126006*^9, 
   3.864118903921212*^9}, {3.864119144157544*^9, 3.8641191642426558`*^9}, {
   3.8641193504771852`*^9, 3.8641193556424294`*^9}, {3.864119421020211*^9, 
   3.864119447679233*^9}, {3.864119568302143*^9, 3.8641195909589767`*^9}, 
   3.864875745694748*^9, 3.867905723120974*^9, 3.869114434846344*^9, 
   3.869114967612947*^9, 3.86922658861215*^9, 3.869292754104545*^9, 
   3.869305638565976*^9, 3.869309815950715*^9, 3.8695637834037952`*^9, 
   3.8696924100095167`*^9, 3.871566535910078*^9, 3.8722468381982193`*^9},
 CellLabel->
  "Out[325]=",ExpressionUUID->"c1b1f84f-6f48-4d93-8334-b8dc955548fe"],

Cell[BoxData["0.6000000000000001`"], "Output",
 CellChangeTimes->{{3.864116249094777*^9, 3.864116272820882*^9}, {
   3.864117022564393*^9, 3.864117025953425*^9}, 3.864117152087448*^9, 
   3.864117473319861*^9, {3.864117520598768*^9, 3.864117537941269*^9}, 
   3.864117578836165*^9, 3.864117746391261*^9, 3.86411843899688*^9, {
   3.8641187385680647`*^9, 3.8641187502259073`*^9}, {3.864118897126006*^9, 
   3.864118903921212*^9}, {3.864119144157544*^9, 3.8641191642426558`*^9}, {
   3.8641193504771852`*^9, 3.8641193556424294`*^9}, {3.864119421020211*^9, 
   3.864119447679233*^9}, {3.864119568302143*^9, 3.8641195909589767`*^9}, 
   3.864875745694748*^9, 3.867905723120974*^9, 3.869114434846344*^9, 
   3.869114967612947*^9, 3.86922658861215*^9, 3.869292754104545*^9, 
   3.869305638565976*^9, 3.869309815950715*^9, 3.8695637834037952`*^9, 
   3.8696924100095167`*^9, 3.871566535910078*^9, 3.872246838199523*^9},
 CellLabel->
  "Out[326]=",ExpressionUUID->"2543087e-09fd-4cbb-b6b2-7a4d37577e5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"aerrorsimp", "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "/.", "numerics"}]}], "Input",
 CellChangeTimes->{{3.864118794436264*^9, 3.864118803745371*^9}},
 CellLabel->
  "In[327]:=",ExpressionUUID->"2e3115af-bf6e-4b7c-a271-8c5d3ab52dbb"],

Cell[BoxData["ComplexInfinity"], "Output",
 CellChangeTimes->{{3.8641187955866003`*^9, 3.864118803955037*^9}, 
   3.864119458145639*^9, 3.864875745707282*^9, 3.867905723134766*^9, 
   3.869114434857868*^9, 3.8691149676285133`*^9, 3.869226588629654*^9, 
   3.869292754121851*^9, 3.869305638581881*^9, 3.86930981596861*^9, 
   3.869563783435574*^9, 3.869692410026647*^9, 3.8715665359504128`*^9, 
   3.872246838210449*^9},
 CellLabel->
  "Out[327]=",ExpressionUUID->"c2cce758-b9a2-45b0-b371-ce9d79d95708"],

Cell[BoxData["ComplexInfinity"], "Output",
 CellChangeTimes->{{3.8641187955866003`*^9, 3.864118803955037*^9}, 
   3.864119458145639*^9, 3.864875745707282*^9, 3.867905723134766*^9, 
   3.869114434857868*^9, 3.8691149676285133`*^9, 3.869226588629654*^9, 
   3.869292754121851*^9, 3.869305638581881*^9, 3.86930981596861*^9, 
   3.869563783435574*^9, 3.869692410026647*^9, 3.8715665359504128`*^9, 
   3.872246838211781*^9},
 CellLabel->
  "Out[328]=",ExpressionUUID->"048eaabd-e19a-486f-a8e6-8088f50a58a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "*", 
   "a"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"a", " ", "d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
       RowBox[{"c", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "-", "a"}]}]}], "Input",
 CellChangeTimes->{{3.864113223874488*^9, 3.864113226196624*^9}, {
  3.864113272624613*^9, 3.8641132729413843`*^9}, {3.8641136148879833`*^9, 
  3.8641136279827423`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"f9443457-5132-439a-9b87-f8cd6fd30002"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"a", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}]], "Output",
 CellChangeTimes->{
  3.864113226674*^9, {3.86411326978658*^9, 3.864113273176454*^9}, {
   3.864113617360448*^9, 3.864113629376327*^9}, 3.8648757457201757`*^9, 
   3.867905723167451*^9, 3.8691144348695517`*^9, 3.869114967644762*^9, 
   3.869226588648028*^9, 3.8692927541398277`*^9, 3.86930563859874*^9, 
   3.86930981598743*^9, 3.869563783469534*^9, 3.869692410043871*^9, 
   3.871566535993883*^9, 3.872246838223167*^9},
 CellLabel->
  "Out[329]=",ExpressionUUID->"5cb3602f-f54c-41aa-8df0-855b6b549cbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{"a", " ", "d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
      RowBox[{"c", " ", "\[Epsilon]", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}]], "Output",
 CellChangeTimes->{
  3.864113226674*^9, {3.86411326978658*^9, 3.864113273176454*^9}, {
   3.864113617360448*^9, 3.864113629376327*^9}, 3.8648757457201757`*^9, 
   3.867905723167451*^9, 3.8691144348695517`*^9, 3.869114967644762*^9, 
   3.869226588648028*^9, 3.8692927541398277`*^9, 3.86930563859874*^9, 
   3.86930981598743*^9, 3.869563783469534*^9, 3.869692410043871*^9, 
   3.871566535993883*^9, 3.872246838224609*^9},
 CellLabel->
  "Out[330]=",ExpressionUUID->"56d206e3-67d9-49b5-9628-7f448a28c8f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", "->", "1"}], ",", 
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"c", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.863856380066532*^9, 3.8638563950769453`*^9}, {
  3.864113229811339*^9, 3.864113234308474*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"016d38f0-2156-4028-bc0e-640ac8c5e244"],

Cell[BoxData[
 RowBox[{"-", "0.6`"}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641132349317503`*^9, 3.864113275229712*^9, 3.8641136192846527`*^9, 
   3.86487574573309*^9, 3.867905723200021*^9, 3.869114434881257*^9, 
   3.869114967661051*^9, 3.869226588666326*^9, 3.869292754157258*^9, 
   3.869305638614992*^9, 3.869309816009664*^9, 3.869563783500702*^9, 
   3.869692410060586*^9, 3.871566536034376*^9, 3.8722468382356787`*^9},
 CellLabel->
  "Out[331]=",ExpressionUUID->"b8e6dc4e-251c-4c50-b51a-d9a483280295"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Y", " ", "=", " ", 
  RowBox[{
   RowBox[{"a", 
    RowBox[{"(", 
     RowBox[{"uM", " ", "-", " ", 
      RowBox[{
       FractionBox["e", "d"], "uX"}]}], ")"}]}], "+", 
   RowBox[{"(", 
    RowBox[{"uY", " ", "+", "bW"}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ca", "+", 
      FractionBox["ea", "d"]}], ")"}], "X"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E", "[", 
   FractionBox[
    RowBox[{"Y", ".", 
     RowBox[{"(", 
      RowBox[{"uM", " ", "-", " ", 
       RowBox[{
        FractionBox["e", "d"], "uX"}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"uM", " ", "-", " ", 
       RowBox[{
        FractionBox["e", "d"], "uX"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"uM", " ", "-", " ", 
       RowBox[{
        FractionBox["e", "d"], "uX"}]}], ")"}]}]], "]"}], " ", "=", " ", 
  RowBox[{"a", " ", "+", " ", 
   RowBox[{"a", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      FractionBox["e", "d"]}], ")"}], 
    RowBox[{"E", "[", 
     FractionBox[
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{"uM", " ", "-", " ", 
         RowBox[{
          FractionBox["e", "d"], "uX"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", " ", "-", " ", 
         RowBox[{
          FractionBox["e", "d"], "uX"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", " ", "-", " ", 
         RowBox[{
          FractionBox["e", "d"], "uX"}]}], ")"}]}]], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8638594617681303`*^9, 3.863859583037216*^9}, {
  3.863859623471648*^9, 3.863859625239078*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"6086f94d-81d2-46bd-b31f-fcd50ea58b5d"],

Cell[BoxData[
 RowBox[{"bW", "+", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{"uM", "-", 
     FractionBox[
      RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ca", "+", 
     FractionBox["ea", "d"]}], ")"}], " ", "X"}]}]], "Output",
 CellChangeTimes->{3.864875745745207*^9, 3.867905723241557*^9, 
  3.8691144348934402`*^9, 3.8691149676775503`*^9, 3.869226588685104*^9, 
  3.869292754172452*^9, 3.869305638629084*^9, 3.869309816025133*^9, 
  3.869563783526973*^9, 3.8696924100766077`*^9, 3.8715665360813437`*^9, 
  3.872246838248219*^9},
 CellLabel->
  "Out[332]=",ExpressionUUID->"68d9ffb1-28b3-45ef-a347-8a1c3d4a9196"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[ExponentialE]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[ExponentialE]\\\", \\\"[\\\", \
FractionBox[RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"bW\\\", \\\"+\\\", \
RowBox[{\\\"a\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"uM\\\", \
\\\"-\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \
\\\", \\\"e\\\", \\\" \\\", \\\"uX\\\"}]}], \\\")\\\"}]}], \\\"+\\\", \
\\\"uY\\\", \\\"+\\\", RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"ca\\\", \\\"+\\\
\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\" \\\", \\\"ea\\\"}]}], \\\")\\\"}], \\\" \\\", \\\"X\\\"}]}], \
\\\")\\\"}], \\\".\\\", RowBox[{\\\"(\\\", RowBox[{\\\"uM\\\", \\\"-\\\", \
FractionBox[RowBox[{\\\"e\\\", \\\" \\\", \\\"uX\\\"}], \\\"d\\\"]}], \\\")\\\
\"}]}], RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"uM\\\", \\\"-\\\", \
FractionBox[RowBox[{\\\"e\\\", \\\" \\\", \\\"uX\\\"}], \\\"d\\\"]}], \\\")\\\
\"}], \\\".\\\", RowBox[{\\\"(\\\", RowBox[{\\\"uM\\\", \\\"-\\\", \
FractionBox[RowBox[{\\\"e\\\", \\\" \\\", \\\"uX\\\"}], \\\"d\\\"]}], \\\")\\\
\"}]}]], \\\"]\\\"}]\\) is Protected.\"", 2, 333, 10, 21942966268712677875, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.864875745769459*^9, 3.867905723297462*^9, 
  3.8691144349194813`*^9, 3.8691149676792727`*^9, 3.869226588724347*^9, 
  3.869292754176367*^9, 3.869305638633585*^9, 3.869309816030196*^9, 
  3.869563783531529*^9, 3.869692410106889*^9, 3.871566536151266*^9, 
  3.872246838274156*^9},
 CellLabel->
  "During evaluation of \
In[332]:=",ExpressionUUID->"aa3ebbd6-f76a-46b9-82fc-c50e186546a4"],

Cell[BoxData[
 RowBox[{"a", "+", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     FractionBox["e", "d"]}], ")"}], " ", 
   RowBox[{"\[ExponentialE]", "[", 
    FractionBox[
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}]], "]"}]}]}]], "Output",
 CellChangeTimes->{3.864875745745207*^9, 3.867905723241557*^9, 
  3.8691144348934402`*^9, 3.8691149676775503`*^9, 3.869226588685104*^9, 
  3.869292754172452*^9, 3.869305638629084*^9, 3.869309816025133*^9, 
  3.869563783526973*^9, 3.8696924100766077`*^9, 3.8715665360813437`*^9, 
  3.872246838279256*^9},
 CellLabel->
  "Out[333]=",ExpressionUUID->"e70b0c9b-0320-4d11-81b5-43bef0b5dde5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CondMeansLinComb", "[", 
  RowBox[{"causalgraph", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "\"\<X\>\"", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<uM\>\"", ",", "\"\<uX\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", 
         FractionBox["\[Epsilon]", "d"]}]}], "}"}]}], "}"}], "}"}]}], 
  "]"}]], "Input",
 CellLabel->
  "In[334]:=",ExpressionUUID->"488df2e9-4c0a-4a0f-9fbe-247ca9aa698c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"d", " ", "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.864110450797554*^9, 3.864875745786147*^9, 
  3.8679057233433733`*^9, 3.869114434936777*^9, 3.869114967699161*^9, 
  3.8692265887482147`*^9, 3.8692927541976347`*^9, 3.869305638653274*^9, 
  3.8693098160520773`*^9, 3.869563783563404*^9, 3.8696924101304693`*^9, 
  3.8715665362063227`*^9, 3.872246838291644*^9},
 CellLabel->
  "Out[334]=",ExpressionUUID->"f908806a-13ac-41f5-be0d-5fa96d3486b0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Instrumental Variables for Chains of Confounded Mediators", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.859559150645014*^9}, {3.864187779695509*^9, 
  3.8641877894520607`*^9}},ExpressionUUID->"41b12d69-70c0-4fe3-a437-\
5b9f741d3fb6"],

Cell[TextData[{
 "The following case is well known as a simple success of IVs.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "1faaaa9e-bab8-48c2-8e48-756465f90cc5"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", 
    SubscriptBox[
     SuperscriptBox["u", "x"], "i"]}], TraditionalForm]],ExpressionUUID->
  "24c22b63-7427-490f-8dbb-04b73c6ed4a5"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "8d2b5114-7ffc-401e-9f1b-431d0fc5db0b"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "c8678ad3-088b-41a3-ac58-b3a0a6d4a8f0"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.859559164128237*^9, 3.859559167825494*^9}, {
  3.864187796712625*^9, 
  3.864187839733988*^9}},ExpressionUUID->"34a919b9-f156-47e2-805e-\
ec531e6ea90a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"4", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"4", "\[DirectedEdge]", "3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vnames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<X\>\"", ",", "\"\<M\>\"", ",", "\"\<Y\>\"", ",", "\"\<W\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweights", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "uW"], ",", 
     SubscriptBox["\[Sigma]", "uX"], ",", 
     SubscriptBox["\[Sigma]", "uM"], ",", 
     SubscriptBox["\[Sigma]", "uY"]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{"#1", ",", "Center"}], "]"}], "&"}], ",", "vnames"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eweights", "=", 
   RowBox[{"{", 
    RowBox[{"c", ",", "a", ",", "d", ",", "b"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elabels", " ", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"edges", "\[Rule]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "#1", ",", "18", ",", "Italic", ",", "Bold", ",", "Blue"}], 
             "]"}], ",", 
            RowBox[{"Background", "->", "White"}], ",", 
            RowBox[{"FrameStyle", "->", "White"}]}], "]"}], ",", 
          "\"\<Middle\>\""}], "]"}], "&"}], ",", "eweights"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcoords", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1.5", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookup", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vnames", "->", "vertices"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupname", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", "vnames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweightsnou", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "W"], ",", 
     SubscriptBox["\[Sigma]", "X"], ",", 
     SubscriptBox["\[Sigma]", "M"], ",", 
     SubscriptBox["\[Sigma]", "Y"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvars", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupweight", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
         "]"}], "->", "vweights"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "#", "]"}], "&"}], ",", "vnames"}], "]"}], "->",
         "vweightsnou"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"causalgraphiv", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"edges", ",", 
    RowBox[{"VertexLabels", "->", "vlabels"}], ",", 
    RowBox[{"EdgeLabels", "->", "elabels"}], ",", 
    RowBox[{"VertexWeight", "\[Rule]", "vweights"}], ",", 
    RowBox[{"EdgeWeight", "\[Rule]", "eweights"}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "\"\<LayeredEmbedding\>\""}], ",", 
    RowBox[{"VertexStyle", "->", "Black"}], ",", 
    RowBox[{"VertexSize", "->", "0.3"}], ",", 
    RowBox[{"VertexLabelStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Italic", ",", "26"}], "]"}]}], ",", 
    RowBox[{"EdgeStyle", "->", "Black"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->CompressedData["
1:eJwd0DtIQgEARuHbcyiM0sjIKAWRQqGIwCGIJIMQixDMsCIIg1pKxUEsQSPE
alAaJLIHtYQRRSkJkYkOCoJlJSEKqaEtSWgU1NDj/g6Hbz+s6QXJTClBEAwy
KJto0El9OcHnimwZDprsq9BPfbBCg2LABhXi2BkU5gMX0NWy64ZPQ2kPHKnJ
X8M9z34AEqrDexg76onDpdRNUcKlT8KXcDYDN+TMV/js1b5BUTr6DTXRv6IS
c7xklFTpslCg0LFZD7k+PhvaH9U8yBkr9MLh39l+eKrlCGG72bMGt1gMK9RI
nU7YlSi4oG5K/yEnDbUdfEE2PVk5Tnpc7qiGqUkzFZ7ovTRo4rMaoWSe2Qoj
fdt1Gny4vKPBzooEHTYFuhlQGQ5W2fAr20yBtx0iGuQZxUU1ahUDvv8Yi57v
WNzyUE6QicxdQcM61w/LFmuD8B9aNetE
  "],
 CellLabel->
  "In[335]:=",ExpressionUUID->"2319b478-ba51-4816-a1a9-57e433e16cf8"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4}, {{{1, 2}, {2, 3}, {4, 2}, {4, 3}}, Null}, {
      EdgeLabels -> {DirectedEdge[4, 2] -> Placed[
           Framed[
            Style[$CellContext`d, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[2, 3] -> Placed[
           Framed[
            Style[$CellContext`a, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[4, 3] -> Placed[
           Framed[
            Style[$CellContext`b, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[1, 2] -> Placed[
           Framed[
            Style[$CellContext`c, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"]}, EdgeStyle -> {
         GrayLevel[0]}, 
       EdgeWeight -> {$CellContext`c, $CellContext`a, $CellContext`d, \
$CellContext`b}, GraphLayout -> "LayeredEmbedding", 
       VertexCoordinates -> {{0, 0}, {1, 0}, {2, 0}, {1.5, 1}}, 
       VertexLabels -> {
        3 -> Placed["Y", Center], 4 -> Placed["W", Center], 2 -> 
         Placed["M", Center], 1 -> Placed["X", Center]}, 
       VertexLabelStyle -> {
         Directive[
          RGBColor[1, 0, 0], Italic, 26]}, VertexSize -> {0.3}, VertexStyle -> {
         GrayLevel[0]}, VertexWeight -> {
         Subscript[$CellContext`\[Sigma], $CellContext`uW], 
         Subscript[$CellContext`\[Sigma], $CellContext`uX], 
         Subscript[$CellContext`\[Sigma], $CellContext`uM], 
         Subscript[$CellContext`\[Sigma], $CellContext`uY]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {GrayLevel[0], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 0.}, {1., 0.}}, 0.15], InsetBox[
          FrameBox[
           StyleBox["c",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 0.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["a",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1.5, 1.}, {1., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["d",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.25, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1.5, 1.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["b",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.75, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 0.}, 0.15], InsetBox[
          StyleBox["\<\"X\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {0., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.15], InsetBox[
          StyleBox["\<\"M\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 0.}, 0.15], InsetBox[
          StyleBox["\<\"Y\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{1.5, 1.}, 0.15], InsetBox[
          StyleBox["\<\"W\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1.5, 1.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.8594603171460943`*^9, 3.859460386017805*^9}, {
   3.859460454785201*^9, 3.8594605998876123`*^9}, 3.8594606415257893`*^9, 
   3.859461268058887*^9, 3.859461543872567*^9, 3.859466284866777*^9, 
   3.859470279216584*^9, 3.859470394271792*^9, 3.85947042966777*^9, 
   3.859470494745961*^9, 3.859470536051578*^9, 3.859470585553668*^9, {
   3.859521734023562*^9, 3.859521753987259*^9}, 3.8595229955804377`*^9, 
   3.8595427752146187`*^9, 3.859546029888934*^9, 3.859557352486274*^9, 
   3.859557518895973*^9, 3.859557549725955*^9, 3.859558667544119*^9, 
   3.859591278099156*^9, 3.859591312709568*^9, {3.859591359015799*^9, 
   3.859591388708403*^9}, 3.8595915848026648`*^9, 3.859591708969687*^9, 
   3.85960777014734*^9, 3.859610027389793*^9, 3.859631367762354*^9, 
   3.8597012074244337`*^9, 3.859701238831704*^9, 3.859885020025416*^9, 
   3.859885166451066*^9, 3.85988534067631*^9, 3.859885565340048*^9, 
   3.859885599261207*^9, 3.859885664256173*^9, 3.859885861916664*^9, 
   3.859886104261126*^9, {3.8598862075558357`*^9, 3.859886253854308*^9}, 
   3.859886415104455*^9, 3.859887265987966*^9, 3.8598877621058617`*^9, 
   3.8598877943368883`*^9, 3.859887828331506*^9, 3.859967774529307*^9, 
   3.859980996384199*^9, 3.8600361395965853`*^9, 3.860150627811681*^9, 
   3.8602224868258743`*^9, 3.860222649614502*^9, 3.86022309117213*^9, 
   3.861254042574033*^9, 3.861750777581769*^9, 3.863856312811172*^9, 
   3.864116567098157*^9, {3.8641883493590193`*^9, 3.864188374288547*^9}, 
   3.864188405917667*^9, {3.8641884522482643`*^9, 3.864188472928413*^9}, 
   3.8648757458036757`*^9, 3.867905723401997*^9, 3.8691144349553337`*^9, 
   3.8691149677202797`*^9, 3.869226588772882*^9, 3.8692927542188787`*^9, 
   3.869305638672641*^9, 3.8693098160729723`*^9, 3.869563783596209*^9, 
   3.869692410153561*^9, 3.8715665362711487`*^9, 3.872246838309731*^9},
 CellLabel->
  "Out[348]=",ExpressionUUID->"be2d1177-5b26-4c90-9bf6-346b94e9e1c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eweightlookup", "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"ArrayRules", "@", 
      RowBox[{"WeightedAdjacencyMatrix", "[", "causalgraphiv", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8594606713535023`*^9, 3.859460687989484*^9}, {
  3.859460757668127*^9, 3.8594607600893993`*^9}, {3.859461892329628*^9, 
  3.859461896820756*^9}, {3.859461939972322*^9, 3.859461952336578*^9}, {
  3.85959134581249*^9, 3.8595913458676977`*^9}, {3.8641883517602787`*^9, 
  3.8641883527498426`*^9}, {3.86418848789916*^9, 3.864188488326531*^9}},
 NumberMarks->False,
 CellLabel->
  "In[349]:=",ExpressionUUID->"f7f930c2-2f56-40e1-b25f-6e30fea00ead"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "2"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"2", "\[DirectedEdge]", "3"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{"4", "\[DirectedEdge]", "2"}], "\[Rule]", "d"}], ",", 
   RowBox[{
    RowBox[{"4", "\[DirectedEdge]", "3"}], "\[Rule]", "b"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591313069002*^9, 
   3.859591359276739*^9, 3.859591394007164*^9, 3.859591584820829*^9, 
   3.859591708977866*^9, 3.8596077701534157`*^9, 3.8596100273978577`*^9, 
   3.8596313677717524`*^9, 3.859701207482258*^9, 3.859701238853579*^9, 
   3.859885020056724*^9, 3.859885166459116*^9, 3.8598853406844263`*^9, 
   3.8598855653471327`*^9, 3.8598855992688427`*^9, 3.859885664263939*^9, 
   3.859885861923909*^9, 3.859886104268804*^9, {3.8598862075637407`*^9, 
   3.859886253862501*^9}, 3.859886415113274*^9, 3.8598872659976*^9, 
   3.859887762115253*^9, 3.859887794346856*^9, 3.8598878283404713`*^9, 
   3.859967774535819*^9, 3.859980996397859*^9, 3.8600361396149063`*^9, 
   3.8601506278258142`*^9, 3.860222486832569*^9, 3.860222649621842*^9, 
   3.860223091179274*^9, 3.8612540734485893`*^9, 3.861750777600848*^9, 
   3.8638563128221292`*^9, 3.864116569569106*^9, {3.8641883542004433`*^9, 
   3.864188376867119*^9}, {3.864188475197609*^9, 3.8641884888765717`*^9}, 
   3.864875745810296*^9, 3.867905723425831*^9, 3.869114434962207*^9, 
   3.869114967730034*^9, 3.869226588795788*^9, 3.869292754234779*^9, 
   3.869305638686737*^9, 3.869309816084168*^9, 3.869563783620129*^9, 
   3.869692410170726*^9, 3.871566536315549*^9, 3.872246838323184*^9},
 CellLabel->
  "Out[349]=",ExpressionUUID->"029b9dc9-417b-4ee9-86c3-bfd75eda3a31"]
}, Open  ]],

Cell[TextData[{
 "Now we can apply this! Say we want to evaluate the expectation value \
E[ux*um | X,M]. First, we need to calculate the joint covariance between all \
four variables.",
 StyleBox["\n",
  FontColor->GrayLevel[0]]
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
   3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
   3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
   3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
   3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
   3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
   3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
   3.858337999684861*^9}, {3.858338318328642*^9, 3.858338330985588*^9}, {
   3.858338386385976*^9, 3.858338403783554*^9}, {3.858338535213355*^9, 
   3.858338577034197*^9}, {3.858338652546804*^9, 3.8583386617161016`*^9}, {
   3.858338759635105*^9, 3.858338795923196*^9}, {3.858338841585185*^9, 
   3.858338916581684*^9}, {3.858339075022015*^9, 3.8583390813359327`*^9}, {
   3.858346827071652*^9, 3.85834682807152*^9}, {3.8595435455848227`*^9, 
   3.859543581806551*^9}, 
   3.8595439831394987`*^9},ExpressionUUID->"4ce69ac0-6ad0-431f-a089-\
33a35f74615b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv", "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"allvariances", "=", 
   RowBox[{"GraphNodeVariance", "[", "causalgraphiv", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"causalgraphiv", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Sig", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondVar", "[", 
   RowBox[{"causalgraphiv", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.859543456025009*^9, 3.859543464098876*^9}, {
  3.859544443127898*^9, 3.859544505923212*^9}, {3.859544613314905*^9, 
  3.859544614650338*^9}, {3.859544910325439*^9, 3.859544963556361*^9}, {
  3.859545083488456*^9, 3.859545127921324*^9}, {3.8595451601353827`*^9, 
  3.859545237085483*^9}, {3.8595452722968693`*^9, 3.859545273539131*^9}, {
  3.859545457472375*^9, 3.859545516603259*^9}, {3.859549232610675*^9, 
  3.859549252973567*^9}, {3.8595915589354477`*^9, 3.8595915663511972`*^9}, {
  3.864118320826148*^9, 3.864118331584223*^9}, {3.8641880893336983`*^9, 
  3.864188104043231*^9}},
 CellLabel->
  "In[350]:=",ExpressionUUID->"7a366d38-d200-44e3-b569-7a73811a5a11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "\[Rule]", "uX"}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"d", " ", "W"}], "+", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{
    RowBox[{"bW", "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ca", "+", 
        FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, 
   3.8648757458220053`*^9, 3.867905723471786*^9, 3.8691144349751663`*^9, 
   3.869114967748721*^9, 3.869226588813891*^9, 3.869292754249942*^9, 
   3.869305638700426*^9, 3.869309816099907*^9, 3.8695637836435623`*^9, 
   3.8696924101885967`*^9, 3.87156653635457*^9, 3.872246838335423*^9},
 CellLabel->
  "Out[350]=",ExpressionUUID->"892d0602-444c-411e-a546-43db450f59d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "W", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "X", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
     RowBox[{"c", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}], "+", 
     RowBox[{"d", " ", 
      SubsuperscriptBox["\[Sigma]", 
       RowBox[{"bW", "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"uM", "-", 
           FractionBox[
            RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ca", "+", 
           FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "M", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{"a", " ", 
      SubsuperscriptBox["\[Sigma]", "X", "2"]}], "+", 
     RowBox[{"b", " ", 
      SubsuperscriptBox["\[Sigma]", 
       RowBox[{"bW", "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"uM", "-", 
           FractionBox[
            RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ca", "+", 
           FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", 
     RowBox[{"bW", "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"uM", "-", 
         FractionBox[
          RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ca", "+", 
         FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, 
   3.8648757458220053`*^9, 3.867905723471786*^9, 3.8691144349751663`*^9, 
   3.869114967748721*^9, 3.869226588813891*^9, 3.869292754249942*^9, 
   3.869305638700426*^9, 3.869309816099907*^9, 3.8695637836435623`*^9, 
   3.8696924101885967`*^9, 3.87156653635457*^9, 3.872246838337246*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"16ffd74e-cb36-492d-83e4-d8093b1e45bb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]},
     {"0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]},
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]},
     {
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, 
   3.8648757458220053`*^9, 3.867905723471786*^9, 3.8691144349751663`*^9, 
   3.869114967748721*^9, 3.869226588813891*^9, 3.869292754249942*^9, 
   3.869305638700426*^9, 3.869309816099907*^9, 3.8695637836435623`*^9, 
   3.8696924101885967`*^9, 3.87156653635457*^9, 3.872246838338969*^9},
 CellLabel->
  "Out[353]//MatrixForm=",ExpressionUUID->"3bd3f45d-88d5-4a00-b3d4-\
826d28416dd8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"X"},
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, 
   3.8648757458220053`*^9, 3.867905723471786*^9, 3.8691144349751663`*^9, 
   3.869114967748721*^9, 3.869226588813891*^9, 3.869292754249942*^9, 
   3.869305638700426*^9, 3.869309816099907*^9, 3.8695637836435623`*^9, 
   3.8696924101885967`*^9, 3.87156653635457*^9, 3.872246838340506*^9},
 CellLabel->
  "Out[354]//MatrixForm=",ExpressionUUID->"294e630d-101f-4102-b6e8-\
efa849db8f79"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0"},
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, 
   3.8648757458220053`*^9, 3.867905723471786*^9, 3.8691144349751663`*^9, 
   3.869114967748721*^9, 3.869226588813891*^9, 3.869292754249942*^9, 
   3.869305638700426*^9, 3.869309816099907*^9, 3.8695637836435623`*^9, 
   3.8696924101885967`*^9, 3.87156653635457*^9, 3.872246838341876*^9},
 CellLabel->
  "Out[355]//MatrixForm=",ExpressionUUID->"8e382027-faa8-4640-8fc0-\
0ab98b40c1a2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CharacteristicPolynomial", "[", 
   RowBox[{"Sig", ",", "x"}], "]"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.8596098299897203`*^9, 3.859609945111977*^9}, 
   3.859609976972699*^9},
 CellLabel->
  "In[356]:=",ExpressionUUID->"272e4451-6ade-4efc-93ed-de83d981cc0b"],

Cell[BoxData[
 RowBox[{"x", " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["x", "3"], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", 
     SuperscriptBox["x", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"4", " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", "x", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.859609843520874*^9, 3.859609855048254*^9}, {
   3.859609889687147*^9, 3.859609945404512*^9}, 3.859609977439784*^9, 
   3.8596100274509497`*^9, 3.859631367844215*^9, 3.859701207599634*^9, 
   3.859701238974517*^9, 3.8598850201147823`*^9, 3.85988516651187*^9, 
   3.8598853407384567`*^9, 3.859885565395042*^9, 3.859885599320858*^9, 
   3.859885664314855*^9, 3.859885861974718*^9, 3.859886104319315*^9, {
   3.859886207614677*^9, 3.859886253915251*^9}, 3.8598864151713333`*^9, 
   3.8598872660601788`*^9, 3.859887762173218*^9, 3.85988779440408*^9, 
   3.859887828399729*^9, 3.8599677745842867`*^9, 3.859980996445022*^9, 
   3.860036139685253*^9, 3.860150627874468*^9, 3.8602224868734283`*^9, 
   3.860222649663681*^9, 3.8602230912187862`*^9, 3.861750777649396*^9, 
   3.8638563128639708`*^9, 3.864116573465136*^9, 3.8641885027770033`*^9, 
   3.8648757458392467`*^9, 3.867905723529894*^9, 3.8691144349928513`*^9, 
   3.869114967770776*^9, 3.869226588839402*^9, 3.869292754277275*^9, 
   3.8693056387299767`*^9, 3.86930981613195*^9, 3.869563783680925*^9, 
   3.869692410211452*^9, 3.871566536408861*^9, 3.8722468383537607`*^9},
 CellLabel->
  "Out[356]=",ExpressionUUID->"cbd32edd-f1ac-4627-85af-1867cdd37f05"]
}, Open  ]],

Cell[TextData[{
 "Extending our causal graph to have a dependency W\[Rule]M, linearly \
controlled by \[Epsilon], modifies the structural equations as follows:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "21384108-6286-49d9-be0e-c013055115f6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "8931c4e3-ec62-4304-97c3-515c41dbe7a7"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "5caf2c93-f486-4c83-a618-25704da1dda8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "1bb85bbe-9cdc-4395-b4a9-58091a3347ef"],
 ".\n\nApplying the standard FDC is not technically permitted, because node X \
no longer blocks all backdoor paths from M to Y; however, since W is \
unobserved, it cannot be a member of the FDC set. Since the intention is to \
evaluate error from violating this very assumption, we apply the FDC with \
{X,M} regardless, and obtain estimators as follows:\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "9baa2a1f-b5a1-4bb4-91de-7e4108c7b2ef"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     RowBox[{
      FractionBox["b", "d"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["x", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "x"], "i"]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["\[Epsilon]", "b"], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["m", "i"], "-", 
        SubscriptBox[
         SuperscriptBox["u", "m"], "i"]}], ")"}]}], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "7fe37e94-29ee-4d01-a4af-f77ad284fc4a"],
 ".\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 
   3.858325388127117*^9}},ExpressionUUID->"1941cb98-fc3b-4281-8753-\
e0e94c4cf6f8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xa", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ya", " ", "=", " ", 
    RowBox[{"{", "M", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["c", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Ya", ",", "Xa"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xc", " ", "=", " ", 
   RowBox[{"{", "X", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Yc", " ", "=", " ", 
    RowBox[{"{", "Y", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["ca", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{"Yc", ",", "Xc"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aIV", "^"], "=", 
  RowBox[{
   OverscriptBox["ca", "^"], "/", 
   OverscriptBox["c", "^"]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.858324779349805*^9, 3.8583247888458023`*^9}, {
   3.8583253078292217`*^9, 3.858325314837751*^9}, {3.858325396607929*^9, 
   3.85832542701947*^9}, {3.860036107824605*^9, 3.860036115763649*^9}, {
   3.864189020257053*^9, 3.864189103478299*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"5a73ce84-1458-4aa0-b4c0-e6ec04ce129f"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.864116577398624*^9, 3.864117114340075*^9, {3.8641890288247757`*^9, 
   3.864189104068159*^9}, 3.864875745843843*^9, 3.867905723571678*^9, 
   3.869114435005106*^9, 3.8691149677868557`*^9, 3.869226588858955*^9, 
   3.869292754293481*^9, 3.869305638743763*^9, 3.869309816147174*^9, 
   3.8695637837061977`*^9, 3.8696924102288227`*^9, 3.871566536449141*^9, 
   3.872246838366343*^9},
 CellLabel->
  "Out[359]=",ExpressionUUID->"a503ed25-3c2c-4d3c-b2d7-dbe4faa3551f"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"uM", "-", 
         FractionBox[
          RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      FractionBox[
       RowBox[{"ea", " ", "X"}], "d"]}], ")"}]}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.864116577398624*^9, 3.864117114340075*^9, {3.8641890288247757`*^9, 
   3.864189104068159*^9}, 3.864875745843843*^9, 3.867905723571678*^9, 
   3.869114435005106*^9, 3.8691149677868557`*^9, 3.869226588858955*^9, 
   3.869292754293481*^9, 3.869305638743763*^9, 3.869309816147174*^9, 
   3.8695637837061977`*^9, 3.8696924102288227`*^9, 3.871566536449141*^9, 
   3.87224683836792*^9},
 CellLabel->
  "Out[362]=",ExpressionUUID->"f9482d4c-3ccb-41df-8a7c-cd2d5224b772"],

Cell[BoxData[
 FractionBox[
  RowBox[{"X", ".", 
   RowBox[{"(", 
    RowBox[{"bW", "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
     RowBox[{"ca", " ", "X"}], "+", 
     FractionBox[
      RowBox[{"ea", " ", "X"}], "d"]}], ")"}]}], 
  RowBox[{"X", ".", "M"}]]], "Output",
 CellChangeTimes->{
  3.8583254393218*^9, 3.858329543265813*^9, 3.858329608531355*^9, 
   3.858330131665799*^9, 3.858335311665249*^9, {3.858335380216281*^9, 
   3.858335400085225*^9}, {3.858335477009038*^9, 3.858335484525206*^9}, 
   3.8583357390899754`*^9, 3.858335818002787*^9, 3.858335917181685*^9, 
   3.859546029764577*^9, 3.859557351354917*^9, 3.859557517829896*^9, 
   3.859557548829136*^9, 3.859558666250654*^9, 3.859591312415123*^9, 
   3.8595913587190323`*^9, 3.859591450918021*^9, 3.8595915848742228`*^9, 
   3.859591709029335*^9, 3.8596077701968527`*^9, 3.859610027464621*^9, 
   3.859631367860623*^9, 3.859701207630288*^9, 3.8597012390023117`*^9, 
   3.85988502012814*^9, 3.8598851665256577`*^9, 3.859885340751431*^9, 
   3.85988556540641*^9, 3.859885599333592*^9, 3.859885664327003*^9, 
   3.859885861986642*^9, 3.859886104331746*^9, {3.859886207626478*^9, 
   3.8598862539278727`*^9}, 3.859886415185102*^9, 3.859887266075395*^9, 
   3.859887762187325*^9, 3.859887794417515*^9, 3.85988782841502*^9, 
   3.8599677745942297`*^9, 3.859980996455461*^9, 3.860036139701679*^9, 
   3.8601506278875933`*^9, 3.8602224868844852`*^9, 3.860222649676942*^9, 
   3.860223091231185*^9, 3.8612539791217813`*^9, {3.8612540596143913`*^9, 
   3.8612540797472057`*^9}, 3.861750777661422*^9, 3.863856312874034*^9, 
   3.864116577398624*^9, 3.864117114340075*^9, {3.8641890288247757`*^9, 
   3.864189104068159*^9}, 3.864875745843843*^9, 3.867905723571678*^9, 
   3.869114435005106*^9, 3.8691149677868557`*^9, 3.869226588858955*^9, 
   3.869292754293481*^9, 3.869305638743763*^9, 3.869309816147174*^9, 
   3.8695637837061977`*^9, 3.8696924102288227`*^9, 3.871566536449141*^9, 
   3.872246838369246*^9},
 CellLabel->
  "Out[363]=",ExpressionUUID->"99495d76-30fa-4b75-89c8-8fd0ca026e02"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"M", "-", "uM"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aIV", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy00og3EAx/ERaV6WFdpGK2W2y7BZIyGPlHnbDMVMeU9essMKeW+NvOyA
RBZ2Uo6WaeU1HBhLEnIRloOXJ4ksQ/j/nsO3z+kbW2coafRnsVhCEmzoWfdK
d2hKMR36CdW8Vv8EYpfylXFxScuFloipKNhvShHDMlWYBHJ87XL48xepgCF7
mWnQ0zJLMb+mvAA+Ct40cN+Yv5pELJp8dkA6/GoLppq/D6DZaD2BZ3Hvl1BR
r/TCpl/XL7watwXKiMGuM8ZM3TEbbii1HGgduYiAE5V+fPhaVS2DPZ+bCqjO
a86GYXf9Kti9RhVCQVBTMazZTh+F+YeJFuh72PHAsfObexgwt/kEl52OF+jI
MLDlxAHZAuObXS6FK4lZjJbkBPbgLk3ZPiK5UFJaEQNFRXohFOhoEaxQ6cXw
NMfbN0QM4c2bYJu7mjdM7KXn+bCzI1o0Q5QnuePh+dfWWOoRTTlrr8fhba5d
oCfqrjei4T95evOh
  "],
 CellLabel->
  "In[364]:=",ExpressionUUID->"8498350e-58b1-44fd-a050-3ef1fd0e9881"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphiv", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{"aerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], "}"}],
           "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
  3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
  3.860036875204605*^9}, {3.864189213309959*^9, 3.864189237505952*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[366]:=",ExpressionUUID->"83a62cf8-254a-4c2b-bf5b-cefae74a4d35"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875745870904*^9, 3.8679057236268463`*^9, 
   3.869114435022896*^9, 3.869114967816846*^9, 3.869226588885654*^9, 
   3.8692927543172894`*^9, 3.869305638766417*^9, 3.869309816173047*^9, 
   3.869563783741259*^9, 3.869692410248659*^9, 3.8715665365036716`*^9, 
   3.872246838383057*^9},
 CellLabel->
  "Out[367]=",ExpressionUUID->"a673ff6a-c2a7-4fac-9046-62c832b20d43"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", "X"}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"M", "-", 
        RowBox[{"c", " ", "X"}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]}], 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875745870904*^9, 3.8679057236268463`*^9, 
   3.869114435022896*^9, 3.869114967816846*^9, 3.869226588885654*^9, 
   3.8692927543172894`*^9, 3.869305638766417*^9, 3.869309816173047*^9, 
   3.869563783741259*^9, 3.869692410248659*^9, 3.8715665365036716`*^9, 
   3.872246838393963*^9},
 CellLabel->
  "Out[369]=",ExpressionUUID->"24799f54-a6b1-4ee0-8c06-7d5e334b0f72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      FractionBox[
       RowBox[{"ea", " ", "X"}], "d"], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"e", " ", "X"}], "d"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"M", "-", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], 
          RowBox[{
           SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}]]}], ")"}]}]}], 
     ")"}]}], 
   RowBox[{"X", ".", "M"}]]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875745870904*^9, 3.8679057236268463`*^9, 
   3.869114435022896*^9, 3.869114967816846*^9, 3.869226588885654*^9, 
   3.8692927543172894`*^9, 3.869305638766417*^9, 3.869309816173047*^9, 
   3.869563783741259*^9, 3.869692410248659*^9, 3.8715665365036716`*^9, 
   3.872246838395979*^9},
 CellLabel->
  "Out[370]=",ExpressionUUID->"844f7158-e44c-4ecd-8452-229ddf3603ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"aIVcorr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["ca", "^"], "-", 
       RowBox[{"c", "*", "a"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["c", "^"], "-", "c"}], ")"}]}], "//", 
    RowBox[{"Expand", "//.", "structureEqs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<M\>\"", 
     ",", "\"\<Y\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphiv", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aIVcorrsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aIVcorr", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864189595862781*^9, 3.864189705397428*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"91ba22eb-2604-4514-90a1-2afea9e9b380"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "M", ",", 
   RowBox[{"bW", "+", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"uM", "-", 
       FractionBox[
        RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ca", "+", 
       FractionBox["ea", "d"]}], ")"}], " ", "X"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.864875745896141*^9, 
   3.867905723702215*^9, 3.8691144350483*^9, 3.869114967837522*^9, 
   3.86922658892922*^9, 3.8692927543397083`*^9, 3.8693056387895117`*^9, 
   3.869309816197641*^9, 3.8695637837849283`*^9, 3.869692410285214*^9, 
   3.871566536642706*^9, 3.872246838409919*^9},
 CellLabel->
  "Out[373]=",ExpressionUUID->"058f0c75-e99a-4f1e-9729-b51d080b146f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", "X"}], ",", 
   RowBox[{"uM", "\[Rule]", "0"}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"c", " ", "X"}]}], ",", 
   RowBox[{
    RowBox[{"bW", "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ca", "+", 
        FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "\[Rule]", 
    RowBox[{"a", " ", "c", " ", "X"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.864875745896141*^9, 
   3.867905723702215*^9, 3.8691144350483*^9, 3.869114967837522*^9, 
   3.86922658892922*^9, 3.8692927543397083`*^9, 3.8693056387895117`*^9, 
   3.869309816197641*^9, 3.8695637837849283`*^9, 3.869692410285214*^9, 
   3.871566536642706*^9, 3.872246838421475*^9},
 CellLabel->
  "Out[375]=",ExpressionUUID->"e02f3429-dbdb-4253-9482-0fd7317f3ec9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.864875745896141*^9, 
   3.867905723702215*^9, 3.8691144350483*^9, 3.869114967837522*^9, 
   3.86922658892922*^9, 3.8692927543397083`*^9, 3.8693056387895117`*^9, 
   3.869309816197641*^9, 3.8695637837849283`*^9, 3.869692410285214*^9, 
   3.871566536642706*^9, 3.8722468384231443`*^9},
 CellLabel->
  "Out[376]=",ExpressionUUID->"427c28bf-68e0-4966-8f9e-2f969d69d776"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.863856380066532*^9, 3.8638563950769453`*^9}, {
  3.8641165213663473`*^9, 3.8641165231740637`*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"40cd5ef8-5c1c-4c31-bae4-70c542e3838b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      RowBox[{"ea", " ", "X"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "e"}], " ", "X"}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"X", ".", "M"}]]}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.86487574591331*^9, 
   3.8679057237572412`*^9, 3.869114435063286*^9, 3.8691149678564672`*^9, 
   3.869226588964572*^9, 3.869292754360878*^9, 3.869305638810555*^9, 
   3.869309816220948*^9, 3.8695637838326273`*^9, 3.8696924103181763`*^9, 
   3.871566536716852*^9, 3.872246838434834*^9},
 CellLabel->
  "Out[377]=",ExpressionUUID->"370bffe1-2809-4eee-87a4-b053bf6d185d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      RowBox[{"ea", " ", "X"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "e"}], " ", "X"}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{"X", ".", "M"}]]}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.86487574591331*^9, 
   3.8679057237572412`*^9, 3.869114435063286*^9, 3.8691149678564672`*^9, 
   3.869226588964572*^9, 3.869292754360878*^9, 3.869305638810555*^9, 
   3.869309816220948*^9, 3.8695637838326273`*^9, 3.8696924103181763`*^9, 
   3.871566536716852*^9, 3.872246838436379*^9},
 CellLabel->
  "Out[378]=",ExpressionUUID->"321249d2-b5ff-46e5-b608-9d01284096df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"b", " ", "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "-", 
    FractionBox["b", "\[Epsilon]"]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], "}"}],
           "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.8612536672031307`*^9, 3.8612536799745626`*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"59a665c1-37ce-44f5-9c88-dd765f025291"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["b", "\[Epsilon]"]}], "+", 
  FractionBox[
   RowBox[{"b", " ", "\[Epsilon]", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[Epsilon]", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.8612536806018353`*^9, 3.861254086272423*^9, 
  3.86385631329045*^9, 3.864875745927352*^9, 3.867905723796543*^9, 
  3.869114435075184*^9, 3.869114967873947*^9, 3.869226588982533*^9, 
  3.8692927543792467`*^9, 3.869305638827736*^9, 3.869309816240238*^9, 
  3.8695637838594217`*^9, 3.869692410336132*^9, 3.871566536758231*^9, 
  3.872246838447822*^9},
 CellLabel->
  "Out[379]=",ExpressionUUID->"73a145eb-dcde-41f0-836b-db7bff7865d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", "\"\<X\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphcm", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<M\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8638671588478518`*^9, 3.863867216342785*^9}, {
  3.863867261316597*^9, 3.8638672618028812`*^9}},
 CellLabel->
  "In[380]:=",ExpressionUUID->"8acf20d7-4b78-4937-b795-2a71d8011143"],

Cell[BoxData[
 RowBox[{"{", "X", "}"}]], "Output",
 CellChangeTimes->{{3.863867170909947*^9, 3.863867216650784*^9}, 
   3.863867262517476*^9, 3.864875745940688*^9, 3.867905723837009*^9, 
   3.8691144350865097`*^9, 3.8691149678916683`*^9, 3.869226589002705*^9, 
   3.869292754387519*^9, 3.869305638842084*^9, 3.869309816256103*^9, 
   3.869563783884248*^9, 3.8696924103536587`*^9, 3.871566536796949*^9, 
   3.872246838459893*^9},
 CellLabel->
  "Out[381]=",ExpressionUUID->"3304dc5c-846e-47dd-8a2f-b7e4afcf0643"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"X", "\[Rule]", 
   FractionBox[
    RowBox[{"c", " ", "M", " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.863867170909947*^9, 3.863867216650784*^9}, 
   3.863867262517476*^9, 3.864875745940688*^9, 3.867905723837009*^9, 
   3.8691144350865097`*^9, 3.8691149678916683`*^9, 3.869226589002705*^9, 
   3.869292754387519*^9, 3.869305638842084*^9, 3.869309816256103*^9, 
   3.869563783884248*^9, 3.8696924103536587`*^9, 3.871566536796949*^9, 
   3.8722468384614*^9},
 CellLabel->
  "Out[383]=",ExpressionUUID->"89560fe1-919e-40ac-b125-1efe4a46a6bd"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", "d", " ", 
     RowBox[{"M", ".", "uM"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
    RowBox[{"a", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "uX"}], ")"}]}], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "uY"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
    RowBox[{"c", " ", "d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"ca", " ", "M"}], ")"}]}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"ea", " ", "M"}], ")"}]}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"a", " ", 
     SuperscriptBox["c", "2"], " ", "d", " ", 
     RowBox[{"M", ".", "uM"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
    RowBox[{"a", " ", 
     SuperscriptBox["c", "2"], " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "uX"}], ")"}]}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["c", "2"], " ", "d", " ", 
     RowBox[{"M", ".", "uY"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "bW"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "-", 
    RowBox[{"a", " ", "d", " ", 
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.863867170909947*^9, 3.863867216650784*^9}, 
   3.863867262517476*^9, 3.864875745940688*^9, 3.867905723837009*^9, 
   3.8691144350865097`*^9, 3.8691149678916683`*^9, 3.869226589002705*^9, 
   3.869292754387519*^9, 3.869305638842084*^9, 3.869309816256103*^9, 
   3.869563783884248*^9, 3.8696924103536587`*^9, 3.871566536796949*^9, 
   3.872246838482204*^9},
 CellLabel->
  "Out[384]=",ExpressionUUID->"88305552-7cd4-4b62-9cfc-79e1307e4be0"]
}, Open  ]],

Cell["Similarly for c:", "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
  3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
  3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
  3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
  3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
  3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
  3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
  3.858337999684861*^9}, {3.858338170753792*^9, 
  3.85833817346621*^9}},ExpressionUUID->"16b21cec-b960-44ed-85b1-\
f95d70657655"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "\[Rule]", 
      RowBox[{
       RowBox[{"c", "*", "X"}], "+", 
       RowBox[{"\[Epsilon]", "*", "W"}], "+", "uM"}]}], ",", " ", 
     RowBox[{"W", "->", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["cplusedivd", "^"], "-", "c"}], "//.", "structureEqs"}], "//",
    "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uM\>\"", ",", "\"\<uX\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"noises", "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphcm", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeanreplace", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"noises", ",", "condmeans"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "/.", "condmeanreplace"}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338267786409*^9}, {
   3.859558614011969*^9, 3.859558647788122*^9}, {3.85955879728541*^9, 
   3.859558823382238*^9}, {3.8595588600651493`*^9, 3.859558869104723*^9}, {
   3.859558901600066*^9, 3.8595589122563334`*^9}, {3.860036194108721*^9, 
   3.86003619421777*^9}, {3.860036883849634*^9, 3.860036883936343*^9}, 
   3.860038282842125*^9, {3.860038533209559*^9, 3.8600385704905977`*^9}, {
   3.861253286929769*^9, 3.861253287988051*^9}, {3.8612540943031816`*^9, 
   3.861254105159108*^9}},
 CellLabel->
  "In[385]:=",ExpressionUUID->"28d5c79e-de88-48d4-bcfd-838393b39959"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "uX"}], "+", "X"}], ")"}], " ", "\[Epsilon]"}], "d"]}],
      ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.85959131545763*^9, 3.859591359351385*^9, 3.859591584932322*^9, 
   3.859591709078452*^9, 3.859607770232106*^9, 3.859610027512891*^9, 
   3.85963136796106*^9, 3.859701207722165*^9, 3.859701239097814*^9, 
   3.8598850201698923`*^9, 3.859885166568738*^9, 3.859885340795495*^9, 
   3.859885565449551*^9, 3.859885599377165*^9, 3.859885664369411*^9, 
   3.85988586202808*^9, 3.85988610437422*^9, {3.859886207669685*^9, 
   3.859886253969054*^9}, 3.859886415232485*^9, 3.859887266126856*^9, 
   3.859887762238892*^9, 3.859887794466033*^9, 3.859887828468302*^9, 
   3.8599677746291122`*^9, 3.859980996491336*^9, 3.8600361404766293`*^9, 
   3.860036195497006*^9, 3.8600368848132467`*^9, 3.860038284147812*^9, {
   3.860038556092149*^9, 3.860038571466565*^9}, 3.860150628371627*^9, 
   3.860222487301791*^9, 3.8602226500932217`*^9, 3.860223091652135*^9, 
   3.86125397216308*^9, {3.861254088259173*^9, 3.861254105574132*^9}, 
   3.863856313300393*^9, 3.864875745974411*^9, 3.867905723961187*^9, 
   3.869114435121176*^9, 3.8691149679333487`*^9, 3.8692265890602407`*^9, 
   3.86929275443941*^9, 3.869305638886683*^9, 3.869309816300664*^9, 
   3.8695637839569683`*^9, 3.869692410396268*^9, 3.8715665369216433`*^9, 
   3.872246838495483*^9},
 CellLabel->
  "Out[386]=",ExpressionUUID->"fb8556e9-6388-404c-9609-75e30775544b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"c", " ", "X"}], ")"}]}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.85959131545763*^9, 3.859591359351385*^9, 3.859591584932322*^9, 
   3.859591709078452*^9, 3.859607770232106*^9, 3.859610027512891*^9, 
   3.85963136796106*^9, 3.859701207722165*^9, 3.859701239097814*^9, 
   3.8598850201698923`*^9, 3.859885166568738*^9, 3.859885340795495*^9, 
   3.859885565449551*^9, 3.859885599377165*^9, 3.859885664369411*^9, 
   3.85988586202808*^9, 3.85988610437422*^9, {3.859886207669685*^9, 
   3.859886253969054*^9}, 3.859886415232485*^9, 3.859887266126856*^9, 
   3.859887762238892*^9, 3.859887794466033*^9, 3.859887828468302*^9, 
   3.8599677746291122`*^9, 3.859980996491336*^9, 3.8600361404766293`*^9, 
   3.860036195497006*^9, 3.8600368848132467`*^9, 3.860038284147812*^9, {
   3.860038556092149*^9, 3.860038571466565*^9}, 3.860150628371627*^9, 
   3.860222487301791*^9, 3.8602226500932217`*^9, 3.860223091652135*^9, 
   3.86125397216308*^9, {3.861254088259173*^9, 3.861254105574132*^9}, 
   3.863856313300393*^9, 3.864875745974411*^9, 3.867905723961187*^9, 
   3.869114435121176*^9, 3.8691149679333487`*^9, 3.8692265890602407`*^9, 
   3.86929275443941*^9, 3.869305638886683*^9, 3.869309816300664*^9, 
   3.8695637839569683`*^9, 3.869692410396268*^9, 3.8715665369216433`*^9, 
   3.87224683849712*^9},
 CellLabel->
  "Out[391]=",ExpressionUUID->"b3e341de-e2fe-4339-9256-858ff9650e5e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.858338200678625*^9, 3.858338268050568*^9}, 
   3.859546029971702*^9, 3.859557354131118*^9, 3.8595575207226*^9, 
   3.859557550803891*^9, 3.859558669612838*^9, {3.859558800727542*^9, 
   3.859558824150867*^9}, {3.85955890638067*^9, 3.8595589131350117`*^9}, 
   3.85959131545763*^9, 3.859591359351385*^9, 3.859591584932322*^9, 
   3.859591709078452*^9, 3.859607770232106*^9, 3.859610027512891*^9, 
   3.85963136796106*^9, 3.859701207722165*^9, 3.859701239097814*^9, 
   3.8598850201698923`*^9, 3.859885166568738*^9, 3.859885340795495*^9, 
   3.859885565449551*^9, 3.859885599377165*^9, 3.859885664369411*^9, 
   3.85988586202808*^9, 3.85988610437422*^9, {3.859886207669685*^9, 
   3.859886253969054*^9}, 3.859886415232485*^9, 3.859887266126856*^9, 
   3.859887762238892*^9, 3.859887794466033*^9, 3.859887828468302*^9, 
   3.8599677746291122`*^9, 3.859980996491336*^9, 3.8600361404766293`*^9, 
   3.860036195497006*^9, 3.8600368848132467`*^9, 3.860038284147812*^9, {
   3.860038556092149*^9, 3.860038571466565*^9}, 3.860150628371627*^9, 
   3.860222487301791*^9, 3.8602226500932217`*^9, 3.860223091652135*^9, 
   3.86125397216308*^9, {3.861254088259173*^9, 3.861254105574132*^9}, 
   3.863856313300393*^9, 3.864875745974411*^9, 3.867905723961187*^9, 
   3.869114435121176*^9, 3.8691149679333487`*^9, 3.8692265890602407`*^9, 
   3.86929275443941*^9, 3.869305638886683*^9, 3.869309816300664*^9, 
   3.8695637839569683`*^9, 3.869692410396268*^9, 3.8715665369216433`*^9, 
   3.872246838498397*^9},
 CellLabel->
  "Out[392]=",ExpressionUUID->"0f6bdb08-5910-4e87-8dd6-1f7b0e5ddbd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.8638563392567997`*^9, 3.863856368808345*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"07c44553-b95b-4067-9d07-9c5f1b2db83c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.863856363167431*^9, 3.8638563692670603`*^9}, 
   3.864875745988269*^9, 3.867905724001402*^9, 3.869114435133585*^9, 
   3.869114967949596*^9, 3.8692265890798597`*^9, 3.869292754459639*^9, 
   3.86930563890729*^9, 3.869309816323214*^9, 3.869563783986957*^9, 
   3.869692410421324*^9, 3.871566536964202*^9, 3.872246838509288*^9},
 CellLabel->
  "Out[393]=",ExpressionUUID->"e7566a06-c9bd-4358-8d9f-8086c03faf7d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraph", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimate", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "*", "cerror"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"covestimatesimp", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"covestimate", "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
             "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
     "Simplify"}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.8595579821985483`*^9, 3.859558061814584*^9}, {
  3.859558655476707*^9, 3.859558658433288*^9}, {3.8595590766617002`*^9, 
  3.859559108103771*^9}, {3.860036889983594*^9, 3.860036890328168*^9}, {
  3.860037064690646*^9, 3.860037079570932*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"5be26913-1549-4def-8a47-e2a24d5f51fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.8648757460008507`*^9, 
   3.867905724046682*^9, 3.86911443514576*^9, 3.869114967963602*^9, 
   3.869226589097336*^9, 3.869292754475479*^9, 3.869305638921419*^9, 
   3.869309816338942*^9, 3.869563784012013*^9, 3.869692410439375*^9, 
   3.871566537009609*^9, 3.8722468385221653`*^9},
 CellLabel->
  "Out[396]=",ExpressionUUID->"c79e1265-6855-4e8c-b26b-f0fcd95b3613"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", "X"}], ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{"M", "-", 
     RowBox[{"c", " ", "X"}]}]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.8648757460008507`*^9, 
   3.867905724046682*^9, 3.86911443514576*^9, 3.869114967963602*^9, 
   3.869226589097336*^9, 3.869292754475479*^9, 3.869305638921419*^9, 
   3.869309816338942*^9, 3.869563784012013*^9, 3.869692410439375*^9, 
   3.871566537009609*^9, 3.872246838523674*^9},
 CellLabel->
  "Out[398]=",ExpressionUUID->"715a2bf0-2c86-40e5-82da-62dcf09f2870"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "a"}], "+", 
    FractionBox[
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"bW", "+", 
        RowBox[{"a", " ", "uM"}], "-", 
        FractionBox[
         RowBox[{"a", " ", "e", " ", "uX"}], "d"], "+", "uY", "+", 
        RowBox[{"ca", " ", "X"}], "+", 
        FractionBox[
         RowBox[{"ea", " ", "X"}], "d"]}], ")"}]}], 
     RowBox[{"X", ".", "M"}]]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "c"}], "+", 
    FractionBox[
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"uM", "+", 
        RowBox[{"c", " ", "X"}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "uX"}], "+", "X"}], ")"}], " ", "\[Epsilon]"}], 
         "d"]}], ")"}]}], 
     RowBox[{"X", ".", "X"}]]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.8648757460008507`*^9, 
   3.867905724046682*^9, 3.86911443514576*^9, 3.869114967963602*^9, 
   3.869226589097336*^9, 3.869292754475479*^9, 3.869305638921419*^9, 
   3.869309816338942*^9, 3.869563784012013*^9, 3.869692410439375*^9, 
   3.871566537009609*^9, 3.87224683852503*^9},
 CellLabel->
  "Out[399]=",ExpressionUUID->"6b62da0e-fab5-48ef-b886-51c15933f11f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"a", " ", "\[Epsilon]"}], "d"]}], "+", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "bW"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", "\[Epsilon]", " ", 
    RowBox[{"X", ".", "uM"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}]}]], "-", 
  FractionBox[
   RowBox[{"a", " ", "\[Epsilon]", " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"e", " ", "uX"}], ")"}]}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"X", ".", "M"}]}]], "+", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "uY"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}]}]], "-", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"X", ".", "uM"}]}], 
   RowBox[{"X", ".", "X"}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"X", ".", "bW"}], " ", 
    RowBox[{"X", ".", "uM"}]}], 
   RowBox[{
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"X", ".", "uM"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", "\[Epsilon]", " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "X"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "bW"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "-", 
  FractionBox[
   RowBox[{"a", " ", "\[Epsilon]", " ", 
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", "uX"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "-", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"e", " ", "uX"}], ")"}]}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", "\[Epsilon]", " ", 
    RowBox[{"X", ".", "uX"}], " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"e", " ", "uX"}], ")"}]}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", "uY"}]}], 
   RowBox[{
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "uX"}], " ", 
    RowBox[{"X", ".", "uY"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "+", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"ca", " ", "X"}], ")"}]}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"ca", " ", "X"}], ")"}]}]}], 
   RowBox[{
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "uX"}], " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"ca", " ", "X"}], ")"}]}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "+", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"ea", " ", "X"}], ")"}]}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"X", ".", "M"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"X", ".", "uM"}], " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"ea", " ", "X"}], ")"}]}]}], 
   RowBox[{"d", " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]], "-", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"X", ".", "uX"}], " ", 
    RowBox[{"X", ".", 
     RowBox[{"(", 
      RowBox[{"ea", " ", "X"}], ")"}]}]}], 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"X", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]]}]], "Output",
 CellChangeTimes->{
  3.8595580070636387`*^9, {3.859558038737299*^9, 3.859558062672244*^9}, 
   3.859558669623419*^9, {3.859559086584029*^9, 3.859559109999281*^9}, 
   3.8595913160828257`*^9, 3.859591359390189*^9, 3.859591584954681*^9, 
   3.859591709096043*^9, 3.859607770243002*^9, 3.85961002752923*^9, 
   3.859631367981798*^9, 3.859701207751149*^9, 3.859701239128227*^9, 
   3.8598850201852837`*^9, 3.859885166583355*^9, 3.859885340810473*^9, 
   3.859885565463208*^9, 3.859885599391181*^9, 3.859885664382176*^9, 
   3.859885862041593*^9, 3.859886104388515*^9, {3.859886207683717*^9, 
   3.8598862539823017`*^9}, 3.8598864152469997`*^9, 3.859887266144432*^9, 
   3.859887762255919*^9, 3.859887794482532*^9, 3.859887828484983*^9, 
   3.859967774640069*^9, 3.8599809965018253`*^9, 3.860036140494351*^9, 
   3.860036891676013*^9, {3.86003706566475*^9, 3.86003708004464*^9}, 
   3.860150628384529*^9, 3.860222487313682*^9, 3.8602226501073303`*^9, 
   3.860223091666215*^9, 3.8638563133215027`*^9, 3.8648757460008507`*^9, 
   3.867905724046682*^9, 3.86911443514576*^9, 3.869114967963602*^9, 
   3.869226589097336*^9, 3.869292754475479*^9, 3.869305638921419*^9, 
   3.869309816338942*^9, 3.869563784012013*^9, 3.869692410439375*^9, 
   3.871566537009609*^9, 3.872246840922961*^9},
 CellLabel->
  "Out[400]=",ExpressionUUID->"53a78653-d58e-4f55-88b4-e9f9d6bd8dac"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Instrumental Variables for Chains of Confounded Mediators, New Estimators\
\>", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.859559150645014*^9}, {3.864187779695509*^9, 3.8641877894520607`*^9}, {
  3.86427756096316*^9, 
  3.86427756298777*^9}},ExpressionUUID->"a55bea93-6432-48b9-ace0-\
e4ae96f426b0"],

Cell[TextData[{
 "We now consider the confounded mediator graph with an added instrument V \
prior to X.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "6ec2c2c5-1732-43da-bfef-f83afb88b7c9"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "v"], "i"]}], TraditionalForm]],ExpressionUUID->
  "66f52820-da72-4690-a1d3-5ae37c590bc1"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", 
    RowBox[{
     SubscriptBox["gv", "i"], "+", 
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f89d8bf4-120a-48fe-a85b-d2d4bb6f6743"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "8c89233a-6b38-4213-9fd5-2e8e2fa39fa7"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "f2c3e962-2b75-40c6-9ee9-93323b95aa41"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.859559164128237*^9, 3.859559167825494*^9}, {
  3.864187796712625*^9, 3.864187839733988*^9}, {3.864281011833482*^9, 
  3.864281066469715*^9}},ExpressionUUID->"458b2556-2a8d-4e1f-9a54-\
7fc2d26f0567"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"3", "\[DirectedEdge]", "4"}], ",", 
     RowBox[{"5", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"5", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"5", "\[DirectedEdge]", "4"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vnames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<V\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\"", ",", "\"\<Y\>\"", ",", 
     "\"\<W\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweights", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "uV"], ",", 
     SubscriptBox["\[Sigma]", "uX"], ",", 
     SubscriptBox["\[Sigma]", "uM"], ",", 
     SubscriptBox["\[Sigma]", "uY"], ",", 
     SubscriptBox["\[Sigma]", "uW"]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{"#1", ",", "Center"}], "]"}], "&"}], ",", "vnames"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eweights", "=", 
   RowBox[{"{", 
    RowBox[{"g", ",", "c", ",", "a", ",", "d", ",", "\[Epsilon]", ",", "b"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elabels", " ", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"edges", "\[Rule]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "#1", ",", "18", ",", "Italic", ",", "Bold", ",", "Blue"}], 
             "]"}], ",", 
            RowBox[{"Background", "->", "White"}], ",", 
            RowBox[{"FrameStyle", "->", "White"}]}], "]"}], ",", 
          "\"\<Middle\>\""}], "]"}], "&"}], ",", "eweights"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcoords", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookup", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vnames", "->", "vertices"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupname", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", "vnames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweightsnou", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "V"], ",", 
     SubscriptBox["\[Sigma]", "X"], ",", 
     SubscriptBox["\[Sigma]", "M"], ",", 
     SubscriptBox["\[Sigma]", "Y"], ",", 
     SubscriptBox["\[Sigma]", "W"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvars", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupweight", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
         "]"}], "->", "vweights"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "#", "]"}], "&"}], ",", "vnames"}], "]"}], "->",
         "vweightsnou"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"causalgraphiv2", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"edges", ",", 
    RowBox[{"VertexLabels", "->", "vlabels"}], ",", 
    RowBox[{"EdgeLabels", "->", "elabels"}], ",", 
    RowBox[{"VertexWeight", "\[Rule]", "vweights"}], ",", 
    RowBox[{"EdgeWeight", "\[Rule]", "eweights"}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "\"\<LayeredEmbedding\>\""}], ",", 
    RowBox[{"VertexStyle", "->", "Black"}], ",", 
    RowBox[{"VertexSize", "->", "0.3"}], ",", 
    RowBox[{"VertexLabelStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Italic", ",", "26"}], "]"}]}], ",", 
    RowBox[{"EdgeStyle", "->", "Black"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.859459024698772*^9, 3.85945909073498*^9}, {
   3.8594591488601418`*^9, 3.85945920659604*^9}, {3.859459250168518*^9, 
   3.859459470759325*^9}, {3.8594595102168293`*^9, 3.859459516941248*^9}, {
   3.8594595670407553`*^9, 3.859459575501747*^9}, {3.859459637054397*^9, 
   3.859459733232544*^9}, {3.859459793864605*^9, 3.859459798464903*^9}, {
   3.8594598359282227`*^9, 3.859459879181384*^9}, {3.859459929011056*^9, 
   3.859459955773423*^9}, {3.859460046652501*^9, 3.859460047994684*^9}, {
   3.8594601108291407`*^9, 3.859460204490776*^9}, {3.8594602607706623`*^9, 
   3.85946038574233*^9}, {3.859460451588697*^9, 3.8594605995420103`*^9}, {
   3.859460635281043*^9, 3.859460641202232*^9}, {3.859461205922871*^9, 
   3.8594612488478518`*^9}, {3.8594615336041813`*^9, 
   3.8594615435580072`*^9}, {3.859470243917905*^9, 3.859470277067479*^9}, {
   3.859470390971575*^9, 3.8594704292818203`*^9}, {3.8594704842614594`*^9, 
   3.8594704939840918`*^9}, {3.859470529038028*^9, 3.859470585013467*^9}, {
   3.8595216768829117`*^9, 3.859521694554061*^9}, {3.8595217268443832`*^9, 
   3.8595217536491823`*^9}, {3.859591254243828*^9, 3.85959127290304*^9}, {
   3.859591322318336*^9, 3.859591322390768*^9}, {3.8595913875452213`*^9, 
   3.859591388062249*^9}, {3.864188348488*^9, 3.8641883873067493`*^9}, {
   3.864188433360779*^9, 3.864188472515016*^9}, {3.864277576893174*^9, 
   3.8642776786858797`*^9}, 3.8642777509719343`*^9},
 CellLabel->
  "In[401]:=",ExpressionUUID->"9bb7b4be-cb8b-45d2-bc1d-87ffa9d55e1b"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 
      5}, {{{1, 2}, {2, 3}, {3, 4}, {5, 2}, {5, 3}, {5, 4}}, Null}, {
      EdgeLabels -> {DirectedEdge[5, 3] -> Placed[
           Framed[
            Style[$CellContext`\[Epsilon], 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[3, 4] -> Placed[
           Framed[
            Style[$CellContext`a, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[2, 3] -> Placed[
           Framed[
            Style[$CellContext`c, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[5, 4] -> Placed[
           Framed[
            Style[$CellContext`b, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[1, 2] -> Placed[
           Framed[
            Style[$CellContext`g, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[5, 2] -> Placed[
           Framed[
            Style[$CellContext`d, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"]}, EdgeStyle -> {
         GrayLevel[0]}, 
       EdgeWeight -> {$CellContext`g, $CellContext`c, $CellContext`a, \
$CellContext`d, $CellContext`\[Epsilon], $CellContext`b}, GraphLayout -> 
       "LayeredEmbedding", 
       VertexCoordinates -> {{0, 0}, {1, 0}, {2, 0}, {3, 0}, {2, 1}}, 
       VertexLabels -> {
        3 -> Placed["M", Center], 5 -> Placed["W", Center], 4 -> 
         Placed["Y", Center], 2 -> Placed["X", Center], 1 -> 
         Placed["V", Center]}, VertexLabelStyle -> {
         Directive[
          RGBColor[1, 0, 0], Italic, 26]}, VertexSize -> {0.3}, VertexStyle -> {
         GrayLevel[0]}, VertexWeight -> {
         Subscript[$CellContext`\[Sigma], $CellContext`uV], 
         Subscript[$CellContext`\[Sigma], $CellContext`uX], 
         Subscript[$CellContext`\[Sigma], $CellContext`uM], 
         Subscript[$CellContext`\[Sigma], $CellContext`uY], 
         Subscript[$CellContext`\[Sigma], $CellContext`uW]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {GrayLevel[0], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 0.}, {1., 0.}}, 0.15], InsetBox[
          FrameBox[
           StyleBox["g",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 0.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["c",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 0.}, {3., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["a",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {2.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 1.}, {1., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["d",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 1.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["\[Epsilon]",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {2., 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 1.}, {3., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["b",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {2.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 0.}, 0.15], InsetBox[
          StyleBox["\<\"V\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {0., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.15], InsetBox[
          StyleBox["\<\"X\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 0.}, 0.15], InsetBox[
          StyleBox["\<\"M\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{3., 0.}, 0.15], InsetBox[
          StyleBox["\<\"Y\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {3., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 1.}, 0.15], InsetBox[
          StyleBox["\<\"W\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 1.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.864277662537609*^9, 3.8642776793116503`*^9}, 
   3.864277753708777*^9, 3.864277807119232*^9, 3.8648757484933157`*^9, 
   3.867905729195159*^9, 3.869114437699519*^9, 3.8692265928025227`*^9, 
   3.869292756995686*^9, 3.869305641301607*^9, 3.869309818975349*^9, 
   3.869526928645076*^9, 3.869563787592888*^9, 3.8696924128872337`*^9, 
   3.871566542858939*^9, 3.87224684094986*^9},
 CellLabel->
  "Out[414]=",ExpressionUUID->"fba88e8c-30b8-4e32-ab09-63df8b7d6ebb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eweightlookup", "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"ArrayRules", "@", 
      RowBox[{"WeightedAdjacencyMatrix", "[", "causalgraphiv2", "]"}]}]}], 
    ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvarpairs", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"uvars", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uprodrules", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#1", "*", "#1"}], "->", 
         SuperscriptBox["#2", "2"]}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"uvars", ",", "vweights"}], "}"}]}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "->", "0"}], "&"}], ",", 
       "uvarpairs"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8594606713535023`*^9, 3.859460687989484*^9}, {
   3.859460757668127*^9, 3.8594607600893993`*^9}, {3.859461892329628*^9, 
   3.859461896820756*^9}, {3.859461939972322*^9, 3.859461952336578*^9}, {
   3.85959134581249*^9, 3.8595913458676977`*^9}, {3.8641883517602787`*^9, 
   3.8641883527498426`*^9}, {3.86418848789916*^9, 3.864188488326531*^9}, 
   3.8642777525040073`*^9, {3.869313211380677*^9, 3.8693132123290367`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[415]:=",ExpressionUUID->"c8768e9a-d927-4855-aa3a-daa8fba6e3b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "2"}], "\[Rule]", "g"}], ",", 
   RowBox[{
    RowBox[{"2", "\[DirectedEdge]", "3"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"3", "\[DirectedEdge]", "4"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{"5", "\[DirectedEdge]", "2"}], "\[Rule]", "d"}], ",", 
   RowBox[{
    RowBox[{"5", "\[DirectedEdge]", "3"}], "\[Rule]", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"5", "\[DirectedEdge]", "4"}], "\[Rule]", "b"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591313069002*^9, 
   3.859591359276739*^9, 3.859591394007164*^9, 3.859591584820829*^9, 
   3.859591708977866*^9, 3.8596077701534157`*^9, 3.8596100273978577`*^9, 
   3.8596313677717524`*^9, 3.859701207482258*^9, 3.859701238853579*^9, 
   3.859885020056724*^9, 3.859885166459116*^9, 3.8598853406844263`*^9, 
   3.8598855653471327`*^9, 3.8598855992688427`*^9, 3.859885664263939*^9, 
   3.859885861923909*^9, 3.859886104268804*^9, {3.8598862075637407`*^9, 
   3.859886253862501*^9}, 3.859886415113274*^9, 3.8598872659976*^9, 
   3.859887762115253*^9, 3.859887794346856*^9, 3.8598878283404713`*^9, 
   3.859967774535819*^9, 3.859980996397859*^9, 3.8600361396149063`*^9, 
   3.8601506278258142`*^9, 3.860222486832569*^9, 3.860222649621842*^9, 
   3.860223091179274*^9, 3.8612540734485893`*^9, 3.861750777600848*^9, 
   3.8638563128221292`*^9, 3.864116569569106*^9, {3.8641883542004433`*^9, 
   3.864188376867119*^9}, {3.864188475197609*^9, 3.8641884888765717`*^9}, 
   3.8642777556467857`*^9, 3.864277808856291*^9, 3.864875748501*^9, 
   3.867905729218108*^9, 3.8691144377071*^9, 3.8692265928227243`*^9, 
   3.869292757012314*^9, 3.869305641317418*^9, 3.869309818987529*^9, 
   3.8693132131736107`*^9, 3.8695269306398487`*^9, 3.8695637876180887`*^9, 
   3.869692412904904*^9, 3.871566542902338*^9, 3.872246840964163*^9},
 CellLabel->
  "Out[415]=",ExpressionUUID->"a7db3e76-24f8-420e-82d7-cd9786c238a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["uV", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uX", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uM", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uY", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uY", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uW", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uV"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uX", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uV"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uX", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uY"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591313069002*^9, 
   3.859591359276739*^9, 3.859591394007164*^9, 3.859591584820829*^9, 
   3.859591708977866*^9, 3.8596077701534157`*^9, 3.8596100273978577`*^9, 
   3.8596313677717524`*^9, 3.859701207482258*^9, 3.859701238853579*^9, 
   3.859885020056724*^9, 3.859885166459116*^9, 3.8598853406844263`*^9, 
   3.8598855653471327`*^9, 3.8598855992688427`*^9, 3.859885664263939*^9, 
   3.859885861923909*^9, 3.859886104268804*^9, {3.8598862075637407`*^9, 
   3.859886253862501*^9}, 3.859886415113274*^9, 3.8598872659976*^9, 
   3.859887762115253*^9, 3.859887794346856*^9, 3.8598878283404713`*^9, 
   3.859967774535819*^9, 3.859980996397859*^9, 3.8600361396149063`*^9, 
   3.8601506278258142`*^9, 3.860222486832569*^9, 3.860222649621842*^9, 
   3.860223091179274*^9, 3.8612540734485893`*^9, 3.861750777600848*^9, 
   3.8638563128221292`*^9, 3.864116569569106*^9, {3.8641883542004433`*^9, 
   3.864188376867119*^9}, {3.864188475197609*^9, 3.8641884888765717`*^9}, 
   3.8642777556467857`*^9, 3.864277808856291*^9, 3.864875748501*^9, 
   3.867905729218108*^9, 3.8691144377071*^9, 3.8692265928227243`*^9, 
   3.869292757012314*^9, 3.869305641317418*^9, 3.869309818987529*^9, 
   3.8693132131736107`*^9, 3.8695269306398487`*^9, 3.8695637876180887`*^9, 
   3.869692412904904*^9, 3.871566542902338*^9, 3.872246840965972*^9},
 CellLabel->
  "Out[417]=",ExpressionUUID->"70a307b9-67c8-4c59-aee0-1c226503a776"]
}, Open  ]],

Cell[TextData[{
 "Now we can apply this! Say we want to evaluate the expectation value \
E[ux*um | X,M]. First, we need to calculate the joint covariance between all \
four variables.",
 StyleBox["\n",
  FontColor->GrayLevel[0]]
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
   3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
   3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
   3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
   3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
   3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
   3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
   3.858337999684861*^9}, {3.858338318328642*^9, 3.858338330985588*^9}, {
   3.858338386385976*^9, 3.858338403783554*^9}, {3.858338535213355*^9, 
   3.858338577034197*^9}, {3.858338652546804*^9, 3.8583386617161016`*^9}, {
   3.858338759635105*^9, 3.858338795923196*^9}, {3.858338841585185*^9, 
   3.858338916581684*^9}, {3.858339075022015*^9, 3.8583390813359327`*^9}, {
   3.858346827071652*^9, 3.85834682807152*^9}, {3.8595435455848227`*^9, 
   3.859543581806551*^9}, 
   3.8595439831394987`*^9},ExpressionUUID->"62862608-bdad-4403-9d31-\
03fcd864b4c6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NodeCovariance", "[", 
    RowBox[{"graph_", ",", "node1_", ",", "node2_"}], "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"ReplaceRepeated", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", "node1", "]"}], "*", 
         RowBox[{"Symbol", "[", "node2", "]"}]}], ",", 
        RowBox[{"GraphNodeStructure", "[", "graph", "]"}]}], "]"}], "]"}], 
     ",", "uprodrules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "uV", "\[IndentingNewLine]", "uX", "\
\[IndentingNewLine]", "uW", "\[IndentingNewLine]", "uM", \
"\[IndentingNewLine]", "uW"}], "Input",
 CellChangeTimes->{{3.86931364662292*^9, 3.8693136610172653`*^9}},
 CellLabel->
  "In[418]:=",ExpressionUUID->"d2d22e61-3745-4000-af6f-bfafcfd346f1"],

Cell[BoxData["uV"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412921506*^9, 
   3.871566542946535*^9, 3.872246840977433*^9},
 CellLabel->
  "Out[419]=",ExpressionUUID->"e4e7fb90-5854-4df1-af61-c7e0995fe467"],

Cell[BoxData["uX"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412921506*^9, 
   3.871566542946535*^9, 3.872246840978713*^9},
 CellLabel->
  "Out[420]=",ExpressionUUID->"2586615c-a813-49e4-8000-30f561e60d0f"],

Cell[BoxData["uW"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412921506*^9, 
   3.871566542946535*^9, 3.872246840979827*^9},
 CellLabel->
  "Out[421]=",ExpressionUUID->"e35b10c3-775d-494c-876f-6852142a5f55"],

Cell[BoxData["uM"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412921506*^9, 
   3.871566542946535*^9, 3.872246840980898*^9},
 CellLabel->
  "Out[422]=",ExpressionUUID->"26890d0e-c318-4cc2-b187-25048e6b0a68"],

Cell[BoxData["uW"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412921506*^9, 
   3.871566542946535*^9, 3.872246840981872*^9},
 CellLabel->
  "Out[423]=",ExpressionUUID->"8b48146d-bf27-4998-b1ca-8fa0c50b2cd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"allvariances", "=", 
  RowBox[{
  "GraphNodeVariance", "[", "causalgraphiv2", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NodeCovariance", "[", 
  RowBox[{"causalgraphiv2", ",", "\"\<uX\>\"", ",", "\"\<X\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"causalgraphiv2", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Sig", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", 
    RowBox[{"{", "\"\<uX\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondVar", "[", 
   RowBox[{"causalgraphiv2", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/eAMw5a6g28c/2kybwXR+8RT9OuB9JcuW3MQvUV4
lQuInnT+Cpj+n3kqE0RvO1tYAKLzFubXg+ia6r8tIJovlKUTRLvvWTQJbE49
53QQPcHBEExvktVfB6Kf+U7eCqKXdQm3NQLpMvX5HSDa4P1dg2lAmsn2tCGI
Ppcv1WZxCmjOxqJ2EL1irdb0KCCtlsQ4E0R3J/IntAFptrOnwHTG4nQ3hStv
HF/JfXAH0bILPgeC6LC+3SEgumR60z4QfclzKZg+1frnOohO2Cd0A0TL+Mxx
VATS/PXzobS3tRKQTpIJswXRAMi4ouo=
  "],
 CellLabel->
  "In[424]:=",ExpressionUUID->"7d7e24b3-d94d-4aa8-aafe-131f72524eaf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{
    RowBox[{"bW", "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ca", "+", 
        FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.872246840993483*^9},
 CellLabel->
  "Out[424]=",ExpressionUUID->"499618ea-0692-4fb2-849d-332df91bf98b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "V", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "X", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
     RowBox[{"g", " ", 
      SubsuperscriptBox["\[Sigma]", "V", "2"]}], "+", 
     RowBox[{"d", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "M", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{"\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}], "+", 
     RowBox[{"c", " ", 
      SubsuperscriptBox["\[Sigma]", "X", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", 
     RowBox[{"bW", "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"uM", "-", 
         FractionBox[
          RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ca", "+", 
         FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "2"], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", 
      SubsuperscriptBox["\[Sigma]", "M", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uY", "2"], "+", 
     RowBox[{"b", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "W", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.8722468409952383`*^9},
 CellLabel->
  "Out[425]=",ExpressionUUID->"1edde00c-a45b-4ce7-9eb6-c2282d0f718f"],

Cell[BoxData[
 SubsuperscriptBox["\[Sigma]", "uX", "2"]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.872246840996723*^9},
 CellLabel->
  "Out[426]=",ExpressionUUID->"c4b6412f-a60b-4987-8d76-184efa72742f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]},
     {"0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]},
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]},
     {
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"2", " ", "c", " ", "d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.872246840998157*^9},
 CellLabel->
  "Out[428]//MatrixForm=",ExpressionUUID->"26467191-ed67-478c-aa64-\
06fa2c5144e1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", "M"}], "+", 
              RowBox[{"c", " ", "d", " ", "X"}], "+", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.872246840999898*^9},
 CellLabel->
  "Out[429]//MatrixForm=",ExpressionUUID->"ffe56387-2501-4812-8619-\
da20b59bbfba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", "M"}], "+", 
              RowBox[{"c", " ", "d", " ", "X"}], "+", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]},
      {
       FractionBox[
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M", "-", 
              RowBox[{"c", " ", "X"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", "M"}], "-", 
              RowBox[{"c", " ", "d", " ", "X"}], "-", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M", "-", 
              RowBox[{"c", " ", "X"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.872246841011375*^9},
 CellLabel->
  "Out[430]//MatrixForm=",ExpressionUUID->"d759463d-a1c5-4968-b81c-\
48ca59f73737"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}]}], ")"}], 
        " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]},
     {
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9, 3.871566542997818*^9, 
   3.8722468410225887`*^9},
 CellLabel->
  "Out[431]//MatrixForm=",ExpressionUUID->"27d6412b-7e55-43e3-9403-\
51412430f28c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CharacteristicPolynomial", "[", 
   RowBox[{"Sig", ",", "x"}], "]"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.8596098299897203`*^9, 3.859609945111977*^9}, 
   3.859609976972699*^9},
 CellLabel->
  "In[432]:=",ExpressionUUID->"8df664ac-bda9-44b8-94b8-bc227b1d103f"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "4"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{"2", " ", "c", " ", "d", " ", 
   SuperscriptBox["x", "3"], " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"2", " ", "c", " ", "d", " ", 
   SuperscriptBox["x", "2"], " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{"2", " ", "c", " ", "d", " ", 
   SuperscriptBox["x", "2"], " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", "c", " ", "d", " ", "x", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", "x", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "Output",
 CellChangeTimes->{{3.859609843520874*^9, 3.859609855048254*^9}, {
   3.859609889687147*^9, 3.859609945404512*^9}, 3.859609977439784*^9, 
   3.8596100274509497`*^9, 3.859631367844215*^9, 3.859701207599634*^9, 
   3.859701238974517*^9, 3.8598850201147823`*^9, 3.85988516651187*^9, 
   3.8598853407384567`*^9, 3.859885565395042*^9, 3.859885599320858*^9, 
   3.859885664314855*^9, 3.859885861974718*^9, 3.859886104319315*^9, {
   3.859886207614677*^9, 3.859886253915251*^9}, 3.8598864151713333`*^9, 
   3.8598872660601788`*^9, 3.859887762173218*^9, 3.85988779440408*^9, 
   3.859887828399729*^9, 3.8599677745842867`*^9, 3.859980996445022*^9, 
   3.860036139685253*^9, 3.860150627874468*^9, 3.8602224868734283`*^9, 
   3.860222649663681*^9, 3.8602230912187862`*^9, 3.861750777649396*^9, 
   3.8638563128639708`*^9, 3.864116573465136*^9, 3.8641885027770033`*^9, 
   3.86427781868827*^9, 3.8648757487495193`*^9, 3.8679057298916388`*^9, 
   3.869114437960512*^9, 3.8692265932245617`*^9, 3.8692927572551413`*^9, 
   3.869305641564396*^9, 3.8693098192399893`*^9, 3.869563787775721*^9, 
   3.8696924130083733`*^9, 3.8715665431614122`*^9, 3.8722468410429697`*^9},
 CellLabel->
  "Out[432]=",ExpressionUUID->"efdc3f6e-ee5c-459f-bd3d-238031229dd0"]
}, Open  ]],

Cell[TextData[{
 "We will now seek to construct an estimator with improved bias or variance \
over the standard IV estimators on causal effects a and ca.\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "65d36f26-b650-4fd3-b826-635122091be4"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "v"], "i"]}], TraditionalForm]],ExpressionUUID->
  "67d1cae9-5369-4b48-af6b-96ca1976c9a7"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", 
    RowBox[{
     SubscriptBox["gv", "i"], "+", 
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "80f71143-8f11-4b52-a4f2-e0a080c84791"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "2b4dc439-9aea-4e07-9a7a-dc47c56034d0"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "4552c78e-e123-462d-9278-0cb1da2fb503"],
 ".\n\nResXV = X - gV = dW + uX\nResMX = M - cX = eW + uM\n\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "samples"], TraditionalForm]],ExpressionUUID->
  "03ab9566-bb13-457b-a5dc-27902b88bb60"],
 "[",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Epsilon]", "d"], TraditionalForm]],ExpressionUUID->
  "24466bf8-c276-4dd8-9822-e1e4a9f7cd28"],
 "]\n\nSample i = {(W),V,X,M,Y}\n\n\nE[X - gV = dW + uX]\nE[X] - g E[V] = d \
E[W] = 0\n\nUnbiased\ng\nc\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dW", "i"], "+", 
    SubscriptBox["uX", "i"]}], TraditionalForm]],ExpressionUUID->
  "5e3ace8b-ab6b-4bf4-a6d8-235455d0c133"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["eW", "i"], "+", 
    SubscriptBox["uM", "i"]}], TraditionalForm]],ExpressionUUID->
  "fda57e4e-8b28-46c1-bdd6-3d679bd53552"],
 "\n\nc+e/d (small bias)\n\n\nc\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["eW", "i"], "+", 
    SubscriptBox["uM", "i"]}], TraditionalForm]],ExpressionUUID->
  "68b9e2fa-a729-48e0-9ab6-288cdb216583"],
 "\nW->X uniquely:   uW = (X-ux)/d\n\nX = dW + uX\nM = eW + cX + uM\n\ne \
.dinv(dw) - e.dinv(dw + ux)\ne(W) - e.dinv(dw + uX)\nbias ~= E[dW.uX] + \
Ew[dW^2]\n\n\n\n\nKey residual: Res\[CloseCurlyQuote] = uM - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["e", "d"], "uX"}], TraditionalForm]],ExpressionUUID->
  "226a3556-5a38-4158-8b07-e4021b0ed690"],
 " -  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "*", 
    RowBox[{"Cov", "(", 
     RowBox[{"X", ",", 
      RowBox[{"uM", "-", 
       RowBox[{
        RowBox[{"e", "/", "d"}], " ", "uX"}]}]}], ")"}], "*", 
    RowBox[{"X", "/", 
     SubscriptBox["\[Sigma]", "X"]}]}], TraditionalForm]],ExpressionUUID->
  "0dab8943-b30c-4bca-a813-c6754a7983bc"],
 ",    \[Alpha] \[Element] [0,1]\nsuch that Cov(X,Res\[CloseCurlyQuote]) = 0\n\
but ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Cov", "(", 
    RowBox[{"W", ",", 
     RowBox[{
      RowBox[{"Cov", "(", 
       RowBox[{"X", ",", 
        RowBox[{"uM", "-", 
         RowBox[{
          RowBox[{"e", "/", "d"}], " ", "uX"}]}]}], ")"}], "*", 
      RowBox[{"X", "/", 
       SubscriptBox["\[Sigma]", "X"]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"f2fdc46a-2da1-41f0-83d8-061a12c614cb"],
 ") != 0\n\n\nV(Res) = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uM"], "2"], "+", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[Epsilon]", "2"], 
      SuperscriptBox["d", "2"]], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "uX"], "2"]}]}], TraditionalForm]],
  ExpressionUUID->"7a62e2bf-fb64-4add-9519-8255a1a7ae21"],
 " =~ 2\nCov(X,Res) =  -",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["\[Epsilon]", "d"], 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uX"], "2"]}], TraditionalForm]],ExpressionUUID->
  "af2ede36-2c86-449d-8ea5-34e7467af945"],
 " =~ -1\n-- Need to check next order of these i.e. with V->X->M pathway\n\n* \
Key result: Take res1 = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "-", 
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"M", ".", "X"}], 
       RowBox[{"X", ".", "X"}]], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"00c40b20-1cac-40b4-8405-fdba9979dddd"],
 " as a vector-valued estimator\nThen, Cov(X,res1) = E[M.X - M.X] = 0\nbut \
Cov(W,res1) = E[W.M - ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"M", ".", "X"}], " ", 
     RowBox[{"W", ".", "X"}]}], 
    RowBox[{"X", ".", "X"}]], TraditionalForm]],ExpressionUUID->
  "6f6d4239-fc41-424f-a54a-cf8a83405333"],
 "] = eE[W.W] - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"eE", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"W", ".", "X"}], " ", 
      RowBox[{"W", ".", "X"}]}], 
     RowBox[{"X", ".", "X"}]], "]"}], TraditionalForm]],ExpressionUUID->
  "dd11ff51-6bc9-4e84-99d1-b68db62dab5e"],
 " - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"uM", ".", "X"}], " ", 
      RowBox[{"W", ".", "X"}]}], 
     RowBox[{"X", ".", "X"}]], "]"}], TraditionalForm]],ExpressionUUID->
  "c8bc5790-af9c-4a8c-b1fc-e23ebc48b080"],
 " != 0\n\nThis is counter to our intuition about uM - e/d uX, since:\nCov(uM \
- e/d uX, X) != 0\nCov(uM - e/d uX, W)  = 0\n\nWhat about res2?\n\nWe have \
(biased) knowledge of ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    FractionBox["\[Epsilon]", "d"], "^"], TraditionalForm]],ExpressionUUID->
  "38b0710f-3a33-4404-b456-01dedb704047"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uM"], "2"], "="}], TraditionalForm]],
  ExpressionUUID->"fdd6e232-cb22-4510-851b-2b7164767a3f"],
 " V(Res) + ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    FractionBox["\[Epsilon]", "d"], "^"], TraditionalForm]],ExpressionUUID->
  "11dae55e-5723-457b-9212-b33c62d77799"],
 "Cov(X,Res)\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uX"], "2"], "="}], TraditionalForm]],
  ExpressionUUID->"491d3262-e1f0-4bdb-8dad-baf205e45ff2"],
 " - Cov(X,Res)/",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    OverscriptBox[
     FractionBox["\[Epsilon]", "d"], "^"]}], TraditionalForm]],ExpressionUUID->
  "ec439abe-3f12-456e-b9cb-2a1c2a4c94e7"],
 ")\n--Can we re-insert samples from learned uM, uX variances to decrease \
bias?\n\n\n\n\n\n\n\n\nUsing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     FractionBox["A", "B"], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"E", "[", "A", "]"}], 
      RowBox[{"E", "[", "B", "]"}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"cov", "[", 
         RowBox[{"A", ",", "B"}], "]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"E", "[", "A", "]"}], 
          RowBox[{"E", "[", "B"}]}], "}"}]], "+", 
       FractionBox[
        RowBox[{"V", "[", "B", "]"}], 
        SuperscriptBox[
         RowBox[{"E", "[", "B", "]"}], "2"]]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"fcca47f1-9a75-45de-9683-101a06196882"],
 ",\nwe have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    FractionBox["A", "B"], "]"}], TraditionalForm]],ExpressionUUID->
  "1cdbe47e-bdb2-4296-ace3-42fce0b074fb"],
 " - ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"E", "[", "A", "]"}], 
    RowBox[{"E", "[", "B", "]"}]], TraditionalForm]],ExpressionUUID->
  "0f59b095-f5c0-4e2f-8734-2be5264cae42"],
 " = ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"V", "[", "B", "]"}], 
     RowBox[{"E", "[", "A", "]"}]}], 
    SuperscriptBox[
     RowBox[{"E", "[", "B", "]"}], "3"]], TraditionalForm]],ExpressionUUID->
  "4fe25d50-04b4-4e1a-ac87-8dfcbe6a1e0e"],
 "-",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"cov", "[", 
     RowBox[{"A", ",", "B"}], "]"}], 
    SuperscriptBox[
     RowBox[{
      RowBox[{"E", "[", "B"}], "}"}], "2"]], TraditionalForm]],ExpressionUUID->
  "2028131e-cb49-46e0-90c8-f355edb9604b"],
 "\n\nEmpirically, we see ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     FractionBox[
      RowBox[{"|", "E", "|"}], 
      RowBox[{"|", "D", "|"}]], "]"}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"E", "[", 
       RowBox[{"|", "E", "|"}], "]"}], 
      RowBox[{"E", "[", 
       RowBox[{"|", "D", "|"}], "]"}]], "=", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"[", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["e", "d"], ")"}], "2"]}], "]"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"98d21192-1b53-4498-934c-eb387f4ca8c6"],
 " \nindependent of a, b, c, absolute magnitude of e and d, noises,\nbut NOT \
g\n\n\n",
 Cell[BoxData[
  RowBox[{"ResMV", "-", 
   RowBox[{
    OverscriptBox["edivd", "^"], "*", "ResXV"}]}]], "Input",ExpressionUUID->
  "16f09fbd-3bda-4f6a-b122-cc030909f7dd"],
 " = um - e/d ux\n\n\n1) Check regressing Y on residual (um- e/d ux) AND x\n\
2) Check E[e/d] vs E[e]/E[d] vs E[mag(e)/mag(d)] vs. E[c+e/d] - E[c]\n3) Try \
all e/d estimators with improved (um- e/d ux) instrument for a.\n\n\n4) \
Monotonic decrease in e/d, consider even setting e/d constant=K throughout a \
run and just estimating initial confounding d and K\n5) Are there two types \
of confounders, monotonic and catastrophic?\n6)\n\n\n\n\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864277835972797*^9, 3.864277881807207*^9}, {3.864464734998878*^9, 
   3.864464820262539*^9}, {3.864464865641577*^9, 3.864464873689899*^9}, {
   3.864464970102149*^9, 3.8644650099094343`*^9}, {3.8644650550152283`*^9, 
   3.864465070165859*^9}, {3.864465103488549*^9, 3.864465106253504*^9}, {
   3.864465201658597*^9, 3.8644652411515417`*^9}, {3.864465347346011*^9, 
   3.864465403195983*^9}, {3.864465542896598*^9, 3.864465545026658*^9}, {
   3.864465898458987*^9, 3.864465928073763*^9}, {3.8644664218458548`*^9, 
   3.8644665029317427`*^9}, {3.864886045339703*^9, 3.86488609504772*^9}, {
   3.864886191854381*^9, 3.864886201924528*^9}, {3.8648866239201527`*^9, 
   3.8648866414987383`*^9}, 3.864895712032373*^9, 3.8648991224313087`*^9, {
   3.864899283837049*^9, 3.8648993819351883`*^9}, {3.864901559907631*^9, 
   3.8649016766743813`*^9}, {3.864901754354113*^9, 3.864901755070035*^9}, {
   3.864901907838039*^9, 3.8649019102699833`*^9}, {3.865577511518066*^9, 
   3.8655775950703173`*^9}, {3.8655776377588377`*^9, 3.865577654366778*^9}, {
   3.865577859323119*^9, 3.8655778957855873`*^9}, {3.865577943319222*^9, 
   3.865578068542758*^9}, {3.865578161065772*^9, 3.865578216456259*^9}, {
   3.865578254452281*^9, 3.865578256724207*^9}, {3.865578303234501*^9, 
   3.8655784155633497`*^9}, {3.865578486645647*^9, 3.865578500950493*^9}, {
   3.865578547536077*^9, 3.865578548647827*^9}, {3.865578596233593*^9, 
   3.865578615014429*^9}, {3.865578666401824*^9, 3.86557867029084*^9}, {
   3.8655787349473753`*^9, 3.865578750423996*^9}, {3.8655788394192753`*^9, 
   3.8655788878339043`*^9}, {3.8655789542347813`*^9, 
   3.8655789608559437`*^9}, {3.8655790065021057`*^9, 3.865579039158032*^9}, {
   3.865579074896187*^9, 3.865579170049872*^9}, {3.865579263101845*^9, 
   3.865579276514566*^9}, {3.865579330425247*^9, 3.865579399254757*^9}, {
   3.8655794538805532`*^9, 3.86557948465628*^9}, {3.866270997524091*^9, 
   3.866271007895977*^9}, {3.8662713029406757`*^9, 3.866271318730076*^9}, 
   3.8662768807774963`*^9, {3.866277540801097*^9, 3.866277699626751*^9}, {
   3.866278531612834*^9, 3.866278534140801*^9}, {3.866278646828219*^9, 
   3.86627867214741*^9}, {3.866280801638206*^9, 3.86628080177341*^9}, {
   3.871460847996417*^9, 3.871460863094181*^9}, {3.8714609516299677`*^9, 
   3.8714610562786007`*^9}, 
   3.871461388367394*^9},ExpressionUUID->"fb32edc5-d6ba-4a98-b9f6-\
055e669224c2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["csimp", "^"], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"M", ".", "X", " "}], 
    RowBox[{"X", ".", "X"}]], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "\[Rule]", 
      RowBox[{
       RowBox[{"c", "*", "X"}], "+", 
       RowBox[{"\[Epsilon]", "*", "W"}], "+", "uM"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["csimp", "^"], "-", "c"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uV\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", "=", 
  RowBox[{"cerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
             "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
     "&"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}, {
   3.869692269945052*^9, 3.869692367207098*^9}},
 CellLabel->
  "In[433]:=",ExpressionUUID->"a3c55f74-0b79-44f9-8a1f-ce1c11044fca"],

Cell[BoxData[
 FractionBox[
  RowBox[{"M", ".", "X"}], 
  RowBox[{"X", ".", "X"}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.872246841058262*^9},
 CellLabel->
  "Out[433]=",ExpressionUUID->"8ff926f3-89ff-4382-a96d-9692879ed81c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}], " ", 
        "\[Epsilon]"}], "d"]}], ")"}], ".", "X"}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.872246841059917*^9},
 CellLabel->
  "Out[435]=",ExpressionUUID->"eb2eb36a-a436-46bf-b041-65ec001aae77"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uV"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.872246841061331*^9},
 CellLabel->
  "Out[437]=",ExpressionUUID->"80f338d6-f7dc-4c70-a9ec-8d7b6fc43b14"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"X", " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{"g", " ", "X", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.872246841071582*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"9c9dd551-ae05-4c53-868c-1a622f8f0499"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", "0"}], ",", 
   RowBox[{"uV", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", "X", " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.872246841073279*^9},
 CellLabel->
  "Out[439]=",ExpressionUUID->"f4e6043c-3bce-4df4-b2b5-fbd51753223b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "X"}], "-", 
      FractionBox[
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "X"}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["g", "2"], " ", "X", " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]], "+", 
          FractionBox[
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ")"}]}], "d"]}], 
     ")"}], ".", "X"}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.8722468410747147`*^9},
 CellLabel->
  "Out[440]=",ExpressionUUID->"bb2d6b13-53b9-4e36-83fe-dc20ad7170e5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9, 3.8715665432062597`*^9, 3.872246841076021*^9},
 CellLabel->
  "Out[441]=",ExpressionUUID->"54000921-289d-443f-ad0e-38f6c230c6ba"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["c", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", 
     RowBox[{"{", "X", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResMXSimp", "=", 
    RowBox[{
     RowBox[{"M", "-", 
      RowBox[{
       OverscriptBox["c", "^"], "X"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["g", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{
     RowBox[{"{", "X", "}"}], ",", 
     RowBox[{"{", "V", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResXV", "=", 
    RowBox[{
     RowBox[{"X", "-", 
      RowBox[{
       OverscriptBox["g", "^"], "V"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["gc", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", 
     RowBox[{"{", "V", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResMV", "=", 
    RowBox[{
     RowBox[{"M", "-", 
      RowBox[{
       OverscriptBox["gc", "^"], "V"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["cIV", "^"], "=", 
   RowBox[{
    OverscriptBox["gc", "^"], "/", 
    OverscriptBox["g", "^"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResMX", "=", 
   RowBox[{
    RowBox[{"M", "-", 
     RowBox[{
      OverscriptBox["cIV", "^"], "X"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.858324779349805*^9, 3.8583247888458023`*^9}, {
   3.8583253078292217`*^9, 3.858325314837751*^9}, {3.858325396607929*^9, 
   3.85832542701947*^9}, {3.860036107824605*^9, 3.860036115763649*^9}, {
   3.864189020257053*^9, 3.864189103478299*^9}, {3.864277906570218*^9, 
   3.86427793070198*^9}, {3.864278019218787*^9, 3.864278039113723*^9}, {
   3.864278075835719*^9, 3.864278120976528*^9}, {3.864278178587859*^9, 
   3.864278361447269*^9}, {3.869303872125587*^9, 3.869303893638217*^9}},
 CellLabel->
  "In[442]:=",ExpressionUUID->"2bc8b1fb-c10a-4b98-a22a-eb6147e694b7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "asimp"}], "^"], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"ResMXSimp", ".", "Y"}], 
    RowBox[{"ResMXSimp", ".", "M"}]], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "asimp"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ResMXSimp", ".", "Y"}], 
      RowBox[{"ResMXSimp", ".", "M"}]], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "V"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["arem", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["arem", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
  3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
  3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
  3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
  3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
  3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
  3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
  3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
  3.8692280275853577`*^9}, {3.8692280599089527`*^9, 3.8692281375468616`*^9}, {
  3.869297316532125*^9, 3.8692973167578382`*^9}, {3.869297702528627*^9, 
  3.8692977482320223`*^9}, {3.869303913353629*^9, 3.869303929895047*^9}, {
  3.869305596097282*^9, 3.869305597011416*^9}},
 CellLabel->
  "In[450]:=",ExpressionUUID->"17b93a3e-3474-4f90-9189-de50a085a740"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9, 
   3.871566543317913*^9, 3.872246841090178*^9},
 CellLabel->
  "Out[451]=",ExpressionUUID->"70045c57-7378-41cd-82e7-ec68a7cf20d5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     FractionBox[
      RowBox[{"X", " ", 
       RowBox[{"X", ".", "M"}]}], 
      RowBox[{"X", ".", "X"}]]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     FractionBox[
      RowBox[{"X", " ", 
       RowBox[{"X", ".", "M"}]}], 
      RowBox[{"X", ".", "X"}]]}], ")"}], ".", "M"}]]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9, 
   3.871566543317913*^9, 3.872246841091798*^9},
 CellLabel->
  "Out[452]=",ExpressionUUID->"e2af3b8d-349c-4c17-83b7-9aa38c85b010"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", ".", "M"}], ")"}], "2"], "-", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", "d", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "M"}], ")"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "d", " ", 
        RowBox[{"M", ".", "M"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"M", ".", "uX"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "uY"}]}], "-", 
       RowBox[{"b", " ", "g", " ", 
        RowBox[{"M", ".", "V"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"M", ".", "X"}]}]}], ")"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], " ", 
        RowBox[{"X", ".", "uX"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"X", ".", "uY"}]}], "-", 
       RowBox[{"b", " ", "g", " ", 
        RowBox[{"X", ".", "V"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"X", ".", "X"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9, 
   3.871566543317913*^9, 3.8722468411626863`*^9},
 CellLabel->
  "Out[453]=",ExpressionUUID->"129c607d-a701-4baa-b8f5-860432db6138"],

Cell[BoxData[
 OverscriptBox["arem", "^"]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9, 
   3.871566543317913*^9, 3.872246841164963*^9},
 CellLabel->
  "Out[454]=",ExpressionUUID->"5b46778e-666f-4bcd-be59-30c429d54ce6"],

Cell[BoxData[
 OverscriptBox["arem", "^"]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9, 
   3.871566543317913*^9, 3.8722468411661654`*^9},
 CellLabel->
  "Out[455]=",ExpressionUUID->"06261162-f0f4-4bbc-8f59-3d2feeb87890"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9, 
   3.871566543317913*^9, 3.872246841167245*^9},
 CellLabel->
  "Out[456]=",ExpressionUUID->"dfdb01ce-f7bf-4d51-8167-c1784e61bb56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["asimp", "^"], "=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["asimp", "^"], "-", "a"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"73c248e6-59bf-471b-81e9-65f69a29fa82"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"M", ".", "Y"}], " ", 
    RowBox[{"X", ".", "X"}]}], "-", 
   RowBox[{
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "Y"}]}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"M", ".", "X"}]}], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692413166896*^9, 3.871566543592718*^9, 
   3.872246841179208*^9},
 CellLabel->
  "Out[457]=",ExpressionUUID->"4e8c9fa9-dfd2-4cc7-9b6e-48d5e0aae675"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}], " ", 
     RowBox[{"X", ".", "X"}]}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692413166896*^9, 3.871566543592718*^9, 
   3.872246841194662*^9},
 CellLabel->
  "Out[459]=",ExpressionUUID->"91592a84-1ff5-4f94-a85b-961420514b7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<uW\>\"", 
     ",", "\"\<uV\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{"aerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
             "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
     "&"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
   3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
   3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
   3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
   3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
   3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
   3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
   3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
   3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
   3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
   3.860036875204605*^9}, {3.869308336422339*^9, 3.8693083368832283`*^9}, {
   3.869308501704814*^9, 3.86930850182689*^9}, {3.869309609850891*^9, 
   3.8693096134984827`*^9}, {3.869309694496868*^9, 3.869309724573353*^9}, 
   3.869309761048152*^9, {3.8695270175510883`*^9, 3.8695270206970453`*^9}, {
   3.869527842727806*^9, 3.86952784548337*^9}},
 CellLabel->
  "In[460]:=",ExpressionUUID->"ba5387fb-abe3-467e-9ae3-650b5b78d934"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "uW", ",", "uV"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241319772*^9, 3.8715665436810513`*^9, 
   3.8722468412069263`*^9},
 CellLabel->
  "Out[461]=",ExpressionUUID->"e8e95668-4984-495d-bdcd-ec91835cd80e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "M"}], "-", 
          RowBox[{"c", " ", "d", " ", "X"}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"g", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241319772*^9, 3.8715665436810513`*^9, 
   3.872246841218474*^9},
 CellLabel->
  "Out[462]=",ExpressionUUID->"785920b7-ba67-4c73-8f18-af8669efba28"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "M"}], "-", 
           RowBox[{"c", " ", "d", " ", "X"}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"uW", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uV", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241319772*^9, 3.8715665436810513`*^9, 
   3.872246841221542*^9},
 CellLabel->
  "Out[463]=",ExpressionUUID->"c9875a1a-ec0c-476b-ace9-1a171e877293"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241319772*^9, 3.8715665436810513`*^9, 
   3.8722468412243*^9},
 CellLabel->
  "Out[464]=",ExpressionUUID->"a75449c8-9740-4bde-866b-5b1355427ce1"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241319772*^9, 3.8715665436810513`*^9, 
   3.8722468426006804`*^9},
 CellLabel->
  "Out[465]=",ExpressionUUID->"dad62b22-dee6-4145-81e0-5835766007b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"g", "->", "0"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uV", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uY", "2"], "->", "1"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.869527096240508*^9, 3.8695271418516693`*^9}, {
  3.869530158582767*^9, 3.869530158649358*^9}, {3.869553221124552*^9, 
  3.869553221316163*^9}},
 CellLabel->
  "In[466]:=",ExpressionUUID->"fb3de4f1-5619-4000-b4bb-3cfaa5563b1e"],

Cell[BoxData[
 FractionBox["\[Epsilon]", 
  RowBox[{"1", "+", 
   SuperscriptBox["d", "2"], "+", 
   SuperscriptBox["\[Epsilon]", "2"]}]]], "Output",
 CellChangeTimes->{3.8695271426198187`*^9, 3.869530159021469*^9, 
  3.869563790385996*^9, 3.869692414620493*^9, 3.8715665470565863`*^9, 
  3.87224684264491*^9},
 CellLabel->
  "Out[466]=",ExpressionUUID->"d53a3b3e-32b6-4730-b5eb-897a3eee5cd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["anum", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"M", ".", "Y"}], " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{
     RowBox[{"M", ".", "X"}], " ", 
     RowBox[{"X", ".", "Y"}]}]}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "uW"}], "+", "uY"}]}], ",", 
     RowBox[{"M", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}], "+", "uM"}], ")"}]}], ",", 
     RowBox[{"X", "->", 
      RowBox[{
       RowBox[{"g", "*", "uV"}], " ", "+", " ", 
       RowBox[{"d", "*", "uW"}], " ", "+", " ", "uX"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"anumerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["anum", "^"], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"anumerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"anumerror", ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"anumerror", "=", 
  RowBox[{
   RowBox[{"anumerror", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.8695532247923527`*^9, 3.8695532492968273`*^9}, {
   3.8695532912142572`*^9, 3.869553349612878*^9}, {3.8695533844437923`*^9, 
   3.8695534235433826`*^9}, 3.8695534635005836`*^9, {3.8695535171188583`*^9, 
   3.869553518092111*^9}, {3.8695537522899218`*^9, 3.869553759252079*^9}},
 CellLabel->
  "In[467]:=",ExpressionUUID->"b460eaf9-77ba-4555-a349-2255e375bbaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", ".", "Y"}], " ", 
   RowBox[{"X", ".", "X"}]}], "-", 
  RowBox[{
   RowBox[{"M", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.86969241463556*^9, 3.871566547097725*^9, 3.872246842659601*^9},
 CellLabel->
  "Out[467]=",ExpressionUUID->"c0313f47-b462-4bd6-955a-d73102fbc724"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "uV"}], "+", 
       RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "uW"}], "+", "uY", "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"uM", "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
          RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "uW"}], "+", "uY", "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.86969241463556*^9, 3.871566547097725*^9, 3.87224684266148*^9},
 CellLabel->
  "Out[469]=",ExpressionUUID->"70b72202-3c44-4122-885c-7fa81313d7ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
   RowBox[{"uW", ".", "uW"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"uM", ".", "uM"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"uW", ".", "uW"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.86969241463556*^9, 3.871566547097725*^9, 3.872246842703095*^9},
 CellLabel->
  "Out[470]=",ExpressionUUID->"a15e98b4-8562-41e9-a109-e1a24a36aeea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
  RowBox[{"a", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.86969241463556*^9, 3.871566547097725*^9, 3.872246842705472*^9},
 CellLabel->
  "Out[471]=",ExpressionUUID->"bfe7720c-83d3-44a0-8181-b89392396b69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["adenom", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"+", 
      RowBox[{"M", ".", "M"}]}], " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{
     RowBox[{"M", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}]}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "uW"}], "+", "uY"}]}], ",", 
     RowBox[{"M", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}], "+", "uM"}], ")"}]}], ",", 
     RowBox[{"X", "->", 
      RowBox[{
       RowBox[{"g", "*", "uV"}], " ", "+", " ", 
       RowBox[{"d", "*", "uW"}], " ", "+", " ", "uX"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"adenomerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["adenom", "^"], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"adenomerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"adenomerror", ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"adenomerror", "=", 
  RowBox[{
   RowBox[{"adenomerror", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.8695532247923527`*^9, 3.8695532492968273`*^9}, {
   3.8695532912142572`*^9, 3.869553349612878*^9}, {3.8695533844437923`*^9, 
   3.8695534235433826`*^9}, 3.8695534635005836`*^9, {3.8695534941949472`*^9, 
   3.8695535263848763`*^9}, {3.86955393828699*^9, 3.869553940783311*^9}},
 CellLabel->
  "In[472]:=",ExpressionUUID->"bbc12927-e347-4a75-8e05-76b74efc3ef7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"M", ".", "X"}]}], " ", 
   RowBox[{"X", ".", "M"}]}], "+", 
  RowBox[{
   RowBox[{"M", ".", "M"}], " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.869692414704383*^9, 3.87156654727914*^9, 3.872246842717628*^9},
 CellLabel->
  "Out[472]=",ExpressionUUID->"fc8637d1-e661-4aea-8b8e-081b6ca81741"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "uV"}], "+", 
       RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"uM", "+", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
       RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.869692414704383*^9, 3.87156654727914*^9, 3.872246842719593*^9},
 CellLabel->
  "Out[474]=",ExpressionUUID->"04d5c720-ddc5-4988-a7e2-0166bb404968"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"uW", ".", "uW"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"uM", ".", "uM"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"uW", ".", "uW"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.869692414704383*^9, 3.87156654727914*^9, 3.872246842732233*^9},
 CellLabel->
  "Out[475]=",ExpressionUUID->"53fba82c-e7d1-4f9e-9dc1-cb5cd2f1b31a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
  RowBox[{
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.869692414704383*^9, 3.87156654727914*^9, 3.872246842733901*^9},
 CellLabel->
  "Out[476]=",ExpressionUUID->"ece80c15-9723-4de6-a5e1-dc33813089a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"anumerror", "/", "adenomerror"}], " ", "-", " ", "a"}], " ", "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.869553540612804*^9, 3.869553545239005*^9}},
 CellLabel->
  "In[477]:=",ExpressionUUID->"70ecb97a-770b-4fe7-8318-0d032c72ca4e"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.869553545520512*^9, 3.86955394341881*^9, 
  3.86956379058534*^9, 3.8696924147384043`*^9, 3.871566547370531*^9, 
  3.872246842745043*^9},
 CellLabel->
  "Out[477]=",ExpressionUUID->"2f78daa3-45cf-41f0-abde-3a1effd8227b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["cplusedivd", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{
    RowBox[{"{", "M", "}"}], ",", 
    RowBox[{"{", "X", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["edivd", "^"], "=", 
   RowBox[{
    OverscriptBox["cplusedivd", "^"], " ", "-", " ", 
    OverscriptBox["cIV", "^"]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResNewMXsubed", "=", 
   RowBox[{
    RowBox[{"ResMV", "-", 
     RowBox[{
      OverscriptBox["edivd", "^"], "*", "ResXV"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], "&"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"regress", " ", "M", " ", "on", " ", "V"}], "\[IndentingNewLine]", 
 RowBox[{"ResNewMXold", "=", 
  RowBox[{
   RowBox[{"ResMV", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Epsilon]", "/", "d"}], ")"}], "*", "ResXV"}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"regress", " ", "M", " ", "on", " ", "X"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResNewMX", "=", 
   RowBox[{
    RowBox[{"ResMX", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Epsilon]", "/", "d"}], ")"}], "*", "ResXV"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], "&"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"eW", " ", "+", " ", "uM"}], ")"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"\[Epsilon]", "/", "d"}], 
     RowBox[{"(", 
      RowBox[{"dW", " ", "+", " ", "uX"}], ")"}]}]}], " ", "=", " ", 
   "residual"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemNewMX", " ", "=", " ", 
   RowBox[{"M", " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c", "+", 
       RowBox[{"\[Epsilon]", "/", "d"}]}], ")"}], "*", "X"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eW", " ", "+", " ", "uM"}], " ", "=", " ", "remainder"}]}], "Input",\

 CellChangeTimes->{{3.8692276397214622`*^9, 3.869227674758326*^9}, {
  3.869227777951429*^9, 3.869227778868437*^9}, {3.869227831252347*^9, 
  3.869227831325255*^9}, {3.869283857827505*^9, 3.869283863288822*^9}, {
  3.869295876949485*^9, 3.869295877610033*^9}, {3.8692959104234133`*^9, 
  3.869295910696864*^9}, {3.869296313064618*^9, 3.869296324196219*^9}, {
  3.869297004791106*^9, 3.869297075309421*^9}, {3.869297154131587*^9, 
  3.8692971608671703`*^9}, {3.869297196852882*^9, 3.869297202815156*^9}, {
  3.8695562638454*^9, 3.86955627009824*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"a8928b79-7e1f-4c95-87aa-26baeb738771"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.8722468427565403`*^9},
 CellLabel->
  "Out[478]=",ExpressionUUID->"94a4b633-3a6b-4df3-9004-4d4dbe5b693f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"V", ".", "M"}], 
    RowBox[{"V", ".", "X"}]]}], "+", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.87224684275802*^9},
 CellLabel->
  "Out[479]=",ExpressionUUID->"7a906073-c511-4330-8025-ecb9351613eb"],

Cell[BoxData[
 RowBox[{"M", "+", 
  RowBox[{"X", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"V", ".", "M"}], 
      RowBox[{"V", ".", "X"}]], "-", 
     FractionBox[
      RowBox[{"X", ".", "M"}], 
      RowBox[{"X", ".", "X"}]]}], ")"}]}], "+", 
  RowBox[{"V", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"V", ".", "M"}]}], 
       RowBox[{"V", ".", "V"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}], 
      RowBox[{
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "X"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.872246842759651*^9},
 CellLabel->
  "Out[480]=",ExpressionUUID->"c4c4cbf2-e022-44f2-b1b9-4f4e87dc78d8"],

Cell[BoxData[
 RowBox[{"M", " ", "on", " ", "regress", " ", "V"}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.872246842761096*^9},
 CellLabel->
  "Out[481]=",ExpressionUUID->"4ae4ef53-7a9e-483c-aea1-6cfde12cc4a8"],

Cell[BoxData[
 RowBox[{"M", "-", 
  FractionBox[
   RowBox[{"X", " ", "\[Epsilon]"}], "d"], "+", 
  RowBox[{"V", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"V", ".", "M"}], 
       RowBox[{"V", ".", "V"}]]}], "+", 
     FractionBox[
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"V", ".", "X"}]}], 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "V"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.872246842762416*^9},
 CellLabel->
  "Out[482]=",ExpressionUUID->"216c6f76-5cbc-4adf-96a2-42b19d782a35"],

Cell[BoxData[
 RowBox[{"M", " ", "on", " ", "regress", " ", "X"}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.872246842763708*^9},
 CellLabel->
  "Out[483]=",ExpressionUUID->"c618a4fc-d5cf-49c4-9aa4-d521de60966f"],

Cell[BoxData[
 RowBox[{"M", "+", 
  RowBox[{"X", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Epsilon]", "d"]}], "-", 
     FractionBox[
      RowBox[{"V", ".", "M"}], 
      RowBox[{"V", ".", "X"}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"V", " ", "\[Epsilon]", " ", 
    RowBox[{"V", ".", "X"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}]}]]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.872246842765067*^9},
 CellLabel->
  "Out[484]=",ExpressionUUID->"ca15e25d-6417-4371-8971-57e7aa9445ab"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Plus\\\"}]\\) in \
\\!\\(\\*RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"eW\\\", \\\"+\\\", \
\\\"uM\\\"}], \\\")\\\"}], \\\"-\\\", FractionBox[RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"dW\\\", \\\"+\\\", \\\"uX\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Epsilon]\\\"}], \\\"d\\\"]}]\\) is Protected.\"", 2, 485, 12, 
   21942966268712677875, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8693056417278233`*^9, 3.869309825356584*^9, 
  3.869555218148621*^9, 3.869555252926237*^9, 3.8695562756052847`*^9, 
  3.8695637906360703`*^9, 3.869692414763595*^9, 3.871566547434145*^9, 
  3.872246842766403*^9},
 CellLabel->
  "During evaluation of \
In[478]:=",ExpressionUUID->"34cec88a-f1fc-424e-8b58-d38f69b63bf7"],

Cell[BoxData["residual"], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.8722468427702312`*^9},
 CellLabel->
  "Out[485]=",ExpressionUUID->"0628a06e-2542-4db0-980b-8bcaa4d88982"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Plus\\\"}]\\) in \\!\\(\\*RowBox[{\\\"eW\\\", \
\\\"+\\\", \\\"uM\\\"}]\\) is Protected.\"", 2, 487, 13, 21942966268712677875,
    "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8693056417278233`*^9, 3.869309825356584*^9, 
  3.869555218148621*^9, 3.869555252926237*^9, 3.8695562756052847`*^9, 
  3.8695637906360703`*^9, 3.869692414763595*^9, 3.871566547434145*^9, 
  3.872246842771347*^9},
 CellLabel->
  "During evaluation of \
In[478]:=",ExpressionUUID->"34abe2ef-a2ee-43ad-bff1-ab67640f824e"],

Cell[BoxData["remainder"], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9, 
  3.8715665474073544`*^9, 3.8722468427744713`*^9},
 CellLabel->
  "Out[487]=",ExpressionUUID->"955a78e0-a066-468c-904c-2f7760f0371e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  FractionBox[
   RowBox[{"RemNewMX", ".", "Y"}], 
   RowBox[{"RemNewMX", ".", "M"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"RemNewMX", ".", "Y"}], 
      RowBox[{"RemNewMX", ".", "M"}]], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "V"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["arem", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["arem", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
  3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
  3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
  3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
  3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
  3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
  3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
  3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
  3.8692280275853577`*^9}, {3.8692280599089527`*^9, 3.8692281375468616`*^9}, {
  3.869297316532125*^9, 3.8692973167578382`*^9}, {3.869297702528627*^9, 
  3.8692977482320223`*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"effed24d-96b5-4e78-8391-2508746e5cbe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9, 3.871566547498856*^9, 
   3.872246842786454*^9},
 CellLabel->
  "Out[489]=",ExpressionUUID->"a89abb85-9730-403a-aeb1-b40fe9450199"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", 
   "M"}]]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9, 3.871566547498856*^9, 
   3.872246842788455*^9},
 CellLabel->
  "Out[490]=",ExpressionUUID->"6518a37b-2e1b-4adc-9331-0e44cfe1bb68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"M", ".", "V"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "X"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"X", ".", "V"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "V"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9, 3.871566547498856*^9, 
   3.8722468430070267`*^9},
 CellLabel->
  "Out[491]=",ExpressionUUID->"f7ce21a7-8cb6-4a06-a8c1-86d37049d76a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"V", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"V", ".", "X"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"V", ".", "X"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9, 3.871566547498856*^9, 
   3.8722468430183353`*^9},
 CellLabel->
  "Out[492]=",ExpressionUUID->"8334c850-1d01-418e-b524-e6a858006771"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}]}], "-", 
  RowBox[{"b", " ", "d", " ", 
   RowBox[{"M", ".", "uX"}]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "uY"}]}], "-", 
  RowBox[{"b", " ", "d", " ", "g", " ", 
   RowBox[{"V", ".", "M"}]}], "+", 
  RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
   RowBox[{"V", ".", "X"}]}], "+", 
  RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
   RowBox[{"V", ".", "X"}]}], "+", 
  RowBox[{"b", " ", "d", " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"a", " ", "c", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "M"}]}], "+", 
  RowBox[{"b", " ", "c", " ", "d", " ", 
   RowBox[{"X", ".", "uX"}]}], "+", 
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "uX"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"X", ".", "uY"}]}], "-", 
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "uY"}]}], "-", 
  RowBox[{"b", " ", "c", " ", "d", " ", 
   RowBox[{"X", ".", "X"}]}], "-", 
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9, 3.871566547498856*^9, 
   3.872246843020588*^9},
 CellLabel->
  "Out[493]=",ExpressionUUID->"9c975603-6f5b-4161-982f-b29412dac406"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "M"}]}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9, 3.871566547498856*^9, 
   3.872246843022236*^9},
 CellLabel->
  "Out[494]=",ExpressionUUID->"1719b49b-d8bb-47f3-938a-d6e129daaa2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  FractionBox[
   RowBox[{"RemNewMX", ".", "Y"}], 
   RowBox[{"RemNewMX", ".", "M"}]]}], "\[IndentingNewLine]", 
 RowBox[{"Numarem", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Numerator", "[", 
     OverscriptBox["arem", "^"], "]"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Denomarem", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Denominator", "[", 
     OverscriptBox["arem", "^"], "]"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
   3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
   3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
   3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
   3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
   3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
   3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
   3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
   3.8692280275853577`*^9}, {3.8692280599089527`*^9, 
   3.8692281375468616`*^9}, {3.869297316532125*^9, 3.8692973167578382`*^9}, {
   3.869297702528627*^9, 3.8692977482320223`*^9}, {3.869555486692275*^9, 
   3.869555508652031*^9}, {3.869555564397079*^9, 3.869555588379808*^9}, {
   3.869555640058826*^9, 3.869555687682781*^9}, 3.869555784388283*^9, {
   3.869555936704833*^9, 3.869555945592201*^9}, {3.869561521860147*^9, 
   3.869561533303043*^9}, {3.869561576905616*^9, 3.8695615802303*^9}},
 CellLabel->
  "In[495]:=",ExpressionUUID->"6d455989-8b3a-4c8a-8fb1-720d6e7449fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.8696924150439796`*^9, 
   3.8715665481464443`*^9, 3.872246843034268*^9},
 CellLabel->
  "Out[496]=",ExpressionUUID->"ac0ec1e9-e407-4f2d-b507-9d24ad58bde6"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", 
   "M"}]]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.8696924150439796`*^9, 
   3.8715665481464443`*^9, 3.8722468430359097`*^9},
 CellLabel->
  "Out[497]=",ExpressionUUID->"0771ec22-550a-40fb-8019-bbe61c8920c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "Y"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.8696924150439796`*^9, 
   3.8715665481464443`*^9, 3.87224684303734*^9},
 CellLabel->
  "Out[498]=",ExpressionUUID->"c0bac172-cc5d-4856-a955-04210a7bf46b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.8696924150439796`*^9, 
   3.8715665481464443`*^9, 3.872246843038602*^9},
 CellLabel->
  "Out[499]=",ExpressionUUID->"55f59d3d-9110-439e-8914-b9ba6c49ace8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  RowBox[{
   FractionBox["Numarem", "Denomarem"], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aremerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["arem", "^"], "-", "a"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<uW\>\"", 
     ",", "\"\<uV\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aremerrorsimp", "=", 
  RowBox[{"aremerror", "/.", "condmeanreplace"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}, {
   3.8695560672211657`*^9, 3.869556081234673*^9}, {3.869561802977852*^9, 
   3.86956181056039*^9}, {3.8695618693270884`*^9, 3.869561898272396*^9}, {
   3.8695620354930468`*^9, 3.869562035652595*^9}, {3.8695637264572687`*^9, 
   3.8695637265873537`*^9}},
 CellLabel->
  "In[500]:=",ExpressionUUID->"aaa6a32f-bdce-4f3b-856a-a9ab48520f34"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "Y"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "Y"}]}]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9, 3.871566548231139*^9, 3.872246843050564*^9},
 CellLabel->
  "Out[500]=",ExpressionUUID->"e885b130-1b07-49ef-b570-bfcdc4376147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}]}]}], 
   RowBox[{
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"X", ".", "M"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9, 3.871566548231139*^9, 3.872246843066441*^9},
 CellLabel->
  "Out[502]=",ExpressionUUID->"33a3f571-db13-4d43-abbd-f77793ac33c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "uW", ",", "uV"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9, 3.871566548231139*^9, 3.872246843068722*^9},
 CellLabel->
  "Out[504]=",ExpressionUUID->"715a9fbd-acfa-4825-863c-c844eb0ce2e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "M"}], "-", 
          RowBox[{"c", " ", "d", " ", "X"}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"g", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9, 3.871566548231139*^9, 3.8722468430823383`*^9},
 CellLabel->
  "Out[505]=",ExpressionUUID->"da248e5f-db61-413a-bf67-3c04003f8fe2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "M"}], "-", 
           RowBox[{"c", " ", "d", " ", "X"}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"uW", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uV", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9, 3.871566548231139*^9, 3.872246843085455*^9},
 CellLabel->
  "Out[506]=",ExpressionUUID->"1b76a9c3-f1d4-467d-819c-3e11697800bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"X", ".", "M"}]}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9, 3.871566548231139*^9, 3.8722468430879583`*^9},
 CellLabel->
  "Out[507]=",ExpressionUUID->"d228ad0c-af4b-4531-a83d-242296b1eee7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "b"}], "d"], 
    FractionBox["1", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", 
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
          ")"}], ")"}]}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", 
        RowBox[{"(", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
          ")"}], ")"}]}]}]}], ")"}]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
            "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
    "&"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.86956204364915*^9, 3.869562070596869*^9}, {
  3.869562326539212*^9, 3.869562327645155*^9}},
 CellLabel->
  "In[508]:=",ExpressionUUID->"2014604f-e999-49f2-b327-d55a1ae303d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"b", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Epsilon]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          RowBox[{"M", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
          RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.8695622977398853`*^9, 3.869562375838229*^9, 
  3.869563843487658*^9, 3.8696924497478848`*^9, 3.871566632426056*^9, 
  3.872246877468099*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"fb1ae49a-4b0f-4c42-94a9-dab713857aae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Epsilon]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{"M", ".", "M"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
           RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        RowBox[{"X", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}]}],
       ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          RowBox[{"M", ".", "M"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
          RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
      ")"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"X", ".", "M"}], "->", 
      RowBox[{"M", ".", "X"}]}], ",", 
     RowBox[{"g", "->", "0"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.869562727135985*^9, 3.8695627396118383`*^9}, {
  3.869562791201972*^9, 3.869562792253668*^9}},
 CellLabel->
  "In[509]:=",ExpressionUUID->"db57165f-8dbe-4a1b-beca-171bcdd8f001"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "\[Epsilon]", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"X", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"c", " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"M", ".", "X"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.869562740194868*^9, 3.8695627927835293`*^9, 
  3.8695638435735188`*^9, 3.869692449789753*^9, 3.871566632536583*^9, 
  3.872246877515497*^9},
 CellLabel->
  "Out[509]=",ExpressionUUID->"fa123859-0289-4187-a33f-0a939b73cb8a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "remVar"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemNewMX", ".", "RemNewMX"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"\[IndentingNewLine]", "remVar"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"\[IndentingNewLine]", "remVar"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", "uM", "+", 
        RowBox[{"e", "*", "uW"}]}]}], ",", 
      RowBox[{"X", "->", 
       RowBox[{
        RowBox[{"g", "*", "uV"}], "+", 
        RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["remVar", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["remVar", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.869295536396841*^9, 3.869295584447096*^9}},
 CellLabel->
  "In[510]:=",ExpressionUUID->"403aa1cc-df18-496e-a10d-7c5faa448efb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"M", ".", "X"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449815629*^9, 3.871566632587865*^9, 3.87224687753363*^9},
 CellLabel->
  "Out[510]=",ExpressionUUID->"d9e055bc-4dd1-4370-a66c-2569e7fcb488"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "d", " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449815629*^9, 3.871566632587865*^9, 3.872246877538857*^9},
 CellLabel->
  "Out[511]=",ExpressionUUID->"08ff2a73-d565-4443-a77f-f8adf403f63d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["d", "2"]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"uM", "+", 
          RowBox[{"e", " ", "uW"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], ")"}]}]}]}], 
     ")"}]}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"e", " ", "uW"}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], ")"}], ".", 
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"e", " ", "uW"}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449815629*^9, 3.871566632587865*^9, 3.872246877552412*^9},
 CellLabel->
  "Out[512]=",ExpressionUUID->"ad7afcd9-0876-47e9-8529-1ac196a7a913"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uM", ".", "uM"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    RowBox[{"uV", ".", "uV"}]}], 
   SuperscriptBox["d", "2"]], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   RowBox[{"uW", ".", "uW"}]}], "-", 
  RowBox[{"2", " ", "e", " ", "\[Epsilon]", " ", 
   RowBox[{"uW", ".", "uW"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"uW", ".", "uW"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    RowBox[{"uX", ".", "uX"}]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449815629*^9, 3.871566632587865*^9, 3.872246877569044*^9},
 CellLabel->
  "Out[513]=",ExpressionUUID->"c595de41-7e2d-43b2-aaa5-d294e9264e80"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
   SuperscriptBox["d", "2"]], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{"2", " ", "e", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449815629*^9, 3.871566632587865*^9, 3.872246877581455*^9},
 CellLabel->
  "Out[514]=",ExpressionUUID->"6d149ff7-f198-42f8-8667-6a696912639d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "aremDen"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemNewMX", ".", "M"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremDen", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremDen", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", "uM", "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
      RowBox[{"X", "->", 
       RowBox[{
        RowBox[{"g", "*", "uV"}], "+", 
        RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aremDen", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aremDen", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228621169265*^9}, {
   3.869228684749145*^9, 3.8692287109186583`*^9}, 3.8692288277954473`*^9, 
   3.869295570238495*^9, {3.869563842060727*^9, 3.8695638600460777`*^9}},
 CellLabel->
  "In[515]:=",ExpressionUUID->"038e047d-0615-4b78-a12f-0c63a7e10df7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449885902*^9, 3.871566632784134*^9, 3.8722468775971823`*^9},
 CellLabel->
  "Out[515]=",ExpressionUUID->"3d1a516a-35d3-4882-9a96-6fdb13fe116f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449885902*^9, 3.871566632784134*^9, 3.872246877598763*^9},
 CellLabel->
  "Out[516]=",ExpressionUUID->"6542703e-6b3f-420a-ad8e-0ac41b9f9fb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"uM", "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", "uV"}], "+", 
           RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
        RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "d"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
     RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
     RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449885902*^9, 3.871566632784134*^9, 3.872246877600224*^9},
 CellLabel->
  "Out[517]=",ExpressionUUID->"ba034217-085a-4168-ac25-c1c407b56b61"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uM", ".", "uM"}], "-", 
  FractionBox[
   RowBox[{"c", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       RowBox[{"uV", ".", "uV"}]}], "+", 
      RowBox[{"uX", ".", "uX"}]}], ")"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449885902*^9, 3.871566632784134*^9, 3.8722468776127443`*^9},
 CellLabel->
  "Out[518]=",ExpressionUUID->"74c04c23-1156-4f4c-a101-46e59b3a2115"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "-", 
  FractionBox[
   RowBox[{"c", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449885902*^9, 3.871566632784134*^9, 3.872246877614333*^9},
 CellLabel->
  "Out[519]=",ExpressionUUID->"5d7edfc1-1529-4f9c-9b09-08ffb2ac79ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "aremNum"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemNewMX", ".", "Y"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremNum", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremNum", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", "uM", "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
      RowBox[{"X", "->", 
       RowBox[{
        RowBox[{"g", "*", "uV"}], "+", 
        RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aremNum", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aremNum", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228669324094*^9}, 
   3.869228718749824*^9, {3.869228749084634*^9, 3.869228825631928*^9}, {
   3.869563845830163*^9, 3.8695638515760727`*^9}},
 CellLabel->
  "In[520]:=",ExpressionUUID->"514f4303-d882-4df9-8fad-ccbcf4f86408"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["d", "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"M", ".", "uV"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "X"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692449957265*^9, 3.871566632950513*^9, 
   3.872246877658453*^9},
 CellLabel->
  "Out[520]=",ExpressionUUID->"6747b484-082a-490a-8643-6eea22f61765"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["d", "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"M", ".", "uV"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692449957265*^9, 3.871566632950513*^9, 
   3.8722468776656103`*^9},
 CellLabel->
  "Out[521]=",ExpressionUUID->"2f3f47ea-7aff-4eec-81f3-165432ee000c"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["d", "2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uV"}]}], "-", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uX"}]}], "+", 
     RowBox[{"b", " ", "c", " ", "d", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
     RowBox[{"b", " ", "\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
     RowBox[{"c", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uY"}]}], "+", 
     RowBox[{"d", " ", "\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uY"}]}], "-", 
     RowBox[{"b", " ", "d", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "+", 
     RowBox[{"a", " ", "c", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "+", 
     RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "+", 
     RowBox[{"b", " ", "d", " ", "g", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", "uV"}]}], "+", 
     RowBox[{"b", " ", "d", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", "uX"}]}], "-", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", "uY"}]}], "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692449957265*^9, 3.871566632950513*^9, 
   3.872246877686117*^9},
 CellLabel->
  "Out[522]=",ExpressionUUID->"4ddc1972-e695-4f32-b24d-f2152b58814e"],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"uM", ".", "uM"}], "-", 
    FractionBox[
     RowBox[{"c", " ", "\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         RowBox[{"uV", ".", "uV"}]}], "+", 
        RowBox[{"uX", ".", "uX"}]}], ")"}]}], "d"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692449957265*^9, 3.871566632950513*^9, 
   3.872246877715605*^9},
 CellLabel->
  "Out[523]=",ExpressionUUID->"675b8af6-92b5-4570-a893-94b4c96a7fa0"],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], "-", 
    FractionBox[
     RowBox[{"c", " ", "\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "d"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692449957265*^9, 3.871566632950513*^9, 
   3.8722468777175713`*^9},
 CellLabel->
  "Out[524]=",ExpressionUUID->"f907695a-cb56-40f6-8f54-3d717f585bbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "ares"}], "^"], "=", 
  FractionBox[
   RowBox[{"ResNewMX", ".", "Y"}], 
   RowBox[{"ResNewMX", ".", "M"}]]}], "\[IndentingNewLine]", 
 RowBox[{"Numares", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Numerator", "[", 
      OverscriptBox["ares", "^"], "]"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Denomares", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Denominator", "[", 
      OverscriptBox["ares", "^"], "]"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
   3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
   3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
   3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
   3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
   3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
   3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
   3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
   3.8692280275853577`*^9}, {3.8692280599089527`*^9, 
   3.8692281375468616`*^9}, {3.869297316532125*^9, 3.8692973167578382`*^9}, {
   3.869297702528627*^9, 3.8692977482320223`*^9}, {3.869555486692275*^9, 
   3.869555508652031*^9}, {3.869555564397079*^9, 3.869555588379808*^9}, {
   3.869555640058826*^9, 3.869555687682781*^9}, 3.869555784388283*^9, {
   3.869555936704833*^9, 3.869555945592201*^9}},
 CellLabel->
  "In[525]:=",ExpressionUUID->"a6e3e5c6-e041-402c-b937-9fd5ae32fec0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.869692450043766*^9, 3.87156663317386*^9, 3.872246877733419*^9},
 CellLabel->
  "Out[526]=",ExpressionUUID->"df9006cc-125b-4140-b245-a07c310b841c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "+", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Epsilon]", "d"]}], "-", 
        FractionBox[
         RowBox[{"V", ".", "M"}], 
         RowBox[{"V", ".", "X"}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"V", " ", "\[Epsilon]", " ", 
       RowBox[{"V", ".", "X"}]}], 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "V"}]}]]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "+", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Epsilon]", "d"]}], "-", 
        FractionBox[
         RowBox[{"V", ".", "M"}], 
         RowBox[{"V", ".", "X"}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"V", " ", "\[Epsilon]", " ", 
       RowBox[{"V", ".", "X"}]}], 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "V"}]}]]}], ")"}], ".", "M"}]]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.869692450043766*^9, 3.87156663317386*^9, 3.87224687773516*^9},
 CellLabel->
  "Out[527]=",ExpressionUUID->"68a11436-b9bc-4bfc-af25-f7edbaf6bb9c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "Y"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "Y"}]}]}], "d"]], "Output",\

 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.869692450043766*^9, 3.87156663317386*^9, 3.872246877736794*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"00c77c42-d6f8-4ae7-aa04-ab75ed65e388"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "M"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], "d"]], "Output",\

 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.869692450043766*^9, 3.87156663317386*^9, 3.872246877738143*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"395ec333-f36e-4f2e-941b-d897dd332a56"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "ares"}], "^"], "=", 
  RowBox[{
   FractionBox["Numares", "Denomares"], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"areserror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["ares", "^"], "-", "a"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}, {
   3.8695560672211657`*^9, 3.869556081234673*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"a0022d1e-5d77-4133-bdfb-c0ba9396c7da"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "Y"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "Y"}]}]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "M"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.8695638440963573`*^9, 3.869692450075451*^9, 3.871566633228342*^9},
 CellLabel->
  "Out[530]=",ExpressionUUID->"8df14f63-79b0-4341-a30b-bad39358b91a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}],
         ")"}]}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}],
         ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "+", "uY", "-", 
            FractionBox[
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], 
             "d"]}], ")"}]}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "+", "uY", "-", 
            FractionBox[
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], 
             "d"]}], ")"}]}]}]}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.8695638440963573`*^9, 3.869692450075451*^9, 3.871566633296493*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"93fc6ca2-a10f-4cf2-bf25-e41a8bb2d401"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<uW\>\"", 
     ",", "\"\<uV\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<V\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"areserrorsimp", "=", 
  RowBox[{"areserror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{"areserrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"areserror", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{
           RowBox[{"V", ".", "X"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], 
         ")"}]}]}], ")"}]}], "/.", "condmeanreplace"}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
            "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
    "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
   3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
   3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
   3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
   3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
   3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
   3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
   3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
   3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
   3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
   3.860036875204605*^9}, {3.869308336422339*^9, 3.8693083368832283`*^9}, {
   3.869308501704814*^9, 3.86930850182689*^9}, {3.869309609850891*^9, 
   3.8693096134984827`*^9}, {3.869309694496868*^9, 3.869309724573353*^9}, 
   3.869309761048152*^9, {3.8695270175510883`*^9, 3.8695270206970453`*^9}, {
   3.869527842727806*^9, 3.86952784548337*^9}, {3.869556091216662*^9, 
   3.869556101294402*^9}, 3.869556421060235*^9, {3.869556611301257*^9, 
   3.86955661173039*^9}},
 CellLabel->
  "In[533]:=",ExpressionUUID->"dd042bd0-d1aa-4f3c-8560-d22b539be9f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "uW", ",", "uV"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.8696924501196404`*^9, 3.8715666333468513`*^9},
 CellLabel->
  "Out[534]=",ExpressionUUID->"feb9cf58-4868-45b7-b671-a5d70d4f82a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "-", 
          RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "M"}], "-", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "V"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.8696924501196404`*^9, 3.8715666334177856`*^9},
 CellLabel->
  "Out[535]=",ExpressionUUID->"b2eae41a-5053-4039-81d0-c1a3ce31cb1c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "-", 
           RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "M"}], "-", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"uW", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uV", "\[Rule]", "V"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.8696924501196404`*^9, 3.87156663342799*^9},
 CellLabel->
  "Out[536]=",ExpressionUUID->"186e61be-8e5e-4cd9-9c23-c9e261df0628"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         RowBox[{
          FractionBox["1", "d"], 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "V"}], "-", "X", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                   SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Epsilon]", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}]}], ")"}]}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         RowBox[{
          FractionBox["1", "d"], 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "V"}], "-", "X", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                   SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                  RowBox[{"\[Epsilon]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["\[Epsilon]", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                RowBox[{
                 SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "-", 
            RowBox[{
             FractionBox["1", "d"], 
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "V"}], "-", "X", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                   
                   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["\[Epsilon]", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                   RowBox[{
                    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}]}], ")"}]}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "-", 
            RowBox[{
             FractionBox["1", "d"], 
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "V"}], "-", "X", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                   
                   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SuperscriptBox["\[Epsilon]", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                   RowBox[{
                    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}]}], ")"}]}]}]}], ")"}]}]}], ")"}], "/", 
   
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.8696924501196404`*^9, 3.8715666334358*^9},
 CellLabel->
  "Out[537]=",ExpressionUUID->"ee565794-6877-4898-8e7c-09fdc70ddc42"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", ".", "M"}], " ", 
  RowBox[{"V", ".", "V"}], " ", 
  RowBox[{"V", ".", "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", ".", "M"}], " ", 
  RowBox[{"V", ".", "V"}], " ", 
  RowBox[{"X", ".", "M"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", ".", "X"}], " ", 
  RowBox[{"V", ".", "V"}], " ", 
  RowBox[{"X", ".", "M"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", ".", "X"}], " ", 
  RowBox[{"V", ".", "X"}], " ", 
  RowBox[{"V", ".", "M"}]}]}], "Input",
 CellChangeTimes->{{3.86955711664285*^9, 
  3.8695571468435717`*^9}},ExpressionUUID->"9b643ce3-aa43-4a04-b9ea-\
4899a3820c0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "b"}], "d"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"X", " ", 
                 SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                   RowBox[{"c", " ", "d", " ", "X"}], "+", 
                   RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"X", " ", 
                 SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                   RowBox[{"c", " ", "d", " ", "X"}], "+", 
                   RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "X"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"X", " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                   RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Epsilon]", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                 RowBox[{
                  SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], "+", 
          RowBox[{
           RowBox[{"V", ".", "X"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "X"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"X", " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                   RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Epsilon]", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                 RowBox[{
                  SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{
           RowBox[{"V", ".", "X"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], 
         ")"}]}]}], ")"}]}]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
            "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
    "&"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8695566969923*^9, 3.8695567491644278`*^9}, {
  3.869556910614193*^9, 3.869556966969453*^9}, {3.869557082887801*^9, 
  3.869557084743704*^9}},
 CellLabel->
  "In[703]:=",ExpressionUUID->"78c0f4ca-ae25-419d-b76c-5a0a9ab83c0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"b", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       RowBox[{"V", ".", "M"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
      RowBox[{"\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"X", ".", "M"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          RowBox[{"X", ".", "X"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
            RowBox[{"c", " ", "\[Epsilon]", " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], ")"}]}],
       "+", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             RowBox[{"M", ".", "M"}]}], "-", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          RowBox[{"X", ".", "X"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
            RowBox[{"c", " ", "\[Epsilon]", " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "-", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"V", ".", "X"}], ")"}], "2"]}], "-", 
         RowBox[{"d", " ", 
          RowBox[{"V", ".", "V"}], " ", 
          RowBox[{"X", ".", "M"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.869556920784384*^9, 3.8695569401077833`*^9}, 
   3.8695569973216457`*^9, 3.869557112297407*^9},
 CellLabel->
  "Out[703]=",ExpressionUUID->"e76257ac-8adc-48c1-a9d8-bad8525a8d33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        RowBox[{"V", ".", "M"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "X"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"X", ".", "M"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"M", ".", "M"}]}], "-", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"V", ".", "X"}], ")"}], "2"]}], "-", 
          RowBox[{"d", " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
    ")"}]}], "//", "\[IndentingNewLine]", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.869556974248987*^9, 3.8695570149905157`*^9}, {
  3.869557464140861*^9, 3.869557465955286*^9}, {3.869557616519744*^9, 
  3.869557657370851*^9}, {3.8695577926533613`*^9, 3.869557793382078*^9}},
 CellLabel->
  "In[706]:=",ExpressionUUID->"5914d9f6-f930-42cf-a6bd-0295c9baa6ab"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"M", ".", "X"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", "\[Epsilon]", " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
             RowBox[{"d", " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["\[Sigma]", "uX", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"M", ".", "M"}]}], "-", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"X", ".", "M"}]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"X", ".", "M"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        RowBox[{"V", ".", "M"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"V", ".", "X"}], ")"}], "2"]}], "-", 
          RowBox[{"d", " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", "\[Epsilon]", " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"V", ".", "X"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.869557466290968*^9, 3.869557657680332*^9, 
  3.8695577938153887`*^9},
 CellLabel->
  "Out[706]//TraditionalForm=",ExpressionUUID->"3a6092ee-9ea9-4a62-beba-\
a5f07edbb36c"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8695568621292257`*^9, 3.869556899108749*^9}, 
   3.869557016941049*^9},ExpressionUUID->"97758225-c2f5-4091-a130-\
9b941ca63211"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox[
    RowBox[{"\[IndentingNewLine]", "aresDen"}], "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ResNewMXold", ".", "M"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Y", "\[Rule]", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          RowBox[{"b", " ", "W"}]}]}], ",", 
        RowBox[{"W", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"X", "-", "uX", "-", 
            RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}], ",", 
        RowBox[{"V", "->", "uV"}]}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"V", ".", "V"}], ",", 
              RowBox[{"V", ".", "X"}], ",", 
              RowBox[{"V", ".", "M"}], ",", 
              RowBox[{"X", ".", "V"}], ",", 
              RowBox[{"X", ".", "X"}], ",", 
              RowBox[{"X", ".", "M"}], ",", 
              RowBox[{"M", ".", "V"}], ",", 
              RowBox[{"M", ".", "X"}], ",", 
              RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
           
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
              ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
      "&"}]}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresDen", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aresDen", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresDen", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aresDen", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "->", 
        RowBox[{
         RowBox[{"c", "*", "X"}], "+", "uM", "+", 
         RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
       RowBox[{"X", "->", 
        RowBox[{
         RowBox[{"g", "*", "uV"}], "+", 
         RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresDen", "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{
       OverscriptBox["aresDen", "^"], ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
             ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresDen", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aresDen", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresDen", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    OverscriptBox["aresDen", "^"], ",", "a"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228669324094*^9}, 
   3.869228718749824*^9, {3.869228749084634*^9, 3.869228825631928*^9}, {
   3.869283803264785*^9, 3.869283823492714*^9}, {3.869283880302532*^9, 
   3.869283883039679*^9}, {3.8692839258878937`*^9, 3.8692840053885612`*^9}, {
   3.86928404888568*^9, 3.869284103002675*^9}, {3.869559053068713*^9, 
   3.869559053214302*^9}, {3.869559102811775*^9, 3.869559119841145*^9}, {
   3.8695591832506123`*^9, 3.86955918356768*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"126a441a-3565-460b-a2ca-25996162c207"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uM"}], "+", 
    RowBox[{"c", " ", "g", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uV"}]}], "+", 
    RowBox[{"c", " ", "d", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"\[Epsilon]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uX"}]}], "+", 
    RowBox[{"d", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
    RowBox[{"c", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "4"]}], "+", 
    RowBox[{"c", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189176394*^9},
 CellLabel->
  "Out[751]=",ExpressionUUID->"4bd0dfac-f57d-4ebf-a0f7-08101eccef55"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", 
    SuperscriptBox["g", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"uV", ".", "uV"}]}], "+", 
   RowBox[{"d", " ", 
    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
  "d"]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189210685*^9},
 CellLabel->
  "Out[752]=",ExpressionUUID->"23749786-697e-48ae-91db-7072f8947e3a"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189229308*^9},
 CellLabel->
  "Out[753]=",ExpressionUUID->"5a64e9f4-5069-4849-a79d-086ccc2ca75e"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189232772*^9},
 CellLabel->
  "Out[754]=",ExpressionUUID->"bf85937c-714c-45a5-8f72-09a9e9c88ba7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"noise", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"aresDenSolve", "=", 
  RowBox[{
   OverscriptBox["aresDen", "^"], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "->", "1"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "noise"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "noise"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "noise"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"aresDenSol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"aresDenSolve", "==", "0"}], ",", "e"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"e", "/.", 
    RowBox[{"aresDenSol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.869284305874529*^9, 3.8692843477776003`*^9}, {
  3.86928448797668*^9, 3.8692845092960777`*^9}, {3.869284588933527*^9, 
  3.869284594167206*^9}, {3.869284656468687*^9, 3.869284658841823*^9}, {
  3.8692856084181004`*^9, 3.86928567507589*^9}, {3.869285727397005*^9, 
  3.869285774126294*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"8ab6c42e-6c9d-43e9-9c5c-9ce9a573251a"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.869555265899795*^9},
 CellLabel->
  "Out[530]=",ExpressionUUID->"4edec103-44c6-4ce3-b90e-4b72ab318860"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox["e", "d"]}]], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.869555265901765*^9},
 CellLabel->
  "Out[531]=",ExpressionUUID->"0a8ff7f0-1c52-429c-9516-634a7d63d777"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"e", "\[Rule]", "d"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.869555265903713*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"a6c6a9e9-1002-4474-8561-28c6044d5c49"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJxF1OlPEnAcgHEkKRTLExVDOWyu2FCnS+fR0ozhVqJhUMtlhtKcUZg606GW
EzWtLRXRifLCI9KxsrWl5mpamJYWuZqY0WGReLXyQslJVFt8fy+eff6DhyYQ
c4VYDAaT8Ld/Fs8mrFit/oM2jRJPk34LyXH5vNH7C0mNyLaIV5FPq+vw00Yk
PnDSb/AVsj4v7cjVZqTaLrcDE47ECdkhpNN00P3dM1FbLQ3kahTp+0apoOTn
AVGNgQL2XVZkdSf6gZw6HvV3ExlkKx9z4r/7gKqRQl1uCglMldYTX3d6gSVp
2+4S3D1BDJMyEFfuAb6/3lSpnnADyY6ZXWuHXMHz+xk4PdkZTA//1KnREEBG
QaT1YgcebP2YPFQYiwNnS4nRbG8s2C/fy5rjWwZsBs9PrQUp18HD/XoHC38J
zO7qNru6G0D+Of/WN0UvwJGXU9Whyc8P2oxkPrmf1GgAsfnEDxmkJXCHU1Kp
4Mc6WDati8tpt4D3miuSSlbsYmyK2zJcvvFxYGqWwreyFA9WHcuPCG0hgPYe
cuOVzV3g5Fj5ktTZFeRJBGEKjRsoIizStac8QIp6uGH7AhGU9MUlOzd7gdkq
UU9YEAl0woYLAmd8QNaF43KGjAx6P/QVs/b4gXU512qDJykgtyKRqeyhgowU
Ka+jmAbqjA5tMh4d1ApmYt0o/uAX+9tmOR25psrsJgUgSYuLZBoTmZG7shEU
hdwss95JOIEMuEXyqbqJjGDrx51kyKPzLZU1DchLTKqpUYl89CBgXKVGcodD
K4ZGkMJMU3T8GLLAsXd1TItUciLPvp1Azulior8akJsF2FXhLHLn7qGu+QVk
yBm21/IykmXnoM0zIU+2j0rNZmQW60ZU0Rby/7fAPwoONb0=
       "]]},
     Annotation[#, "Charting`Private`Tag$59420#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-10, 10}, {-9.999999591836735, 9.999999591836735}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.86955526593585*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"e4d78b7e-1efe-42da-adaa-c30cd4e9799b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox[
    RowBox[{"\[IndentingNewLine]", "aresNum"}], "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ResNewMXold", ".", "Y"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Y", "\[Rule]", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          RowBox[{"b", " ", "W"}]}]}], ",", 
        RowBox[{"W", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"X", "-", "uX", "-", 
            RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}], ",", 
        RowBox[{"V", "->", "uV"}]}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"V", ".", "V"}], ",", 
              RowBox[{"V", ".", "X"}], ",", 
              RowBox[{"V", ".", "M"}], ",", 
              RowBox[{"X", ".", "V"}], ",", 
              RowBox[{"X", ".", "X"}], ",", 
              RowBox[{"X", ".", "M"}], ",", 
              RowBox[{"M", ".", "V"}], ",", 
              RowBox[{"M", ".", "X"}], ",", 
              RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
           
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
              ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
      "&"}]}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresNum", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox[
      RowBox[{"aresNum", "\[IndentingNewLine]"}], "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresNum", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox[
      RowBox[{"aresNum", "\[IndentingNewLine]"}], "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "->", 
        RowBox[{
         RowBox[{"c", "*", "X"}], "+", "uM", "+", 
         RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
       RowBox[{"X", "->", 
        RowBox[{
         RowBox[{"g", "*", "uV"}], "+", 
         RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresNum", "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{
       OverscriptBox["aresNum", "^"], ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
             ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresNum", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aresNum", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresNum", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    OverscriptBox["aresNum", "^"], ",", "a"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228669324094*^9}, 
   3.869228718749824*^9, {3.869228749084634*^9, 3.869228825631928*^9}, {
   3.869283803264785*^9, 3.869283823492714*^9}, {3.869283880302532*^9, 
   3.869283883039679*^9}, {3.8692839258878937`*^9, 3.8692840053885612`*^9}, {
   3.869559202776163*^9, 3.869559215589676*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"f55f2f5d-1245-487a-8064-e3a94f4674ea"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uM"}]}], "+", 
    RowBox[{"a", " ", "c", " ", "g", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uV"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"a", " ", "c", " ", "d", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"a", " ", "\[Epsilon]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"a", " ", "c", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uX"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uY"}], "+", 
    RowBox[{"a", " ", "d", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "4"]}], "+", 
    RowBox[{"c", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}]}]}], ")"}], 
        " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.8695592293526154`*^9},
 CellLabel->
  "Out[759]=",ExpressionUUID->"0b93195c-abc3-4513-8e3d-f9cc8488089b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "d"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"uV", ".", "uV"}]}], "+", 
    RowBox[{"a", " ", "d", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["g", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"a", " ", "c", " ", "d"}], "+", 
          RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.8695592293971*^9},
 CellLabel->
  "Out[760]=",ExpressionUUID->"6992934d-c62e-4012-bff3-55f217fa4476"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"a", " ", "c", " ", "d"}], "+", 
     RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{"a", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.869559229437874*^9},
 CellLabel->
  "Out[761]=",ExpressionUUID->"7bd949a2-d1c8-47ad-a4af-d3818d042a99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", " ", "c", " ", "d", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     RowBox[{"c", " ", "d", " ", "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.869559229441852*^9},
 CellLabel->
  "Out[762]=",ExpressionUUID->"bca8fdef-ed83-4eff-9e95-ee51ae686c86"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "a", "}"}], ",", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dynamic", "@", 
       RowBox[{"Plot", "[", 
        RowBox[{"aresBiasNum", ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "0", ",", "5"}], "}"}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ",", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "d"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "5"}], "}"}], ",", "Label"}], "]"}]}], "}"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.869559659278062*^9},
 CellLabel->
  "In[2752]:=",ExpressionUUID->"5967e82d-294b-49ee-863f-2c236d853529"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`a$$}, 
  TagBox[GridBox[{
     {
      DynamicBox[ToBoxes[
        Plot[$CellContext`aresBiasNum, {$CellContext`e, 0, 5}, 
         PlotRange -> {All, {-3, 3}}], StandardForm],
       ImageSizeCache->{180., {56., 60.58812949121591}}]},
     {
      RowBox[{"Slider", "[", 
       RowBox[{
        DynamicBox[ToBoxes[$CellContext`d, StandardForm],
         ImageSizeCache->{7.640625, {1., 9.}}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "5"}], "}"}], ",", "Label"}], "]"}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{3.8693056431929083`*^9, 3.869309826864869*^9},
 CellLabel->
  "Out[2752]=",ExpressionUUID->"0bc6119f-7b3f-4a20-9fe7-c122c7b0e1bd"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aresBias", "=", 
     RowBox[{
      OverscriptBox[
       RowBox[{"(", "aresNum"}], "^"], "/", 
      OverscriptBox["aresDen", "^"]}]}], ")"}], "-", "a"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aresBiasNum", "[", 
   RowBox[{"d_", ",", "e_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"aresBias", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", "->", "1"}], ",", 
      RowBox[{"c", "->", "1"}], ",", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], "}"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"aresBiasNum", "[", 
  RowBox[{"d", ",", "e"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"aresBiasNum", "[", 
  RowBox[{"0.5", ",", "1.499"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"aresBiasNum", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "0", ",", "5", ",", 
     RowBox[{
      RowBox[{"Labeled", "[", 
       RowBox[{
        RowBox[{"Panel", "@", 
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Slider", "[", 
              RowBox[{"##", ",", 
               RowBox[{"ImageSize", "->", "250"}]}], "]"}], ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"Axes", "->", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], ",", 
               RowBox[{"Ticks", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Subdivide", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"##", "&"}], "@@", "#2"}], ",", "5"}], "]"}], ",",
                   "None"}], "}"}]}], ",", 
               RowBox[{"ImageSize", "->", "250"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", ".05"}], "}"}]}], "}"}]}]}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"Alignment", "->", "Center"}], ",", 
           RowBox[{"Spacings", "->", "0"}]}], "]"}]}], ",", "#", ",", 
        "Right"}], "]"}], "&"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "d"}], "-", "e", "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"d", "+", "e"}], ")"}]}]}], "==", "0"}], ",", "e"}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQvc+A6YnQlTeOwte63oLoxpdtvSJAuqj3/WwQrbz+
50IQvT85cT2IPiO+dTOI9qn8vAVEr170aAeIvqchvhNEs532OAqi806XngTR
nEHN4qJAuuraHWUQPUlIyQJE/zjwEkz3nHO9CaIzGzrvgujIrJT3IHq36++P
IDrg890fIHqK/O5fINrEcB6LGJD+EBPEDqIDp8r7guhHdjb+INpjhtZUEH3h
jdwMEN22+tAiEC135+ASEJ335uxqEC2ZemgjiH6eNHEfiJ7Ym38IRJ+q33UW
RM9Z6HkORJ9d18snDqQ3XTovAqIrLlv7gOitta98QbTub7ZmCVB41AWCaQDM
1rTz
  "],
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[2753]:=",ExpressionUUID->"9d9bb6c9-eeeb-43a5-af58-1f31845764df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["slopeMuM", "^"], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ResNewMX", ".", "M"}], 
     RowBox[{"ResNewMX", ".", "ResNewMX"}]], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
         "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["slopeMuM", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["slopeMuM", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["slopeMuM", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["slopeMuM", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
   3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
   3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
   3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
   3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
   3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
   3.869227758046924*^9}, 3.869227846459057*^9},
 CellLabel->
  "In[2753]:=",ExpressionUUID->"c8346299-38a5-4ca1-b5fa-7eb5d26773f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "M"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "X"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}]}], "+", 
       RowBox[{"e", " ", 
        RowBox[{"V", ".", "X"}]}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.869309826991728*^9},
 CellLabel->
  "Out[2753]=",ExpressionUUID->"1ed43b1b-c8e9-4aba-a289-13b238c1c558"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "M"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.869309827004174*^9},
 CellLabel->
  "Out[2754]=",ExpressionUUID->"b054b6f5-3a40-4799-8989-6a29b3cb51f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}]}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.8693098270109158`*^9},
 CellLabel->
  "Out[2755]=",ExpressionUUID->"64b679d2-928b-49af-9711-d700d75bd1cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"M", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.869309827015757*^9},
 CellLabel->
  "Out[2756]=",ExpressionUUID->"36429ca3-f844-4394-8192-32627aeb3623"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["slopeYuM", "^"], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ResNewMX", ".", "Y"}], 
     RowBox[{"ResNewMX", ".", "ResNewMX"}]], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
         "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["slopeYuM", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["slopeYuM", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["slopeYuM", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["slopeYuM", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864279199372098*^9, 3.864279212567052*^9}},
 CellLabel->
  "In[2757]:=",ExpressionUUID->"0cbe1341-d4af-4080-b77e-5212dd4b5c1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "Y"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "Y"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "Y"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "X"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}]}], "+", 
       RowBox[{"e", " ", 
        RowBox[{"V", ".", "X"}]}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827096087*^9},
 CellLabel->
  "Out[2757]=",ExpressionUUID->"ccb21ef5-aabb-4304-beaa-f8cb40181ee3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "Y"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "Y"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "Y"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827103979*^9},
 CellLabel->
  "Out[2758]=",ExpressionUUID->"a91e03cb-ae4c-4add-92bc-f31f3de9459c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "Y"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}], "-", 
  RowBox[{"d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "Y"}]}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827110302*^9},
 CellLabel->
  "Out[2759]=",ExpressionUUID->"44f898dc-eeb5-4d74-b41c-18a30375ec5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"M", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827114697*^9},
 CellLabel->
  "Out[2760]=",ExpressionUUID->"b9b8a136-9bd3-45e8-8cf3-d70bc0aa9187"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["numslopeYuM", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeYuM", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["numslopeMuM", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeMuM", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aNewIV", "^"], "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeYuM", "^"], "/", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}], "/", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeMuM", "^"], "/", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8642792905835943`*^9, 3.864279328512782*^9}, {
  3.864279393545319*^9, 3.8642794356395206`*^9}, {3.8642795434241333`*^9, 
  3.864279632612693*^9}, {3.864279689694309*^9, 3.8642796911241703`*^9}},
 CellLabel->
  "In[2761]:=",ExpressionUUID->"f5601b99-a387-4964-b1de-7c2e1c596001"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"V", ".", "V"}]}], "-", 
     RowBox[{"e", " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
   3.8642796916854773`*^9, 3.8648757498134413`*^9, 3.867905732258651*^9, 
   3.8691144390497503`*^9, 3.8692265948242083`*^9, 3.869292771508428*^9, 
   3.869305643467147*^9, 3.869309827127482*^9},
 CellLabel->
  "Out[2761]=",ExpressionUUID->"dbda3697-a31f-4076-95b9-a41fa865c486"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}]}], "-", 
     RowBox[{"e", " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
   3.8642796916854773`*^9, 3.8648757498134413`*^9, 3.867905732258651*^9, 
   3.8691144390497503`*^9, 3.8692265948242083`*^9, 3.869292771508428*^9, 
   3.869305643467147*^9, 3.869309827133737*^9},
 CellLabel->
  "Out[2762]=",ExpressionUUID->"192cb37b-031d-40cc-804e-6d9a48e068d9"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "d"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"V", ".", "M"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
    RowBox[{"X", ".", "Y"}]}], "+", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"M", ".", "Y"}], " ", 
       RowBox[{"V", ".", "V"}]}], "+", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "d"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"V", ".", "M"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}]}], "+", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
   3.8642796916854773`*^9, 3.8648757498134413`*^9, 3.867905732258651*^9, 
   3.8691144390497503`*^9, 3.8692265948242083`*^9, 3.869292771508428*^9, 
   3.869305643467147*^9, 3.869309827138432*^9},
 CellLabel->
  "Out[2763]=",ExpressionUUID->"4016d2d9-3439-423a-840c-2372ae9127e3"]
}, Open  ]],

Cell[TextData[{
 "The above estimator for a can be written in the more manifestly-symmetric \
form, where it is clear that the denominator is simply the numerator /. {Y\
\[Rule]M}:\n",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "Y"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "Y"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "Y"}]}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "M"}]}], "-", 
       RowBox[{"2", "  ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "M"}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], 
     RowBox[{"X", ".", "M"}]}]}]]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
    3.8642796916891403`*^9},ExpressionUUID->
  "c3344d28-98a8-4bd0-823d-c3077954e100"],
 "\n\nAnother approach is possible, where instead of retrieving ",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Epsilon]", "d"], TraditionalForm]],ExpressionUUID->
  "0a616673-433d-4509-b7e7-e5134c04e7a6"],
 "from the difference between the IV estimator on C and the backdoor \
estimator on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "+", 
    FractionBox["\[Epsilon]", "d"]}], TraditionalForm]],ExpressionUUID->
  "e1cbd33c-c55e-4a44-9006-b9b1b94d1528"],
 ", we extract ",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Epsilon]", "d"], TraditionalForm]],ExpressionUUID->
  "8c647302-c52a-4969-86fa-bb5a3be5f01e"],
 " from the following ratio of residuals:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"(", 
      FractionBox["\[Epsilon]", "d"], ")"}], "^"], "=", 
    FractionBox[
     RowBox[{"m", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"m", ".", "v"}], 
        RowBox[{"x", ".", "v"}]], "x"}]}], 
     RowBox[{"x", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"x", ".", "v"}], 
        RowBox[{"v", ".", "v"}]], "v"}]}]]}], TraditionalForm]],
  ExpressionUUID->"469e9264-f65e-406d-a4a2-21989bbfef31"],
 "\nWe have been a bit notationally irresponsible here, as we are dividing \
two vectors which are not exactly parallel, due to the noise terms ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "m"], TraditionalForm]],ExpressionUUID->
  "1f6840ae-8736-49f8-8696-92be7ad10c17"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "x"], TraditionalForm]],ExpressionUUID->
  "f1d31d76-3918-487d-b80e-1007a5b2b2c4"],
 ". On the average they should be parallel, so we take the estimator to be \
the ratio of magnitudes:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"(", 
      FractionBox["\[Epsilon]", "d"], ")"}], "^"], "=", 
    FractionBox[
     RowBox[{"|", 
      RowBox[{"m", "-", 
       RowBox[{
        FractionBox[
         RowBox[{"m", ".", "v"}], 
         RowBox[{"x", ".", "v"}]], "x"}]}], "|"}], 
     RowBox[{"|", 
      RowBox[{"x", "-", 
       RowBox[{
        FractionBox[
         RowBox[{"x", ".", "v"}], 
         RowBox[{"v", ".", "v"}]], "v"}]}], "|"}]]}], TraditionalForm]],
  ExpressionUUID->"0b92d169-7e6e-4c69-a4c0-556977dab120"],
 "\nMore specifically,"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864277835972797*^9, 3.864277881807207*^9}, {3.864279907170121*^9, 
   3.864279923541842*^9}, {3.864279984138883*^9, 3.8642800687863827`*^9}, {
   3.864280189326881*^9, 3.864280312462824*^9}, {3.864280443371169*^9, 
   3.864280489310554*^9}, {3.864282903581594*^9, 3.864282985099619*^9}, {
   3.864283056642858*^9, 
   3.864283143114409*^9}},ExpressionUUID->"8d572e12-250f-4bef-a3d6-\
9c9e3f0c8720"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["edivd2", "^"], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ResMX", ".", "ResMX"}], 
     RowBox[{"ResXV", ".", "ResXV"}]], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
         "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["edivd2", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["edivd2", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.864283157759853*^9, 3.864283170659472*^9}, {
  3.864283289611043*^9, 3.8642833692568007`*^9}},
 CellLabel->
  "In[2764]:=",ExpressionUUID->"5582aa67-fef6-4e38-afcd-11db737a2356"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"V", ".", "V"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{"X", ".", "M"}]}], "-", 
        RowBox[{
         RowBox[{"V", ".", "M"}], " ", 
         RowBox[{"X", ".", "X"}]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"X", ".", "V"}]}], "-", 
     RowBox[{
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "X"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.864283285581399*^9, 3.864283313877812*^9}, {
   3.864283344728586*^9, 3.864283369802348*^9}, 3.864875749851974*^9, 
   3.867905732376409*^9, 3.869114439087323*^9, 3.8692265948884697`*^9, 
   3.8692927715376167`*^9, 3.869305643506974*^9, 3.869309827161181*^9},
 CellLabel->
  "Out[2764]=",ExpressionUUID->"7b5a93a1-ef58-4e84-85db-154766a11f21"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"V", ".", "X"}], " ", 
          RowBox[{"X", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"V", ".", "M"}], " ", 
          RowBox[{"X", ".", "X"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
    RowBox[{
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.864283285581399*^9, 3.864283313877812*^9}, {
   3.864283344728586*^9, 3.864283369802348*^9}, 3.864875749851974*^9, 
   3.867905732376409*^9, 3.869114439087323*^9, 3.8692265948884697`*^9, 
   3.8692927715376167`*^9, 3.869305643506974*^9, 3.869309827167304*^9},
 CellLabel->
  "Out[2765]=",ExpressionUUID->"27ac25a6-2607-4155-84b4-aa239517f05f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResNewMX2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ResMV", "-", 
     RowBox[{
      OverscriptBox["edivd2", "^"], "*", "ResXV"}]}], "//", "Simplify"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], "&"}]}]}]], "Input",\

 CellChangeTimes->{{3.864283472655937*^9, 3.864283531345242*^9}},
 CellLabel->
  "In[2766]:=",ExpressionUUID->"1c1d0502-04e7-43f6-9066-ebcc5ca5bec0"],

Cell[BoxData[
 RowBox[{"M", "+", 
  RowBox[{"X", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"V", ".", "X"}], " ", 
          RowBox[{"X", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"V", ".", "M"}], " ", 
          RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]]}], ")"}]}], "+", 
  RowBox[{"V", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"V", ".", "M"}], 
       RowBox[{"V", ".", "V"}]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "3"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"V", ".", "X"}], " ", 
          RowBox[{"X", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"V", ".", "M"}], " ", 
          RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8642834736480427`*^9, 3.864283533490588*^9}, 
   3.8648757498676147`*^9, 3.8679057324238167`*^9, 3.869114439102861*^9, 
   3.8692265949158783`*^9, 3.8692927715581017`*^9, 3.86930564352952*^9, 
   3.869309827184998*^9},
 CellLabel->
  "Out[2766]=",ExpressionUUID->"6d48f39e-9fe4-45fe-9173-cee90906449a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["slopeMuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ResNewMX2", ".", "M"}], 
      RowBox[{"ResNewMX2", ".", "ResNewMX2"}]], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
          "}"}]}]}], "]"}], "&"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["slopeMuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["slopeMuM2", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeMuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Denominator", "[", 
    OverscriptBox["slopeMuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8642835370342693`*^9, 3.864283585038824*^9}},
 CellLabel->
  "In[2767]:=",ExpressionUUID->"911f1cb6-ad72-4c29-997e-a7b2980dbb04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["slopeYuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ResNewMX2", ".", "Y"}], 
      RowBox[{"ResNewMX2", ".", "ResNewMX2"}]], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
          "}"}]}]}], "]"}], "&"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["slopeYuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["slopeYuM2", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeYuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Denominator", "[", 
    OverscriptBox["slopeYuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.864279199372098*^9, 3.864279212567052*^9}, {
  3.864283600777308*^9, 3.864283611095649*^9}, {3.864283645815322*^9, 
  3.8642836522943*^9}},
 CellLabel->
  "In[2771]:=",ExpressionUUID->"d4d61f03-b73b-4ecb-8c6b-25f4236e0d54"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["numslopeYuM2", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeYuM2", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["numslopeMuM2", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeMuM2", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aNewIV2", "^"], "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeYuM2", "^"], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}], "/", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeMuM2", "^"], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8642792905835943`*^9, 3.864279328512782*^9}, {
  3.864279393545319*^9, 3.8642794356395206`*^9}, {3.8642795434241333`*^9, 
  3.864279632612693*^9}, {3.864279689694309*^9, 3.8642796911241703`*^9}, {
  3.864283662645979*^9, 3.8642836992045937`*^9}, {3.864283838022381*^9, 
  3.8642838524903297`*^9}},
 CellLabel->
  "In[2775]:=",ExpressionUUID->"99b3d397-0d31-44f2-9d8d-952c022c0d92"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "5"], " ", 
   RowBox[{"V", ".", "Y"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "6"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "Y"}]}], " ", 
      RowBox[{"V", ".", "V"}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "Y"}]}]}], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "Y"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{"X", ".", "X"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.864283701293281*^9, 3.8642837094336243`*^9}, {
   3.8642838453279123`*^9, 3.864283852977318*^9}, 3.864875774260747*^9, 
   3.867905783145464*^9, 3.869114465031118*^9, 3.869226632262288*^9, 
   3.869292772269948*^9, 3.869305644159102*^9, 3.869309827828842*^9},
 CellLabel->
  "Out[2775]=",ExpressionUUID->"7f67d00b-1635-4a88-a543-b78632334af3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", ".", "M"}], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "5"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "6"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", ".", "M"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "M"}], ")"}], "3"], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "X"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{"X", ".", "X"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{"X", ".", "X"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.864283701293281*^9, 3.8642837094336243`*^9}, {
   3.8642838453279123`*^9, 3.864283852977318*^9}, 3.864875774260747*^9, 
   3.867905783145464*^9, 3.869114465031118*^9, 3.869226632262288*^9, 
   3.869292772269948*^9, 3.869305644159102*^9, 3.869309827834365*^9},
 CellLabel->
  "Out[2776]=",ExpressionUUID->"3425193b-86c1-4966-a13a-0aa7fcf467de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"V", ".", "Y"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"M", ".", "Y"}]}], " ", 
        RowBox[{"V", ".", "V"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"X", ".", "Y"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}], " ", 
        RowBox[{"X", ".", "X"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"V", ".", "M"}]}], " ", 
        RowBox[{"V", ".", "Y"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{"X", ".", "X"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"M", ".", "Y"}], " ", 
           RowBox[{"X", ".", "X"}]}], "-", 
          RowBox[{
           RowBox[{"M", ".", "M"}], " ", 
           RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "M"}], ")"}], "2"], "-", 
       RowBox[{
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "M"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "3"], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"M", ".", "M"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{"X", ".", "X"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{"X", ".", "X"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.864283701293281*^9, 3.8642837094336243`*^9}, {
   3.8642838453279123`*^9, 3.864283852977318*^9}, 3.864875774260747*^9, 
   3.867905783145464*^9, 3.869114465031118*^9, 3.869226632262288*^9, 
   3.869292772269948*^9, 3.869305644159102*^9, 3.869309827847776*^9},
 CellLabel->
  "Out[2777]=",ExpressionUUID->"0b558055-e11f-4842-9d8f-d60680452296"]
}, Open  ]],

Cell[TextData[{
 "The above estimator for a can be written in the more manifestly-symmetric \
form, where it is clear that the denominator is simply the numerator /. {Y\
\[Rule]M}:\n",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "Y"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "Y"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "Y"}]}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "M"}]}], "-", 
       RowBox[{"2", "  ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "M"}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], 
     RowBox[{"X", ".", "M"}]}]}]]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
    3.8642796916891403`*^9},ExpressionUUID->
  "c7f96696-ce0b-41b7-985c-af3e16c3abdf"],
 "\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864277835972797*^9, 3.864277881807207*^9}, {3.864279907170121*^9, 
   3.864279923541842*^9}, {3.864279984138883*^9, 3.8642800687863827`*^9}, {
   3.864280189326881*^9, 3.864280312462824*^9}, {3.864280443371169*^9, 
   3.864280489310554*^9}, {3.864282903581594*^9, 3.864282985099619*^9}, {
   3.864283056642858*^9, 3.864283143114409*^9}, {3.864283813848689*^9, 
   3.864283814536786*^9}},ExpressionUUID->"ce83f5aa-236c-4e9a-8fa5-\
b9d062d269d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"M", "-", "uM"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aIV", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy00og3EAx/ERaV6WFdpGK2W2y7BZIyGPlHnbDMVMeU9essMKeW+NvOyA
RBZ2Uo6WaeU1HBhLEnIRloOXJ4ksQ/j/nsO3z+kbW2coafRnsVhCEmzoWfdK
d2hKMR36CdW8Vv8EYpfylXFxScuFloipKNhvShHDMlWYBHJ87XL48xepgCF7
mWnQ0zJLMb+mvAA+Ct40cN+Yv5pELJp8dkA6/GoLppq/D6DZaD2BZ3Hvl1BR
r/TCpl/XL7watwXKiMGuM8ZM3TEbbii1HGgduYiAE5V+fPhaVS2DPZ+bCqjO
a86GYXf9Kti9RhVCQVBTMazZTh+F+YeJFuh72PHAsfObexgwt/kEl52OF+jI
MLDlxAHZAuObXS6FK4lZjJbkBPbgLk3ZPiK5UFJaEQNFRXohFOhoEaxQ6cXw
NMfbN0QM4c2bYJu7mjdM7KXn+bCzI1o0Q5QnuePh+dfWWOoRTTlrr8fhba5d
oCfqrjei4T95evOh
  "],
 CellLabel->
  "In[2778]:=",ExpressionUUID->"bf90c7c7-d9af-44cb-bf82-aa7edea63556"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphiv", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{"aerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], "}"}],
           "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
  3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
  3.860036875204605*^9}, {3.864189213309959*^9, 3.864189237505952*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[2780]:=",ExpressionUUID->"50a24e15-32bf-4017-a4ac-6aa29177ca19"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875774314048*^9, 3.867905783304817*^9, 
   3.869114465083761*^9, 3.8692266323534718`*^9, 3.869292772304901*^9, 
   3.8693056441968517`*^9, 3.86930982787593*^9},
 CellLabel->
  "Out[2781]=",ExpressionUUID->"45074abf-40bb-4be0-8419-37aad1e6f8dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV", " ", "uX"}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "-", 
         
         RowBox[{"X", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "M"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"c", " ", "X", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"X", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"uM", "+", 
           RowBox[{"uY", " ", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], "2"]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"2", " ", "uX"}], "+", 
             RowBox[{"2", " ", "uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}]}]}],
    ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "M"}], " ", "uV"}], "+", 
                RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{"uX", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"2", " ", "c", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{"uX", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"uY", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M"}], "+", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "M"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{"X", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
            ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
       RowBox[{"g", " ", "uM", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{"M", "-", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "M"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{"X", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
            ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"uM", "+", 
           RowBox[{"uY", " ", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], "2"]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"2", " ", "uX"}], "+", 
             RowBox[{"2", " ", "uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}]}]}],
    ",", 
   RowBox[{"uY", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", "uY", " ", 
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"uM", "+", 
          RowBox[{"uY", " ", 
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"M", " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
             RowBox[{"M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
             RowBox[{"uM", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
             RowBox[{"c", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "uM"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "uV"}], "+", 
                   RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}]}],
             ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M"}], "+", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"uM", "+", 
           RowBox[{"uY", " ", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], "2"]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"2", " ", "uX"}], "+", 
             RowBox[{"2", " ", "uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875774314048*^9, 3.867905783304817*^9, 
   3.869114465083761*^9, 3.8692266323534718`*^9, 3.869292772304901*^9, 
   3.8693056441968517`*^9, 3.869309828065304*^9},
 CellLabel->
  "Out[2783]=",ExpressionUUID->"090fe42b-a75a-4827-81e6-8ee3831235c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"X", ".", "M"}]], 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      FractionBox[
       RowBox[{"ea", " ", "X"}], "d"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"uM", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "uM"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M"}], "+", 
               RowBox[{"c", " ", "X"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{"X", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV"}], "+", 
               RowBox[{"2", " ", "uX"}], "+", 
               RowBox[{"2", " ", "uY", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
            "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}]}],
       "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV", " ", "uX"}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV", " ", 
                 RowBox[{"(", 
                  RowBox[{"M", "-", 
                   RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"uM", "+", 
                   RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{"X", " ", 
                 SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "M"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"c", " ", "X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                 " ", 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SuperscriptBox["uV", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"uM", "+", 
                    RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                  "2"]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "uV", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "uM", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                    "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
                 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
                RowBox[{
                 SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "uV", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}], "+", 
                    RowBox[{"2", " ", "uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                    "+", 
                   SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
               ")"}]}], ")"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "M"}], " ", "uV"}], "+", 
                    RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "M", " ", 
                   RowBox[{"(", 
                    RowBox[{"uX", "+", 
                    RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                   "+", 
                  RowBox[{"2", " ", "c", " ", "X", " ", 
                   RowBox[{"(", 
                    RowBox[{"uX", "+", 
                    RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                   "+", 
                  RowBox[{"uY", " ", "X", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "M"}], "+", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
            RowBox[{"g", " ", "uM", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["uV", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"uM", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
              "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "uM", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
            RowBox[{
             SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}], "+", 
                  RowBox[{"2", " ", "uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875774314048*^9, 3.867905783304817*^9, 
   3.869114465083761*^9, 3.8692266323534718`*^9, 3.869292772304901*^9, 
   3.8693056441968517`*^9, 3.869309828074607*^9},
 CellLabel->
  "Out[2784]=",ExpressionUUID->"d46fb0e7-209f-4af7-91c9-b2bdef107059"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"aIVcorr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["ca", "^"], "-", 
       RowBox[{"c", "*", "a"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["c", "^"], "-", "c"}], ")"}]}], "//", 
    RowBox[{"Expand", "//.", "structureEqs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<M\>\"", 
     ",", "\"\<Y\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphiv", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aIVcorrsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aIVcorr", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864189595862781*^9, 3.864189705397428*^9}},
 CellLabel->
  "In[2785]:=",ExpressionUUID->"76f7976a-38d9-4160-b3a0-95a3e002ebfb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "M", ",", "Y"}], "}"}]], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.8648757745137157`*^9, 
   3.8679057838405647`*^9, 3.869114465288781*^9, 3.869226632674734*^9, 
   3.869292772519232*^9, 3.869305644407152*^9, 3.869309828092286*^9},
 CellLabel->
  "Out[2787]=",ExpressionUUID->"008ca62d-3446-4452-b9f7-322808ba7c15"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV", " ", "uX"}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", "uM", " ", "uV", " ", "X"}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"X", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"c", " ", "g", " ", "uV"}], "+", 
            RowBox[{"2", " ", "c", " ", "uX"}], "+", 
            RowBox[{"2", " ", "c", " ", "uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{"c", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"2", " ", "uX"}], "+", 
          RowBox[{"2", " ", "uY", " ", 
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.8648757745137157`*^9, 
   3.8679057838405647`*^9, 3.869114465288781*^9, 3.869226632674734*^9, 
   3.869292772519232*^9, 3.869305644407152*^9, 3.869309828109475*^9},
 CellLabel->
  "Out[2789]=",ExpressionUUID->"7df7f886-34ab-4472-ae66-5fee8c8a74b1"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.8648757745137157`*^9, 
   3.8679057838405647`*^9, 3.869114465288781*^9, 3.869226632674734*^9, 
   3.869292772519232*^9, 3.869305644407152*^9, 3.869311647971531*^9},
 CellLabel->
  "Out[2790]=",ExpressionUUID->"1309679d-7349-4119-ba71-0c9d44ebea25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.863856380066532*^9, 3.8638563950769453`*^9}, {
  3.8641165213663473`*^9, 3.8641165231740637`*^9}},
 CellLabel->
  "In[2201]:=",ExpressionUUID->"2243662c-1052-4bd7-bdf8-768475876f16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"X", ".", "M"}]], 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      RowBox[{"ea", " ", "X"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M"}], "+", 
               RowBox[{"c", " ", "X"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"uM", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "uM"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{"X", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"2", " ", "uX"}], "+", 
            RowBox[{"2", " ", "uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}]}], 
           ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"g", " ", "uV", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "X"}], "+", 
                RowBox[{"g", " ", "uV", " ", 
                 RowBox[{"(", 
                  RowBox[{"M", "-", 
                   RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"uM", "+", 
                   RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "M"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"c", " ", "X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                 " ", 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              RowBox[{"g", " ", "uV", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", "uV"}], "+", 
                 RowBox[{"2", " ", "uX"}], "+", 
                 RowBox[{"2", " ", "uY", " ", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SuperscriptBox["uV", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                "2"]}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
                 RowBox[{"g", " ", "uV", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "uM", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                   ")"}]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}]}],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "M"}], "+", 
            RowBox[{"c", " ", "X"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", "uV"}], "+", 
                  RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "M", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"2", " ", "c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"uY", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "M"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{"X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
              ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "+", 
            RowBox[{"g", " ", "uM", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV"}], "+", 
               RowBox[{"2", " ", "uX"}], "+", 
               RowBox[{"2", " ", "uY", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["uV", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"uM", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
              "2"]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "uM", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.869307749374545*^9},
 CellLabel->
  "Out[2201]=",ExpressionUUID->"28768656-4877-4f9e-9c03-ff8b88ac64e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"X", ".", "M"}]], 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      RowBox[{"ea", " ", "X"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M"}], "+", 
               RowBox[{"c", " ", "X"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"uM", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "uM"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{"X", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"2", " ", "uX"}], "+", 
            RowBox[{"2", " ", "uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}]}], 
           ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"g", " ", "uV", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "X"}], "+", 
                RowBox[{"g", " ", "uV", " ", 
                 RowBox[{"(", 
                  RowBox[{"M", "-", 
                   RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"uM", "+", 
                   RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "M"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"c", " ", "X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                 " ", 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              RowBox[{"g", " ", "uV", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", "uV"}], "+", 
                 RowBox[{"2", " ", "uX"}], "+", 
                 RowBox[{"2", " ", "uY", " ", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SuperscriptBox["uV", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                "2"]}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
                 RowBox[{"g", " ", "uV", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "uM", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                   ")"}]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}]}],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "M"}], "+", 
            RowBox[{"c", " ", "X"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", "uV"}], "+", 
                  RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "M", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"2", " ", "c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"uY", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "M"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{"X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
              ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "+", 
            RowBox[{"g", " ", "uM", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV"}], "+", 
               RowBox[{"2", " ", "uX"}], "+", 
               RowBox[{"2", " ", "uY", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["uV", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"uM", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
              "2"]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "uM", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.86930774938531*^9},
 CellLabel->
  "Out[2202]=",ExpressionUUID->"b7bf05a0-dc4f-4568-b4a8-796378cdef00"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Instrumental Variables for Chains of Confounded Mediators, Nonlinear Case\
\>", "Subsection",
 CellChangeTimes->{{3.846918380209955*^9, 3.846918403746295*^9}, {
  3.847094931567748*^9, 3.847094945843382*^9}, {3.858319075597793*^9, 
  3.8583190781426697`*^9}, {3.8583294810528927`*^9, 3.8583294837393723`*^9}, {
  3.859545918605206*^9, 3.859545920301775*^9}, {3.859559128455942*^9, 
  3.859559150645014*^9}, {3.864187779695509*^9, 3.8641877894520607`*^9}, {
  3.86427756096316*^9, 3.86427756298777*^9}, {3.871566479850684*^9, 
  3.871566481533293*^9}},ExpressionUUID->"82daa309-cf85-4794-9357-\
618ebdfdca32"],

Cell[TextData[{
 "We now consider the confounded mediator graph with an added instrument V \
prior to X.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "8c9c2b3e-b78a-4959-8501-b473459f5890"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "v"], "i"]}], TraditionalForm]],ExpressionUUID->
  "6c225529-d744-4ff3-b91c-fd7e82f794e2"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", 
    RowBox[{
     SubscriptBox["gv", "i"], "+", 
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "26bd186f-61d2-4e82-9d7e-bb4f89614c02"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "684ac276-5aa7-411a-97e9-6db5ef98a57a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "299fcee2-ece9-4e29-a1a7-04627c139f7a"],
 "."
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
  3.859546077292572*^9, 3.8595460830009737`*^9}, {3.859547299267392*^9, 
  3.859547300907641*^9}, {3.859559164128237*^9, 3.859559167825494*^9}, {
  3.864187796712625*^9, 3.864187839733988*^9}, {3.864281011833482*^9, 
  3.864281066469715*^9}},ExpressionUUID->"8cce385d-5c89-4b22-957b-\
29d507f679b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"2", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"3", "\[DirectedEdge]", "4"}], ",", 
     RowBox[{"5", "\[DirectedEdge]", "2"}], ",", 
     RowBox[{"5", "\[DirectedEdge]", "3"}], ",", 
     RowBox[{"5", "\[DirectedEdge]", "4"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vertices", " ", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vnames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<V\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\"", ",", "\"\<Y\>\"", ",", 
     "\"\<W\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweights", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "uV"], ",", 
     SubscriptBox["\[Sigma]", "uX"], ",", 
     SubscriptBox["\[Sigma]", "uM"], ",", 
     SubscriptBox["\[Sigma]", "uY"], ",", 
     SubscriptBox["\[Sigma]", "uW"]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlabels", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{"#1", ",", "Center"}], "]"}], "&"}], ",", "vnames"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eweights", "=", 
   RowBox[{"{", 
    RowBox[{"g", ",", "c", ",", "a", ",", "d", ",", "\[Epsilon]", ",", "b"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"elabels", " ", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"edges", "\[Rule]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "#1", ",", "18", ",", "Italic", ",", "Bold", ",", "Blue"}], 
             "]"}], ",", 
            RowBox[{"Background", "->", "White"}], ",", 
            RowBox[{"FrameStyle", "->", "White"}]}], "]"}], ",", 
          "\"\<Middle\>\""}], "]"}], "&"}], ",", "eweights"}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcoords", " ", "=", " ", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookup", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vnames", "->", "vertices"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupname", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{"vertices", "->", "vnames"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vweightsnou", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["\[Sigma]", "V"], ",", 
     SubscriptBox["\[Sigma]", "X"], ",", 
     SubscriptBox["\[Sigma]", "M"], ",", 
     SubscriptBox["\[Sigma]", "Y"], ",", 
     SubscriptBox["\[Sigma]", "W"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvars", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Symbol", "[", 
       RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vlookupweight", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<u\>\"", "<>", "#"}], "]"}], "&"}], ",", "vnames"}], 
         "]"}], "->", "vweights"}], "]"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Symbol", "[", "#", "]"}], "&"}], ",", "vnames"}], "]"}], "->",
         "vweightsnou"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"causalgraphiv2", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{"edges", ",", 
    RowBox[{"VertexLabels", "->", "vlabels"}], ",", 
    RowBox[{"EdgeLabels", "->", "elabels"}], ",", 
    RowBox[{"VertexWeight", "\[Rule]", "vweights"}], ",", 
    RowBox[{"EdgeWeight", "\[Rule]", "eweights"}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "\"\<LayeredEmbedding\>\""}], ",", 
    RowBox[{"VertexStyle", "->", "Black"}], ",", 
    RowBox[{"VertexSize", "->", "0.3"}], ",", 
    RowBox[{"VertexLabelStyle", "->", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Italic", ",", "26"}], "]"}]}], ",", 
    RowBox[{"EdgeStyle", "->", "Black"}], ",", 
    RowBox[{"VertexCoordinates", "\[Rule]", "vcoords"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.859459024698772*^9, 3.85945909073498*^9}, {
   3.8594591488601418`*^9, 3.85945920659604*^9}, {3.859459250168518*^9, 
   3.859459470759325*^9}, {3.8594595102168293`*^9, 3.859459516941248*^9}, {
   3.8594595670407553`*^9, 3.859459575501747*^9}, {3.859459637054397*^9, 
   3.859459733232544*^9}, {3.859459793864605*^9, 3.859459798464903*^9}, {
   3.8594598359282227`*^9, 3.859459879181384*^9}, {3.859459929011056*^9, 
   3.859459955773423*^9}, {3.859460046652501*^9, 3.859460047994684*^9}, {
   3.8594601108291407`*^9, 3.859460204490776*^9}, {3.8594602607706623`*^9, 
   3.85946038574233*^9}, {3.859460451588697*^9, 3.8594605995420103`*^9}, {
   3.859460635281043*^9, 3.859460641202232*^9}, {3.859461205922871*^9, 
   3.8594612488478518`*^9}, {3.8594615336041813`*^9, 
   3.8594615435580072`*^9}, {3.859470243917905*^9, 3.859470277067479*^9}, {
   3.859470390971575*^9, 3.8594704292818203`*^9}, {3.8594704842614594`*^9, 
   3.8594704939840918`*^9}, {3.859470529038028*^9, 3.859470585013467*^9}, {
   3.8595216768829117`*^9, 3.859521694554061*^9}, {3.8595217268443832`*^9, 
   3.8595217536491823`*^9}, {3.859591254243828*^9, 3.85959127290304*^9}, {
   3.859591322318336*^9, 3.859591322390768*^9}, {3.8595913875452213`*^9, 
   3.859591388062249*^9}, {3.864188348488*^9, 3.8641883873067493`*^9}, {
   3.864188433360779*^9, 3.864188472515016*^9}, {3.864277576893174*^9, 
   3.8642776786858797`*^9}, 3.8642777509719343`*^9},
 CellLabel->
  "In[413]:=",ExpressionUUID->"57a115b4-b308-4512-8d5b-fc9e2dfc77f8"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 
      5}, {{{1, 2}, {2, 3}, {3, 4}, {5, 2}, {5, 3}, {5, 4}}, Null}, {
      EdgeLabels -> {DirectedEdge[5, 3] -> Placed[
           Framed[
            Style[$CellContext`\[Epsilon], 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[3, 4] -> Placed[
           Framed[
            Style[$CellContext`a, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[2, 3] -> Placed[
           Framed[
            Style[$CellContext`c, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[5, 4] -> Placed[
           Framed[
            Style[$CellContext`b, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[1, 2] -> Placed[
           Framed[
            Style[$CellContext`g, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"], DirectedEdge[5, 2] -> Placed[
           Framed[
            Style[$CellContext`d, 18, Italic, Bold, 
             RGBColor[0, 0, 1]], Background -> GrayLevel[1], FrameStyle -> 
            GrayLevel[1]], "Middle"]}, EdgeStyle -> {
         GrayLevel[0]}, 
       EdgeWeight -> {$CellContext`g, $CellContext`c, $CellContext`a, \
$CellContext`d, $CellContext`\[Epsilon], $CellContext`b}, GraphLayout -> 
       "LayeredEmbedding", 
       VertexCoordinates -> {{0, 0}, {1, 0}, {2, 0}, {3, 0}, {2, 1}}, 
       VertexLabels -> {
        3 -> Placed["M", Center], 5 -> Placed["W", Center], 4 -> 
         Placed["Y", Center], 2 -> Placed["X", Center], 1 -> 
         Placed["V", Center]}, VertexLabelStyle -> {
         Directive[
          RGBColor[1, 0, 0], Italic, 26]}, VertexSize -> {0.3}, VertexStyle -> {
         GrayLevel[0]}, VertexWeight -> {
         Subscript[$CellContext`\[Sigma], $CellContext`uV], 
         Subscript[$CellContext`\[Sigma], $CellContext`uX], 
         Subscript[$CellContext`\[Sigma], $CellContext`uM], 
         Subscript[$CellContext`\[Sigma], $CellContext`uY], 
         Subscript[$CellContext`\[Sigma], $CellContext`uW]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {GrayLevel[0], Opacity[0.7], Arrowheads[
        Medium], {ArrowBox[{{0., 0.}, {1., 0.}}, 0.15], InsetBox[
          FrameBox[
           StyleBox["g",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {0.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{1., 0.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["c",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 0.}, {3., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["a",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {2.5, 0.}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 1.}, {1., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["d",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {1.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 1.}, {2., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["\[Epsilon]",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {2., 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {ArrowBox[{{2., 1.}, {3., 0.}}, 0.15], 
         InsetBox[
          FrameBox[
           StyleBox["b",
            StripOnInput->False,
            LineColor->RGBColor[0, 0, 1],
            FrontFaceColor->RGBColor[0, 0, 1],
            BackFaceColor->RGBColor[0, 0, 1],
            GraphicsColor->RGBColor[0, 0, 1],
            FontSize->18,
            FontWeight->Bold,
            FontSlant->Italic,
            FontColor->RGBColor[0, 0, 1]],
           Background->GrayLevel[1],
           FrameStyle->GrayLevel[1],
           StripOnInput->False], {2.5, 0.5}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {GrayLevel[0], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 0.}, 0.15], InsetBox[
          StyleBox["\<\"V\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {0., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{1., 0.}, 0.15], InsetBox[
          StyleBox["\<\"X\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {1., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 0.}, 0.15], InsetBox[
          StyleBox["\<\"M\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{3., 0.}, 0.15], InsetBox[
          StyleBox["\<\"Y\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {3., 0.},
          BaseStyle->"Graphics"]}, {DiskBox[{2., 1.}, 0.15], InsetBox[
          StyleBox["\<\"W\"\>",
           StripOnInput->False,
           LineColor->RGBColor[1, 0, 0],
           FrontFaceColor->RGBColor[1, 0, 0],
           BackFaceColor->RGBColor[1, 0, 0],
           GraphicsColor->RGBColor[1, 0, 0],
           FontSize->26,
           FontSlant->Italic,
           FontColor->RGBColor[1, 0, 0]], {2., 1.},
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.864277662537609*^9, 3.8642776793116503`*^9}, 
   3.864277753708777*^9, 3.864277807119232*^9, 3.8648757484933157`*^9, 
   3.867905729195159*^9, 3.869114437699519*^9, 3.8692265928025227`*^9, 
   3.869292756995686*^9, 3.869305641301607*^9, 3.869309818975349*^9, 
   3.869526928645076*^9, 3.869563787592888*^9, 3.8696924128872337`*^9},
 CellLabel->
  "Out[426]=",ExpressionUUID->"b4322328-84ba-4169-bd3f-3ad7d39ffefc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eweightlookup", "=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"Most", "@", 
     RowBox[{"ArrayRules", "@", 
      RowBox[{"WeightedAdjacencyMatrix", "[", "causalgraphiv2", "]"}]}]}], 
    ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvarpairs", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"uvars", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"uprodrules", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#1", "*", "#1"}], "->", 
         SuperscriptBox["#2", "2"]}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"uvars", ",", "vweights"}], "}"}]}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "->", "0"}], "&"}], ",", 
       "uvarpairs"}], "]"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8594606713535023`*^9, 3.859460687989484*^9}, {
   3.859460757668127*^9, 3.8594607600893993`*^9}, {3.859461892329628*^9, 
   3.859461896820756*^9}, {3.859461939972322*^9, 3.859461952336578*^9}, {
   3.85959134581249*^9, 3.8595913458676977`*^9}, {3.8641883517602787`*^9, 
   3.8641883527498426`*^9}, {3.86418848789916*^9, 3.864188488326531*^9}, 
   3.8642777525040073`*^9, {3.869313211380677*^9, 3.8693132123290367`*^9}},
 NumberMarks->False,
 CellLabel->
  "In[427]:=",ExpressionUUID->"948e49fe-4948-4df0-8352-8a0429ebbbfd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "\[DirectedEdge]", "2"}], "\[Rule]", "g"}], ",", 
   RowBox[{
    RowBox[{"2", "\[DirectedEdge]", "3"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"3", "\[DirectedEdge]", "4"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{"5", "\[DirectedEdge]", "2"}], "\[Rule]", "d"}], ",", 
   RowBox[{
    RowBox[{"5", "\[DirectedEdge]", "3"}], "\[Rule]", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"5", "\[DirectedEdge]", "4"}], "\[Rule]", "b"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591313069002*^9, 
   3.859591359276739*^9, 3.859591394007164*^9, 3.859591584820829*^9, 
   3.859591708977866*^9, 3.8596077701534157`*^9, 3.8596100273978577`*^9, 
   3.8596313677717524`*^9, 3.859701207482258*^9, 3.859701238853579*^9, 
   3.859885020056724*^9, 3.859885166459116*^9, 3.8598853406844263`*^9, 
   3.8598855653471327`*^9, 3.8598855992688427`*^9, 3.859885664263939*^9, 
   3.859885861923909*^9, 3.859886104268804*^9, {3.8598862075637407`*^9, 
   3.859886253862501*^9}, 3.859886415113274*^9, 3.8598872659976*^9, 
   3.859887762115253*^9, 3.859887794346856*^9, 3.8598878283404713`*^9, 
   3.859967774535819*^9, 3.859980996397859*^9, 3.8600361396149063`*^9, 
   3.8601506278258142`*^9, 3.860222486832569*^9, 3.860222649621842*^9, 
   3.860223091179274*^9, 3.8612540734485893`*^9, 3.861750777600848*^9, 
   3.8638563128221292`*^9, 3.864116569569106*^9, {3.8641883542004433`*^9, 
   3.864188376867119*^9}, {3.864188475197609*^9, 3.8641884888765717`*^9}, 
   3.8642777556467857`*^9, 3.864277808856291*^9, 3.864875748501*^9, 
   3.867905729218108*^9, 3.8691144377071*^9, 3.8692265928227243`*^9, 
   3.869292757012314*^9, 3.869305641317418*^9, 3.869309818987529*^9, 
   3.8693132131736107`*^9, 3.8695269306398487`*^9, 3.8695637876180887`*^9, 
   3.869692412904904*^9},
 CellLabel->
  "Out[427]=",ExpressionUUID->"b7fe47cf-2a84-4703-9010-f023fc412bd9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["uV", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uX", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uM", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uY", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uY", "2"]}], ",", 
   RowBox[{
    SuperscriptBox["uW", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uV"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uX", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uV"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uX", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uY"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uV", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uX"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uM", " ", "uW"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"uW", " ", "uY"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8594619403071413`*^9, 3.8594619527645903`*^9}, 
   3.85946628607933*^9, 3.8595229983297*^9, 3.859542777504375*^9, 
   3.8595460299030857`*^9, 3.859557352588951*^9, 3.859557518997089*^9, 
   3.859557549821533*^9, 3.859558668048545*^9, 3.859591313069002*^9, 
   3.859591359276739*^9, 3.859591394007164*^9, 3.859591584820829*^9, 
   3.859591708977866*^9, 3.8596077701534157`*^9, 3.8596100273978577`*^9, 
   3.8596313677717524`*^9, 3.859701207482258*^9, 3.859701238853579*^9, 
   3.859885020056724*^9, 3.859885166459116*^9, 3.8598853406844263`*^9, 
   3.8598855653471327`*^9, 3.8598855992688427`*^9, 3.859885664263939*^9, 
   3.859885861923909*^9, 3.859886104268804*^9, {3.8598862075637407`*^9, 
   3.859886253862501*^9}, 3.859886415113274*^9, 3.8598872659976*^9, 
   3.859887762115253*^9, 3.859887794346856*^9, 3.8598878283404713`*^9, 
   3.859967774535819*^9, 3.859980996397859*^9, 3.8600361396149063`*^9, 
   3.8601506278258142`*^9, 3.860222486832569*^9, 3.860222649621842*^9, 
   3.860223091179274*^9, 3.8612540734485893`*^9, 3.861750777600848*^9, 
   3.8638563128221292`*^9, 3.864116569569106*^9, {3.8641883542004433`*^9, 
   3.864188376867119*^9}, {3.864188475197609*^9, 3.8641884888765717`*^9}, 
   3.8642777556467857`*^9, 3.864277808856291*^9, 3.864875748501*^9, 
   3.867905729218108*^9, 3.8691144377071*^9, 3.8692265928227243`*^9, 
   3.869292757012314*^9, 3.869305641317418*^9, 3.869309818987529*^9, 
   3.8693132131736107`*^9, 3.8695269306398487`*^9, 3.8695637876180887`*^9, 
   3.8696924129066057`*^9},
 CellLabel->
  "Out[429]=",ExpressionUUID->"f73593a6-05ed-4c45-9661-dc915bb382a8"]
}, Open  ]],

Cell[TextData[{
 "Now we can apply this! Say we want to evaluate the expectation value \
E[ux*um | X,M]. First, we need to calculate the joint covariance between all \
four variables.",
 StyleBox["\n",
  FontColor->GrayLevel[0]]
}], "Text",
 CellChangeTimes->{{3.858329655819387*^9, 3.858329671361067*^9}, {
   3.8583365091190863`*^9, 3.8583365243137302`*^9}, {3.8583366390667553`*^9, 
   3.8583366565523233`*^9}, {3.8583367237914457`*^9, 3.858336734530424*^9}, {
   3.858337277815318*^9, 3.858337300482787*^9}, {3.8583374346713037`*^9, 
   3.85833743609445*^9}, {3.858337494084875*^9, 3.85833753940872*^9}, {
   3.858337667358366*^9, 3.8583376722662897`*^9}, {3.858337703520871*^9, 
   3.858337740192953*^9}, {3.85833777440618*^9, 3.858337774406398*^9}, {
   3.8583378911031847`*^9, 3.85833789689917*^9}, {3.8583379994837112`*^9, 
   3.858337999684861*^9}, {3.858338318328642*^9, 3.858338330985588*^9}, {
   3.858338386385976*^9, 3.858338403783554*^9}, {3.858338535213355*^9, 
   3.858338577034197*^9}, {3.858338652546804*^9, 3.8583386617161016`*^9}, {
   3.858338759635105*^9, 3.858338795923196*^9}, {3.858338841585185*^9, 
   3.858338916581684*^9}, {3.858339075022015*^9, 3.8583390813359327`*^9}, {
   3.858346827071652*^9, 3.85834682807152*^9}, {3.8595435455848227`*^9, 
   3.859543581806551*^9}, 
   3.8595439831394987`*^9},ExpressionUUID->"50f9a449-f358-41c6-b31e-\
2eee3c54d43c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NodeCovariance", "[", 
    RowBox[{"graph_", ",", "node1_", ",", "node2_"}], "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"ReplaceRepeated", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", "node1", "]"}], "*", 
         RowBox[{"Symbol", "[", "node2", "]"}]}], ",", 
        RowBox[{"GraphNodeStructure", "[", "graph", "]"}]}], "]"}], "]"}], 
     ",", "uprodrules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "uV", "\[IndentingNewLine]", "uX", "\
\[IndentingNewLine]", "uW", "\[IndentingNewLine]", "uM", \
"\[IndentingNewLine]", "uW"}], "Input",
 CellChangeTimes->{{3.86931364662292*^9, 3.8693136610172653`*^9}},
 CellLabel->
  "In[430]:=",ExpressionUUID->"002af834-fba6-4ab2-93d5-9256d405a43f"],

Cell[BoxData["uV"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412921506*^9},
 CellLabel->
  "Out[431]=",ExpressionUUID->"b485a49b-677d-4e02-8270-22bd4d37397d"],

Cell[BoxData["uX"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412923218*^9},
 CellLabel->
  "Out[432]=",ExpressionUUID->"b22026d6-637e-49db-9db0-84de470d3635"],

Cell[BoxData["uW"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412924492*^9},
 CellLabel->
  "Out[433]=",ExpressionUUID->"03b21566-16e4-4bc6-8916-6dbb38032dec"],

Cell[BoxData["uM"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412925654*^9},
 CellLabel->
  "Out[434]=",ExpressionUUID->"a0be9b4a-b270-4353-8b79-73caa108b26e"],

Cell[BoxData["uW"], "Output",
 CellChangeTimes->{{3.8693136515618*^9, 3.869313661312304*^9}, 
   3.8695269339595003`*^9, 3.869563787643775*^9, 3.869692412926676*^9},
 CellLabel->
  "Out[435]=",ExpressionUUID->"e6a3ee2b-bf30-4332-b106-2abae690bb9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"allvariances", "=", 
  RowBox[{
  "GraphNodeVariance", "[", "causalgraphiv2", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NodeCovariance", "[", 
  RowBox[{"causalgraphiv2", ",", "\"\<uX\>\"", ",", "\"\<X\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sig", "=", 
   RowBox[{"NodesCovariance", "[", 
    RowBox[{"causalgraphiv2", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Sig", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", 
    RowBox[{"{", "\"\<uX\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CondVar", "[", 
   RowBox[{"causalgraphiv2", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ/eAMw5a6g28c/2kybwXR+8RT9OuB9JcuW3MQvUV4
lQuInnT+Cpj+n3kqE0RvO1tYAKLzFubXg+ia6r8tIJovlKUTRLvvWTQJbE49
53QQPcHBEExvktVfB6Kf+U7eCqKXdQm3NQLpMvX5HSDa4P1dg2lAmsn2tCGI
Ppcv1WZxCmjOxqJ2EL1irdb0KCCtlsQ4E0R3J/IntAFptrOnwHTG4nQ3hStv
HF/JfXAH0bILPgeC6LC+3SEgumR60z4QfclzKZg+1frnOohO2Cd0A0TL+Mxx
VATS/PXzobS3tRKQTpIJswXRAMi4ouo=
  "],
 CellLabel->
  "In[436]:=",ExpressionUUID->"24934acf-6f49-4d6f-97e1-4b9a20f7a673"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{
    RowBox[{"bW", "+", 
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"uM", "-", 
        FractionBox[
         RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ca", "+", 
        FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129435167`*^9},
 CellLabel->
  "Out[436]=",ExpressionUUID->"ff2f4c5e-b78f-48ca-acc0-a84ea82f9478"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "V", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "X", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
     RowBox[{"g", " ", 
      SubsuperscriptBox["\[Sigma]", "V", "2"]}], "+", 
     RowBox[{"d", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "M", "2"], "\[Rule]", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{"\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}], "+", 
     RowBox[{"c", " ", 
      SubsuperscriptBox["\[Sigma]", "X", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", 
     RowBox[{"bW", "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"uM", "-", 
         FractionBox[
          RowBox[{"e", " ", "uX"}], "d"]}], ")"}]}], "+", "uY", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ca", "+", 
         FractionBox["ea", "d"]}], ")"}], " ", "X"}]}], "2"], "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", 
      SubsuperscriptBox["\[Sigma]", "M", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uY", "2"], "+", 
     RowBox[{"b", " ", 
      SubsuperscriptBox["\[Sigma]", "W", "2"]}]}]}], ",", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "W", "2"], "\[Rule]", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.869692412945788*^9},
 CellLabel->
  "Out[437]=",ExpressionUUID->"eefdf8f1-7b66-459f-a787-b19923eb0fcd"],

Cell[BoxData[
 SubsuperscriptBox["\[Sigma]", "uX", "2"]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.869692412947901*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"379a366d-4bf3-4dd0-9a09-17f3684ace2e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], 
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]},
     {"0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "0", 
      SubsuperscriptBox["\[Sigma]", "uM", "2"]},
     {
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]},
     {
      RowBox[{"c", " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
      SubsuperscriptBox["\[Sigma]", "uM", "2"], 
      RowBox[{
       RowBox[{"c", " ", 
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"c", " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"c", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox["g", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SuperscriptBox["d", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"2", " ", "c", " ", "d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.86969241294951*^9},
 CellLabel->
  "Out[440]//MatrixForm=",ExpressionUUID->"cc8138f9-a4e8-4610-a5db-\
6c043ae70971"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", "M"}], "+", 
              RowBox[{"c", " ", "d", " ", "X"}], "+", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.8696924129515133`*^9},
 CellLabel->
  "Out[441]//MatrixForm=",ExpressionUUID->"130b8ecb-a24f-449c-9bbe-\
b3cccb31ece9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
           RowBox[{"\[Epsilon]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d"}], " ", "M"}], "+", 
              RowBox[{"c", " ", "d", " ", "X"}], "+", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]},
      {
       FractionBox[
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"M", "-", 
              RowBox[{"c", " ", "X"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", "M"}], "-", 
              RowBox[{"c", " ", "d", " ", "X"}], "-", 
              RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M", "-", 
              RowBox[{"c", " ", "X"}]}], ")"}], " ", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.86969241296733*^9},
 CellLabel->
  "Out[442]//MatrixForm=",ExpressionUUID->"27ef2492-bec2-4eb6-a112-\
ef7eae7d2365"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SuperscriptBox["\[Epsilon]", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          RowBox[{
           SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["d", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}]}], ")"}], 
        " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]},
     {
      FractionBox[
       RowBox[{"d", " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Epsilon]", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["d", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8595434255834208`*^9, {3.85954345915383*^9, 3.859543464858212*^9}, 
   3.859544445975209*^9, {3.859544939831971*^9, 3.859544967324952*^9}, {
   3.8595450734086123`*^9, 3.859545124392468*^9}, {3.8595451839142437`*^9, 
   3.859545237403852*^9}, {3.859545464404763*^9, 3.859545482741844*^9}, 
   3.859545516957611*^9, 3.859546029929311*^9, {3.859549234373043*^9, 
   3.859549253307372*^9}, 3.859557353120474*^9, 3.859557457891028*^9, 
   3.859557519374383*^9, 3.859557550114813*^9, 3.8595586688457947`*^9, 
   3.859591312590061*^9, 3.85959135890029*^9, {3.859591569845628*^9, 
   3.859591584843876*^9}, 3.859591708992797*^9, 3.8596077701660023`*^9, 
   3.859610027410537*^9, 3.8596313677863197`*^9, 3.8597012075087767`*^9, 
   3.8597012388838987`*^9, 3.859885020072041*^9, 3.859885166471766*^9, 
   3.85988534069715*^9, 3.859885565358225*^9, 3.859885599281329*^9, 
   3.859885664274858*^9, 3.859885861934856*^9, 3.859886104280427*^9, {
   3.859886207576006*^9, 3.8598862538743343`*^9}, 3.859886415127425*^9, 
   3.859887266012411*^9, 3.859887762130262*^9, 3.859887794360503*^9, 
   3.859887828354438*^9, 3.859967774546206*^9, 3.859980996408428*^9, 
   3.860036139630662*^9, 3.8601506278509207`*^9, 3.860222486842321*^9, 
   3.86022264963347*^9, 3.8602230911906977`*^9, 3.861254077256701*^9, 
   3.861750777613357*^9, 3.863856312831293*^9, 3.8641165715267982`*^9, {
   3.864118323469472*^9, 3.8641183321004133`*^9}, 3.864188005958921*^9, {
   3.86418809041155*^9, 3.864188104373432*^9}, {3.8641881527745657`*^9, 
   3.864188159557146*^9}, {3.864188495134755*^9, 3.8641884989626226`*^9}, {
   3.864277761844224*^9, 3.864277766741808*^9}, 3.8642778101359043`*^9, 
   3.8648757485133142`*^9, 3.867905729272764*^9, 3.869114437720849*^9, 
   3.8692265928434772`*^9, 3.869292757028372*^9, 3.8693056413323393`*^9, 
   3.8693098190031357`*^9, {3.869311649782763*^9, 3.869311654287261*^9}, 
   3.8693127049069357`*^9, {3.869313541683538*^9, 3.869313549542633*^9}, {
   3.869315557831229*^9, 3.869315569880415*^9}, 3.86952693602328*^9, 
   3.8695637876790648`*^9, 3.869692412982704*^9},
 CellLabel->
  "Out[443]//MatrixForm=",ExpressionUUID->"6b7037bb-a59e-4711-bb8a-\
240fb533852a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CharacteristicPolynomial", "[", 
   RowBox[{"Sig", ",", "x"}], "]"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.8596098299897203`*^9, 3.859609945111977*^9}, 
   3.859609976972699*^9},
 CellLabel->
  "In[444]:=",ExpressionUUID->"7d6939c4-726e-4dac-99bf-3491ca862fd5"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "4"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{"2", " ", "c", " ", "d", " ", 
   SuperscriptBox["x", "3"], " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"2", " ", "c", " ", "d", " ", 
   SuperscriptBox["x", "2"], " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["x", "3"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox["x", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{"2", " ", "c", " ", "d", " ", 
   SuperscriptBox["x", "2"], " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["c", "2"], " ", 
   SuperscriptBox["d", "2"], " ", "x", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", "c", " ", "d", " ", "x", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{"2", " ", "x", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", "x", " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["g", "2"], " ", 
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}]], "Output",
 CellChangeTimes->{{3.859609843520874*^9, 3.859609855048254*^9}, {
   3.859609889687147*^9, 3.859609945404512*^9}, 3.859609977439784*^9, 
   3.8596100274509497`*^9, 3.859631367844215*^9, 3.859701207599634*^9, 
   3.859701238974517*^9, 3.8598850201147823`*^9, 3.85988516651187*^9, 
   3.8598853407384567`*^9, 3.859885565395042*^9, 3.859885599320858*^9, 
   3.859885664314855*^9, 3.859885861974718*^9, 3.859886104319315*^9, {
   3.859886207614677*^9, 3.859886253915251*^9}, 3.8598864151713333`*^9, 
   3.8598872660601788`*^9, 3.859887762173218*^9, 3.85988779440408*^9, 
   3.859887828399729*^9, 3.8599677745842867`*^9, 3.859980996445022*^9, 
   3.860036139685253*^9, 3.860150627874468*^9, 3.8602224868734283`*^9, 
   3.860222649663681*^9, 3.8602230912187862`*^9, 3.861750777649396*^9, 
   3.8638563128639708`*^9, 3.864116573465136*^9, 3.8641885027770033`*^9, 
   3.86427781868827*^9, 3.8648757487495193`*^9, 3.8679057298916388`*^9, 
   3.869114437960512*^9, 3.8692265932245617`*^9, 3.8692927572551413`*^9, 
   3.869305641564396*^9, 3.8693098192399893`*^9, 3.869563787775721*^9, 
   3.8696924130083733`*^9},
 CellLabel->
  "Out[444]=",ExpressionUUID->"7d1c79e4-4a42-4642-b4e2-af1c44ec3101"]
}, Open  ]],

Cell[TextData[{
 "We will now seek to construct an estimator with improved bias or variance \
over the standard IV estimators on causal effects a and ca.\n\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "w"], "i"]}], TraditionalForm]],ExpressionUUID->
  "a1000766-f83d-498a-a567-c8cca6b4367e"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "i"], " ", "=", " ", 
    SubscriptBox[
     SuperscriptBox["u", "v"], "i"]}], TraditionalForm]],ExpressionUUID->
  "c931280b-c943-4bbb-aad1-9c17d6f88046"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "i"], " ", "=", 
    RowBox[{
     SubscriptBox["gv", "i"], "+", 
     SubscriptBox["dw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "x"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "372ade72-409e-45ab-bfec-83c5667cee74"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["cx", "i"], "+", 
     SubscriptBox["\[Epsilon]w", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "m"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "a669e7f4-274e-4ae2-a71c-1e17209f4fd6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["y", "i"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["am", "i"], "+", 
     SubscriptBox["bw", "i"], "+", 
     SubscriptBox[
      SuperscriptBox["u", "y"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "78092a6a-5559-4d5a-a80d-4e50cd387cbb"],
 ".\n\nResXV = X - gV = dW + uX\nResMX = M - cX = eW + uM\n\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "samples"], TraditionalForm]],ExpressionUUID->
  "7a032de5-d0b9-4bb5-a556-82c5c6a2f7f8"],
 "[",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Epsilon]", "d"], TraditionalForm]],ExpressionUUID->
  "e5949212-b375-4bc0-8167-a5b86776497f"],
 "]\n\nSample i = {(W),V,X,M,Y}\n\n\nE[X - gV = dW + uX]\nE[X] - g E[V] = d \
E[W] = 0\n\nUnbiased\ng\nc\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["dW", "i"], "+", 
    SubscriptBox["uX", "i"]}], TraditionalForm]],ExpressionUUID->
  "2c6a2b51-e285-496c-a4e5-a3f514082637"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["eW", "i"], "+", 
    SubscriptBox["uM", "i"]}], TraditionalForm]],ExpressionUUID->
  "3da9a784-e862-4cdf-afff-7fe3e01a7482"],
 "\n\nc+e/d (small bias)\n\n\nc\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["eW", "i"], "+", 
    SubscriptBox["uM", "i"]}], TraditionalForm]],ExpressionUUID->
  "acd69ac5-8ff3-41e1-b8c5-581b5aaa21ec"],
 "\nW->X uniquely:   uW = (X-ux)/d\n\nX = dW + uX\nM = eW + cX + uM\n\ne \
.dinv(dw) - e.dinv(dw + ux)\ne(W) - e.dinv(dw + uX)\nbias ~= E[dW.uX] + \
Ew[dW^2]\n\n\n\n\nKey residual: Res\[CloseCurlyQuote] = uM - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["e", "d"], "uX"}], TraditionalForm]],ExpressionUUID->
  "40bf4121-68b9-4c74-b9a5-b06176eb4e26"],
 " -  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "*", 
    RowBox[{"Cov", "(", 
     RowBox[{"X", ",", 
      RowBox[{"uM", "-", 
       RowBox[{
        RowBox[{"e", "/", "d"}], " ", "uX"}]}]}], ")"}], "*", 
    RowBox[{"X", "/", 
     SubscriptBox["\[Sigma]", "X"]}]}], TraditionalForm]],ExpressionUUID->
  "5d653987-3f96-489c-9054-b04c14a64f55"],
 ",    \[Alpha] \[Element] [0,1]\nsuch that Cov(X,Res\[CloseCurlyQuote]) = 0\n\
but ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Cov", "(", 
    RowBox[{"W", ",", 
     RowBox[{
      RowBox[{"Cov", "(", 
       RowBox[{"X", ",", 
        RowBox[{"uM", "-", 
         RowBox[{
          RowBox[{"e", "/", "d"}], " ", "uX"}]}]}], ")"}], "*", 
      RowBox[{"X", "/", 
       SubscriptBox["\[Sigma]", "X"]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0bcda0e2-e19a-4706-9652-0b1d9ed38d49"],
 ") != 0\n\n\nV(Res) = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uM"], "2"], "+", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[Epsilon]", "2"], 
      SuperscriptBox["d", "2"]], 
     SuperscriptBox[
      SubscriptBox["\[Sigma]", "uX"], "2"]}]}], TraditionalForm]],
  ExpressionUUID->"5e9f2f41-a314-4100-9f73-2d17ed0ba595"],
 " =~ 2\nCov(X,Res) =  -",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["\[Epsilon]", "d"], 
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uX"], "2"]}], TraditionalForm]],ExpressionUUID->
  "36304115-e555-4d2c-8b39-0fb6a85b6545"],
 " =~ -1\n-- Need to check next order of these i.e. with V->X->M pathway\n\n* \
Key result: Take res1 = ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "-", 
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"M", ".", "X"}], 
       RowBox[{"X", ".", "X"}]], ")"}], "X"}]}], TraditionalForm]],
  ExpressionUUID->"5a773d2f-564c-4406-ace3-6c599a440e53"],
 " as a vector-valued estimator\nThen, Cov(X,res1) = E[M.X - M.X] = 0\nbut \
Cov(W,res1) = E[W.M - ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"M", ".", "X"}], " ", 
     RowBox[{"W", ".", "X"}]}], 
    RowBox[{"X", ".", "X"}]], TraditionalForm]],ExpressionUUID->
  "4d1c1a20-518b-4bd9-a4bc-8a0c348c7cd6"],
 "] = eE[W.W] - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"eE", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"W", ".", "X"}], " ", 
      RowBox[{"W", ".", "X"}]}], 
     RowBox[{"X", ".", "X"}]], "]"}], TraditionalForm]],ExpressionUUID->
  "7d850c78-ff2b-4381-87b0-9f4193711ff0"],
 " - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    FractionBox[
     RowBox[{
      RowBox[{"uM", ".", "X"}], " ", 
      RowBox[{"W", ".", "X"}]}], 
     RowBox[{"X", ".", "X"}]], "]"}], TraditionalForm]],ExpressionUUID->
  "cbc9dd0f-326a-4803-ad7c-0ec439fa3995"],
 " != 0\n\nThis is counter to our intuition about uM - e/d uX, since:\nCov(uM \
- e/d uX, X) != 0\nCov(uM - e/d uX, W)  = 0\n\nWhat about res2?\n\nWe have \
(biased) knowledge of ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    FractionBox["\[Epsilon]", "d"], "^"], TraditionalForm]],ExpressionUUID->
  "73dfc889-0f71-40af-931b-cd75f581a4d5"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uM"], "2"], "="}], TraditionalForm]],
  ExpressionUUID->"03a2246b-e98a-4029-af4e-c62afe9924c2"],
 " V(Res) + ",
 Cell[BoxData[
  FormBox[
   OverscriptBox[
    FractionBox["\[Epsilon]", "d"], "^"], TraditionalForm]],ExpressionUUID->
  "8234533c-8dcb-4aba-8430-3085e086f2b0"],
 "Cov(X,Res)\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[Sigma]", "uX"], "2"], "="}], TraditionalForm]],
  ExpressionUUID->"8161cb58-f4ea-47ea-88b8-7f8c0f25ed4d"],
 " - Cov(X,Res)/",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    OverscriptBox[
     FractionBox["\[Epsilon]", "d"], "^"]}], TraditionalForm]],ExpressionUUID->
  "98da7e3b-7d38-4cb0-90df-85e535d9513b"],
 ")\n--Can we re-insert samples from learned uM, uX variances to decrease \
bias?\n\n\n\n\n\n\n\n\nUsing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     FractionBox["A", "B"], "]"}], " ", "=", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"E", "[", "A", "]"}], 
      RowBox[{"E", "[", "B", "]"}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"cov", "[", 
         RowBox[{"A", ",", "B"}], "]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"E", "[", "A", "]"}], 
          RowBox[{"E", "[", "B"}]}], "}"}]], "+", 
       FractionBox[
        RowBox[{"V", "[", "B", "]"}], 
        SuperscriptBox[
         RowBox[{"E", "[", "B", "]"}], "2"]]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"176d5949-9759-4c8f-8bc6-b97a46913c6a"],
 ",\nwe have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"E", "[", 
    FractionBox["A", "B"], "]"}], TraditionalForm]],ExpressionUUID->
  "861ab2d7-faf2-4e29-ba4b-b6c296c27f3e"],
 " - ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"E", "[", "A", "]"}], 
    RowBox[{"E", "[", "B", "]"}]], TraditionalForm]],ExpressionUUID->
  "45f52f54-4520-4d82-a3e4-9c998b813125"],
 " = ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"V", "[", "B", "]"}], 
     RowBox[{"E", "[", "A", "]"}]}], 
    SuperscriptBox[
     RowBox[{"E", "[", "B", "]"}], "3"]], TraditionalForm]],ExpressionUUID->
  "9438f9db-96f6-43cf-b619-7f59b3dd629a"],
 "-",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"cov", "[", 
     RowBox[{"A", ",", "B"}], "]"}], 
    SuperscriptBox[
     RowBox[{
      RowBox[{"E", "[", "B"}], "}"}], "2"]], TraditionalForm]],ExpressionUUID->
  "7aba1e3c-3713-46f8-907d-da0e296a0980"],
 "\n\nEmpirically, we see ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"E", "[", 
     FractionBox[
      RowBox[{"|", "E", "|"}], 
      RowBox[{"|", "D", "|"}]], "]"}], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"E", "[", 
       RowBox[{"|", "E", "|"}], "]"}], 
      RowBox[{"E", "[", 
       RowBox[{"|", "D", "|"}], "]"}]], "=", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"[", 
       RowBox[{
        FractionBox["1", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["e", "d"], ")"}], "2"]}], "]"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"c5b1997a-53cf-4183-8bf3-d477b87edd58"],
 " \nindependent of a, b, c, absolute magnitude of e and d, noises,\nbut NOT \
g\n\n\n",
 Cell[BoxData[
  RowBox[{"ResMV", "-", 
   RowBox[{
    OverscriptBox["edivd", "^"], "*", "ResXV"}]}]], "Input",ExpressionUUID->
  "1245a4b4-2040-4342-a239-951a21604c65"],
 " = um - e/d ux\n\n\n1) Check regressing Y on residual (um- e/d ux) AND x\n\
2) Check E[e/d] vs E[e]/E[d] vs E[mag(e)/mag(d)] vs. E[c+e/d] - E[c]\n3) Try \
all e/d estimators with improved (um- e/d ux) instrument for a.\n\n\n4) \
Monotonic decrease in e/d, consider even setting e/d constant=K throughout a \
run and just estimating initial confounding d and K\n5) Are there two types \
of confounders, monotonic and catastrophic?\n6)\n\n\n\n\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864277835972797*^9, 3.864277881807207*^9}, {3.864464734998878*^9, 
   3.864464820262539*^9}, {3.864464865641577*^9, 3.864464873689899*^9}, {
   3.864464970102149*^9, 3.8644650099094343`*^9}, {3.8644650550152283`*^9, 
   3.864465070165859*^9}, {3.864465103488549*^9, 3.864465106253504*^9}, {
   3.864465201658597*^9, 3.8644652411515417`*^9}, {3.864465347346011*^9, 
   3.864465403195983*^9}, {3.864465542896598*^9, 3.864465545026658*^9}, {
   3.864465898458987*^9, 3.864465928073763*^9}, {3.8644664218458548`*^9, 
   3.8644665029317427`*^9}, {3.864886045339703*^9, 3.86488609504772*^9}, {
   3.864886191854381*^9, 3.864886201924528*^9}, {3.8648866239201527`*^9, 
   3.8648866414987383`*^9}, 3.864895712032373*^9, 3.8648991224313087`*^9, {
   3.864899283837049*^9, 3.8648993819351883`*^9}, {3.864901559907631*^9, 
   3.8649016766743813`*^9}, {3.864901754354113*^9, 3.864901755070035*^9}, {
   3.864901907838039*^9, 3.8649019102699833`*^9}, {3.865577511518066*^9, 
   3.8655775950703173`*^9}, {3.8655776377588377`*^9, 3.865577654366778*^9}, {
   3.865577859323119*^9, 3.8655778957855873`*^9}, {3.865577943319222*^9, 
   3.865578068542758*^9}, {3.865578161065772*^9, 3.865578216456259*^9}, {
   3.865578254452281*^9, 3.865578256724207*^9}, {3.865578303234501*^9, 
   3.8655784155633497`*^9}, {3.865578486645647*^9, 3.865578500950493*^9}, {
   3.865578547536077*^9, 3.865578548647827*^9}, {3.865578596233593*^9, 
   3.865578615014429*^9}, {3.865578666401824*^9, 3.86557867029084*^9}, {
   3.8655787349473753`*^9, 3.865578750423996*^9}, {3.8655788394192753`*^9, 
   3.8655788878339043`*^9}, {3.8655789542347813`*^9, 
   3.8655789608559437`*^9}, {3.8655790065021057`*^9, 3.865579039158032*^9}, {
   3.865579074896187*^9, 3.865579170049872*^9}, {3.865579263101845*^9, 
   3.865579276514566*^9}, {3.865579330425247*^9, 3.865579399254757*^9}, {
   3.8655794538805532`*^9, 3.86557948465628*^9}, {3.866270997524091*^9, 
   3.866271007895977*^9}, {3.8662713029406757`*^9, 3.866271318730076*^9}, 
   3.8662768807774963`*^9, {3.866277540801097*^9, 3.866277699626751*^9}, {
   3.866278531612834*^9, 3.866278534140801*^9}, {3.866278646828219*^9, 
   3.86627867214741*^9}, {3.866280801638206*^9, 3.86628080177341*^9}, {
   3.871460847996417*^9, 3.871460863094181*^9}, {3.8714609516299677`*^9, 
   3.8714610562786007`*^9}, 
   3.871461388367394*^9},ExpressionUUID->"c5688ec5-dbba-4596-8008-\
4aa90e75e41d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["csimp", "^"], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"M", ".", "X", " "}], 
    RowBox[{"X", ".", "X"}]], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"M", "\[Rule]", 
      RowBox[{
       RowBox[{"c", "*", "X"}], "+", 
       RowBox[{"\[Epsilon]", "*", "W"}], "+", "uM"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["csimp", "^"], "-", "c"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uV\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", "=", 
  RowBox[{"cerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{"cerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"cerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
             "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
     "&"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}, {
   3.869692269945052*^9, 3.869692367207098*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"839adafb-18ce-4d85-a196-4c412fb527d8"],

Cell[BoxData[
 FractionBox[
  RowBox[{"M", ".", "X"}], 
  RowBox[{"X", ".", "X"}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130302134`*^9},
 CellLabel->
  "Out[445]=",ExpressionUUID->"d5984c85-36de-4818-ad85-9d024d061384"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", "X"}], "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}], " ", 
        "\[Epsilon]"}], "d"]}], ")"}], ".", "X"}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130314827`*^9},
 CellLabel->
  "Out[447]=",ExpressionUUID->"96dbbf01-ded1-4128-b96c-db0598b66b27"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uV"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.869692413032651*^9},
 CellLabel->
  "Out[449]=",ExpressionUUID->"7893bc6d-5884-4c7a-a5d3-cb7e436fb004"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"X", " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{"g", " ", "X", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.86969241303379*^9},
 CellLabel->
  "Out[450]=",ExpressionUUID->"1e57ba35-b87a-43b3-a7da-8733796fbf5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", "0"}], ",", 
   RowBox[{"uV", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", "X", " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.869692413035088*^9},
 CellLabel->
  "Out[451]=",ExpressionUUID->"994b4b52-3d93-4908-8a73-86f3743469a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "c"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "X"}], "-", 
      FractionBox[
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "X"}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["g", "2"], " ", "X", " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]], "+", 
          FractionBox[
           RowBox[{"X", " ", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]}], ")"}]}], "d"]}], 
     ")"}], ".", "X"}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.86969241303658*^9},
 CellLabel->
  "Out[452]=",ExpressionUUID->"cafdb181-5f8d-4c92-b40f-65ab80b7bff4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
   SubsuperscriptBox["\[Sigma]", "uX", "2"]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692327548943*^9, 3.869692367579082*^9, 
   3.8696924130476913`*^9},
 CellLabel->
  "Out[453]=",ExpressionUUID->"7aafc298-5acc-4796-8ea6-1d2e1af0953a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["c", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", 
     RowBox[{"{", "X", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResMXSimp", "=", 
    RowBox[{
     RowBox[{"M", "-", 
      RowBox[{
       OverscriptBox["c", "^"], "X"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["g", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{
     RowBox[{"{", "X", "}"}], ",", 
     RowBox[{"{", "V", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResXV", "=", 
    RowBox[{
     RowBox[{"X", "-", 
      RowBox[{
       OverscriptBox["g", "^"], "V"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    OverscriptBox["gc", "^"], "}"}], "=", 
   RowBox[{"Estimator", "[", 
    RowBox[{
     RowBox[{"{", "M", "}"}], ",", 
     RowBox[{"{", "V", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResMV", "=", 
    RowBox[{
     RowBox[{"M", "-", 
      RowBox[{
       OverscriptBox["gc", "^"], "V"}]}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["cIV", "^"], "=", 
   RowBox[{
    OverscriptBox["gc", "^"], "/", 
    OverscriptBox["g", "^"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResMX", "=", 
   RowBox[{
    RowBox[{"M", "-", 
     RowBox[{
      OverscriptBox["cIV", "^"], "X"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8582530097062817`*^9, 3.858253036746434*^9}, {
   3.858253085853051*^9, 3.858253090542363*^9}, {3.858253149683667*^9, 
   3.8582531551864967`*^9}, {3.858254082532806*^9, 3.858254089114677*^9}, 
   3.858254666912057*^9, {3.8583207464114857`*^9, 3.858320777596154*^9}, {
   3.858320901578082*^9, 3.858320904430571*^9}, {3.858320948962329*^9, 
   3.858320998243658*^9}, {3.858321056381373*^9, 3.858321113084228*^9}, {
   3.8583211766156816`*^9, 3.858321275206876*^9}, {3.8583213405440063`*^9, 
   3.858321396245824*^9}, {3.858321565443347*^9, 3.858321591463482*^9}, {
   3.858321669346789*^9, 3.858321687544816*^9}, {3.858321728391357*^9, 
   3.858321750807044*^9}, {3.858321864809815*^9, 3.858321995528502*^9}, {
   3.858322104359277*^9, 3.858322130914505*^9}, {3.8583224673384047`*^9, 
   3.8583224903797483`*^9}, {3.858324779349805*^9, 3.8583247888458023`*^9}, {
   3.8583253078292217`*^9, 3.858325314837751*^9}, {3.858325396607929*^9, 
   3.85832542701947*^9}, {3.860036107824605*^9, 3.860036115763649*^9}, {
   3.864189020257053*^9, 3.864189103478299*^9}, {3.864277906570218*^9, 
   3.86427793070198*^9}, {3.864278019218787*^9, 3.864278039113723*^9}, {
   3.864278075835719*^9, 3.864278120976528*^9}, {3.864278178587859*^9, 
   3.864278361447269*^9}, {3.869303872125587*^9, 3.869303893638217*^9}},
 CellLabel->
  "In[454]:=",ExpressionUUID->"c6d9b1af-359d-4b26-85db-7f740ca24ca3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "asimp"}], "^"], "=", 
  RowBox[{
   FractionBox[
    RowBox[{"ResMXSimp", ".", "Y"}], 
    RowBox[{"ResMXSimp", ".", "M"}]], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "asimp"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ResMXSimp", ".", "Y"}], 
      RowBox[{"ResMXSimp", ".", "M"}]], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "V"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["arem", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["arem", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
  3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
  3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
  3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
  3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
  3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
  3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
  3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
  3.8692280275853577`*^9}, {3.8692280599089527`*^9, 3.8692281375468616`*^9}, {
  3.869297316532125*^9, 3.8692973167578382`*^9}, {3.869297702528627*^9, 
  3.8692977482320223`*^9}, {3.869303913353629*^9, 3.869303929895047*^9}, {
  3.869305596097282*^9, 3.869305597011416*^9}},
 CellLabel->
  "In[462]:=",ExpressionUUID->"22e54495-9e73-4bbf-8c20-e5f809d133ae"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413068081*^9},
 CellLabel->
  "Out[463]=",ExpressionUUID->"4e8dc0f6-b642-45cb-acc3-6a7c06df4ac0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     FractionBox[
      RowBox[{"X", " ", 
       RowBox[{"X", ".", "M"}]}], 
      RowBox[{"X", ".", "X"}]]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     FractionBox[
      RowBox[{"X", " ", 
       RowBox[{"X", ".", "M"}]}], 
      RowBox[{"X", ".", "X"}]]}], ")"}], ".", "M"}]]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413070073*^9},
 CellLabel->
  "Out[464]=",ExpressionUUID->"7adc6e8d-e7e2-4c97-b9f7-69c91d58a83d"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", ".", "M"}], ")"}], "2"], "-", 
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", "d", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "M"}], ")"}], "2"]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "d", " ", 
        RowBox[{"M", ".", "M"}]}], "-", 
       RowBox[{"b", " ", 
        RowBox[{"M", ".", "uX"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "uY"}]}], "-", 
       RowBox[{"b", " ", "g", " ", 
        RowBox[{"M", ".", "V"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"M", ".", "X"}]}]}], ")"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "b"}], " ", 
        RowBox[{"X", ".", "uX"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"X", ".", "uY"}]}], "-", 
       RowBox[{"b", " ", "g", " ", 
        RowBox[{"X", ".", "V"}]}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"X", ".", "X"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413144998*^9},
 CellLabel->
  "Out[465]=",ExpressionUUID->"39b433bf-8e17-481b-851b-db431cd143a2"],

Cell[BoxData[
 OverscriptBox["arem", "^"]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413148055*^9},
 CellLabel->
  "Out[466]=",ExpressionUUID->"a716f110-fa77-407f-95d0-ddae42a2ab4c"],

Cell[BoxData[
 OverscriptBox["arem", "^"]], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.8696924131505203`*^9},
 CellLabel->
  "Out[467]=",ExpressionUUID->"db492504-52b1-47d1-b399-58e47d5a3324"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.869303919175346*^9, 3.8693039306614103`*^9}, 
   3.8693055973081827`*^9, 3.869305641587875*^9, 3.869309819260968*^9, 
   3.8695552436488256`*^9, 3.869563787808305*^9, 3.869692413152174*^9},
 CellLabel->
  "Out[468]=",ExpressionUUID->"0c1c5306-7ec2-48f1-ba14-fe51aa3dccd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["asimp", "^"], "=", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["asimp", "^"], "-", "a"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}},
 CellLabel->
  "In[469]:=",ExpressionUUID->"50b029ae-c04d-4b02-86db-cf381adbc4fa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"M", ".", "Y"}], " ", 
    RowBox[{"X", ".", "X"}]}], "-", 
   RowBox[{
    RowBox[{"M", ".", "X"}], " ", 
    RowBox[{"X", ".", "Y"}]}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"M", ".", "X"}]}], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"X", ".", "X"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692413166896*^9},
 CellLabel->
  "Out[469]=",ExpressionUUID->"ed373b43-d95f-40c9-8113-f3d06c6932e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}], " ", 
     RowBox[{"X", ".", "X"}]}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"M", ".", "X"}]}], " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, 
   3.86956378797094*^9, 3.869692413184022*^9},
 CellLabel->
  "Out[471]=",ExpressionUUID->"04241a16-b350-419d-8394-3ae4576aa26b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<uW\>\"", 
     ",", "\"\<uV\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{"aerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aerror", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
             "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
     "&"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
   3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
   3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
   3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
   3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
   3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
   3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
   3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
   3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
   3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
   3.860036875204605*^9}, {3.869308336422339*^9, 3.8693083368832283`*^9}, {
   3.869308501704814*^9, 3.86930850182689*^9}, {3.869309609850891*^9, 
   3.8693096134984827`*^9}, {3.869309694496868*^9, 3.869309724573353*^9}, 
   3.869309761048152*^9, {3.8695270175510883`*^9, 3.8695270206970453`*^9}, {
   3.869527842727806*^9, 3.86952784548337*^9}},
 CellLabel->
  "In[472]:=",ExpressionUUID->"72e35cdf-0d18-4872-837d-f989b07ffd0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "uW", ",", "uV"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241319772*^9},
 CellLabel->
  "Out[473]=",ExpressionUUID->"b4c1ff44-5756-48ea-b254-bcd6b5e250cf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "M"}], "-", 
          RowBox[{"c", " ", "d", " ", "X"}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"g", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.86969241320807*^9},
 CellLabel->
  "Out[474]=",ExpressionUUID->"08aa57ef-ddbe-4ea1-93cd-2a0ba1872dc2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "M"}], "-", 
           RowBox[{"c", " ", "d", " ", "X"}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"uW", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uV", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.8696924132110567`*^9},
 CellLabel->
  "Out[475]=",ExpressionUUID->"00cead88-ec51-4d58-b61d-a9b5f800d2ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "X"}]}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"X", ".", "X"}]}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.869692413213904*^9},
 CellLabel->
  "Out[476]=",ExpressionUUID->"0c5828fb-fafd-4b82-b41c-9afff002312c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, 
   3.8695637880467043`*^9, 3.869692414590529*^9},
 CellLabel->
  "Out[477]=",ExpressionUUID->"b85a0637-cd90-4073-ba6e-38d38f82c362"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"g", "->", "0"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uV", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uY", "2"], "->", "1"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.869527096240508*^9, 3.8695271418516693`*^9}, {
  3.869530158582767*^9, 3.869530158649358*^9}, {3.869553221124552*^9, 
  3.869553221316163*^9}},
 CellLabel->
  "In[478]:=",ExpressionUUID->"b88b3145-8dc9-4eae-80d8-c862029bb8cf"],

Cell[BoxData[
 FractionBox["\[Epsilon]", 
  RowBox[{"1", "+", 
   SuperscriptBox["d", "2"], "+", 
   SuperscriptBox["\[Epsilon]", "2"]}]]], "Output",
 CellChangeTimes->{3.8695271426198187`*^9, 3.869530159021469*^9, 
  3.869563790385996*^9, 3.869692414620493*^9},
 CellLabel->
  "Out[478]=",ExpressionUUID->"4d02ebdf-cd1a-43a2-8d9a-08044fb34c77"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["anum", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"M", ".", "Y"}], " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{
     RowBox[{"M", ".", "X"}], " ", 
     RowBox[{"X", ".", "Y"}]}]}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "uW"}], "+", "uY"}]}], ",", 
     RowBox[{"M", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}], "+", "uM"}], ")"}]}], ",", 
     RowBox[{"X", "->", 
      RowBox[{
       RowBox[{"g", "*", "uV"}], " ", "+", " ", 
       RowBox[{"d", "*", "uW"}], " ", "+", " ", "uX"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"anumerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["anum", "^"], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"anumerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"anumerror", ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"anumerror", "=", 
  RowBox[{
   RowBox[{"anumerror", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.8695532247923527`*^9, 3.8695532492968273`*^9}, {
   3.8695532912142572`*^9, 3.869553349612878*^9}, {3.8695533844437923`*^9, 
   3.8695534235433826`*^9}, 3.8695534635005836`*^9, {3.8695535171188583`*^9, 
   3.869553518092111*^9}, {3.8695537522899218`*^9, 3.869553759252079*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"6868e226-8077-4e98-8586-0739ef5d37c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", ".", "Y"}], " ", 
   RowBox[{"X", ".", "X"}]}], "-", 
  RowBox[{
   RowBox[{"M", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.86969241463556*^9},
 CellLabel->
  "Out[479]=",ExpressionUUID->"67c87030-e3b8-4534-9957-91f63fd3fd8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "uV"}], "+", 
       RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", "uW"}], "+", "uY", "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"uM", "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
          RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"b", " ", "uW"}], "+", "uY", "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.8696924146384907`*^9},
 CellLabel->
  "Out[481]=",ExpressionUUID->"d7f91da2-295a-4ec6-9125-6a088e4fe5d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
   RowBox[{"uW", ".", "uW"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"uM", ".", "uM"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"uW", ".", "uW"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.8696924146769342`*^9},
 CellLabel->
  "Out[482]=",ExpressionUUID->"06036ca0-7fdf-4df0-9ba8-04a9ea74e246"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
  RowBox[{"a", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, 3.869553518833922*^9, {
   3.869553754766219*^9, 3.869553759712776*^9}, 3.8695637904182053`*^9, 
   3.869692414689127*^9},
 CellLabel->
  "Out[483]=",ExpressionUUID->"7d8d26e0-a97e-422a-855b-0bbbeec28faa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["adenom", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"+", 
      RowBox[{"M", ".", "M"}]}], " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{
     RowBox[{"M", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}]}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "uW"}], "+", "uY"}]}], ",", 
     RowBox[{"M", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}], "+", "uM"}], ")"}]}], ",", 
     RowBox[{"X", "->", 
      RowBox[{
       RowBox[{"g", "*", "uV"}], " ", "+", " ", 
       RowBox[{"d", "*", "uW"}], " ", "+", " ", "uX"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"adenomerror", "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["adenom", "^"], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"adenomerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"adenomerror", ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"adenomerror", "=", 
  RowBox[{
   RowBox[{"adenomerror", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.8695532247923527`*^9, 3.8695532492968273`*^9}, {
   3.8695532912142572`*^9, 3.869553349612878*^9}, {3.8695533844437923`*^9, 
   3.8695534235433826`*^9}, 3.8695534635005836`*^9, {3.8695534941949472`*^9, 
   3.8695535263848763`*^9}, {3.86955393828699*^9, 3.869553940783311*^9}},
 CellLabel->
  "In[484]:=",ExpressionUUID->"2ecd15b4-cdb8-4e65-a5bb-c2d97812eb39"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"M", ".", "X"}]}], " ", 
   RowBox[{"X", ".", "M"}]}], "+", 
  RowBox[{
   RowBox[{"M", ".", "M"}], " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.869692414704383*^9},
 CellLabel->
  "Out[484]=",ExpressionUUID->"1b5d40a4-0afb-45d7-b078-74b3a239416d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "uV"}], "+", 
       RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"uM", "+", 
       RowBox[{"c", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
       RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "uV"}], "+", 
      RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"uM", "+", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
      RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.8696924147064667`*^9},
 CellLabel->
  "Out[486]=",ExpressionUUID->"56c2033d-fec3-4f07-8278-b084111074b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"uW", ".", "uW"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"uM", ".", "uM"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      RowBox[{"uV", ".", "uV"}]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"uW", ".", "uW"}]}], "+", 
     RowBox[{"uX", ".", "uX"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.869692414722766*^9},
 CellLabel->
  "Out[487]=",ExpressionUUID->"ab63a032-c525-48c3-b82c-dca4ea0865ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
  RowBox[{
   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, {3.8695532320139523`*^9, 
   3.869553265205646*^9}, 3.869553350147633*^9, {3.869553399725305*^9, 
   3.869553423853306*^9}, 3.869553463941312*^9, {3.869553523354595*^9, 
   3.869553526873263*^9}, 3.869553941140437*^9, 3.8695637905267057`*^9, 
   3.8696924147253323`*^9},
 CellLabel->
  "Out[488]=",ExpressionUUID->"4c75a5dd-2cc1-420b-8ae4-3c219e89742e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"anumerror", "/", "adenomerror"}], " ", "-", " ", "a"}], " ", "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.869553540612804*^9, 3.869553545239005*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"a0d518aa-f568-4add-8f58-eeae726ce9f1"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["g", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.869553545520512*^9, 3.86955394341881*^9, 
  3.86956379058534*^9, 3.8696924147384043`*^9},
 CellLabel->
  "Out[489]=",ExpressionUUID->"0c74c446-1a02-4576-957e-e947fd193d6d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   OverscriptBox["cplusedivd", "^"], "}"}], "=", 
  RowBox[{"Estimator", "[", 
   RowBox[{
    RowBox[{"{", "M", "}"}], ",", 
    RowBox[{"{", "X", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["edivd", "^"], "=", 
   RowBox[{
    OverscriptBox["cplusedivd", "^"], " ", "-", " ", 
    OverscriptBox["cIV", "^"]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResNewMXsubed", "=", 
   RowBox[{
    RowBox[{"ResMV", "-", 
     RowBox[{
      OverscriptBox["edivd", "^"], "*", "ResXV"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], "&"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"regress", " ", "M", " ", "on", " ", "V"}], "\[IndentingNewLine]", 
 RowBox[{"ResNewMXold", "=", 
  RowBox[{
   RowBox[{"ResMV", "-", 
    RowBox[{"edivd", "[", "ResXV", "]"}]}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"regress", " ", "M", " ", "on", " ", "X"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResNewMX", "=", 
   RowBox[{
    RowBox[{"ResMX", "-", 
     RowBox[{"edivd", "[", "ResXV", "]"}]}], "//", 
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], "&"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", "[", "W", "]"}], " ", "+", " ", "uM"}], ")"}], " ", "-", 
    " ", 
    RowBox[{"\[Epsilon]", "/", 
     RowBox[{"d", "[", 
      RowBox[{"dW", " ", "+", " ", "uX"}], "]"}]}]}], " ", "=", " ", 
   "residual"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RemNewMX", " ", "=", " ", 
   RowBox[{"M", " ", "-", " ", "cX", "-", 
    RowBox[{"edivd", "[", "X", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", "W", "]"}], " ", "+", " ", "uM"}], " ", "=", " ", 
  "remainder"}]}], "Input",
 CellChangeTimes->{{3.8692276397214622`*^9, 3.869227674758326*^9}, {
  3.869227777951429*^9, 3.869227778868437*^9}, {3.869227831252347*^9, 
  3.869227831325255*^9}, {3.869283857827505*^9, 3.869283863288822*^9}, {
  3.869295876949485*^9, 3.869295877610033*^9}, {3.8692959104234133`*^9, 
  3.869295910696864*^9}, {3.869296313064618*^9, 3.869296324196219*^9}, {
  3.869297004791106*^9, 3.869297075309421*^9}, {3.869297154131587*^9, 
  3.8692971608671703`*^9}, {3.869297196852882*^9, 3.869297202815156*^9}, {
  3.8695562638454*^9, 3.86955627009824*^9}, {3.871566515134881*^9, 
  3.8715665816426497`*^9}},ExpressionUUID->"34b6cb81-c15c-4789-be14-\
a1d5d8f6209c"],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]], "}"}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414752885*^9},
 CellLabel->
  "Out[490]=",ExpressionUUID->"e652669b-c3ee-4350-b133-b773d9c47c82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"V", ".", "M"}], 
    RowBox[{"V", ".", "X"}]]}], "+", 
  FractionBox[
   RowBox[{"X", ".", "M"}], 
   RowBox[{"X", ".", "X"}]]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414754507*^9},
 CellLabel->
  "Out[491]=",ExpressionUUID->"a75e0a1e-d8b7-4f59-b1d4-bf4ff5eafaf4"],

Cell[BoxData[
 RowBox[{"M", "+", 
  RowBox[{"X", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"V", ".", "M"}], 
      RowBox[{"V", ".", "X"}]], "-", 
     FractionBox[
      RowBox[{"X", ".", "M"}], 
      RowBox[{"X", ".", "X"}]]}], ")"}]}], "+", 
  RowBox[{"V", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"V", ".", "M"}]}], 
       RowBox[{"V", ".", "V"}]]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}], 
      RowBox[{
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "X"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.86969241475609*^9},
 CellLabel->
  "Out[492]=",ExpressionUUID->"36021845-71bf-4efd-b4a7-574efc2e9400"],

Cell[BoxData[
 RowBox[{"M", " ", "on", " ", "regress", " ", "V"}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414757841*^9},
 CellLabel->
  "Out[493]=",ExpressionUUID->"5776a5a9-77cf-4260-99c1-7e46acedaf8c"],

Cell[BoxData[
 RowBox[{"M", "-", 
  FractionBox[
   RowBox[{"X", " ", "\[Epsilon]"}], "d"], "+", 
  RowBox[{"V", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"V", ".", "M"}], 
       RowBox[{"V", ".", "V"}]]}], "+", 
     FractionBox[
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"V", ".", "X"}]}], 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "V"}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414759251*^9},
 CellLabel->
  "Out[494]=",ExpressionUUID->"7d806a89-e61d-485c-b5be-3ef56be303ec"],

Cell[BoxData[
 RowBox[{"M", " ", "on", " ", "regress", " ", "X"}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.8696924147609653`*^9},
 CellLabel->
  "Out[495]=",ExpressionUUID->"557496c4-057c-474d-aeb8-343a15a25cd8"],

Cell[BoxData[
 RowBox[{"M", "+", 
  RowBox[{"X", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Epsilon]", "d"]}], "-", 
     FractionBox[
      RowBox[{"V", ".", "M"}], 
      RowBox[{"V", ".", "X"}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"V", " ", "\[Epsilon]", " ", 
    RowBox[{"V", ".", "X"}]}], 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}]}]]}]], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414762259*^9},
 CellLabel->
  "Out[496]=",ExpressionUUID->"b084b866-11c9-4638-857a-61c146c418d1"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Plus\\\"}]\\) in \
\\!\\(\\*RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"eW\\\", \\\"+\\\", \
\\\"uM\\\"}], \\\")\\\"}], \\\"-\\\", FractionBox[RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"dW\\\", \\\"+\\\", \\\"uX\\\"}], \\\")\\\"}], \\\" \\\", \\\"\
\[Epsilon]\\\"}], \\\"d\\\"]}]\\) is Protected.\"", 2, 497, 17, 
   21926225762630875076, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8693056417278233`*^9, 3.869309825356584*^9, 
  3.869555218148621*^9, 3.869555252926237*^9, 3.8695562756052847`*^9, 
  3.8695637906360703`*^9, 3.869692414763595*^9},
 CellLabel->
  "During evaluation of \
In[490]:=",ExpressionUUID->"8c64034f-d61a-4568-8572-235bc9c759bf"],

Cell[BoxData["residual"], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.869692414767955*^9},
 CellLabel->
  "Out[497]=",ExpressionUUID->"ca84807f-60be-41c1-b175-fc2dd5581c1e"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"Plus\\\"}]\\) in \\!\\(\\*RowBox[{\\\"eW\\\", \
\\\"+\\\", \\\"uM\\\"}]\\) is Protected.\"", 2, 499, 18, 21926225762630875076,
    "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8693056417278233`*^9, 3.869309825356584*^9, 
  3.869555218148621*^9, 3.869555252926237*^9, 3.8695562756052847`*^9, 
  3.8695637906360703`*^9, 3.869692414769114*^9},
 CellLabel->
  "During evaluation of \
In[490]:=",ExpressionUUID->"15fc8712-4520-465e-af5d-0ebc48098fb0"],

Cell[BoxData["remainder"], "Output",
 CellChangeTimes->{3.864278366028371*^9, 3.864875748782174*^9, 
  3.867905729989809*^9, 3.8691144379922523`*^9, 3.869226593289227*^9, 
  3.869227681415757*^9, 3.869283863722286*^9, 3.8692927573024197`*^9, 
  3.86929592586546*^9, 3.8692964972210007`*^9, 3.8693056416925983`*^9, 
  3.869309825327289*^9, 3.869555218112648*^9, 3.86955525291611*^9, 
  3.8695562755936537`*^9, 3.869563790614626*^9, 3.8696924147732763`*^9},
 CellLabel->
  "Out[499]=",ExpressionUUID->"fd63b0bc-3ef8-4729-9d7d-fe50bfacb221"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  FractionBox[
   RowBox[{"RemNewMX", ".", "Y"}], 
   RowBox[{"RemNewMX", ".", "M"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"RemNewMX", ".", "Y"}], 
      RowBox[{"RemNewMX", ".", "M"}]], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "V"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["arem", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["arem", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["arem", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
  3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
  3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
  3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
  3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
  3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
  3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
  3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
  3.8692280275853577`*^9}, {3.8692280599089527`*^9, 3.8692281375468616`*^9}, {
  3.869297316532125*^9, 3.8692973167578382`*^9}, {3.869297702528627*^9, 
  3.8692977482320223`*^9}},
 CellLabel->
  "In[500]:=",ExpressionUUID->"3f710ad7-2751-456a-997a-a435eaa62abe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414786655*^9},
 CellLabel->
  "Out[501]=",ExpressionUUID->"97bf4274-a439-4f4b-a055-45b3b4bbe9b1"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", 
   "M"}]]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692414789077*^9},
 CellLabel->
  "Out[502]=",ExpressionUUID->"584d81af-3a8c-47e0-b3b1-65fca92fe866"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"M", ".", "V"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "X"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"X", ".", "V"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "V"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692415012561*^9},
 CellLabel->
  "Out[503]=",ExpressionUUID->"6efc2442-0eac-49dc-9e9a-b469f5af5825"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"V", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"V", ".", "X"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"V", ".", "X"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692415025379*^9},
 CellLabel->
  "Out[504]=",ExpressionUUID->"a7627c02-b2c4-4a14-942b-4a7bfd4aa9ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}]}], "-", 
  RowBox[{"b", " ", "d", " ", 
   RowBox[{"M", ".", "uX"}]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "uY"}]}], "-", 
  RowBox[{"b", " ", "d", " ", "g", " ", 
   RowBox[{"V", ".", "M"}]}], "+", 
  RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
   RowBox[{"V", ".", "X"}]}], "+", 
  RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
   RowBox[{"V", ".", "X"}]}], "+", 
  RowBox[{"b", " ", "d", " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"a", " ", "c", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "M"}]}], "+", 
  RowBox[{"b", " ", "c", " ", "d", " ", 
   RowBox[{"X", ".", "uX"}]}], "+", 
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "uX"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"X", ".", "uY"}]}], "-", 
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "uY"}]}], "-", 
  RowBox[{"b", " ", "c", " ", "d", " ", 
   RowBox[{"X", ".", "X"}]}], "-", 
  RowBox[{"b", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692415027754*^9},
 CellLabel->
  "Out[505]=",ExpressionUUID->"a14d67a9-c5b1-4ff2-9f5d-c4eb7ccca2fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}]}], "-", 
  RowBox[{"c", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", "\[Epsilon]", " ", 
   RowBox[{"X", ".", "M"}]}]}]], "Output",
 CellChangeTimes->{{3.869227858331057*^9, 3.869227867131558*^9}, {
   3.8692279206362658`*^9, 3.869227958149753*^9}, {3.8692280168067217`*^9, 
   3.869228029408474*^9}, 3.869228066116485*^9, {3.869228114558804*^9, 
   3.86922813804803*^9}, 3.869292757326907*^9, 3.869297278821892*^9, 
   3.869297317134397*^9, 3.869305641763632*^9, 3.869309825392997*^9, 
   3.869555224373661*^9, 3.869555255417788*^9, 3.8695562802174473`*^9, 
   3.869563790680399*^9, 3.869692415029173*^9},
 CellLabel->
  "Out[506]=",ExpressionUUID->"f9f5a033-f374-42c9-9aaf-e1792c71267d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  FractionBox[
   RowBox[{"RemNewMX", ".", "Y"}], 
   RowBox[{"RemNewMX", ".", "M"}]]}], "\[IndentingNewLine]", 
 RowBox[{"Numarem", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Numerator", "[", 
     OverscriptBox["arem", "^"], "]"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Denomarem", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Denominator", "[", 
     OverscriptBox["arem", "^"], "]"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
   3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
   3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
   3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
   3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
   3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
   3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
   3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
   3.8692280275853577`*^9}, {3.8692280599089527`*^9, 
   3.8692281375468616`*^9}, {3.869297316532125*^9, 3.8692973167578382`*^9}, {
   3.869297702528627*^9, 3.8692977482320223`*^9}, {3.869555486692275*^9, 
   3.869555508652031*^9}, {3.869555564397079*^9, 3.869555588379808*^9}, {
   3.869555640058826*^9, 3.869555687682781*^9}, 3.869555784388283*^9, {
   3.869555936704833*^9, 3.869555945592201*^9}, {3.869561521860147*^9, 
   3.869561533303043*^9}, {3.869561576905616*^9, 3.8695615802303*^9}},
 CellLabel->
  "In[507]:=",ExpressionUUID->"148e32b4-dc6d-4e25-bfe5-65b42cf0772d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.8696924150439796`*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"9885f666-7b94-4993-8809-ecabe36595fe"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{"c", "+", 
        FractionBox["\[Epsilon]", "d"]}], ")"}]}]}], ")"}], ".", 
   "M"}]]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.869692415045676*^9},
 CellLabel->
  "Out[509]=",ExpressionUUID->"16db0bae-70e6-44ce-a51d-60fd72cdee2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "Y"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.869692415047406*^9},
 CellLabel->
  "Out[510]=",ExpressionUUID->"d4f685c2-4054-4ec6-9ff7-b54c1cdb089a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.8695615336758547`*^9, 
   3.869561580780189*^9, 3.8695637911219883`*^9, 3.8696924150487347`*^9},
 CellLabel->
  "Out[511]=",ExpressionUUID->"8d6f0108-7e43-4ee4-912b-2d9bba1c2505"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "arem"}], "^"], "=", 
  RowBox[{
   FractionBox["Numarem", "Denomarem"], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"aremerror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["arem", "^"], "-", "a"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<uW\>\"", 
     ",", "\"\<uV\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aremerrorsimp", "=", 
  RowBox[{"aremerror", "/.", "condmeanreplace"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}, {
   3.8695560672211657`*^9, 3.869556081234673*^9}, {3.869561802977852*^9, 
   3.86956181056039*^9}, {3.8695618693270884`*^9, 3.869561898272396*^9}, {
   3.8695620354930468`*^9, 3.869562035652595*^9}, {3.8695637264572687`*^9, 
   3.8695637265873537`*^9}},
 CellLabel->
  "In[512]:=",ExpressionUUID->"3135a0ac-cd5b-405f-abdd-bb17d264bf55"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "Y"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "Y"}]}]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415067595*^9},
 CellLabel->
  "Out[512]=",ExpressionUUID->"1bf55745-7ebb-41ba-b2c2-69ec777759d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "M"}], "+", "uY", "-", 
        FractionBox[
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}], 
       ")"}]}]}]}], 
   RowBox[{
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"X", ".", "M"}]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.8696924150802298`*^9},
 CellLabel->
  "Out[514]=",ExpressionUUID->"215462d0-85ca-4617-97cd-c7e245fd3efe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "uW", ",", "uV"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415082378*^9},
 CellLabel->
  "Out[516]=",ExpressionUUID->"ade23362-ebf5-4527-a372-b52929669e9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "M"}], "-", 
          RowBox[{"c", " ", "d", " ", "X"}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{"g", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.8696924150935183`*^9},
 CellLabel->
  "Out[517]=",ExpressionUUID->"b94f6478-0e0c-4292-ade5-6982c6fcf205"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "M"}], "-", 
           RowBox[{"c", " ", "d", " ", "X"}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"uW", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uV", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", 
      SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"X", " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415096196*^9},
 CellLabel->
  "Out[518]=",ExpressionUUID->"23a53f96-fd37-4c49-82cf-0451f6aeacbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"X", ".", "M"}]}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "X"}], "+", 
             FractionBox[
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"X", " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["g", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.869561812341672*^9, 3.869561900118763*^9, 3.8695637911626*^9, 
   3.869692415099167*^9},
 CellLabel->
  "Out[519]=",ExpressionUUID->"a0c99ace-44d7-4d36-8f23-199266cfb594"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "b"}], "d"], 
    FractionBox["1", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", 
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
          ")"}], ")"}]}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", 
        RowBox[{"(", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           FractionBox[
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"X", " ", 
                SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "d"}], " ", "M"}], "+", 
                  RowBox[{"c", " ", "d", " ", "X"}], "+", 
                  RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Epsilon]", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
             RowBox[{
              SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["d", "2"], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
          ")"}], ")"}]}]}]}], ")"}]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
            "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
    "&"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.86956204364915*^9, 3.869562070596869*^9}, {
  3.869562326539212*^9, 3.869562327645155*^9}},
 CellLabel->
  "In[520]:=",ExpressionUUID->"4276989d-8e88-4b27-adaf-417dbf92065d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"b", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[Epsilon]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          RowBox[{"M", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
          RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.8695622977398853`*^9, 3.869562375838229*^9, 
  3.869563843487658*^9, 3.8696924497478848`*^9},
 CellLabel->
  "Out[520]=",ExpressionUUID->"065f21fa-99f3-4778-af58-41fd693ac652"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Epsilon]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           RowBox[{"M", ".", "M"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
           RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["g", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        RowBox[{"X", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["g", "2"], " ", 
              SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}]}],
       ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          RowBox[{"M", ".", "M"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
          RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[Epsilon]", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
      ")"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"X", ".", "M"}], "->", 
      RowBox[{"M", ".", "X"}]}], ",", 
     RowBox[{"g", "->", "0"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.869562727135985*^9, 3.8695627396118383`*^9}, {
  3.869562791201972*^9, 3.869562792253668*^9}},
 CellLabel->
  "In[521]:=",ExpressionUUID->"3243cf3a-6721-4b39-b16c-2aed5cd004ed"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "\[Epsilon]", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"X", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"c", " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{"M", ".", "X"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.869562740194868*^9, 3.8695627927835293`*^9, 
  3.8695638435735188`*^9, 3.869692449789753*^9},
 CellLabel->
  "Out[521]=",ExpressionUUID->"dcbcef5f-93d1-4ad3-943f-a32c35ad8188"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "remVar"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemNewMX", ".", "RemNewMX"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"\[IndentingNewLine]", "remVar"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"\[IndentingNewLine]", "remVar"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", "uM", "+", 
        RowBox[{"e", "*", "uW"}]}]}], ",", 
      RowBox[{"X", "->", 
       RowBox[{
        RowBox[{"g", "*", "uV"}], "+", 
        RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["remVar", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["remVar", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["remVar", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.869295536396841*^9, 3.869295584447096*^9}},
 CellLabel->
  "In[522]:=",ExpressionUUID->"9d603759-8ed7-4a32-91ff-e2376fd35d35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"M", ".", "X"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449815629*^9},
 CellLabel->
  "Out[522]=",ExpressionUUID->"9428f410-3610-4b96-852d-43c21cadf600"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "d", " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.8696924498210087`*^9},
 CellLabel->
  "Out[523]=",ExpressionUUID->"5a06f646-f13d-4c3f-a438-a9e938ea1eca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["d", "2"]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "-", 
      RowBox[{"2", " ", "d", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"uM", "+", 
          RowBox[{"e", " ", "uW"}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], ")"}]}]}]}], 
     ")"}]}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"e", " ", "uW"}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], ")"}], ".", 
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"e", " ", "uW"}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], ")"}]}]}]], "Output",\

 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.8696924498327923`*^9},
 CellLabel->
  "Out[524]=",ExpressionUUID->"2137b13c-0435-4d4d-8382-c82585003b64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uM", ".", "uM"}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    RowBox[{"uV", ".", "uV"}]}], 
   SuperscriptBox["d", "2"]], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   RowBox[{"uW", ".", "uW"}]}], "-", 
  RowBox[{"2", " ", "e", " ", "\[Epsilon]", " ", 
   RowBox[{"uW", ".", "uW"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   RowBox[{"uW", ".", "uW"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    RowBox[{"uX", ".", "uX"}]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449854836*^9},
 CellLabel->
  "Out[525]=",ExpressionUUID->"8fbf957d-f728-4b82-86cc-1ce7d01ac503"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["g", "2"], " ", 
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}], 
   SuperscriptBox["d", "2"]], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "-", 
  RowBox[{"2", " ", "e", " ", "\[Epsilon]", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{
   SuperscriptBox["\[Epsilon]", "2"], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
   SuperscriptBox["d", "2"]]}]], "Output",
 CellChangeTimes->{{3.869295572311386*^9, 3.8692955847481203`*^9}, 
   3.869305642033614*^9, 3.869309825666205*^9, {3.869555228213067*^9, 
   3.869555257719425*^9}, 3.86955628253406*^9, 3.869563843616517*^9, 
   3.869692449866487*^9},
 CellLabel->
  "Out[526]=",ExpressionUUID->"e8bf1d3a-6462-477d-9902-9a4cf38d7751"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "aremDen"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemNewMX", ".", "M"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremDen", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremDen", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", "uM", "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
      RowBox[{"X", "->", 
       RowBox[{
        RowBox[{"g", "*", "uV"}], "+", 
        RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aremDen", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aremDen", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228621169265*^9}, {
   3.869228684749145*^9, 3.8692287109186583`*^9}, 3.8692288277954473`*^9, 
   3.869295570238495*^9, {3.869563842060727*^9, 3.8695638600460777`*^9}},
 CellLabel->
  "In[527]:=",ExpressionUUID->"5cee2649-b8f7-44fb-a553-c90de243a6dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449885902*^9},
 CellLabel->
  "Out[527]=",ExpressionUUID->"9c63aa95-599d-4b7e-a8ff-cd2de0e54403"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", ".", "M"}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"X", ".", "M"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449887692*^9},
 CellLabel->
  "Out[528]=",ExpressionUUID->"afaa120a-67dd-4736-be87-8af692b0e289"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"uM", "+", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"g", " ", "uV"}], "+", 
           RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
        RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "d"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
     RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
   RowBox[{"(", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV"}], "+", 
        RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
     RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449889429*^9},
 CellLabel->
  "Out[529]=",ExpressionUUID->"271d5522-57cc-4f0f-a022-4848694297cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"uM", ".", "uM"}], "-", 
  FractionBox[
   RowBox[{"c", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       RowBox[{"uV", ".", "uV"}]}], "+", 
      RowBox[{"uX", ".", "uX"}]}], ")"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.8696924499011183`*^9},
 CellLabel->
  "Out[530]=",ExpressionUUID->"79befb53-7fde-4344-afd9-7e34cac168f3"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "-", 
  FractionBox[
   RowBox[{"c", " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "d"]}]], "Output",
 CellChangeTimes->{{3.8692282487543573`*^9, 3.869228309427445*^9}, {
   3.869228357341906*^9, 3.869228397614806*^9}, {3.869228444266523*^9, 
   3.869228489398448*^9}, 3.869228533135543*^9, {3.869228600517309*^9, 
   3.869228621409256*^9}, 3.869228711505005*^9, 3.869228828365995*^9, 
   3.869292757602022*^9, 3.869305642094576*^9, 3.869309825727086*^9, {
   3.869555230603712*^9, 3.869555260075729*^9}, 3.86955628434571*^9, 
   3.8695636964161377`*^9, {3.869563843741578*^9, 3.869563866154265*^9}, 
   3.869692449903503*^9},
 CellLabel->
  "Out[531]=",ExpressionUUID->"5dfa759d-4505-4889-87e5-bc5a4fe1e18e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "aremNum"}], "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RemNewMX", ".", "Y"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "\[Rule]", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "+", 
         RowBox[{"b", " ", "W"}]}]}], ",", 
       RowBox[{"W", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", "uX", "-", 
           RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremNum", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox[
     RowBox[{"aremNum", "\[IndentingNewLine]"}], "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"M", "->", 
       RowBox[{
        RowBox[{"c", "*", "X"}], "+", "uM", "+", 
        RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
      RowBox[{"X", "->", 
       RowBox[{
        RowBox[{"g", "*", "uV"}], "+", 
        RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aremNum", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "\[Epsilon]", ",", "g"}], 
           "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aremNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aremNum", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228669324094*^9}, 
   3.869228718749824*^9, {3.869228749084634*^9, 3.869228825631928*^9}, {
   3.869563845830163*^9, 3.8695638515760727`*^9}},
 CellLabel->
  "In[532]:=",ExpressionUUID->"aee487a7-8222-4e5e-86d3-aa49e2b101e9"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["d", "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"M", ".", "uV"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "X"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692449957265*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"ec5495a3-68d1-4e7e-9847-c9396cdb7357"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox["d", "2"]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}]}], "-", 
    RowBox[{"b", " ", "d", " ", "g", " ", 
     RowBox[{"M", ".", "uV"}]}], "-", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"M", ".", "uX"}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "uY"}]}], "+", 
    RowBox[{"b", " ", "d", " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "M"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", "g", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "g", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uV"}]}], "+", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "uX"}]}], "+", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uX"}]}], "-", 
    RowBox[{"c", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"d", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "uY"}]}], "-", 
    RowBox[{"b", " ", "c", " ", "d", " ", 
     RowBox[{"X", ".", "X"}]}], "-", 
    RowBox[{"b", " ", "\[Epsilon]", " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.8696924499604883`*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"5218aa99-7537-438f-bdb1-4f35b3bfa5ca"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox["d", "2"]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "b"}], " ", "g", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uV"}]}], "-", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uX"}]}], "+", 
     RowBox[{"b", " ", "c", " ", "d", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
     RowBox[{"b", " ", "\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}]}], "+", 
     RowBox[{"c", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uY"}]}], "+", 
     RowBox[{"d", " ", "\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", "uY"}]}], "-", 
     RowBox[{"b", " ", "d", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "+", 
     RowBox[{"a", " ", "c", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "+", 
     RowBox[{"a", " ", "d", " ", "\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}], "+", 
     RowBox[{"b", " ", "d", " ", "g", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", "uV"}]}], "+", 
     RowBox[{"b", " ", "d", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", "uX"}]}], "-", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", "uY"}]}], "-", 
     RowBox[{"a", " ", 
      SuperscriptBox["d", "2"], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"uM", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"d", " ", "uW"}], "+", "uX"}], ")"}]}], "+", 
         RowBox[{"uW", " ", "\[Epsilon]"}]}], ")"}]}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.86969244998766*^9},
 CellLabel->
  "Out[534]=",ExpressionUUID->"9b8a8353-7a5e-40b3-a369-61e7b7e45e4f"],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"uM", ".", "uM"}], "-", 
    FractionBox[
     RowBox[{"c", " ", "\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         RowBox[{"uV", ".", "uV"}]}], "+", 
        RowBox[{"uX", ".", "uX"}]}], ")"}]}], "d"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692450024515*^9},
 CellLabel->
  "Out[535]=",ExpressionUUID->"bf1ed815-3e9c-4938-9c61-4b3e8e1eee34"],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{
    SubsuperscriptBox["\[Sigma]", "uM", "2"], "-", 
    FractionBox[
     RowBox[{"c", " ", "\[Epsilon]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["g", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "d"]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.8692286388150473`*^9, 3.869228669750163*^9, 3.869228719663059*^9, 
   3.8692287506786003`*^9, {3.869228808263636*^9, 3.86922883057966*^9}, 
   3.869292757678975*^9, 3.869305642164*^9, 3.869309825800901*^9, {
   3.869555232884128*^9, 3.869555261818676*^9}, 3.869556286423877*^9, 
   3.869563843884124*^9, 3.869692450026721*^9},
 CellLabel->
  "Out[536]=",ExpressionUUID->"3584846a-2d28-4341-899c-f8281313ed89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"M", ",", "V", ",", "X", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"allstructure", "=", 
  RowBox[{
  "GraphNodeStructure", "[", "causalgraphiv2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "ares"}], "^"], "=", 
  FractionBox[
   RowBox[{"ResNewMX", ".", "Y"}], 
   RowBox[{"ResNewMX", ".", "M"}]]}], "\[IndentingNewLine]", 
 RowBox[{"Numares", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Numerator", "[", 
      OverscriptBox["ares", "^"], "]"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Denomares", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Denominator", "[", 
      OverscriptBox["ares", "^"], "]"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}]}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "g"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
   3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
   3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
   3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
   3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
   3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
   3.869227758046924*^9}, {3.869227848152276*^9, 3.869227866868907*^9}, {
   3.869227901644845*^9, 3.8692279577231293`*^9}, {3.869228016360421*^9, 
   3.8692280275853577`*^9}, {3.8692280599089527`*^9, 
   3.8692281375468616`*^9}, {3.869297316532125*^9, 3.8692973167578382`*^9}, {
   3.869297702528627*^9, 3.8692977482320223`*^9}, {3.869555486692275*^9, 
   3.869555508652031*^9}, {3.869555564397079*^9, 3.869555588379808*^9}, {
   3.869555640058826*^9, 3.869555687682781*^9}, 3.869555784388283*^9, {
   3.869555936704833*^9, 3.869555945592201*^9}},
 CellLabel->
  "In[537]:=",ExpressionUUID->"44b87cad-f4ad-4395-8802-fe7b7af4636c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"V", "\[Rule]", "uV"}], ",", 
   RowBox[{"X", "\[Rule]", 
    RowBox[{"uX", "+", 
     RowBox[{"g", " ", "V"}], "+", 
     RowBox[{"d", " ", "W"}]}]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{"uM", "+", 
     RowBox[{"c", " ", "X"}], "+", 
     RowBox[{"W", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    RowBox[{
     RowBox[{"a", " ", "M"}], "+", "uY", "+", 
     RowBox[{"b", " ", "W"}]}]}], ",", 
   RowBox[{"W", "\[Rule]", "uW"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.869692450043766*^9},
 CellLabel->
  "Out[538]=",ExpressionUUID->"59144e04-73ec-46c0-9e6a-fdf84c9db242"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "+", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Epsilon]", "d"]}], "-", 
        FractionBox[
         RowBox[{"V", ".", "M"}], 
         RowBox[{"V", ".", "X"}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"V", " ", "\[Epsilon]", " ", 
       RowBox[{"V", ".", "X"}]}], 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "V"}]}]]}], ")"}], ".", "Y"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"M", "+", 
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Epsilon]", "d"]}], "-", 
        FractionBox[
         RowBox[{"V", ".", "M"}], 
         RowBox[{"V", ".", "X"}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{"V", " ", "\[Epsilon]", " ", 
       RowBox[{"V", ".", "X"}]}], 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "V"}]}]]}], ")"}], ".", "M"}]]], "Output",
 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.8696924500457153`*^9},
 CellLabel->
  "Out[539]=",ExpressionUUID->"690b9587-df54-4036-9647-bacd52772e57"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "Y"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "Y"}]}]}], "d"]], "Output",\

 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.86969245004775*^9},
 CellLabel->
  "Out[540]=",ExpressionUUID->"c588d418-da90-4405-952d-c3d0ed46680e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "M"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], "d"]], "Output",\

 CellChangeTimes->{
  3.869555509254902*^9, {3.86955558555772*^9, 3.8695555888345137`*^9}, {
   3.869555641714954*^9, 3.8695556881189947`*^9}, 3.869555784863812*^9, 
   3.86955595709944*^9, 3.869556288262475*^9, 3.869563844058776*^9, 
   3.869692450058867*^9},
 CellLabel->
  "Out[541]=",ExpressionUUID->"a2d7698d-1855-4df2-b639-880143970e4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox[
   RowBox[{"\[IndentingNewLine]", "ares"}], "^"], "=", 
  RowBox[{
   FractionBox["Numares", "Denomares"], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X", "-", "uX", "-", 
         RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"areserror", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     OverscriptBox["ares", "^"], "-", "a"}], "//.", "structureEqs"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8583295258275623`*^9, 3.858329536393091*^9}, {
   3.858329619346717*^9, 3.858329623506649*^9}, {3.858329738551467*^9, 
   3.858329780565008*^9}, {3.858329913734679*^9, 3.858329920415079*^9}, {
   3.858330003467902*^9, 3.858330016687498*^9}, {3.858330065961187*^9, 
   3.858330124731797*^9}, {3.858330202728469*^9, 3.858330239565785*^9}, {
   3.858335130326631*^9, 3.858335143361487*^9}, {3.8583352147520657`*^9, 
   3.85833529585989*^9}, {3.858335348826601*^9, 3.8583354155982447`*^9}, {
   3.8583356656996098`*^9, 3.858335734312305*^9}, {3.858335788985821*^9, 
   3.858335790587041*^9}, {3.858335822354644*^9, 3.858335858537931*^9}, {
   3.858335910672925*^9, 3.858335944042305*^9}, {3.858336138980095*^9, 
   3.858336165905332*^9}, {3.8583362752901983`*^9, 3.858336323964972*^9}, {
   3.858336354053403*^9, 3.858336387219617*^9}, {3.858336841898239*^9, 
   3.8583368654931993`*^9}, {3.858337557997189*^9, 3.8583375749946947`*^9}, {
   3.8583376218936787`*^9, 3.858337653647419*^9}, {3.858337867476282*^9, 
   3.858337868912292*^9}, {3.858338153584222*^9, 3.858338154005821*^9}, {
   3.8595461854437923`*^9, 3.859546248686233*^9}, {3.859546338760151*^9, 
   3.859546354853167*^9}, {3.8595464153858767`*^9, 3.859546426852581*^9}, {
   3.8595573596959*^9, 3.859557396877935*^9}, {3.859558594993704*^9, 
   3.8595586049038677`*^9}, {3.859591464858211*^9, 3.859591478380883*^9}, {
   3.8641183579368687`*^9, 3.864118366918178*^9}, {3.869308201462249*^9, 
   3.869308226316249*^9}, 3.8693082952524*^9, {3.869309116953698*^9, 
   3.8693091310567713`*^9}, 3.86930959033851*^9, {3.869527859949767*^9, 
   3.869527867645939*^9}, {3.869553693571763*^9, 3.8695536987461433`*^9}, {
   3.8695560672211657`*^9, 3.869556081234673*^9}},
 CellLabel->
  "In[542]:=",ExpressionUUID->"0888aecc-1513-4e4b-a9bf-977fadf5c019"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "Y"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "Y"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "Y"}]}]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"M", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}]}], "-", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "M"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"X", ".", "M"}]}], "-", 
   RowBox[{"\[Epsilon]", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}]]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.8695638440963573`*^9, 3.869692450075451*^9},
 CellLabel->
  "Out[542]=",ExpressionUUID->"95a034ab-1d0c-44fe-91da-2a2932608499"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}],
         ")"}]}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "+", "uY", "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], "d"]}],
         ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "+", "uY", "-", 
            FractionBox[
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], 
             "d"]}], ")"}]}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "+", "uY", "-", 
            FractionBox[
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", "uX", "-", "X"}], ")"}]}], 
             "d"]}], ")"}]}]}]}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8693082994582243`*^9, {3.869309121287469*^9, 3.869309131471786*^9}, 
   3.869309591498605*^9, 3.8693098193722677`*^9, 3.869527001855694*^9, {
   3.8695278607236967`*^9, 3.869527867964113*^9}, 3.869553699246455*^9, {
   3.869556072881707*^9, 3.8695561111901197`*^9}, 3.869556293585416*^9, 
   3.8695638440963573`*^9, 3.8696924501021013`*^9},
 CellLabel->
  "Out[544]=",ExpressionUUID->"93ea8c80-5915-4465-860e-2e2d54582adf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<uW\>\"", 
     ",", "\"\<uV\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"condmeans", "=", 
  RowBox[{"CondMeans", "[", 
   RowBox[{"causalgraphiv2", ",", "noisenames", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<V\>\"", ",", "\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"areserrorsimp", "=", 
  RowBox[{"areserror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{"areserrorsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"areserror", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{
           RowBox[{"V", ".", "X"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], 
         ")"}]}]}], ")"}]}], "/.", "condmeanreplace"}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
            "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
    "&"}]}]}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
   3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
   3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
   3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
   3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
   3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
   3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
   3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
   3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
   3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
   3.860036875204605*^9}, {3.869308336422339*^9, 3.8693083368832283`*^9}, {
   3.869308501704814*^9, 3.86930850182689*^9}, {3.869309609850891*^9, 
   3.8693096134984827`*^9}, {3.869309694496868*^9, 3.869309724573353*^9}, 
   3.869309761048152*^9, {3.8695270175510883`*^9, 3.8695270206970453`*^9}, {
   3.869527842727806*^9, 3.86952784548337*^9}, {3.869556091216662*^9, 
   3.869556101294402*^9}, 3.869556421060235*^9, {3.869556611301257*^9, 
   3.86955661173039*^9}},
 CellLabel->
  "In[545]:=",ExpressionUUID->"2be5abd4-4c81-413c-b842-bc9541bd9056"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "uW", ",", "uV"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.8696924501196404`*^9},
 CellLabel->
  "Out[546]=",ExpressionUUID->"5f01982c-280e-43c5-92b2-8c34f8f4c24b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "M"}], "+", 
          RowBox[{"c", " ", "d", " ", "X"}], "-", 
          RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "M"}], "-", 
          RowBox[{"c", " ", "d", " ", "X"}], "+", 
          RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "-", 
          RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "0", ",", 
   FractionBox[
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]], ",", "V"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.869692450147291*^9},
 CellLabel->
  "Out[547]=",ExpressionUUID->"2990ac57-d0e1-42b2-b07c-4c196613eeb4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{"\[Epsilon]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], " ", "M"}], "+", 
           RowBox[{"c", " ", "d", " ", "X"}], "-", 
           RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "M"}], "-", 
           RowBox[{"c", " ", "d", " ", "X"}], "+", 
           RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "-", 
           RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", "0"}], ",", 
   RowBox[{"uW", "\[Rule]", 
    FractionBox[
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", "-", 
           RowBox[{"c", " ", "X"}]}], ")"}], " ", "\[Epsilon]", " ", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], ",", 
   RowBox[{"uV", "\[Rule]", "V"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.869692450150573*^9},
 CellLabel->
  "Out[548]=",ExpressionUUID->"496bf3d7-8406-46a4-908b-bdf2dec7f001"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "V"}], "-", "X", "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "M"}], "-", 
         FractionBox[
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "V"}], "-", "X", "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                 RowBox[{"\[Epsilon]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
              RowBox[{
               RowBox[{
                SuperscriptBox["\[Epsilon]", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
               RowBox[{
                SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
            ")"}]}], "d"]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "-", 
            FractionBox[
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "V"}], "-", "X", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                  
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["\[Epsilon]", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                  RowBox[{
                   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
               ")"}]}], "d"]}], ")"}]}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "M"}], "-", 
            FractionBox[
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "V"}], "-", "X", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "g"}], " ", "V"}], "+", "X"}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                    RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "-", 
                    RowBox[{"g", " ", "V", " ", "\[Epsilon]"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                  
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["\[Epsilon]", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                   SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                  RowBox[{
                   SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}]]}], 
               ")"}]}], "d"]}], ")"}]}]}]}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[Epsilon]"}], " ", 
         RowBox[{"V", ".", "V"}], " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], ")"}]}]}],
     ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, 3.864875741814452*^9, 
   3.867905714076714*^9, 3.8679059078203583`*^9, 3.869114431038863*^9, 
   3.869114872318589*^9, 3.869114962986331*^9, 3.869226582794567*^9, 
   3.869292749200561*^9, 3.86930563372579*^9, {3.869308312425269*^9, 
   3.8693083395170183`*^9}, 3.869308506560759*^9, {3.8693095948003473`*^9, 
   3.8693096144442863`*^9}, 3.869309694890094*^9, 3.8693097252099323`*^9, 
   3.8693098193901997`*^9, 3.86931357641227*^9, {3.869527004157792*^9, 
   3.8695270248130283`*^9}, 3.869527845709313*^9, 3.869553727973382*^9, {
   3.869556094255549*^9, 3.869556113505525*^9}, 3.8695562985394573`*^9, 
   3.869556425145008*^9, 3.86955661302092*^9, 3.869563844179731*^9, 
   3.869692450153668*^9},
 CellLabel->
  "Out[549]=",ExpressionUUID->"121611ec-a7c8-4bdd-9691-6b3b5e9fe742"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", ".", "M"}], " ", 
  RowBox[{"V", ".", "V"}], " ", 
  RowBox[{"V", ".", "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", ".", "M"}], " ", 
  RowBox[{"V", ".", "V"}], " ", 
  RowBox[{"X", ".", "M"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", ".", "X"}], " ", 
  RowBox[{"V", ".", "V"}], " ", 
  RowBox[{"X", ".", "M"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V", ".", "X"}], " ", 
  RowBox[{"V", ".", "X"}], " ", 
  RowBox[{"V", ".", "M"}]}]}], "Input",
 CellChangeTimes->{{3.86955711664285*^9, 
  3.8695571468435717`*^9}},ExpressionUUID->"d18bdfa8-fffe-4c67-8af8-\
531300804b3d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"-", "b"}], "d"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"X", " ", 
                 SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                   RowBox[{"c", " ", "d", " ", "X"}], "+", 
                   RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "X"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"X", " ", 
                 SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                RowBox[{"\[Epsilon]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                   RowBox[{"c", " ", "d", " ", "X"}], "+", 
                   RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                 SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["\[Epsilon]", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
              RowBox[{
               SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["d", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "X"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"X", " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                   RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Epsilon]", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                 RowBox[{
                  SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}], "+", 
          RowBox[{
           RowBox[{"V", ".", "X"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "X"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"X", " ", 
                    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
                   RowBox[{"\[Epsilon]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "d"}], " ", "M"}], "+", 
                    RowBox[{"c", " ", "d", " ", "X"}], "+", 
                    RowBox[{"X", " ", "\[Epsilon]"}]}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}]}], ")"}], " ", 
                 
                 SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox["\[Epsilon]", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
                  SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
                 RowBox[{
                  SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}]}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Epsilon]"}], " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{
           RowBox[{"V", ".", "X"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"V", " ", "\[Epsilon]"}], ")"}], ".", "M"}]}]}], 
         ")"}]}]}], ")"}]}]}], "//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]", ",", 
            "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
    "&"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8695566969923*^9, 3.8695567491644278`*^9}, {
  3.869556910614193*^9, 3.869556966969453*^9}, {3.869557082887801*^9, 
  3.869557084743704*^9}},
 CellLabel->
  "In[703]:=",ExpressionUUID->"0e2643d1-468d-4d81-9b34-8b0ac91568ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"b", " ", 
    SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       RowBox[{"V", ".", "M"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "X"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
      RowBox[{"\[Epsilon]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{"c", " ", "\[Epsilon]", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", " ", 
          RowBox[{"X", ".", "M"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          RowBox[{"X", ".", "X"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
            RowBox[{"c", " ", "\[Epsilon]", " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], ")"}]}],
       "+", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             RowBox[{"M", ".", "M"}]}], "-", 
            RowBox[{"\[Epsilon]", " ", 
             RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          RowBox[{"X", ".", "X"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "d"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
            RowBox[{"c", " ", "\[Epsilon]", " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "-", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}], "+", 
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"V", ".", "X"}], ")"}], "2"]}], "-", 
         RowBox[{"d", " ", 
          RowBox[{"V", ".", "V"}], " ", 
          RowBox[{"X", ".", "M"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Epsilon]", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.869556920784384*^9, 3.8695569401077833`*^9}, 
   3.8695569973216457`*^9, 3.869557112297407*^9},
 CellLabel->
  "Out[703]=",ExpressionUUID->"ca17d078-7a87-47c8-9208-8476fe381061"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        RowBox[{"V", ".", "M"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "X"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"X", ".", "M"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"M", ".", "M"}]}], "-", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"X", ".", "M"}]}]}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d"}], " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"X", ".", "M"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"V", ".", "X"}], ")"}], "2"]}], "-", 
          RowBox[{"d", " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}]}], ")"}]}], 
    ")"}]}], "//", "\[IndentingNewLine]", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.869556974248987*^9, 3.8695570149905157`*^9}, {
  3.869557464140861*^9, 3.869557465955286*^9}, {3.869557616519744*^9, 
  3.869557657370851*^9}, {3.8695577926533613`*^9, 3.869557793382078*^9}},
 CellLabel->
  "In[706]:=",ExpressionUUID->"d7b6cdab-8a6d-4c0a-b3b9-299b6ec3fe2e"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", " ", 
     SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"M", ".", "X"}], " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", "\[Epsilon]", " ", 
        RowBox[{"V", ".", "X"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "-", 
             RowBox[{"d", " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}]}], ")"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["\[Sigma]", "uX", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"M", ".", "M"}]}], "-", 
             RowBox[{"\[Epsilon]", " ", 
              RowBox[{"X", ".", "M"}]}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"X", ".", "X"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
             RowBox[{"c", " ", "\[Epsilon]", " ", 
              SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
          RowBox[{"\[Epsilon]", " ", 
           RowBox[{"X", ".", "M"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
          RowBox[{"c", " ", "\[Epsilon]", " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        RowBox[{"V", ".", "M"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Epsilon]", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"V", ".", "X"}], ")"}], "2"]}], "-", 
          RowBox[{"d", " ", 
           RowBox[{"V", ".", "V"}], " ", 
           RowBox[{"X", ".", "M"}]}]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"V", ".", "X"}]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", "\[Epsilon]", " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"V", ".", "X"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["\[Epsilon]", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.869557466290968*^9, 3.869557657680332*^9, 
  3.8695577938153887`*^9},
 CellLabel->
  "Out[706]//TraditionalForm=",ExpressionUUID->"08388162-e4ba-4834-b7f9-\
4c7e48b5037d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8695568621292257`*^9, 3.869556899108749*^9}, 
   3.869557016941049*^9},ExpressionUUID->"24a232fa-4bb4-4c52-a240-\
66ae21bc33c1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox[
    RowBox[{"\[IndentingNewLine]", "aresDen"}], "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ResNewMXold", ".", "M"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Y", "\[Rule]", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          RowBox[{"b", " ", "W"}]}]}], ",", 
        RowBox[{"W", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"X", "-", "uX", "-", 
            RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}], ",", 
        RowBox[{"V", "->", "uV"}]}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"V", ".", "V"}], ",", 
              RowBox[{"V", ".", "X"}], ",", 
              RowBox[{"V", ".", "M"}], ",", 
              RowBox[{"X", ".", "V"}], ",", 
              RowBox[{"X", ".", "X"}], ",", 
              RowBox[{"X", ".", "M"}], ",", 
              RowBox[{"M", ".", "V"}], ",", 
              RowBox[{"M", ".", "X"}], ",", 
              RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
           
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
              ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
      "&"}]}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresDen", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aresDen", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresDen", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aresDen", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "->", 
        RowBox[{
         RowBox[{"c", "*", "X"}], "+", "uM", "+", 
         RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
       RowBox[{"X", "->", 
        RowBox[{
         RowBox[{"g", "*", "uV"}], "+", 
         RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresDen", "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{
       OverscriptBox["aresDen", "^"], ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
             ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresDen", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aresDen", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresDen", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresDen", "^"], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    OverscriptBox["aresDen", "^"], ",", "a"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228669324094*^9}, 
   3.869228718749824*^9, {3.869228749084634*^9, 3.869228825631928*^9}, {
   3.869283803264785*^9, 3.869283823492714*^9}, {3.869283880302532*^9, 
   3.869283883039679*^9}, {3.8692839258878937`*^9, 3.8692840053885612`*^9}, {
   3.86928404888568*^9, 3.869284103002675*^9}, {3.869559053068713*^9, 
   3.869559053214302*^9}, {3.869559102811775*^9, 3.869559119841145*^9}, {
   3.8695591832506123`*^9, 3.86955918356768*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"4e634ccc-9a9e-41b0-b3a2-503c3c430c01"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uM"}], "+", 
    RowBox[{"c", " ", "g", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uV"}]}], "+", 
    RowBox[{"c", " ", "d", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"\[Epsilon]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uX"}]}], "+", 
    RowBox[{"d", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
    RowBox[{"c", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "4"]}], "+", 
    RowBox[{"c", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189176394*^9},
 CellLabel->
  "Out[751]=",ExpressionUUID->"2ca7dad8-e904-4d81-856e-9260ab6f8aaa"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"c", " ", 
    SuperscriptBox["g", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
    RowBox[{"uV", ".", "uV"}]}], "+", 
   RowBox[{"d", " ", 
    SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["g", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
  "d"]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189210685*^9},
 CellLabel->
  "Out[752]=",ExpressionUUID->"ab0e957e-c98a-49b3-b703-20138f6dee6f"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189229308*^9},
 CellLabel->
  "Out[753]=",ExpressionUUID->"e4b814c6-ffe5-4fc5-b0e7-332734dc2acf"],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.86928410687148*^9, 3.86929276144174*^9, 3.869295931074024*^9, 
   3.869305642373962*^9, 3.86930982602024*^9, {3.8695552349076643`*^9, 
   3.869555263523123*^9}, {3.869559060125231*^9, 3.869559076538076*^9}, {
   3.869559108919593*^9, 3.8695591348988867`*^9}, 3.869559189232772*^9},
 CellLabel->
  "Out[754]=",ExpressionUUID->"b21b5b53-ed04-43b1-adc8-f42e07ab549b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"noise", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"aresDenSolve", "=", 
  RowBox[{
   OverscriptBox["aresDen", "^"], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "->", "1"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "noise"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "noise"}], ",", 
     RowBox[{
      SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "noise"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"aresDenSol", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"aresDenSolve", "==", "0"}], ",", "e"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"e", "/.", 
    RowBox[{"aresDenSol", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", 
     RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.869284305874529*^9, 3.8692843477776003`*^9}, {
  3.86928448797668*^9, 3.8692845092960777`*^9}, {3.869284588933527*^9, 
  3.869284594167206*^9}, {3.869284656468687*^9, 3.869284658841823*^9}, {
  3.8692856084181004`*^9, 3.86928567507589*^9}, {3.869285727397005*^9, 
  3.869285774126294*^9}},
 CellLabel->
  "In[530]:=",ExpressionUUID->"259fff40-0107-4062-be35-916546ba0c21"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.869555265899795*^9},
 CellLabel->
  "Out[530]=",ExpressionUUID->"374e5156-4824-4699-8cd6-460c7582698d"],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox["e", "d"]}]], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.869555265901765*^9},
 CellLabel->
  "Out[531]=",ExpressionUUID->"916a1a2a-e9ac-45f5-bb5a-a226f61d5a5c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"e", "\[Rule]", "d"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.869555265903713*^9},
 CellLabel->
  "Out[532]=",ExpressionUUID->"da2f57fe-c85d-41fd-8919-2a508b97de31"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJxF1OlPEnAcgHEkKRTLExVDOWyu2FCnS+fR0ozhVqJhUMtlhtKcUZg606GW
EzWtLRXRifLCI9KxsrWl5mpamJYWuZqY0WGReLXyQslJVFt8fy+eff6DhyYQ
c4VYDAaT8Ld/Fs8mrFit/oM2jRJPk34LyXH5vNH7C0mNyLaIV5FPq+vw00Yk
PnDSb/AVsj4v7cjVZqTaLrcDE47ECdkhpNN00P3dM1FbLQ3kahTp+0apoOTn
AVGNgQL2XVZkdSf6gZw6HvV3ExlkKx9z4r/7gKqRQl1uCglMldYTX3d6gSVp
2+4S3D1BDJMyEFfuAb6/3lSpnnADyY6ZXWuHXMHz+xk4PdkZTA//1KnREEBG
QaT1YgcebP2YPFQYiwNnS4nRbG8s2C/fy5rjWwZsBs9PrQUp18HD/XoHC38J
zO7qNru6G0D+Of/WN0UvwJGXU9Whyc8P2oxkPrmf1GgAsfnEDxmkJXCHU1Kp
4Mc6WDati8tpt4D3miuSSlbsYmyK2zJcvvFxYGqWwreyFA9WHcuPCG0hgPYe
cuOVzV3g5Fj5ktTZFeRJBGEKjRsoIizStac8QIp6uGH7AhGU9MUlOzd7gdkq
UU9YEAl0woYLAmd8QNaF43KGjAx6P/QVs/b4gXU512qDJykgtyKRqeyhgowU
Ka+jmAbqjA5tMh4d1ApmYt0o/uAX+9tmOR25psrsJgUgSYuLZBoTmZG7shEU
hdwss95JOIEMuEXyqbqJjGDrx51kyKPzLZU1DchLTKqpUYl89CBgXKVGcodD
K4ZGkMJMU3T8GLLAsXd1TItUciLPvp1Azulior8akJsF2FXhLHLn7qGu+QVk
yBm21/IykmXnoM0zIU+2j0rNZmQW60ZU0Rby/7fAPwoONb0=
       "]]},
     Annotation[#, "Charting`Private`Tag$59420#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{-10, 10}, {-9.999999591836735, 9.999999591836735}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8692843341708517`*^9, {3.869284488328289*^9, 3.8692844996658278`*^9}, 
   3.869284594882725*^9, 3.869284659238743*^9, {3.869285610359537*^9, 
   3.869285671025223*^9}, {3.869285723403277*^9, 3.8692857331997347`*^9}, {
   3.869285765741576*^9, 3.8692857744542828`*^9}, 3.869292761509263*^9, 
   3.869295959470067*^9, 3.86930564242109*^9, 3.869309826050383*^9, 
   3.86955526593585*^9},
 CellLabel->
  "Out[533]=",ExpressionUUID->"3471034d-4015-472f-b97f-064676c391f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox[
    RowBox[{"\[IndentingNewLine]", "aresNum"}], "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ResNewMXold", ".", "Y"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Y", "\[Rule]", 
         RowBox[{
          RowBox[{"a", " ", "M"}], "+", "uY", "+", 
          RowBox[{"b", " ", "W"}]}]}], ",", 
        RowBox[{"W", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"X", "-", "uX", "-", 
            RowBox[{"g", "*", "uV"}]}], ")"}], "/", "d"}]}], ",", 
        RowBox[{"V", "->", "uV"}]}], "}"}]}], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"V", ".", "V"}], ",", 
              RowBox[{"V", ".", "X"}], ",", 
              RowBox[{"V", ".", "M"}], ",", 
              RowBox[{"X", ".", "V"}], ",", 
              RowBox[{"X", ".", "X"}], ",", 
              RowBox[{"X", ".", "M"}], ",", 
              RowBox[{"M", ".", "V"}], ",", 
              RowBox[{"M", ".", "X"}], ",", 
              RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
           
           RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
              ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], 
      "&"}]}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresNum", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox[
      RowBox[{"aresNum", "\[IndentingNewLine]"}], "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresNum", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox[
      RowBox[{"aresNum", "\[IndentingNewLine]"}], "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", "->", 
        RowBox[{
         RowBox[{"c", "*", "X"}], "+", "uM", "+", 
         RowBox[{"\[Epsilon]", "*", "uW"}]}]}], ",", 
       RowBox[{"X", "->", 
        RowBox[{
         RowBox[{"g", "*", "uV"}], "+", 
         RowBox[{"d", "*", "uW"}], "+", "uX"}]}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["aresNum", "^"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{
       OverscriptBox["aresNum", "^"], ",", 
       RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
             ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
       RowBox[{
        RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresNum", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{
      OverscriptBox["aresNum", "^"], ",", 
      RowBox[{"Assumptions", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], ",", 
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "\[Epsilon]", 
            ",", "g"}], "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uY", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uY", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uX"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uV", ".", "uW"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uY"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uM"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uV"}], "->", "0"}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uX"}], "->", "0"}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["aresNum", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"uV", ".", "uV"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uV"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uW", ".", "uW"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uW"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uX", ".", "uX"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uX"], "2"]}], ",", 
      RowBox[{
       RowBox[{"uM", ".", "uM"}], "->", 
       SuperscriptBox[
        SubscriptBox["\[Sigma]", "uM"], "2"]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aresNum", "^"], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    OverscriptBox["aresNum", "^"], ",", "a"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.869228237518065*^9, 3.869228669324094*^9}, 
   3.869228718749824*^9, {3.869228749084634*^9, 3.869228825631928*^9}, {
   3.869283803264785*^9, 3.869283823492714*^9}, {3.869283880302532*^9, 
   3.869283883039679*^9}, {3.8692839258878937`*^9, 3.8692840053885612`*^9}, {
   3.869559202776163*^9, 3.869559215589676*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"16d6ea4a-f451-4daf-9bba-bcc5871a8788"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", 
    SubsuperscriptBox["\[Sigma]", "uV", "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uM"}]}], "+", 
    RowBox[{"a", " ", "c", " ", "g", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uV"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"a", " ", "c", " ", "d", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"a", " ", "\[Epsilon]", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uW"}]}], "+", 
    RowBox[{"a", " ", "c", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uX"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uV", "2"]}], ")"}], ".", "uY"}], "+", 
    RowBox[{"a", " ", "d", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "4"]}], "+", 
    RowBox[{"c", " ", 
     SubsuperscriptBox["\[Sigma]", "uV", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "d"}], "+", "\[Epsilon]"}], ")"}]}]}], ")"}], 
        " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.8695592293526154`*^9},
 CellLabel->
  "Out[759]=",ExpressionUUID->"cb18e0c9-3905-43dc-ace3-72dec3a800b2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "d"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"a", " ", "c", " ", 
     SuperscriptBox["g", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c"}], " ", "d"}], "+", "\[Epsilon]"}], ")"}], " ", 
     RowBox[{"uV", ".", "uV"}]}], "+", 
    RowBox[{"a", " ", "d", " ", 
     SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", 
        SuperscriptBox["g", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uV", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"a", " ", "c", " ", "d"}], "+", 
          RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.8695592293971*^9},
 CellLabel->
  "Out[760]=",ExpressionUUID->"4fed43b7-8bff-4795-a8ef-452cd9e6e049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"a", " ", "c", " ", "d"}], "+", 
     RowBox[{"a", " ", "\[Epsilon]"}]}], ")"}], " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  FractionBox[
   RowBox[{"a", " ", "c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
    SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.869559229437874*^9},
 CellLabel->
  "Out[761]=",ExpressionUUID->"5d126677-686e-42fb-9036-0a568c1cda3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", " ", "c", " ", "d", " ", 
   SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], " ", 
      SuperscriptBox["d", "2"], " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     RowBox[{"c", " ", "d", " ", "\[Epsilon]", " ", 
      SubsuperscriptBox["\[Sigma]", "uW", "2"]}], "+", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "d"}], "-", "\[Epsilon]"}], ")"}], " ", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "d"]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.869284015020398*^9, 3.869292771125825*^9, 
  3.8692959802327967`*^9, 3.869305643164631*^9, 3.86930982681958*^9, 
  3.869555269272953*^9, 3.869559229441852*^9},
 CellLabel->
  "Out[762]=",ExpressionUUID->"b4581d40-e340-4f85-bc7b-99a00b1e3207"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "a", "}"}], ",", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dynamic", "@", 
       RowBox[{"Plot", "[", 
        RowBox[{"aresBiasNum", ",", 
         RowBox[{"{", 
          RowBox[{"e", ",", "0", ",", "5"}], "}"}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ",", 
      RowBox[{"Slider", "[", 
       RowBox[{
        RowBox[{"Dynamic", "@", "d"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "5"}], "}"}], ",", "Label"}], "]"}]}], "}"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.869559659278062*^9},
 CellLabel->
  "In[2752]:=",ExpressionUUID->"071894b5-67fb-4cc5-9650-d4fb346b2d3d"],

Cell[BoxData[
 DynamicModuleBox[{$CellContext`a$$}, 
  TagBox[GridBox[{
     {
      DynamicBox[ToBoxes[
        Plot[$CellContext`aresBiasNum, {$CellContext`e, 0, 5}, 
         PlotRange -> {All, {-3, 3}}], StandardForm],
       ImageSizeCache->{180., {56., 60.58812949121591}}]},
     {
      RowBox[{"Slider", "[", 
       RowBox[{
        DynamicBox[ToBoxes[$CellContext`d, StandardForm],
         ImageSizeCache->{7.640625, {1., 9.}}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "5"}], "}"}], ",", "Label"}], "]"}]}
    },
    DefaultBaseStyle->"Column",
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Column"],
  DynamicModuleValues:>{}]], "Output",
 CellChangeTimes->{3.8693056431929083`*^9, 3.869309826864869*^9},
 CellLabel->
  "Out[2752]=",ExpressionUUID->"92eb4e1c-0de2-42e4-81b2-72c06fd16ff8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"aresBias", "=", 
     RowBox[{
      OverscriptBox[
       RowBox[{"(", "aresNum"}], "^"], "/", 
      OverscriptBox["aresDen", "^"]}]}], ")"}], "-", "a"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aresBiasNum", "[", 
   RowBox[{"d_", ",", "e_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"aresBias", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", "->", "1"}], ",", 
      RowBox[{"c", "->", "1"}], ",", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
      RowBox[{
       SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], "}"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"aresBiasNum", "[", 
  RowBox[{"d", ",", "e"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"aresBiasNum", "[", 
  RowBox[{"0.5", ",", "1.499"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"aresBiasNum", "[", 
      RowBox[{"d", ",", "e"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"e", ",", "0", ",", "5"}], "}"}], ",", 
     RowBox[{"PlotRange", "->", 
      RowBox[{"{", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "0", ",", "5", ",", 
     RowBox[{
      RowBox[{"Labeled", "[", 
       RowBox[{
        RowBox[{"Panel", "@", 
         RowBox[{"Column", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Slider", "[", 
              RowBox[{"##", ",", 
               RowBox[{"ImageSize", "->", "250"}]}], "]"}], ",", 
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"Axes", "->", 
                RowBox[{"{", 
                 RowBox[{"True", ",", "False"}], "}"}]}], ",", 
               RowBox[{"Ticks", "->", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Subdivide", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"##", "&"}], "@@", "#2"}], ",", "5"}], "]"}], ",",
                   "None"}], "}"}]}], ",", 
               RowBox[{"ImageSize", "->", "250"}], ",", 
               RowBox[{"PlotRange", "->", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", ".05"}], "}"}]}], "}"}]}]}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"Alignment", "->", "Center"}], ",", 
           RowBox[{"Spacings", "->", "0"}]}], "]"}]}], ",", "#", ",", 
        "Right"}], "]"}], "&"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"2", " ", "d"}], "-", "e", "+", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"d", "+", "e"}], ")"}]}]}], "==", "0"}], ",", "e"}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQvc+A6YnQlTeOwte63oLoxpdtvSJAuqj3/WwQrbz+
50IQvT85cT2IPiO+dTOI9qn8vAVEr170aAeIvqchvhNEs532OAqi806XngTR
nEHN4qJAuuraHWUQPUlIyQJE/zjwEkz3nHO9CaIzGzrvgujIrJT3IHq36++P
IDrg890fIHqK/O5fINrEcB6LGJD+EBPEDqIDp8r7guhHdjb+INpjhtZUEH3h
jdwMEN22+tAiEC135+ASEJ335uxqEC2ZemgjiH6eNHEfiJ7Ym38IRJ+q33UW
RM9Z6HkORJ9d18snDqQ3XTovAqIrLlv7gOitta98QbTub7ZmCVB41AWCaQDM
1rTz
  "],
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[2753]:=",ExpressionUUID->"967bda4d-c983-4045-a579-06653842344f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["slopeMuM", "^"], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ResNewMX", ".", "M"}], 
     RowBox[{"ResNewMX", ".", "ResNewMX"}]], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
         "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["slopeMuM", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["slopeMuM", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["slopeMuM", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["slopeMuM", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864278394079479*^9, 3.8642784241601048`*^9}, {
   3.864278469936257*^9, 3.864278516033436*^9}, {3.864278604776476*^9, 
   3.864278611232209*^9}, {3.864278658886808*^9, 3.864278877257143*^9}, {
   3.864278926789817*^9, 3.864279022967366*^9}, {3.8642790573376713`*^9, 
   3.864279122893236*^9}, {3.8642791587940397`*^9, 3.86427916301928*^9}, {
   3.864279217599661*^9, 3.864279268895347*^9}, {3.86922770573629*^9, 
   3.869227758046924*^9}, 3.869227846459057*^9},
 CellLabel->
  "In[2753]:=",ExpressionUUID->"66056d32-6822-493a-8e65-02f22ae2b7ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "M"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "X"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}]}], "+", 
       RowBox[{"e", " ", 
        RowBox[{"V", ".", "X"}]}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.869309826991728*^9},
 CellLabel->
  "Out[2753]=",ExpressionUUID->"efa0795a-5081-4a27-867d-4844ef8e16d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "M"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.869309827004174*^9},
 CellLabel->
  "Out[2754]=",ExpressionUUID->"9464453f-f03d-4777-9358-ca1f40b177d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}]}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.8693098270109158`*^9},
 CellLabel->
  "Out[2755]=",ExpressionUUID->"e03294ad-c1ed-47d5-8386-74b79b8ece7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"M", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{{3.864278412584866*^9, 3.8642784312586737`*^9}, {
   3.864278471851527*^9, 3.864278516403981*^9}, 3.864278613843285*^9, {
   3.864278669857293*^9, 3.864278773010984*^9}, {3.8642788128613377`*^9, 
   3.864278877907493*^9}, 3.864278933043643*^9, {3.864279000477108*^9, 
   3.86427902330916*^9}, {3.864279058224163*^9, 3.8642791232475452`*^9}, 
   3.864279163575622*^9, {3.864279214316328*^9, 3.864279218119775*^9}, {
   3.864279248650549*^9, 3.864279269756124*^9}, 3.864875748848443*^9, 
   3.867905730172083*^9, 3.8691144380625668`*^9, 3.86922659339507*^9, 
   3.869292771397852*^9, 3.869305643317734*^9, 3.869309827015757*^9},
 CellLabel->
  "Out[2756]=",ExpressionUUID->"1c9fbdf8-e0ae-4ed0-80e4-59ef6f19e7c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["slopeYuM", "^"], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ResNewMX", ".", "Y"}], 
     RowBox[{"ResNewMX", ".", "ResNewMX"}]], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
         "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["slopeYuM", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["slopeYuM", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Numerator", "[", 
   OverscriptBox["slopeYuM", "^"], "]"}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Denominator", "[", 
   OverscriptBox["slopeYuM", "^"], "]"}], "//", "ExpandAll"}]}], "Input",
 CellChangeTimes->{{3.864279199372098*^9, 3.864279212567052*^9}},
 CellLabel->
  "In[2757]:=",ExpressionUUID->"b739845a-3464-4bd5-8be4-716148667215"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "Y"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "Y"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "Y"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", "X"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"V", ".", "M"}]}], "+", 
       RowBox[{"e", " ", 
        RowBox[{"V", ".", "X"}]}]}], ")"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827096087*^9},
 CellLabel->
  "Out[2757]=",ExpressionUUID->"1b07de9e-c598-46e6-8c0d-9ecd7e111fec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"M", ".", "Y"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
      RowBox[{"d", " ", 
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "Y"}]}], "-", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"X", ".", "Y"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"M", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"M", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}]}], "-", 
    RowBox[{"d", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
    RowBox[{"e", " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"X", ".", 
      RowBox[{"(", 
       RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{"2", " ", "d", " ", "e", " ", 
     RowBox[{"V", ".", "M"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     SuperscriptBox["e", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827103979*^9},
 CellLabel->
  "Out[2758]=",ExpressionUUID->"81de73a7-41f6-480c-b977-3ca6711f0b95"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "Y"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}], "-", 
  RowBox[{"d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "Y"}]}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827110302*^9},
 CellLabel->
  "Out[2759]=",ExpressionUUID->"7b03c0e0-a962-49ed-ace8-1248fefbbd90"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"M", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"M", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "X"}]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}]}], "-", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "-", 
  RowBox[{"e", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{"2", " ", "d", " ", "e", " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{
   SuperscriptBox["e", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}]}]}]], "Output",
 CellChangeTimes->{3.864279222264102*^9, 3.864875749770503*^9, 
  3.867905732160054*^9, 3.86911443901968*^9, 3.869226594774046*^9, 
  3.869292771472213*^9, 3.869305643420545*^9, 3.869309827114697*^9},
 CellLabel->
  "Out[2760]=",ExpressionUUID->"5a8f92ed-ea09-4973-83cd-85901d65fb41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["numslopeYuM", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeYuM", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["numslopeMuM", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeMuM", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aNewIV", "^"], "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeYuM", "^"], "/", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}], "/", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeMuM", "^"], "/", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8642792905835943`*^9, 3.864279328512782*^9}, {
  3.864279393545319*^9, 3.8642794356395206`*^9}, {3.8642795434241333`*^9, 
  3.864279632612693*^9}, {3.864279689694309*^9, 3.8642796911241703`*^9}},
 CellLabel->
  "In[2761]:=",ExpressionUUID->"a44683be-e67c-468a-bf8b-e108432cd1a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "Y"}], " ", 
      RowBox[{"V", ".", "V"}]}], "-", 
     RowBox[{"e", " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
   3.8642796916854773`*^9, 3.8648757498134413`*^9, 3.867905732258651*^9, 
   3.8691144390497503`*^9, 3.8692265948242083`*^9, 3.869292771508428*^9, 
   3.869305643467147*^9, 3.869309827127482*^9},
 CellLabel->
  "Out[2761]=",ExpressionUUID->"b67f4613-a52d-4187-be45-a3f91c67f0f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "-", 
  RowBox[{
   SuperscriptBox["d", "2"], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   RowBox[{"V", ".", "X"}], " ", 
   RowBox[{"X", ".", "M"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}]}], "-", 
     RowBox[{"e", " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
   3.8642796916854773`*^9, 3.8648757498134413`*^9, 3.867905732258651*^9, 
   3.8691144390497503`*^9, 3.8692265948242083`*^9, 3.869292771508428*^9, 
   3.869305643467147*^9, 3.869309827133737*^9},
 CellLabel->
  "Out[2762]=",ExpressionUUID->"9177009b-750c-40f5-9152-5a676fe17c3b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "d"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"e", " ", "V"}], ")"}], ".", "Y"}]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"V", ".", "M"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
    RowBox[{"X", ".", "Y"}]}], "+", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"M", ".", "Y"}], " ", 
       RowBox[{"V", ".", "V"}]}], "+", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "d"}], " ", 
    RowBox[{"V", ".", "V"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"e", " ", "V"}], ")"}], ".", "M"}]}], "+", 
   RowBox[{
    SuperscriptBox["d", "2"], " ", 
    RowBox[{"V", ".", "M"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
    RowBox[{"X", ".", "M"}]}], "+", 
   RowBox[{"d", " ", 
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"V", ".", "X"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}]}], "+", 
      RowBox[{"e", " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"X", ".", "M"}]}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
   3.8642796916854773`*^9, 3.8648757498134413`*^9, 3.867905732258651*^9, 
   3.8691144390497503`*^9, 3.8692265948242083`*^9, 3.869292771508428*^9, 
   3.869305643467147*^9, 3.869309827138432*^9},
 CellLabel->
  "Out[2763]=",ExpressionUUID->"816dd44a-d7ca-4555-9082-232a34fbda4a"]
}, Open  ]],

Cell[TextData[{
 "The above estimator for a can be written in the more manifestly-symmetric \
form, where it is clear that the denominator is simply the numerator /. {Y\
\[Rule]M}:\n",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "Y"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "Y"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "Y"}]}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "M"}]}], "-", 
       RowBox[{"2", "  ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "M"}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], 
     RowBox[{"X", ".", "M"}]}]}]]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
    3.8642796916891403`*^9},ExpressionUUID->
  "37bf0558-9448-4868-b175-578fc2f74609"],
 "\n\nAnother approach is possible, where instead of retrieving ",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Epsilon]", "d"], TraditionalForm]],ExpressionUUID->
  "bb47589f-9d47-4c53-99c8-dd4b9b37ea6a"],
 "from the difference between the IV estimator on C and the backdoor \
estimator on ",
 Cell[BoxData[
  FormBox[
   RowBox[{"C", "+", 
    FractionBox["\[Epsilon]", "d"]}], TraditionalForm]],ExpressionUUID->
  "dac23684-101b-4b60-8ce5-d4ebf425ce0f"],
 ", we extract ",
 Cell[BoxData[
  FormBox[
   FractionBox["\[Epsilon]", "d"], TraditionalForm]],ExpressionUUID->
  "3da8f44a-f44e-47a0-80d8-509e14095e0d"],
 " from the following ratio of residuals:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"(", 
      FractionBox["\[Epsilon]", "d"], ")"}], "^"], "=", 
    FractionBox[
     RowBox[{"m", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"m", ".", "v"}], 
        RowBox[{"x", ".", "v"}]], "x"}]}], 
     RowBox[{"x", "-", 
      RowBox[{
       FractionBox[
        RowBox[{"x", ".", "v"}], 
        RowBox[{"v", ".", "v"}]], "v"}]}]]}], TraditionalForm]],
  ExpressionUUID->"af6f0548-b29d-4a06-be71-f2a200021b03"],
 "\nWe have been a bit notationally irresponsible here, as we are dividing \
two vectors which are not exactly parallel, due to the noise terms ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "m"], TraditionalForm]],ExpressionUUID->
  "efe0d5d2-f4ea-420c-a6de-fcd629bf9006"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "x"], TraditionalForm]],ExpressionUUID->
  "fb0f21bb-7b4e-4719-b0df-00627c592e77"],
 ". On the average they should be parallel, so we take the estimator to be \
the ratio of magnitudes:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     RowBox[{"(", 
      FractionBox["\[Epsilon]", "d"], ")"}], "^"], "=", 
    FractionBox[
     RowBox[{"|", 
      RowBox[{"m", "-", 
       RowBox[{
        FractionBox[
         RowBox[{"m", ".", "v"}], 
         RowBox[{"x", ".", "v"}]], "x"}]}], "|"}], 
     RowBox[{"|", 
      RowBox[{"x", "-", 
       RowBox[{
        FractionBox[
         RowBox[{"x", ".", "v"}], 
         RowBox[{"v", ".", "v"}]], "v"}]}], "|"}]]}], TraditionalForm]],
  ExpressionUUID->"97f2d984-c6f9-4bec-918a-bfb552fbdcbb"],
 "\nMore specifically,"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864277835972797*^9, 3.864277881807207*^9}, {3.864279907170121*^9, 
   3.864279923541842*^9}, {3.864279984138883*^9, 3.8642800687863827`*^9}, {
   3.864280189326881*^9, 3.864280312462824*^9}, {3.864280443371169*^9, 
   3.864280489310554*^9}, {3.864282903581594*^9, 3.864282985099619*^9}, {
   3.864283056642858*^9, 
   3.864283143114409*^9}},ExpressionUUID->"12a74f15-0741-4e8b-869b-\
0870e85db117"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["edivd2", "^"], "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ResMX", ".", "ResMX"}], 
     RowBox[{"ResXV", ".", "ResXV"}]], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", ".", "V"}], ",", 
            RowBox[{"V", ".", "X"}], ",", 
            RowBox[{"V", ".", "M"}], ",", 
            RowBox[{"X", ".", "V"}], ",", 
            RowBox[{"X", ".", "X"}], ",", 
            RowBox[{"X", ".", "M"}], ",", 
            RowBox[{"M", ".", "V"}], ",", 
            RowBox[{"M", ".", "X"}], ",", 
            RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
         "}"}]}]}], "]"}], "&"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["edivd2", "^"], "=", 
  RowBox[{
   RowBox[{
    OverscriptBox["edivd2", "^"], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"X", ".", "V"}], "->", 
       RowBox[{"V", ".", "X"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "V"}], "->", 
       RowBox[{"V", ".", "M"}]}], ",", 
      RowBox[{
       RowBox[{"M", ".", "X"}], "->", 
       RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.864283157759853*^9, 3.864283170659472*^9}, {
  3.864283289611043*^9, 3.8642833692568007`*^9}},
 CellLabel->
  "In[2764]:=",ExpressionUUID->"c5935310-3934-4087-a636-20d99a7261a4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"V", ".", "V"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "X"}], " ", 
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"V", ".", "X"}], " ", 
         RowBox[{"X", ".", "M"}]}], "-", 
        RowBox[{
         RowBox[{"V", ".", "M"}], " ", 
         RowBox[{"X", ".", "X"}]}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", ".", "X"}], " ", 
      RowBox[{"X", ".", "V"}]}], "-", 
     RowBox[{
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "X"}]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.864283285581399*^9, 3.864283313877812*^9}, {
   3.864283344728586*^9, 3.864283369802348*^9}, 3.864875749851974*^9, 
   3.867905732376409*^9, 3.869114439087323*^9, 3.8692265948884697`*^9, 
   3.8692927715376167`*^9, 3.869305643506974*^9, 3.869309827161181*^9},
 CellLabel->
  "Out[2764]=",ExpressionUUID->"8d4c42a2-040b-4a8b-9e11-020ba6b1999a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"V", ".", "V"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"V", ".", "X"}], " ", 
          RowBox[{"X", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"V", ".", "M"}], " ", 
          RowBox[{"X", ".", "X"}]}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
    RowBox[{
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.864283285581399*^9, 3.864283313877812*^9}, {
   3.864283344728586*^9, 3.864283369802348*^9}, 3.864875749851974*^9, 
   3.867905732376409*^9, 3.869114439087323*^9, 3.8692265948884697`*^9, 
   3.8692927715376167`*^9, 3.869305643506974*^9, 3.869309827167304*^9},
 CellLabel->
  "Out[2765]=",ExpressionUUID->"58b5889a-de41-4f21-8839-3ac08b8ba101"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ResNewMX2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ResMV", "-", 
     RowBox[{
      OverscriptBox["edivd2", "^"], "*", "ResXV"}]}], "//", "Simplify"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", "M", ",", "V"}], "}"}]}], "]"}], "&"}]}]}]], "Input",\

 CellChangeTimes->{{3.864283472655937*^9, 3.864283531345242*^9}},
 CellLabel->
  "In[2766]:=",ExpressionUUID->"f81c1cc0-1833-470e-8c67-d924fd4cccd4"],

Cell[BoxData[
 RowBox[{"M", "+", 
  RowBox[{"X", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "V"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"V", ".", "X"}], " ", 
          RowBox[{"X", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"V", ".", "M"}], " ", 
          RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]]}], ")"}]}], "+", 
  RowBox[{"V", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"V", ".", "M"}], 
       RowBox[{"V", ".", "V"}]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"M", ".", "M"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "3"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"V", ".", "M"}], " ", 
       RowBox[{"V", ".", "X"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"V", ".", "X"}], " ", 
          RowBox[{"X", ".", "M"}]}], "+", 
         RowBox[{
          RowBox[{"V", ".", "M"}], " ", 
          RowBox[{"X", ".", "X"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "4"], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
        RowBox[{"X", ".", "X"}]}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8642834736480427`*^9, 3.864283533490588*^9}, 
   3.8648757498676147`*^9, 3.8679057324238167`*^9, 3.869114439102861*^9, 
   3.8692265949158783`*^9, 3.8692927715581017`*^9, 3.86930564352952*^9, 
   3.869309827184998*^9},
 CellLabel->
  "Out[2766]=",ExpressionUUID->"ebfbb3f8-ae7e-46b5-b4a9-9c4e8c206cde"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["slopeMuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ResNewMX2", ".", "M"}], 
      RowBox[{"ResNewMX2", ".", "ResNewMX2"}]], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
          "}"}]}]}], "]"}], "&"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["slopeMuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["slopeMuM2", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeMuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Denominator", "[", 
    OverscriptBox["slopeMuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8642835370342693`*^9, 3.864283585038824*^9}},
 CellLabel->
  "In[2767]:=",ExpressionUUID->"9828bfa3-0977-4444-bd35-bc73b06e98db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   OverscriptBox["slopeYuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"ResNewMX2", ".", "Y"}], 
      RowBox[{"ResNewMX2", ".", "ResNewMX2"}]], "//", 
     RowBox[{
      RowBox[{"TensorExpand", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"V", ".", "V"}], ",", 
             RowBox[{"V", ".", "X"}], ",", 
             RowBox[{"V", ".", "M"}], ",", 
             RowBox[{"X", ".", "V"}], ",", 
             RowBox[{"X", ".", "X"}], ",", 
             RowBox[{"X", ".", "M"}], ",", 
             RowBox[{"M", ".", "V"}], ",", 
             RowBox[{"M", ".", "X"}], ",", 
             RowBox[{"M", ".", "M"}]}], "}"}], "\[Element]", "Reals"}], 
          "}"}]}]}], "]"}], "&"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["slopeYuM2", "^"], "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["slopeYuM2", "^"], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"X", ".", "V"}], "->", 
        RowBox[{"V", ".", "X"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "V"}], "->", 
        RowBox[{"V", ".", "M"}]}], ",", 
       RowBox[{
        RowBox[{"M", ".", "X"}], "->", 
        RowBox[{"X", ".", "M"}]}]}], "}"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeYuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Denominator", "[", 
    OverscriptBox["slopeYuM2", "^"], "]"}], "//", "ExpandAll"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.864279199372098*^9, 3.864279212567052*^9}, {
  3.864283600777308*^9, 3.864283611095649*^9}, {3.864283645815322*^9, 
  3.8642836522943*^9}},
 CellLabel->
  "In[2771]:=",ExpressionUUID->"88f72eea-055d-4981-b90c-ee305f2a9f81"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  OverscriptBox["numslopeYuM2", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeYuM2", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["numslopeMuM2", "^"], "=", 
  RowBox[{
   RowBox[{"Numerator", "[", 
    OverscriptBox["slopeMuM2", "^"], "]"}], "//", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"V", ".", "X"}], "}"}]}], "]"}], 
    "&"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  OverscriptBox["aNewIV2", "^"], "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeYuM2", "^"], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}], "/", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       OverscriptBox["numslopeMuM2", "^"], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "X"}], ")"}], "2"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"V", ".", "X"}], "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8642792905835943`*^9, 3.864279328512782*^9}, {
  3.864279393545319*^9, 3.8642794356395206`*^9}, {3.8642795434241333`*^9, 
  3.864279632612693*^9}, {3.864279689694309*^9, 3.8642796911241703`*^9}, {
  3.864283662645979*^9, 3.8642836992045937`*^9}, {3.864283838022381*^9, 
  3.8642838524903297`*^9}},
 CellLabel->
  "In[2775]:=",ExpressionUUID->"3e24f080-d62c-4151-8083-9834548ff792"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "5"], " ", 
   RowBox[{"V", ".", "Y"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "6"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"M", ".", "Y"}]}], " ", 
      RowBox[{"V", ".", "V"}]}], "+", 
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "Y"}]}]}], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "X"}], " ", 
   RowBox[{"X", ".", "Y"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "Y"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      RowBox[{"X", ".", "X"}]}], "-", 
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"V", ".", "Y"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{"X", ".", "X"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"V", ".", "M"}], " ", 
      RowBox[{"V", ".", "Y"}], " ", 
      RowBox[{"X", ".", "X"}]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "M"}], " ", 
      RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.864283701293281*^9, 3.8642837094336243`*^9}, {
   3.8642838453279123`*^9, 3.864283852977318*^9}, 3.864875774260747*^9, 
   3.867905783145464*^9, 3.869114465031118*^9, 3.869226632262288*^9, 
   3.869292772269948*^9, 3.869305644159102*^9, 3.869309827828842*^9},
 CellLabel->
  "Out[2775]=",ExpressionUUID->"d47a7e83-2f2c-4242-8715-59c8af865d03"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", ".", "M"}], " ", 
   RowBox[{"V", ".", "M"}], " ", 
   RowBox[{"V", ".", "V"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "5"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], "-", 
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      RowBox[{"V", ".", "V"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "6"]}], "-", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
   RowBox[{"X", ".", "M"}], " ", 
   RowBox[{"X", ".", "X"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"V", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", ".", "M"}], ")"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "M"}], ")"}], "3"], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"X", ".", "X"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"M", ".", "M"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{"X", ".", "X"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
      RowBox[{"V", ".", "V"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"X", ".", "M"}]}], "+", 
        RowBox[{"X", ".", "X"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.864283701293281*^9, 3.8642837094336243`*^9}, {
   3.8642838453279123`*^9, 3.864283852977318*^9}, 3.864875774260747*^9, 
   3.867905783145464*^9, 3.869114465031118*^9, 3.869226632262288*^9, 
   3.869292772269948*^9, 3.869305644159102*^9, 3.869309827834365*^9},
 CellLabel->
  "Out[2776]=",ExpressionUUID->"9774c946-0aab-4d5a-919f-1cd5b7647434"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"], " ", 
     RowBox[{"V", ".", "Y"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"M", ".", "Y"}]}], " ", 
        RowBox[{"V", ".", "V"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}]}]}], ")"}]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"X", ".", "Y"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}], " ", 
        RowBox[{"X", ".", "X"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"V", ".", "M"}]}], " ", 
        RowBox[{"V", ".", "Y"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{"X", ".", "X"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"M", ".", "Y"}], " ", 
           RowBox[{"X", ".", "X"}]}], "-", 
          RowBox[{
           RowBox[{"M", ".", "M"}], " ", 
           RowBox[{"X", ".", "Y"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"M", ".", "M"}], " ", 
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "3"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"V", ".", "M"}], ")"}], "2"], "-", 
       RowBox[{
        RowBox[{"M", ".", "M"}], " ", 
        RowBox[{"V", ".", "V"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "4"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"V", ".", "M"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "M"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "3"], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"M", ".", "M"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "V"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{"X", ".", "X"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "2"], " ", 
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"X", ".", "M"}]}], "+", 
          RowBox[{"X", ".", "X"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.864283701293281*^9, 3.8642837094336243`*^9}, {
   3.8642838453279123`*^9, 3.864283852977318*^9}, 3.864875774260747*^9, 
   3.867905783145464*^9, 3.869114465031118*^9, 3.869226632262288*^9, 
   3.869292772269948*^9, 3.869305644159102*^9, 3.869309827847776*^9},
 CellLabel->
  "Out[2777]=",ExpressionUUID->"c2e0e5cd-23cd-43ec-bd73-a712a1558686"]
}, Open  ]],

Cell[TextData[{
 "The above estimator for a can be written in the more manifestly-symmetric \
form, where it is clear that the denominator is simply the numerator /. {Y\
\[Rule]M}:\n",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "Y"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "Y"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"V", ".", "M"}], " ", 
        RowBox[{"V", ".", "Y"}]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], " ", 
        RowBox[{"X", ".", "M"}], " ", 
        RowBox[{"X", ".", "Y"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "Y"}]}]}], 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"V", ".", "X"}], ")"}], "2"], " ", 
     RowBox[{"X", ".", "M"}], " ", 
     RowBox[{"X", ".", "X"}], " ", 
     RowBox[{"V", ".", "M"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "X"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        RowBox[{"M", ".", "M"}]}], "-", 
       RowBox[{"2", "  ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "X"}], ")"}], "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"V", ".", "M"}], ")"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"V", ".", "V"}], " ", 
        RowBox[{"X", ".", "X"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"X", ".", "M"}], ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"V", ".", "M"}], " ", 
     RowBox[{"V", ".", "V"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"X", ".", "X"}], ")"}], "2"], 
     RowBox[{"X", ".", "M"}]}]}]]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False,
  CellChangeTimes->{{3.86427958771953*^9, 3.8642796331418056`*^9}, 
    3.8642796916891403`*^9},ExpressionUUID->
  "d76f8308-9c7b-4bac-bfa0-dabe9438267a"],
 "\n"
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.846916868982522*^9, 3.846916884786528*^9}, {
   3.84691694183624*^9, 3.846916996397909*^9}, {3.846917094442889*^9, 
   3.846917248843841*^9}, {3.846917301566489*^9, 3.8469175337701902`*^9}, {
   3.846918016707902*^9, 3.846918054148787*^9}, {3.846918148709256*^9, 
   3.846918336761574*^9}, {3.846918377196795*^9, 3.8469183786983833`*^9}, {
   3.847093248630694*^9, 3.847093251976536*^9}, {3.847094110935411*^9, 
   3.8470941673935137`*^9}, {3.8470942036683607`*^9, 
   3.8470942101372538`*^9}, {3.847094270158161*^9, 3.847094405558654*^9}, {
   3.847094449637689*^9, 3.847094667024261*^9}, {3.847094701356984*^9, 
   3.8470947995015993`*^9}, {3.8473720433904867`*^9, 3.84737206294444*^9}, {
   3.84737558878714*^9, 3.8473756038821774`*^9}, {3.848246023772875*^9, 
   3.8482460962992563`*^9}, {3.848246157855905*^9, 3.8482462124882803`*^9}, {
   3.8482462673282537`*^9, 3.848246398168128*^9}, 3.848298317791585*^9, {
   3.8483011812736483`*^9, 3.848301182178994*^9}, 3.8510946902949*^9, 
   3.85227536693225*^9, 3.854785028889073*^9, {3.858318675843993*^9, 
   3.858318770039344*^9}, {3.858318804049596*^9, 3.858318808844802*^9}, {
   3.8583188407264433`*^9, 3.858318986803553*^9}, {3.858319108204403*^9, 
   3.8583191576284847`*^9}, {3.858319457428093*^9, 3.858319556629036*^9}, {
   3.858319629432349*^9, 3.858319687821444*^9}, {3.858319781209342*^9, 
   3.858319784033386*^9}, {3.8583198516334543`*^9, 3.858319938607057*^9}, {
   3.858320031323155*^9, 3.858320429207632*^9}, {3.858320531624117*^9, 
   3.858320568140841*^9}, {3.8583220237994633`*^9, 3.858322092552417*^9}, {
   3.8583222152520523`*^9, 3.858322220190248*^9}, {3.858322350811582*^9, 
   3.85832235434687*^9}, {3.85832238582378*^9, 3.85832244634864*^9}, {
   3.858322481021699*^9, 3.858322513924449*^9}, {3.858322596656805*^9, 
   3.858322651009452*^9}, {3.858323017781777*^9, 3.858323045328596*^9}, {
   3.858323142722087*^9, 3.858323146909768*^9}, 3.858323380073144*^9, {
   3.858323793042741*^9, 3.85832381410446*^9}, {3.858323932274179*^9, 
   3.858324051284658*^9}, {3.858324166249299*^9, 3.858324166334305*^9}, {
   3.858324393399301*^9, 3.858324393946802*^9}, {3.8583251091159363`*^9, 
   3.858325109183071*^9}, {3.8583253728059397`*^9, 3.858325388127117*^9}, {
   3.864277835972797*^9, 3.864277881807207*^9}, {3.864279907170121*^9, 
   3.864279923541842*^9}, {3.864279984138883*^9, 3.8642800687863827`*^9}, {
   3.864280189326881*^9, 3.864280312462824*^9}, {3.864280443371169*^9, 
   3.864280489310554*^9}, {3.864282903581594*^9, 3.864282985099619*^9}, {
   3.864283056642858*^9, 3.864283143114409*^9}, {3.864283813848689*^9, 
   3.864283814536786*^9}},ExpressionUUID->"0775221e-d233-460c-b961-\
077cb2c7ad19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"structureEqs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Y", "\[Rule]", 
      RowBox[{
       RowBox[{"a", "*", "M"}], "+", 
       RowBox[{"b", "*", "W"}], "+", "uY"}]}], ",", 
     RowBox[{"W", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"M", "-", "uM"}], ")"}], "/", "d"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aerror", "=", 
   RowBox[{
    RowBox[{
     OverscriptBox["aIV", "^"], "-", "a"}], "//.", "structureEqs"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy00og3EAx/ERaV6WFdpGK2W2y7BZIyGPlHnbDMVMeU9essMKeW+NvOyA
RBZ2Uo6WaeU1HBhLEnIRloOXJ4ksQ/j/nsO3z+kbW2coafRnsVhCEmzoWfdK
d2hKMR36CdW8Vv8EYpfylXFxScuFloipKNhvShHDMlWYBHJ87XL48xepgCF7
mWnQ0zJLMb+mvAA+Ct40cN+Yv5pELJp8dkA6/GoLppq/D6DZaD2BZ3Hvl1BR
r/TCpl/XL7watwXKiMGuM8ZM3TEbbii1HGgduYiAE5V+fPhaVS2DPZ+bCqjO
a86GYXf9Kti9RhVCQVBTMazZTh+F+YeJFuh72PHAsfObexgwt/kEl52OF+jI
MLDlxAHZAuObXS6FK4lZjJbkBPbgLk3ZPiK5UFJaEQNFRXohFOhoEaxQ6cXw
NMfbN0QM4c2bYJu7mjdM7KXn+bCzI1o0Q5QnuePh+dfWWOoRTTlrr8fhba5d
oCfqrjei4T95evOh
  "],
 CellLabel->
  "In[2778]:=",ExpressionUUID->"55da7776-2f3b-40bd-807a-009e7fc86135"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphiv", ",", "noisenames", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<X\>\"", ",", "\"\<M\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "=", 
  RowBox[{"aerror", "/.", "condmeanreplace"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"//", 
   RowBox[{
    RowBox[{"TensorExpand", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], "}"}],
           "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.858337872195408*^9, 3.858337927335124*^9}, {
  3.858337963646071*^9, 3.85833798275427*^9}, {3.85954648624118*^9, 
  3.8595464942994537`*^9}, {3.859553243246936*^9, 3.859553368807623*^9}, {
  3.8595565284231462`*^9, 3.859556530677973*^9}, {3.859556574233161*^9, 
  3.8595567303572483`*^9}, {3.859556835663702*^9, 3.8595569170776854`*^9}, {
  3.8595569981818533`*^9, 3.859557165389606*^9}, {3.859557247171241*^9, 
  3.859557261180537*^9}, {3.8595572915063257`*^9, 3.859557340262247*^9}, {
  3.859557410188847*^9, 3.8595574275854483`*^9}, {3.859557488186679*^9, 
  3.859557540445837*^9}, {3.859558717645108*^9, 3.8595587644388323`*^9}, {
  3.859591487317195*^9, 3.8595914873962727`*^9}, {3.860036875020287*^9, 
  3.860036875204605*^9}, {3.864189213309959*^9, 3.864189237505952*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[2780]:=",ExpressionUUID->"f07b01ab-89b3-4846-b8c8-fa4dcecc2ae1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY"}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875774314048*^9, 3.867905783304817*^9, 
   3.869114465083761*^9, 3.8692266323534718`*^9, 3.869292772304901*^9, 
   3.8693056441968517`*^9, 3.86930982787593*^9},
 CellLabel->
  "Out[2781]=",ExpressionUUID->"c5f0b90e-d3df-4fae-b23f-68a5e1866af4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV", " ", "uX"}], "+", 
         SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "-", 
         
         RowBox[{"X", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "M"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"c", " ", "X", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"X", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"uM", "+", 
           RowBox[{"uY", " ", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], "2"]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"2", " ", "uX"}], "+", 
             RowBox[{"2", " ", "uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}]}]}],
    ",", 
   RowBox[{"uM", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "M"}], " ", "uV"}], "+", 
                RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "M", " ", 
              RowBox[{"(", 
               RowBox[{"uX", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"2", " ", "c", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{"uX", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"uY", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M"}], "+", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "M"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{"X", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
            ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
       RowBox[{"g", " ", "uM", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{"M", "-", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "M"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{"X", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"c", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
            ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"uM", "+", 
           RowBox[{"uY", " ", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], "2"]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"2", " ", "uX"}], "+", 
             RowBox[{"2", " ", "uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}]}]}],
    ",", 
   RowBox[{"uY", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", "uY", " ", 
        RowBox[{"(", 
         RowBox[{"M", "-", 
          RowBox[{"c", " ", "X"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"uM", "+", 
          RowBox[{"uY", " ", 
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"M", " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
             RowBox[{"M", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
             RowBox[{"uM", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
             RowBox[{"c", " ", "X", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "uM"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "uV"}], "+", 
                   RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}]}],
             ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "M"}], "+", 
             RowBox[{"c", " ", "X"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{"X", " ", 
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["uV", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"uM", "+", 
           RowBox[{"uY", " ", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], "2"]}], 
       "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "uM", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV"}], "+", 
                RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
           SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
       RowBox[{
        SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"g", " ", "uV"}], "+", 
             RowBox[{"2", " ", "uX"}], "+", 
             RowBox[{"2", " ", "uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
           SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875774314048*^9, 3.867905783304817*^9, 
   3.869114465083761*^9, 3.8692266323534718`*^9, 3.869292772304901*^9, 
   3.8693056441968517`*^9, 3.869309828065304*^9},
 CellLabel->
  "Out[2783]=",ExpressionUUID->"832124f8-4e81-49ad-927b-40f856be8067"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"X", ".", "M"}]], 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      FractionBox[
       RowBox[{"ea", " ", "X"}], "d"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"uM", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "uM"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M"}], "+", 
               RowBox[{"c", " ", "X"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{"X", " ", 
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{
          SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV"}], "+", 
               RowBox[{"2", " ", "uX"}], "+", 
               RowBox[{"2", " ", "uY", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
            "+", 
            SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}]}],
       "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV", " ", "uX"}], "+", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "uV", " ", 
                 RowBox[{"(", 
                  RowBox[{"M", "-", 
                   RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"uM", "+", 
                   RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{"X", " ", 
                 SubsuperscriptBox["\[Sigma]", "uM", "2"]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "M"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"c", " ", "X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                 " ", 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["g", "2"], " ", 
                 SuperscriptBox["uV", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"uM", "+", 
                    RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                  "2"]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "uV", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "uM", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                    "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                    SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
                 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
                RowBox[{
                 SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"g", " ", "uV", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}], "+", 
                    RowBox[{"2", " ", "uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                    "+", 
                   SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
                    SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
               ")"}]}], ")"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "M"}], " ", "uV"}], "+", 
                    RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", "M", " ", 
                   RowBox[{"(", 
                    RowBox[{"uX", "+", 
                    RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                   "+", 
                  RowBox[{"2", " ", "c", " ", "X", " ", 
                   RowBox[{"(", 
                    RowBox[{"uX", "+", 
                    RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                   "+", 
                  RowBox[{"uY", " ", "X", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "M"}], "+", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
            RowBox[{"g", " ", "uM", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["uV", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"uM", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
              "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "uM", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uX", "2"]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
            RowBox[{
             SubsuperscriptBox["\[Sigma]", "uM", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}], "+", 
                  RowBox[{"2", " ", "uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.8583379094679956`*^9, 3.858337927621817*^9}, {
   3.858337979823756*^9, 3.858337983200714*^9}, 3.859546029959426*^9, {
   3.859546488437263*^9, 3.859546494596714*^9}, {3.859553248010227*^9, 
   3.859553254263012*^9}, {3.859553354378832*^9, 3.859553370863009*^9}, {
   3.859556590303746*^9, 3.859556731137102*^9}, {3.8595568368802843`*^9, 
   3.859556855184084*^9}, 3.8595568897925453`*^9, 3.859556941186006*^9, 
   3.859556983198007*^9, {3.859557047128931*^9, 3.85955708241224*^9}, {
   3.859557136838951*^9, 3.859557165847919*^9}, 3.859557262044697*^9, 
   3.8595572958728733`*^9, {3.859557340892188*^9, 3.859557353775855*^9}, 
   3.859557416434569*^9, {3.859557470593205*^9, 3.859557488898158*^9}, {
   3.859557520531488*^9, 3.8595575505157337`*^9}, 3.859558669327684*^9, 
   3.859558721452882*^9, {3.859558754088676*^9, 3.85955876521196*^9}, 
   3.8595913131136017`*^9, 3.859591359311697*^9, 3.859591498517894*^9, 
   3.859591584895399*^9, 3.859591709047987*^9, 3.8596077702108173`*^9, 
   3.859610027482188*^9, 3.859631367881378*^9, 3.859701207665772*^9, 
   3.8597012390369787`*^9, 3.859885020144372*^9, 3.859885166541519*^9, 
   3.8598853407675037`*^9, 3.859885565421359*^9, 3.859885599349204*^9, 
   3.85988566434374*^9, 3.859885862002119*^9, 3.859886104346899*^9, {
   3.85988620764218*^9, 3.859886253942675*^9}, 3.8598864152034817`*^9, 
   3.8598872660948477`*^9, 3.8598877622059383`*^9, 3.859887794435771*^9, 
   3.8598878284346247`*^9, 3.8599677746074333`*^9, 3.859980996471656*^9, 
   3.860036139731718*^9, 3.860036876363607*^9, 3.860150627903474*^9, 
   3.860222486899325*^9, 3.860222649692609*^9, 3.860223091246971*^9, {
   3.861254065452084*^9, 3.861254081369493*^9}, 3.861750777677525*^9, 
   3.863856312899067*^9, 3.864116510112237*^9, 3.864116579663926*^9, {
   3.864117106286165*^9, 3.864117118774555*^9}, {3.864189207202978*^9, 
   3.864189237987886*^9}, 3.864875774314048*^9, 3.867905783304817*^9, 
   3.869114465083761*^9, 3.8692266323534718`*^9, 3.869292772304901*^9, 
   3.8693056441968517`*^9, 3.869309828074607*^9},
 CellLabel->
  "Out[2784]=",ExpressionUUID->"03e1d21e-d2bc-4b96-b59e-fb03e414714f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"aIVcorr", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["ca", "^"], "-", 
       RowBox[{"c", "*", "a"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["c", "^"], "-", "c"}], ")"}]}], "//", 
    RowBox[{"Expand", "//.", "structureEqs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noisenames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<uX\>\"", ",", "\"\<uM\>\"", ",", "\"\<uY\>\"", ",", "\"\<M\>\"", 
     ",", "\"\<Y\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noises", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Symbol", ",", "noisenames"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"condmeans", "=", 
   RowBox[{"CondMeans", "[", 
    RowBox[{"causalgraphiv", ",", "noisenames", ",", 
     RowBox[{"{", "\"\<X\>\"", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"condmeanreplace", "=", 
  RowBox[{"MapThread", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"noises", ",", "condmeans"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"aIVcorrsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"aIVcorr", "/.", "condmeanreplace"}], "//", 
    RowBox[{
     RowBox[{"TensorExpand", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vweights", " ", "\[Element]", "Reals"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", " ", "\[Epsilon]"}], 
            "}"}], "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "&"}]}], "//",
    "Simplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864189595862781*^9, 3.864189705397428*^9}},
 CellLabel->
  "In[2785]:=",ExpressionUUID->"04460eec-1310-4856-915b-e79b7e7ebf76"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"uX", ",", "uM", ",", "uY", ",", "M", ",", "Y"}], "}"}]], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.8648757745137157`*^9, 
   3.8679057838405647`*^9, 3.869114465288781*^9, 3.869226632674734*^9, 
   3.869292772519232*^9, 3.869305644407152*^9, 3.869309828092286*^9},
 CellLabel->
  "Out[2787]=",ExpressionUUID->"b6eb5134-81b8-4433-aa49-4e83c53a0167"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"uX", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV", " ", "uX"}], "+", 
        SubsuperscriptBox["\[Sigma]", "uX", "2"]}], ")"}]}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}], ",", 
   RowBox[{"uM", "\[Rule]", 
    FractionBox[
     RowBox[{"g", " ", "uM", " ", "uV", " ", "X"}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}], ",", 
   RowBox[{"uY", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}], ",", 
   RowBox[{"M", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"X", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"c", " ", "g", " ", "uV"}], "+", 
            RowBox[{"2", " ", "c", " ", "uX"}], "+", 
            RowBox[{"2", " ", "c", " ", "uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{"c", " ", 
          SubsuperscriptBox["\[Sigma]", "uX", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"g", " ", "uV", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", " ", "uV"}], "+", 
          RowBox[{"2", " ", "uX"}], "+", 
          RowBox[{"2", " ", "uY", " ", 
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
       SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
        SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{"Y", "\[Rule]", 
    FractionBox[
     RowBox[{"X", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
         SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"g", " ", "uV", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "uV"}], "+", 
         RowBox[{"2", " ", "uX"}], "+", 
         RowBox[{"2", " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
      SubsuperscriptBox["\[Sigma]", "uX", "2"], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
       SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.8648757745137157`*^9, 
   3.8679057838405647`*^9, 3.869114465288781*^9, 3.869226632674734*^9, 
   3.869292772519232*^9, 3.869305644407152*^9, 3.869309828109475*^9},
 CellLabel->
  "Out[2789]=",ExpressionUUID->"d70244e0-d054-4f1b-8339-768f2c5af253"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.864189621796802*^9, 3.864189643415895*^9}, {
   3.8641896747615623`*^9, 3.864189706275193*^9}, 3.8648757745137157`*^9, 
   3.8679057838405647`*^9, 3.869114465288781*^9, 3.869226632674734*^9, 
   3.869292772519232*^9, 3.869305644407152*^9, 3.869311647971531*^9},
 CellLabel->
  "Out[2790]=",ExpressionUUID->"ace22e38-eccf-4e4a-a1de-e5c5a23f2d28"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.5"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"aerrorsimp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "->", "1"}], ",", 
    RowBox[{"d", "->", "1"}], ",", 
    RowBox[{"\[Epsilon]", "->", "0.1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uW", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uX", "2"], "->", "1"}], ",", 
    RowBox[{
     SubsuperscriptBox["\[Sigma]", "uM", "2"], "->", "1"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.863856380066532*^9, 3.8638563950769453`*^9}, {
  3.8641165213663473`*^9, 3.8641165231740637`*^9}},
 CellLabel->
  "In[2201]:=",ExpressionUUID->"a1c7dd27-846d-4779-ad4d-2fbb5b799c37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"X", ".", "M"}]], 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      RowBox[{"ea", " ", "X"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M"}], "+", 
               RowBox[{"c", " ", "X"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"uM", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "uM"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{"X", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"2", " ", "uX"}], "+", 
            RowBox[{"2", " ", "uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}]}], 
           ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"g", " ", "uV", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "X"}], "+", 
                RowBox[{"g", " ", "uV", " ", 
                 RowBox[{"(", 
                  RowBox[{"M", "-", 
                   RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"uM", "+", 
                   RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "M"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"c", " ", "X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                 " ", 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              RowBox[{"g", " ", "uV", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", "uV"}], "+", 
                 RowBox[{"2", " ", "uX"}], "+", 
                 RowBox[{"2", " ", "uY", " ", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SuperscriptBox["uV", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                "2"]}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
                 RowBox[{"g", " ", "uV", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "uM", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                   ")"}]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}]}],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "M"}], "+", 
            RowBox[{"c", " ", "X"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", "uV"}], "+", 
                  RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "M", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"2", " ", "c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"uY", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "M"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{"X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
              ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "+", 
            RowBox[{"g", " ", "uM", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV"}], "+", 
               RowBox[{"2", " ", "uX"}], "+", 
               RowBox[{"2", " ", "uY", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["uV", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"uM", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
              "2"]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "uM", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.869307749374545*^9},
 CellLabel->
  "Out[2201]=",ExpressionUUID->"068b1ef8-ed8d-463d-a166-ed57dd2f7aa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "a"}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"X", ".", "M"}]], 
   RowBox[{"X", ".", 
    RowBox[{"(", 
     RowBox[{"bW", "+", 
      RowBox[{"ca", " ", "X"}], "+", 
      RowBox[{"ea", " ", "X"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", "uY", " ", 
          RowBox[{"(", 
           RowBox[{"M", "-", 
            RowBox[{"c", " ", "X"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"uM", "+", 
            RowBox[{"uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "M"}], "+", 
               RowBox[{"c", " ", "X"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"M", " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "-", 
               RowBox[{"M", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"uM", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], "+", 
               RowBox[{"c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "uM"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{"X", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV", " ", "uY"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], ")"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", 
         RowBox[{"g", " ", "uV", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"g", " ", "uV"}], "+", 
            RowBox[{"2", " ", "uX"}], "+", 
            RowBox[{"2", " ", "uY", " ", 
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], "+", 
         
         RowBox[{
          SuperscriptBox["g", "2"], " ", 
          SuperscriptBox["uV", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"uM", "+", 
             RowBox[{"uY", " ", 
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "uM", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"g", " ", "uV"}], "+", 
                  RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}]}], 
           ")"}], " ", 
          SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"e", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"g", " ", "uV", " ", "uX"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "X"}], "+", 
                RowBox[{"g", " ", "uV", " ", 
                 RowBox[{"(", 
                  RowBox[{"M", "-", 
                   RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"uM", "+", 
                   RowBox[{"uY", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                 "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "M"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"c", " ", "X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                   RowBox[{"X", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                 " ", 
                 SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}],
             "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              RowBox[{"g", " ", "uV", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"g", " ", "uV"}], "+", 
                 RowBox[{"2", " ", "uX"}], "+", 
                 RowBox[{"2", " ", "uY", " ", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{
               SuperscriptBox["g", "2"], " ", 
               SuperscriptBox["uV", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
                "2"]}], "-", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
                 RowBox[{"g", " ", "uV", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "uM", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                   ")"}]}]}], ")"}], " ", 
               SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}], ")"}]}],
          "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "M"}], "+", 
            RowBox[{"c", " ", "X"}], "+", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", "uV"}], "+", 
                  RowBox[{"c", " ", "uV", " ", "X"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "M", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"2", " ", "c", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"uX", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}],
                "+", 
               RowBox[{"uY", " ", "X", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "M"}], " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
               RowBox[{"X", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"(", 
                   RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}], 
              ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "+", 
            RowBox[{"g", " ", "uM", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{"M", "-", 
                  RowBox[{"c", " ", "X"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"uM", "+", 
                  RowBox[{"uY", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}]}],
                "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "M"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{"X", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"c", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                    RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}], ")"}]}]}],
                  ")"}], " ", 
                SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
           ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"g", " ", "uV", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"g", " ", "uV"}], "+", 
               RowBox[{"2", " ", "uX"}], "+", 
               RowBox[{"2", " ", "uY", " ", 
                RowBox[{"(", 
                 RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["g", "2"], " ", 
             SuperscriptBox["uV", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"uM", "+", 
                RowBox[{"uY", " ", 
                 RowBox[{"(", 
                  RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], ")"}], 
              "2"]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}], "2"], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}], "+", 
               RowBox[{"g", " ", "uV", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "uM", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "2"}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"g", " ", "uV"}], "+", 
                    RowBox[{"2", " ", "uX"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "\[DirectedEdge]", "3"}], ")"}]}]}], 
                 ")"}]}]}], ")"}], " ", 
             SubsuperscriptBox["\[Sigma]", "uY", "2"]}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.863856387432002*^9, 3.863856395407341*^9}, 
   3.8641165814833517`*^9, 3.864117122898244*^9, 3.86930774938531*^9},
 CellLabel->
  "Out[2202]=",ExpressionUUID->"eb6dacbd-dce2-49c8-a78b-ff20951a15bb"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{717., 870.75},
WindowMargins->{{Automatic, 1.5}, {Automatic, 13.5}},
Magnification:>1. Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9fbcb4e9-7ea0-4c5f-84cd-ca57da9c0d80"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 239, 4, 51, "Input",ExpressionUUID->"3e3492a6-b39e-49eb-aa8f-ed8f7183b148"],
Cell[CellGroupData[{
Cell[822, 28, 747, 15, 51, "Input",ExpressionUUID->"91d6d697-c0f9-4a55-855d-9f8d3314a6bb"],
Cell[1572, 45, 2063, 33, 28, "Message",ExpressionUUID->"48258500-b651-4802-91f4-b3834067fbbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3672, 83, 630, 13, 91, "Subtitle",ExpressionUUID->"4c1ca689-9203-4139-b190-9cf2efcd4914"],
Cell[4305, 98, 3637, 74, 449, "Text",ExpressionUUID->"1446b3c6-76b4-44d8-98e9-8af1260f8970"],
Cell[CellGroupData[{
Cell[7967, 176, 274, 4, 54, "Subsection",ExpressionUUID->"75bc9517-556a-4466-8059-1e737c80eed7"],
Cell[8244, 182, 3211, 76, 100, "Text",ExpressionUUID->"df50f8d3-e2f5-4f5a-9778-61a3a2a221e0"],
Cell[11458, 260, 771, 17, 92, "Input",ExpressionUUID->"df29d7d5-f772-43c3-971b-41ef594e42a1"],
Cell[CellGroupData[{
Cell[12254, 281, 3303, 92, 221, "Input",ExpressionUUID->"7c5be982-63ab-45a1-82a6-789088b76943"],
Cell[15560, 375, 2323, 37, 54, "Output",ExpressionUUID->"91f5444c-38ff-46fd-9022-31d747847a40"],
Cell[17886, 414, 2356, 38, 54, "Output",ExpressionUUID->"6d039382-b7e8-4bc6-94e0-ea9d8bca3455"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20291, 458, 308, 5, 54, "Subsection",ExpressionUUID->"1550afdd-39e1-4cbd-8ae6-c5e37a02f531"],
Cell[20602, 465, 5827, 156, 453, "Text",ExpressionUUID->"5ffd3cd0-17d8-4887-ad91-660985f5f854",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[26454, 625, 2263, 56, 285, "Input",ExpressionUUID->"0acea007-dcdc-46b2-82c6-bba6faa23ace"],
Cell[28720, 683, 2998, 63, 47, "Output",ExpressionUUID->"e6a840e3-58c8-4935-8271-07c4e4c27c85"],
Cell[31721, 748, 2237, 34, 47, "Output",ExpressionUUID->"1d195e44-e645-49b3-9655-ae9994315d6e"]
}, Open  ]],
Cell[33973, 785, 3304, 74, 219, "Text",ExpressionUUID->"bf9e62c9-c085-4469-91bb-f2a3ce6eeb5c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[37302, 863, 1501, 28, 113, "Input",ExpressionUUID->"9e849b21-5c9b-44da-9744-3f8d9153876f"],
Cell[38806, 893, 1962, 30, 47, "Output",ExpressionUUID->"42d7a39e-869c-4822-b916-a6fe0254aacc"]
}, Open  ]],
Cell[40783, 926, 5507, 133, 384, "Text",ExpressionUUID->"9f44316e-a962-4554-93f7-1ab67a3fa689",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[46315, 1063, 2042, 46, 225, "Input",ExpressionUUID->"f91c049a-16a4-4a64-9657-c82a9ee2b001"],
Cell[48360, 1111, 2613, 58, 47, "Output",ExpressionUUID->"09e29f42-c063-48c3-a989-0652d7107ce5"],
Cell[50976, 1171, 1852, 29, 47, "Output",ExpressionUUID->"99dec690-f89a-43d9-9979-45d5d90d5661"]
}, Open  ]],
Cell[52843, 1203, 5375, 133, 310, "Text",ExpressionUUID->"351b1c0f-ab00-4005-bdaa-bae51a7658d5",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[58243, 1340, 2588, 66, 291, "Input",ExpressionUUID->"227540ad-76f4-432f-98dd-5408c0d51d4e"],
Cell[60834, 1408, 7934, 232, 128, "Output",ExpressionUUID->"dffe5e80-395c-45bf-817e-888fd7b28cee"],
Cell[68771, 1642, 3021, 63, 49, "Output",ExpressionUUID->"135e086a-0e75-4a0b-9566-5e72d6fdeb60"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71841, 1711, 318, 5, 54, "Subsection",ExpressionUUID->"06c4d03f-5d88-4895-8359-cab72b4e9847"],
Cell[72162, 1718, 603, 10, 104, "Text",ExpressionUUID->"31c7e24e-cdc7-41a6-9bd4-d08056299da6"],
Cell[CellGroupData[{
Cell[72790, 1732, 1364, 40, 113, "Input",ExpressionUUID->"e608f519-4e15-4b60-8173-43b22aaedbe3"],
Cell[74157, 1774, 1708, 26, 33, "Output",ExpressionUUID->"b86ba64f-22c7-49f5-8a04-73b4e36e663a"],
Cell[75868, 1802, 1710, 26, 33, "Output",ExpressionUUID->"2c4c3cc5-f9d5-4199-ade0-05dac51d9ff7"],
Cell[77581, 1830, 1603, 22, 33, "Output",ExpressionUUID->"bc077268-78d9-4ca9-8384-445bc4fd9aaa"],
Cell[79187, 1854, 1604, 22, 33, "Output",ExpressionUUID->"4e66e9d6-0d3a-4d81-aa7f-c0ff03baa2d0"]
}, Open  ]],
Cell[80806, 1879, 1466, 49, 150, "Text",ExpressionUUID->"7eb912d9-fea8-402d-a8e2-486f7b51f7e7"],
Cell[CellGroupData[{
Cell[82297, 1932, 1367, 38, 92, "Input",ExpressionUUID->"34a58a2a-2bd7-4200-b7a7-52a5977a7ec5"],
Cell[83667, 1972, 2322, 51, 50, "Output",ExpressionUUID->"2e241adc-622b-4683-a178-3ec055cea85a"]
}, Open  ]],
Cell[86004, 2026, 2750, 80, 112, "Text",ExpressionUUID->"aa00a605-fb10-4ee4-82d4-5729c7923811"],
Cell[CellGroupData[{
Cell[88779, 2110, 614, 17, 51, "Input",ExpressionUUID->"45eef6f8-8657-4ab8-ab2d-b897e507a758"],
Cell[89396, 2129, 1577, 22, 33, "Output",ExpressionUUID->"c5be670c-2c4e-45e1-8224-7ee85f0bd5f3"]
}, Open  ]],
Cell[90988, 2154, 747, 11, 35, "Text",ExpressionUUID->"00966f16-333d-47df-9d51-207cd0a9e98a"],
Cell[CellGroupData[{
Cell[91760, 2169, 1581, 45, 133, "Input",ExpressionUUID->"2633dc54-57e1-438c-b753-1f2674f3fd70"],
Cell[93344, 2216, 1591, 24, 47, "Output",ExpressionUUID->"25984640-42a0-4632-bdf8-fa89e607815f"],
Cell[94938, 2242, 1523, 21, 33, "Output",ExpressionUUID->"da10087c-1d00-43fe-bb03-14ac3bc3f23a"]
}, Open  ]],
Cell[96476, 2266, 1106, 21, 58, "Text",ExpressionUUID->"2ff09b45-dc09-4395-810a-4a7c65bd04a0"],
Cell[97585, 2289, 1964, 56, 173, "Text",ExpressionUUID->"852179da-c38d-4b83-9f27-c4f242931aaf"],
Cell[99552, 2347, 147, 2, 29, "Input",ExpressionUUID->"53cbc348-32ee-4af5-9903-a722f70c8c1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99736, 2354, 367, 6, 54, "Subsection",ExpressionUUID->"84315294-9efc-4788-90ff-784e223ac4e8"],
Cell[CellGroupData[{
Cell[100128, 2364, 5484, 157, 525, "Input",ExpressionUUID->"97e356c5-0904-43ac-b548-c2a00ae761b6"],
Cell[105615, 2523, 8346, 177, 226, "Output",ExpressionUUID->"0a0cb98d-dbca-4a92-92be-f294166acc9b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113998, 2705, 795, 19, 92, "Input",ExpressionUUID->"7a70d2cc-f879-41a9-bb2b-09368f6af7d6"],
Cell[114796, 2726, 1936, 33, 33, "Output",ExpressionUUID->"439e90e0-db4d-4f15-8692-c83b6e4ba61d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116769, 2764, 17398, 464, 1861, "Input",ExpressionUUID->"8ddc0aa2-8b8c-4638-b295-93fc6c7bf41e"],
Cell[134170, 3230, 3206, 66, 58, "Output",ExpressionUUID->"4f5659a1-5250-4757-aafc-915a3ba7e319"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137413, 3301, 832, 26, 51, "Input",ExpressionUUID->"55170268-80ad-47c4-a240-8d2bd6e8fb1c"],
Cell[138248, 3329, 580, 8, 33, "Output",ExpressionUUID->"f5aed879-0aec-42d6-8919-ac61b63c98cf"],
Cell[138831, 3339, 1164, 29, 79, "Output",ExpressionUUID->"c396e6ea-9e21-44d4-9a3e-1562b28dec3b"]
}, Open  ]],
Cell[140010, 3371, 1386, 23, 81, "Text",ExpressionUUID->"64593238-bc16-490a-8ce4-65dfee0c2887"],
Cell[CellGroupData[{
Cell[141421, 3398, 1701, 40, 154, "Input",ExpressionUUID->"b0389f73-589f-4b9e-913c-ad9c6b710da8"],
Cell[143125, 3440, 2279, 40, 33, "Output",ExpressionUUID->"4865b29c-6a45-4594-b16b-e6b6cc71b190"],
Cell[145407, 3482, 2780, 52, 36, "Output",ExpressionUUID->"9ee7c473-57ac-4c26-8a75-247400479581"],
Cell[148190, 3536, 3790, 82, 108, "Output",ExpressionUUID->"8fbc2597-8c29-4f93-becb-41bbbdf93d87"],
Cell[151983, 3620, 2755, 56, 80, "Output",ExpressionUUID->"501cd98a-82a5-4850-a37c-01494bf1d025"],
Cell[154741, 3678, 2738, 54, 80, "Output",ExpressionUUID->"04eb96db-c3b4-4e8a-91c5-b3f698dd592a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157516, 3737, 1770, 54, 195, "Input",ExpressionUUID->"8ec89eb2-b01f-42da-9836-66c9cfe7f920"],
Cell[159289, 3793, 2083, 42, 108, "Output",ExpressionUUID->"c2835759-8750-4718-811e-de7a2911629a"],
Cell[161375, 3837, 1760, 32, 36, "Output",ExpressionUUID->"28ad1930-f0c4-4649-9f66-6386eaff5914"],
Cell[163138, 3871, 1564, 24, 33, "Output",ExpressionUUID->"abba2edd-d024-4156-ba9e-1048cf1ba5cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164739, 3900, 547, 13, 51, "Input",ExpressionUUID->"2fa1a588-7cbd-4bbb-85e3-81150a0e6e69"],
Cell[165289, 3915, 752, 13, 33, "Output",ExpressionUUID->"d12f53ed-91eb-49b1-ac65-036414f3b0e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166078, 3933, 765, 21, 71, "Input",ExpressionUUID->"94625393-8c20-4ea0-bacd-bf5692b38324"],
Cell[166846, 3956, 1916, 49, 68, "Output",ExpressionUUID->"60e5c838-9fc3-4c58-b28d-94517d64d02f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168799, 4010, 1333, 39, 126, "Input",ExpressionUUID->"8cef0432-6661-41b1-8aca-5bb36a3079b4"],
Cell[170135, 4051, 1766, 46, 89, "Output",ExpressionUUID->"91b64fb3-5fcd-4f78-a228-e74c89f6cca3"],
Cell[171904, 4099, 1027, 24, 54, "Output",ExpressionUUID->"6c466daa-3c8f-4711-9c40-fb706dd78fcc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172980, 4129, 438, 6, 54, "Subsection",ExpressionUUID->"6d1561f6-1c63-441b-9ed0-fc35c83d329e"],
Cell[173421, 4137, 724, 13, 104, "Text",ExpressionUUID->"9cead3f3-9580-4bb0-9dc6-a075ff673e9e"],
Cell[174148, 4152, 1413, 45, 127, "Text",ExpressionUUID->"7b80321f-322e-467f-90aa-50f076e0c52e"],
Cell[CellGroupData[{
Cell[175586, 4201, 1088, 34, 202, "Input",ExpressionUUID->"48be7b45-a1f4-4de7-a825-7868272940dd"],
Cell[176677, 4237, 2334, 55, 49, "Output",ExpressionUUID->"4a646367-b1bf-4814-93c8-fcbe67726cad"],
Cell[179014, 4294, 1576, 26, 49, "Output",ExpressionUUID->"ca5fb867-7ad7-4211-9d7f-2e83be73595d"]
}, Open  ]],
Cell[180605, 4323, 1129, 31, 51, "Input",ExpressionUUID->"18d8d8f4-fa4b-4984-bc3a-92128754d852"],
Cell[CellGroupData[{
Cell[181759, 4358, 2103, 52, 195, "Input",ExpressionUUID->"72d0df97-d647-4bf9-b725-2525dd5fea8f"],
Cell[183865, 4412, 2276, 34, 33, "Output",ExpressionUUID->"71aac00b-7d44-4830-877a-4c2da40cc7c4"],
Cell[186144, 4448, 2678, 47, 54, "Output",ExpressionUUID->"a2b7e7b4-12e8-46bb-87dc-6b3d997185db"],
Cell[188825, 4497, 2218, 32, 33, "Output",ExpressionUUID->"5b57094d-20f6-4b51-9768-7015cb207004"]
}, Open  ]],
Cell[191058, 4532, 747, 11, 35, "Text",ExpressionUUID->"2fd0ce14-ca71-455e-93b7-3b4d53263732"],
Cell[CellGroupData[{
Cell[191830, 4547, 2256, 63, 257, "Input",ExpressionUUID->"94181819-8c49-4d07-bee2-fa2ca5909853"],
Cell[194089, 4612, 1816, 32, 49, "Output",ExpressionUUID->"01935de9-81d7-4640-b7ce-3d5b980bd91a"],
Cell[195908, 4646, 1626, 24, 33, "Output",ExpressionUUID->"f9da76c7-c31d-4686-815e-a2bc40042b88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197571, 4675, 2176, 64, 236, "Input",ExpressionUUID->"2c216537-6554-44f2-a3ef-d9574b6cd24d"],
Cell[199750, 4741, 1565, 25, 33, "Output",ExpressionUUID->"d30a1176-019c-44b9-88ec-c995727a9a92"],
Cell[201318, 4768, 1970, 38, 54, "Output",ExpressionUUID->"fe9f6a58-1b89-4af7-b6e4-baf77278c1fb"],
Cell[203291, 4808, 2782, 69, 66, "Output",ExpressionUUID->"6a44bb03-bf60-4f7c-9bbd-f04d024b572b"],
Cell[206076, 4879, 1509, 23, 33, "Output",ExpressionUUID->"093c8606-5bbe-4240-9597-c05f4336738b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[207634, 4908, 536, 9, 54, "Subsection",ExpressionUUID->"1333173b-516b-4f58-b710-f846f770e7ad"],
Cell[208173, 4919, 1541, 48, 150, "Text",ExpressionUUID->"70bc763c-6fcd-4d9b-bfe4-02c5753bd298"],
Cell[CellGroupData[{
Cell[209739, 4971, 1093, 32, 195, "Input",ExpressionUUID->"51848f12-4455-40e1-8e20-e17c2aecc138"],
Cell[210835, 5005, 1633, 27, 49, "Output",ExpressionUUID->"8e8a9f7b-9b28-48bb-a021-8d1817a60081"],
Cell[212471, 5034, 1635, 27, 49, "Output",ExpressionUUID->"17b40d0b-d531-4908-97d8-eed888bf4e24"]
}, Open  ]],
Cell[214121, 5064, 2003, 40, 51, "Input",ExpressionUUID->"b805ede3-7563-44d9-bd74-6b89b4038c41"],
Cell[CellGroupData[{
Cell[216149, 5108, 2183, 53, 195, "Input",ExpressionUUID->"44e44ce1-7c55-4300-9740-8c9b138993ff"],
Cell[218335, 5163, 2377, 35, 33, "Output",ExpressionUUID->"9fc7f245-dad5-4134-b4d1-c8690e813e23"],
Cell[220715, 5200, 3982, 83, 105, "Output",ExpressionUUID->"8f7b767a-ee1e-40a6-9c84-e95ecc597d90"],
Cell[224700, 5285, 2723, 46, 56, "Output",ExpressionUUID->"cebac037-c641-4e59-a01f-555f35a7c15c"]
}, Open  ]],
Cell[227438, 5334, 747, 11, 35, "Text",ExpressionUUID->"fa7c1f65-6a36-40d1-8ea4-c14a2f0c4eaf"],
Cell[CellGroupData[{
Cell[228210, 5349, 2263, 63, 257, "Input",ExpressionUUID->"ae1fa19a-7e0b-40db-8b22-d02e9615ca90"],
Cell[230476, 5414, 1854, 32, 49, "Output",ExpressionUUID->"59e92d0e-5cd8-4e45-abe3-fd25ef57e56d"],
Cell[232333, 5448, 1666, 24, 33, "Output",ExpressionUUID->"ead88ab7-508a-4e64-aa77-68cfec757e77"]
}, Open  ]],
Cell[234014, 5475, 1654, 28, 61, "Text",ExpressionUUID->"eb65eb2f-2e33-46e7-9d68-714185c37d19"],
Cell[CellGroupData[{
Cell[235693, 5507, 3230, 87, 273, "Input",ExpressionUUID->"ac2fbb6b-8391-4dab-b597-55ead479331a"],
Cell[238926, 5596, 1815, 28, 33, "Output",ExpressionUUID->"b91c3f05-1b3d-4bbf-b70c-89b6f7b0b695"],
Cell[240744, 5626, 2674, 56, 68, "Output",ExpressionUUID->"ab9f4f94-941e-4a66-b31e-e93902168d3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243455, 5687, 1956, 57, 199, "Input",ExpressionUUID->"c8562925-333c-47e8-ba95-9e696f1fc838"],
Cell[245414, 5746, 1965, 45, 68, "Output",ExpressionUUID->"7539e1bf-1455-40df-845c-291f3d127db8"]
}, Open  ]],
Cell[247394, 5794, 2139, 47, 227, "Text",ExpressionUUID->"c1693a58-63c8-40f6-8369-d2a957c3ee63"],
Cell[CellGroupData[{
Cell[249558, 5845, 1652, 47, 96, "Input",ExpressionUUID->"c824d810-9878-42ae-8689-3b5b5fcd1057"],
Cell[251213, 5894, 2229, 45, 85, "Output",ExpressionUUID->"45e053d1-243a-4817-b88a-15f92e39c209"],
Cell[253445, 5941, 2904, 61, 243, "Output",ExpressionUUID->"5a85a6f2-9dd0-4d02-8700-45c4643f7dcf"]
}, Open  ]],
Cell[256364, 6005, 814, 16, 150, "Text",ExpressionUUID->"60d483d1-5674-45f4-b23e-a68e6544190e"],
Cell[CellGroupData[{
Cell[257203, 6025, 2885, 83, 166, "Input",ExpressionUUID->"8df836b0-eac2-41d8-946c-b2838cad7f8c"],
Cell[260091, 6110, 2188, 51, 66, "Output",ExpressionUUID->"24f58454-3f88-4e43-bfea-33d3bcd9bde8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262316, 6166, 924, 22, 29, "Input",ExpressionUUID->"6adf52a4-fc6e-4172-9daf-55df1b513fb2"],
Cell[263243, 6190, 1035, 15, 33, "Output",ExpressionUUID->"de327b63-56d6-41e2-8eb9-deefac4057c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264315, 6210, 4020, 110, 276, "Input",ExpressionUUID->"176a2ba7-1367-4f51-89d1-546609772e0f"],
Cell[268338, 6322, 1303, 23, 44, "Message",ExpressionUUID->"adb552c9-c039-48b6-b5b0-c6c238b8fe11"],
Cell[269644, 6347, 1303, 23, 44, "Message",ExpressionUUID->"29cc546f-4aaf-4d24-a335-e710df3ebf32"],
Cell[270950, 6372, 1303, 23, 44, "Message",ExpressionUUID->"d5aef531-68dd-4b38-aa39-02e26dc18fc4"],
Cell[272256, 6397, 1278, 22, 28, "Message",ExpressionUUID->"c7ed41ce-042c-4d5a-acb8-f5adcf6a360e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273571, 6424, 588, 15, 51, "Input",ExpressionUUID->"027d89fc-bb6f-4916-9973-02da6c4bcdf3"],
Cell[274162, 6441, 2496, 56, 251, "Output",ExpressionUUID->"5bb7f2fe-6595-43fc-b886-d2fd860d5da1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276695, 6502, 879, 28, 91, "Input",ExpressionUUID->"ef47b9d6-1d18-4aeb-a08c-792ce8fe9b36"],
Cell[277577, 6532, 8640, 244, 256, "Output",ExpressionUUID->"7313086d-8e7c-4517-8567-b4a335cf3383"],
Cell[286220, 6778, 1015, 25, 58, "Output",ExpressionUUID->"659782c0-b86a-4408-a2c1-dcd87d02ef2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[287272, 6808, 790, 24, 75, "Input",ExpressionUUID->"2ea30e5e-191c-42cb-bb89-4e9cad9d19cd"],
Cell[288065, 6834, 1163, 20, 38, "Message",ExpressionUUID->"859e364a-667b-4ba0-84dc-f8e554636843"],
Cell[289231, 6856, 886, 16, 28, "Message",ExpressionUUID->"405817e5-3eef-46b9-a3df-064d66ca8706"],
Cell[290120, 6874, 953, 22, 52, "Output",ExpressionUUID->"514164c2-9bc7-4065-93b6-89bab985c11d"]
}, Open  ]],
Cell[291088, 6899, 2307, 59, 104, "Text",ExpressionUUID->"f8b63a61-0764-4d68-865d-a705715fc2fb"],
Cell[CellGroupData[{
Cell[293420, 6962, 1609, 43, 174, "Input",ExpressionUUID->"be5e2b77-9aa9-4c4b-a317-14c80188caac"],
Cell[295032, 7007, 1422, 32, 65, "Output",ExpressionUUID->"ca8fd3dd-b271-4201-b727-47cabff8a7ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296491, 7044, 1167, 30, 113, "Input",ExpressionUUID->"ebb6adcd-f8dc-48fa-8305-8bd12fa5f663"],
Cell[297661, 7076, 2799, 72, 103, "Output",ExpressionUUID->"979bc7a8-b674-4770-9382-a1330c5a1a75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300497, 7153, 1435, 39, 133, "Input",ExpressionUUID->"93c1f14e-a4fb-468d-b942-59072288a49b"],
Cell[301935, 7194, 1656, 40, 56, "Output",ExpressionUUID->"8b8e992c-463e-43f7-8b16-140f61f2e109"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[303640, 7240, 583, 9, 54, "Subsection",ExpressionUUID->"1ca2d76d-4ceb-4284-b53f-881365cee286"],
Cell[304226, 7251, 1614, 48, 150, "Text",ExpressionUUID->"44d4db92-1bf3-4e31-8788-f9eee3e305a4"],
Cell[CellGroupData[{
Cell[305865, 7303, 763, 19, 92, "Input",ExpressionUUID->"30df783b-79a3-4828-9d01-0b5d102eccd6"],
Cell[306631, 7324, 1528, 26, 49, "Output",ExpressionUUID->"03162438-f05a-4f91-aaec-eeeae001aaff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[308196, 7355, 2080, 40, 51, "Input",ExpressionUUID->"8fd3fc4a-b635-4dcd-913d-21acd26f6187"],
Cell[310279, 7397, 962, 23, 57, "Output",ExpressionUUID->"5c592d55-abd4-4c60-b0f9-0b74ebd7ddb7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311278, 7425, 2231, 53, 195, "Input",ExpressionUUID->"0f49ba2d-daeb-4d2c-af43-31d740d873f6"],
Cell[313512, 7480, 2292, 34, 33, "Output",ExpressionUUID->"ac2a8f7e-353b-4908-bce4-33cf7bf5ce66"],
Cell[315807, 7516, 2700, 47, 54, "Output",ExpressionUUID->"8c65a133-0dd8-4a5e-a53c-05288b92f07f"],
Cell[318510, 7565, 2474, 40, 54, "Output",ExpressionUUID->"b7c64446-1820-40cd-a151-feea1af7f1f5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[321033, 7611, 491, 7, 54, "Subsection",ExpressionUUID->"01666397-10ec-4231-8f0a-4e0e11ead2b3"],
Cell[321527, 7620, 615, 13, 35, "Text",ExpressionUUID->"e30e6357-feb6-4ca5-89d4-55018ec64e92"],
Cell[322145, 7635, 1525, 47, 173, "Text",ExpressionUUID->"3ef0156a-a016-4e37-8ec9-5023d8e2e1da"],
Cell[CellGroupData[{
Cell[323695, 7686, 1088, 34, 202, "Input",ExpressionUUID->"59039328-20dc-4e75-870c-817bfb4ad206"],
Cell[324786, 7722, 2224, 54, 49, "Output",ExpressionUUID->"6f6e6637-f559-4222-a96a-35279caab4b6"],
Cell[327013, 7778, 1465, 25, 49, "Output",ExpressionUUID->"05913b35-a32f-4cee-9155-bc1fbac42115"]
}, Open  ]],
Cell[328493, 7806, 1129, 31, 51, "Input",ExpressionUUID->"768a7334-3e9b-4fc9-a5a1-400a7e9dfdd6"],
Cell[CellGroupData[{
Cell[329647, 7841, 2103, 52, 195, "Input",ExpressionUUID->"46295a90-b2be-4911-ae9a-341127a689ec"],
Cell[331753, 7895, 2157, 32, 33, "Output",ExpressionUUID->"19a3ebdd-7461-46a4-9718-9aae0ba45988"],
Cell[333913, 7929, 2560, 45, 54, "Output",ExpressionUUID->"b81dc32c-96f2-4565-99b2-6d8a065db5dd"],
Cell[336476, 7976, 2097, 30, 33, "Output",ExpressionUUID->"1837759d-521f-48d1-bbc6-b58560e84324"]
}, Open  ]],
Cell[338588, 8009, 747, 11, 35, "Text",ExpressionUUID->"b83a6ba6-84a6-4cac-ad8e-68a26373eeb1"],
Cell[CellGroupData[{
Cell[339360, 8024, 2256, 63, 257, "Input",ExpressionUUID->"c9d8ddf0-ece0-4e84-9caa-7c29d8feb5bf"],
Cell[341619, 8089, 1711, 30, 49, "Output",ExpressionUUID->"180def75-0b20-4a73-8b9c-b60e0692dc23"],
Cell[343333, 8121, 1521, 22, 33, "Output",ExpressionUUID->"49db4374-d8e9-4eb7-a27f-84cac5e6a7f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[344891, 8148, 2176, 64, 236, "Input",ExpressionUUID->"a8b43178-58fe-472b-b9bc-437623ed0786"],
Cell[347070, 8214, 1444, 23, 33, "Output",ExpressionUUID->"7be4fbf2-64f5-490e-80cf-f649ac1ae65d"],
Cell[348517, 8239, 1849, 36, 54, "Output",ExpressionUUID->"a452c07f-b793-48dc-9fdc-0c1cbb003b9b"],
Cell[350369, 8277, 2661, 67, 66, "Output",ExpressionUUID->"2ae23eb7-1f4d-4294-b8ed-11c514510195"],
Cell[353033, 8346, 1388, 21, 33, "Output",ExpressionUUID->"98dbd3a3-e32d-4aaa-b00d-e093672d4d81"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[354470, 8373, 449, 6, 54, "Subsection",ExpressionUUID->"e8e79363-e6d6-4b07-9ed2-693a16617628"],
Cell[354922, 8381, 1507, 47, 127, "Text",ExpressionUUID->"6ab97049-a272-45e3-b56a-c28fd1fbe654"],
Cell[CellGroupData[{
Cell[356454, 8432, 5373, 154, 525, "Input",ExpressionUUID->"9c789cc0-8a84-46a7-89d4-a7f2cccc6f54"],
Cell[361830, 8588, 9234, 198, 226, "Output",ExpressionUUID->"284ea8e7-2bb8-4754-b6c5-fc80010d1403"]
}, Open  ]],
Cell[CellGroupData[{
Cell[371101, 8791, 851, 21, 113, "Input",ExpressionUUID->"02668223-e9f6-419f-bdf9-4d8f613dc8fb"],
Cell[371955, 8814, 2024, 36, 33, "Output",ExpressionUUID->"a4163e44-5b02-4da1-ac1b-fb6839a6caa0"]
}, Open  ]],
Cell[373994, 8853, 1386, 23, 81, "Text",ExpressionUUID->"87ee5079-490b-4ee6-929e-e462586d68cc"],
Cell[CellGroupData[{
Cell[375405, 8880, 1815, 43, 154, "Input",ExpressionUUID->"55d07a13-42d6-4fd1-be0b-ffc79023da17"],
Cell[377223, 8925, 2332, 42, 33, "Output",ExpressionUUID->"51f281f6-49df-4d7e-be3f-12b1f3a98e8d"],
Cell[379558, 8969, 2878, 55, 36, "Output",ExpressionUUID->"611fe19a-a27e-4173-8eed-bed3489aeed0"],
Cell[382439, 9026, 4249, 91, 108, "Output",ExpressionUUID->"ade0b7c0-501d-43f0-b7c1-3a7c6dd7c573"],
Cell[386691, 9119, 4722, 106, 106, "Output",ExpressionUUID->"ee2a4b6d-47ef-41b6-8709-7d677eed76f2"],
Cell[391416, 9227, 5340, 118, 102, "Output",ExpressionUUID->"d56c66d8-109f-4d35-b49a-c58bc2d7db7f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[396793, 9350, 309, 7, 29, "Input",ExpressionUUID->"b8c8e021-7746-41bf-86fe-2a103b0de24d"],
Cell[397105, 9359, 5073, 108, 99, "Output",ExpressionUUID->"9169e82c-1ced-466a-9d5d-4a53f3784320"]
}, Open  ]],
Cell[402193, 9470, 5180, 122, 360, "Text",ExpressionUUID->"d5b40735-65a5-4ecb-91fe-fd3f33181d33",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[407398, 9596, 2092, 47, 225, "Input",ExpressionUUID->"2017e8dd-40a9-481b-bdd2-032db35785c7"],
Cell[409493, 9645, 2685, 60, 49, "Output",ExpressionUUID->"62b412ea-854d-477c-8c49-f842e3f91587"],
Cell[412181, 9707, 1922, 31, 49, "Output",ExpressionUUID->"ac1924fc-5ff0-41b2-b6db-f28fb78e46b5"]
}, Open  ]],
Cell[414118, 9741, 1167, 32, 52, "Input",ExpressionUUID->"876dffc5-ba07-4858-9653-93e0f4ba8f25"],
Cell[CellGroupData[{
Cell[415310, 9777, 2791, 69, 236, "Input",ExpressionUUID->"dcf53729-6479-494e-b016-52d932c6f5e8"],
Cell[418104, 9848, 2421, 36, 33, "Output",ExpressionUUID->"baad8935-0836-446c-9810-69b7e0517213"],
Cell[420528, 9886, 4485, 97, 58, "Output",ExpressionUUID->"d373ba30-5f4e-4757-8339-9618e388e905"],
Cell[425016, 9985, 4635, 99, 107, "Output",ExpressionUUID->"31ca83d2-6bc8-492f-a970-7d6cfea276d3"],
Cell[429654, 10086, 5037, 121, 142, "Output",ExpressionUUID->"d3498a18-205b-4d2c-bd64-3f49f46d4f1b"],
Cell[434694, 10209, 2953, 51, 56, "Output",ExpressionUUID->"d11d1cce-ac85-4b70-a582-2844043fbe06"]
}, Open  ]],
Cell[CellGroupData[{
Cell[437684, 10265, 1099, 30, 54, "Input",ExpressionUUID->"8d7ce9c7-4bd8-4e43-b9e3-596e268d13ad"],
Cell[438786, 10297, 582, 9, 33, "Output",ExpressionUUID->"65eead37-af0b-47d0-a37a-54ba2a1ddf34"],
Cell[439371, 10308, 583, 9, 33, "Output",ExpressionUUID->"3493b1ce-1350-47e4-aee5-f16fbd32c276"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439991, 10322, 1345, 37, 97, "Input",ExpressionUUID->"c9bde5ab-5dd2-468a-90b4-e0bf94bbf79a"],
Cell[441339, 10361, 1210, 28, 56, "Output",ExpressionUUID->"7c71d9a3-8f83-4124-a60b-6ad75500ba13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[442586, 10394, 1511, 42, 195, "Input",ExpressionUUID->"32578c67-7a8e-4ec3-8df5-126e0195d90c"],
Cell[444100, 10438, 557, 9, 33, "Output",ExpressionUUID->"71bce419-7365-4b08-bbe6-2e98007e3e27"],
Cell[444660, 10449, 1311, 32, 56, "Output",ExpressionUUID->"aa9da237-59f3-464d-b948-c48e685091a8"],
Cell[445974, 10483, 606, 12, 39, "Message",ExpressionUUID->"3d3d1619-e608-45da-aeb4-77e89cc3ba8f"],
Cell[446583, 10497, 547, 8, 33, "Output",ExpressionUUID->"fab9ea30-56a3-4f12-983c-b8f313ae8617"]
}, Open  ]],
Cell[447145, 10508, 747, 11, 35, "Text",ExpressionUUID->"9073d606-5392-4317-b5db-82e56e4e9fe2"],
Cell[CellGroupData[{
Cell[447917, 10523, 3718, 86, 279, "Input",ExpressionUUID->"e313791c-1647-4ce2-bb22-fc3bb1a2f732"],
Cell[451638, 10611, 2048, 39, 56, "Output",ExpressionUUID->"9b869fe7-17ee-4ac1-8176-d468edbc4a7a"],
Cell[453689, 10652, 2322, 46, 97, "Output",ExpressionUUID->"e365b123-0d37-4696-a6cd-a5fafe28f1a8"],
Cell[456014, 10700, 1955, 33, 54, "Output",ExpressionUUID->"9bc5de82-97be-48e9-b22e-c49caf3a74cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[458006, 10738, 1108, 29, 54, "Input",ExpressionUUID->"2df0c537-405b-4ac1-bf85-34d82783797f"],
Cell[459117, 10769, 922, 20, 54, "Output",ExpressionUUID->"a22da0d9-c7e1-417b-834e-b30685731083"],
Cell[460042, 10791, 581, 10, 48, "Output",ExpressionUUID->"dd491d17-e077-49c3-bc7d-aa974b58e72b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[460660, 10806, 2313, 66, 257, "Input",ExpressionUUID->"7dc41a57-323d-434c-9b3e-2fa312e923fc"],
Cell[462976, 10874, 1499, 24, 33, "Output",ExpressionUUID->"3ada4ffe-9fdb-4b83-b508-04744ea82b3c"],
Cell[464478, 10900, 1904, 37, 54, "Output",ExpressionUUID->"686d871f-25ae-477b-830e-a705d9bafc0c"],
Cell[466385, 10939, 2892, 74, 122, "Output",ExpressionUUID->"fa7f2565-4547-4f37-a4e2-1d228ffe9224"],
Cell[469280, 11015, 6471, 203, 176, "Output",ExpressionUUID->"c93bf409-d5dc-4bc0-a5f1-fab96b25ff9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[475788, 11223, 698, 19, 78, "Input",ExpressionUUID->"02bf7984-3dda-4401-ad14-780f27874596"],
Cell[476489, 11244, 1387, 41, 49, "Output",ExpressionUUID->"9e22520f-eacd-4f84-9918-7cbffdaea045"]
}, Open  ]],
Cell[CellGroupData[{
Cell[477913, 11290, 3646, 102, 563, "Input",ExpressionUUID->"bcbe896d-85a5-4303-9469-6cda93a44f32"],
Cell[481562, 11394, 483, 8, 33, "Output",ExpressionUUID->"5538466f-5fce-487d-b22f-68b9f8c7e74e"],
Cell[482048, 11404, 676, 14, 49, "Output",ExpressionUUID->"264950b9-990b-4e52-9685-a822ee171e1c"],
Cell[482727, 11420, 844, 21, 57, "Output",ExpressionUUID->"14b24cc1-e964-4285-a828-b6bd4efe7c76"],
Cell[483574, 11443, 728, 17, 49, "Output",ExpressionUUID->"31c36011-936b-424d-8df8-3f417dd9669e"],
Cell[484305, 11462, 483, 8, 33, "Output",ExpressionUUID->"dff0ad87-15cc-430a-a2df-af63bf376287"],
Cell[484791, 11472, 769, 17, 54, "Output",ExpressionUUID->"813d2a73-1a6b-405d-b7c0-db33bd0110c9"],
Cell[485563, 11491, 1541, 41, 66, "Output",ExpressionUUID->"f25a8d8f-2eba-4cc4-a49e-521d65ecab02"],
Cell[487107, 11534, 863, 19, 56, "Output",ExpressionUUID->"1f495d2a-ba4d-4495-b341-f0357310f5ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[488019, 11559, 495, 7, 54, "Subsection",ExpressionUUID->"73631730-2574-465c-90aa-fe6dde59bc3a"],
Cell[488517, 11568, 10022, 264, 716, "Text",ExpressionUUID->"47393b17-4f09-4646-bb47-5f9f4d20d034"],
Cell[CellGroupData[{
Cell[498564, 11836, 3927, 106, 409, "Input",ExpressionUUID->"acb2a25b-fcc0-4d95-8ad9-5db2af322cc0"],
Cell[502494, 11944, 2728, 61, 49, "Output",ExpressionUUID->"dea9af8f-6e20-480f-9fb9-6566cc9d81f3"],
Cell[505225, 12007, 1965, 32, 49, "Output",ExpressionUUID->"549e1522-946e-4103-bf62-28f83554ec30"],
Cell[507193, 12041, 1990, 33, 49, "Output",ExpressionUUID->"f71f1ba0-ada7-4b18-8407-40720ac20899"],
Cell[509186, 12076, 2445, 47, 66, "Output",ExpressionUUID->"8ea24740-8a65-48c7-9012-62c6b59ed81e"],
Cell[511634, 12125, 2444, 47, 66, "Output",ExpressionUUID->"16522ddc-ad55-4aee-a6d6-ae47a5617960"],
Cell[514081, 12174, 2310, 44, 64, "Output",ExpressionUUID->"cd1c71c3-7991-4de7-bda2-d5ca2faa8361"],
Cell[516394, 12220, 2310, 44, 64, "Output",ExpressionUUID->"d1cf3604-e067-4edc-9ac0-b20b83187b18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[518741, 12269, 2630, 78, 144, "Input",ExpressionUUID->"032cd3d5-5013-449d-8b0e-87924056a856"],
Cell[521374, 12349, 844, 17, 49, "Output",ExpressionUUID->"3859f7f7-3ddc-4dd9-a138-285c6d9c5129"],
Cell[522221, 12368, 844, 17, 49, "Output",ExpressionUUID->"ab478763-4e76-49fa-b3bf-ed0e6ab70de6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[523102, 12390, 3573, 102, 340, "Input",ExpressionUUID->"7dd404ad-9ca9-4623-aeba-a0d0f5e1b73c"],
Cell[526678, 12494, 2762, 40, 33, "Output",ExpressionUUID->"a30fc68e-4e1f-4f7c-ace8-6734c70cbb45"],
Cell[529443, 12536, 4675, 98, 56, "Output",ExpressionUUID->"53ebab3d-857d-4f8f-972d-7c52ad47ecfc"],
Cell[534121, 12636, 4884, 103, 101, "Output",ExpressionUUID->"6dbab24c-dbc3-405b-86f5-12b7a2df9c35"],
Cell[539008, 12741, 3367, 59, 68, "Output",ExpressionUUID->"571120de-3c81-4a26-94fa-e650a12b08f6"],
Cell[542378, 12802, 3353, 59, 68, "Output",ExpressionUUID->"718cfa60-7b6d-47fc-be69-d4cab61b8105"]
}, Open  ]],
Cell[CellGroupData[{
Cell[545768, 12866, 2647, 68, 169, "Input",ExpressionUUID->"cc82193b-ce8d-49ef-88a6-93fba5080006"],
Cell[548418, 12936, 997, 14, 33, "Output",ExpressionUUID->"c1b1f84f-6f48-4d93-8334-b8dc955548fe"],
Cell[549418, 12952, 995, 14, 33, "Output",ExpressionUUID->"2543087e-09fd-4cbb-b6b2-7a4d37577e5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[550450, 12971, 254, 4, 51, "Input",ExpressionUUID->"2e3115af-bf6e-4b7c-a271-8c5d3ab52dbb"],
Cell[550707, 12977, 502, 8, 33, "Output",ExpressionUUID->"c2cce758-b9a2-45b0-b371-ce9d79d95708"],
Cell[551212, 12987, 502, 8, 33, "Output",ExpressionUUID->"048eaabd-e19a-486f-a8e6-8088f50a58a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551751, 13000, 1397, 40, 99, "Input",ExpressionUUID->"f9443457-5132-439a-9b87-f8cd6fd30002"],
Cell[553151, 13042, 975, 23, 54, "Output",ExpressionUUID->"5cb3602f-f54c-41aa-8df0-855b6b549cbd"],
Cell[554129, 13067, 1064, 26, 56, "Output",ExpressionUUID->"56d206e3-67d9-49b5-9628-7f448a28c8f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[555230, 13098, 718, 19, 32, "Input",ExpressionUUID->"016d38f0-2156-4028-bc0e-640ac8c5e244"],
Cell[555951, 13119, 552, 9, 33, "Output",ExpressionUUID->"b8e6dc4e-251c-4c50-b51a-d9a483280295"]
}, Open  ]],
Cell[CellGroupData[{
Cell[556540, 13133, 1692, 55, 105, "Input",ExpressionUUID->"6086f94d-81d2-46bd-b31f-fcd50ea58b5d"],
Cell[558235, 13190, 682, 17, 49, "Output",ExpressionUUID->"68d9ffb1-28b3-45ef-a347-8a1c3d4a9196"],
Cell[558920, 13209, 1794, 30, 61, "Message",ExpressionUUID->"aa3ebbd6-f76a-46b9-82fc-c50e186546a4"],
Cell[560717, 13241, 1003, 28, 64, "Output",ExpressionUUID->"e70b0c9b-0320-4d11-81b5-43bef0b5dde5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[561757, 13274, 599, 19, 43, "Input",ExpressionUUID->"488df2e9-4c0a-4a0f-9fbe-247ca9aa698c"],
Cell[562359, 13295, 857, 21, 54, "Output",ExpressionUUID->"f908806a-13ac-41f5-be0d-5fa96d3486b0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[563265, 13322, 501, 7, 54, "Subsection",ExpressionUUID->"41b12d69-70c0-4fe3-a437-5b9f741d3fb6"],
Cell[563769, 13331, 1485, 46, 127, "Text",ExpressionUUID->"34a919b9-f156-47e2-805e-ec531e6ea90a"],
Cell[CellGroupData[{
Cell[565279, 13381, 5334, 153, 525, "Input",ExpressionUUID->"2319b478-ba51-4816-a1a9-57e433e16cf8"],
Cell[570616, 13536, 8410, 178, 226, "Output",ExpressionUUID->"be2d1177-5b26-4c90-9bf6-346b94e9e1c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[579063, 13719, 899, 20, 71, "Input",ExpressionUUID->"f7f930c2-2f56-40e1-b25f-6e30fea00ead"],
Cell[579965, 13741, 1956, 34, 33, "Output",ExpressionUUID->"029b9dc9-417b-4ee9-86c3-bfd75eda3a31"]
}, Open  ]],
Cell[581936, 13778, 1386, 23, 81, "Text",ExpressionUUID->"4ce69ac0-6ad0-431f-a089-33a35f74615b"],
Cell[CellGroupData[{
Cell[583347, 13805, 1866, 44, 154, "Input",ExpressionUUID->"7a366d38-d200-44e3-b569-7a73811a5a11"],
Cell[585216, 13851, 2666, 51, 49, "Output",ExpressionUUID->"892d0602-444c-411e-a546-43db450f59d1"],
Cell[587885, 13904, 3832, 83, 79, "Output",ExpressionUUID->"16ffd74e-cb36-492d-83e4-d8093b1e45bb"],
Cell[591720, 13989, 3434, 70, 108, "Output",ExpressionUUID->"3bd3f45d-88d5-4a00-b3d4-826d28416dd8"],
Cell[595157, 14061, 2895, 58, 80, "Output",ExpressionUUID->"294e630d-101f-4102-b6e8-efa849db8f79"],
Cell[598055, 14121, 2840, 55, 80, "Output",ExpressionUUID->"8e382027-faa8-4640-8fc0-0ab98b40c1a2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[600932, 14181, 309, 7, 29, "Input",ExpressionUUID->"272e4451-6ade-4efc-93ed-de83d981cc0b"],
Cell[601244, 14190, 2731, 56, 58, "Output",ExpressionUUID->"cbd32edd-f1ac-4627-85af-1867cdd37f05"]
}, Open  ]],
Cell[603990, 14249, 5180, 122, 360, "Text",ExpressionUUID->"1941cb98-fc3b-4281-8753-e0e94c4cf6f8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[609195, 14375, 2234, 52, 258, "Input",ExpressionUUID->"5a73ce84-1458-4aa0-b4c0-e6ec04ce129f"],
Cell[611432, 14429, 1896, 31, 49, "Output",ExpressionUUID->"a503ed25-3c2c-4d3c-b2d7-dbe4faa3551f"],
Cell[613331, 14462, 2205, 41, 56, "Output",ExpressionUUID->"f9482d4c-3ccb-41df-8a7c-cd2d5224b772"],
Cell[615539, 14505, 2171, 40, 56, "Output",ExpressionUUID->"99495d76-30fa-4b75-89c8-8fd0ca026e02"]
}, Open  ]],
Cell[617725, 14548, 1172, 32, 51, "Input",ExpressionUUID->"8498350e-58b1-44fd-a050-3ef1fd0e9881"],
Cell[CellGroupData[{
Cell[618922, 14584, 2324, 56, 195, "Input",ExpressionUUID->"83a62cf8-254a-4c2b-bf5b-cefae74a4d35"],
Cell[621249, 14642, 2353, 35, 33, "Output",ExpressionUUID->"a673ff6a-c2a7-4fac-9046-62c832b20d43"],
Cell[623605, 14679, 2791, 49, 54, "Output",ExpressionUUID->"24799f54-a6b1-4ee0-8c06-7d5e334b0f72"],
Cell[626399, 14730, 3137, 61, 66, "Output",ExpressionUUID->"844f7158-e44c-4ecd-8452-229ddf3603ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[629573, 14796, 1940, 57, 238, "Input",ExpressionUUID->"91ba22eb-2604-4514-90a1-2afea9e9b380"],
Cell[631516, 14855, 877, 20, 49, "Output",ExpressionUUID->"058f0c75-e99a-4f1e-9729-b51d080b146f"],
Cell[632396, 14877, 1097, 27, 49, "Output",ExpressionUUID->"e02f3429-dbdb-4253-9482-0fd7317f3ec9"],
Cell[633496, 14906, 514, 8, 33, "Output",ExpressionUUID->"427c28bf-68e0-4966-8f9e-2f969d69d776"]
}, Open  ]],
Cell[CellGroupData[{
Cell[634047, 14919, 1099, 30, 54, "Input",ExpressionUUID->"40cd5ef8-5c1c-4c31-bae4-70c542e3838b"],
Cell[635149, 14951, 1046, 27, 56, "Output",ExpressionUUID->"370bffe1-2809-4eee-87a4-b053bf6d185d"],
Cell[636198, 14980, 1046, 27, 56, "Output",ExpressionUUID->"321249d2-b5ff-46e5-b608-9d01284096df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[637281, 15012, 1345, 37, 97, "Input",ExpressionUUID->"59a665c1-37ce-44f5-9c88-dd765f025291"],
Cell[638629, 15051, 1161, 28, 56, "Output",ExpressionUUID->"73a145eb-dcde-41f0-836b-db7bff7865d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[639827, 15084, 1511, 42, 195, "Input",ExpressionUUID->"8acf20d7-4b78-4937-b795-2a71d8011143"],
Cell[641341, 15128, 511, 9, 33, "Output",ExpressionUUID->"3304dc5c-846e-47dd-8a2f-b7e4afcf0643"],
Cell[641855, 15139, 804, 18, 54, "Output",ExpressionUUID->"89560fe1-919e-40ac-b125-1efe4a46a6bd"],
Cell[642662, 15159, 2651, 72, 98, "Output",ExpressionUUID->"88305552-7cd4-4b62-9cfc-79e1307e4be0"]
}, Open  ]],
Cell[645328, 15234, 747, 11, 35, "Text",ExpressionUUID->"16b21cec-b960-44ed-85b1-f95d70657655"],
Cell[CellGroupData[{
Cell[646100, 15249, 3718, 86, 279, "Input",ExpressionUUID->"28d5c79e-de88-48d4-bcfd-838393b39959"],
Cell[649821, 15337, 1976, 38, 56, "Output",ExpressionUUID->"fb8556e9-6388-404c-9609-75e30775544b"],
Cell[651800, 15377, 1783, 31, 49, "Output",ExpressionUUID->"b3e341de-e2fe-4339-9256-858ff9650e5e"],
Cell[653586, 15410, 1624, 24, 33, "Output",ExpressionUUID->"0f6bdb08-5910-4e87-8dd6-1f7b0e5ddbd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[655247, 15439, 482, 13, 32, "Input",ExpressionUUID->"07c44553-b95b-4067-9d07-9c5f1b2db83c"],
Cell[655732, 15454, 460, 7, 33, "Output",ExpressionUUID->"e7566a06-c9bd-4358-8d9f-8086c03faf7d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[656229, 15466, 2313, 66, 257, "Input",ExpressionUUID->"5be26913-1549-4def-8a47-e2a24d5f51fd"],
Cell[658545, 15534, 1450, 23, 33, "Output",ExpressionUUID->"c79e1265-6855-4e8c-b26b-f0fcd95b3613"],
Cell[659998, 15559, 1589, 28, 33, "Output",ExpressionUUID->"715a2bf0-2c86-40e5-82da-62dcf09f2870"],
Cell[661590, 15589, 2241, 51, 63, "Output",ExpressionUUID->"6b62da0e-fab5-48ef-b886-51c15933f11f"],
Cell[663834, 15642, 5589, 171, 169, "Output",ExpressionUUID->"53a78653-d58e-4f55-88b4-e9f9d6bd8dac"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[669472, 15819, 572, 10, 54, "Subsection",ExpressionUUID->"a55bea93-6432-48b9-ace0-e4ae96f426b0"],
Cell[670047, 15831, 1880, 58, 173, "Text",ExpressionUUID->"458b2556-2a8d-4e1f-9a54-7fc2d26f0567"],
Cell[CellGroupData[{
Cell[671952, 15893, 6581, 169, 525, "Input",ExpressionUUID->"9bb7b4be-cb8b-45d2-bc1d-87ffa9d55e1b"],
Cell[678536, 16064, 9232, 211, 166, "Output",ExpressionUUID->"fba88e8c-30b8-4e32-ab09-63df8b7d6ebb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[687805, 16280, 1846, 49, 157, "Input",ExpressionUUID->"c8768e9a-d927-4855-aa3a-daa8fba6e3b0"],
Cell[689654, 16331, 2198, 39, 33, "Output",ExpressionUUID->"a7db3e76-24f8-420e-82d7-cd9786c238a2"],
Cell[691855, 16372, 3597, 81, 99, "Output",ExpressionUUID->"70a307b9-67c8-4c59-aee0-1c226503a776"]
}, Open  ]],
Cell[695467, 16456, 1386, 23, 81, "Text",ExpressionUUID->"62862608-bdad-4403-9d31-03fcd864b4c6"],
Cell[CellGroupData[{
Cell[696878, 16483, 824, 20, 195, "Input",ExpressionUUID->"d2d22e61-3745-4000-af6f-bfafcfd346f1"],
Cell[697705, 16505, 296, 5, 33, "Output",ExpressionUUID->"e4e7fb90-5854-4df1-af61-c7e0995fe467"],
Cell[698004, 16512, 296, 5, 33, "Output",ExpressionUUID->"2586615c-a813-49e4-8000-30f561e60d0f"],
Cell[698303, 16519, 296, 5, 33, "Output",ExpressionUUID->"e35b10c3-775d-494c-876f-6852142a5f55"],
Cell[698602, 16526, 296, 5, 33, "Output",ExpressionUUID->"26890d0e-c318-4cc2-b187-25048e6b0a68"],
Cell[698901, 16533, 296, 5, 33, "Output",ExpressionUUID->"8b48146d-bf27-4998-b1ca-8fa0c50b2cd0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[699234, 16543, 1993, 52, 174, "Input",ExpressionUUID->"7d7e24b3-d94d-4aa8-aafe-131f72524eaf"],
Cell[701230, 16597, 3055, 59, 77, "Output",ExpressionUUID->"499618ea-0692-4fb2-849d-332df91bf98b"],
Cell[704288, 16658, 3738, 75, 73, "Output",ExpressionUUID->"1edde00c-a45b-4ce7-9eb6-c2282d0f718f"],
Cell[708029, 16735, 2297, 34, 33, "Output",ExpressionUUID->"c4b6412f-a60b-4987-8d76-184efa72742f"],
Cell[710329, 16771, 5112, 109, 108, "Output",ExpressionUUID->"26467191-ed67-478c-aa64-06fa2c5144e1"],
Cell[715444, 16882, 4160, 86, 67, "Output",ExpressionUUID->"ffe56387-2501-4812-8619-da20b59bbfba"],
Cell[719607, 16970, 5880, 131, 106, "Output",ExpressionUUID->"d759463d-a1c5-4968-b81c-48ca59f73737"],
Cell[725490, 17103, 7624, 175, 106, "Output",ExpressionUUID->"27d6412b-7e55-43e3-9403-51412430f28c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[733151, 17283, 309, 7, 29, "Input",ExpressionUUID->"8df664ac-bda9-44b8-94b8-bc227b1d103f"],
Cell[733463, 17292, 7754, 182, 137, "Output",ExpressionUUID->"efdc3f6e-ee5c-459f-bd3d-238031229dd0"]
}, Open  ]],
Cell[741232, 17477, 14580, 374, 2347, "Text",ExpressionUUID->"fb32edc5-d6ba-4a98-b9f6-055e669224c2",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[755837, 17855, 4077, 93, 297, "Input",ExpressionUUID->"a3c55f74-0b79-44f9-8a1f-ce1c11044fca"],
Cell[759917, 17950, 559, 11, 49, "Output",ExpressionUUID->"8ff926f3-89ff-4382-a96d-9692879ed81c"],
Cell[760479, 17963, 864, 22, 56, "Output",ExpressionUUID->"eb2eb36a-a436-46bf-b041-65ec001aae77"],
Cell[761346, 17987, 551, 10, 33, "Output",ExpressionUUID->"80f338d6-f7dc-4c70-a9ec-8d7b6fc43b14"],
Cell[761900, 17999, 1286, 32, 54, "Output",ExpressionUUID->"9c9dd551-ae05-4c53-868c-1a622f8f0499"],
Cell[763189, 18033, 1401, 35, 54, "Output",ExpressionUUID->"f4e6043c-3bce-4df4-b2b5-fbd51753223b"],
Cell[764593, 18070, 1771, 45, 97, "Output",ExpressionUUID->"bb2d6b13-53b9-4e36-83fe-dc20ad7170e5"],
Cell[766367, 18117, 854, 19, 54, "Output",ExpressionUUID->"54000921-289d-443f-ad0e-38f6c230c6ba"]
}, Open  ]],
Cell[767236, 18139, 3142, 81, 258, "Input",ExpressionUUID->"2bc8b1fb-c10a-4b98-a22a-eb6147e694b7"],
Cell[CellGroupData[{
Cell[770403, 18224, 3667, 95, 282, "Input",ExpressionUUID->"17b93a3e-3474-4f90-9189-de50a085a740"],
Cell[774073, 18321, 871, 22, 33, "Output",ExpressionUUID->"70045c57-7378-41cd-82e7-ec68a7cf20d5"],
Cell[774947, 18345, 747, 21, 64, "Output",ExpressionUUID->"e2af3b8d-349c-4c17-83b7-9aa38c85b010"],
Cell[775697, 18368, 1657, 50, 78, "Output",ExpressionUUID->"129c607d-a701-4baa-b8f5-860432db6138"],
Cell[777357, 18420, 396, 7, 33, "Output",ExpressionUUID->"5b46778e-666f-4bcd-be59-30c429d54ce6"],
Cell[777756, 18429, 398, 7, 33, "Output",ExpressionUUID->"06261162-f0f4-4bbc-8f59-3d2feeb87890"],
Cell[778157, 18438, 371, 6, 33, "Output",ExpressionUUID->"dfdb01ce-f7bf-4d51-8167-c1784e61bb56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[778565, 18449, 2900, 65, 90, "Input",ExpressionUUID->"73c248e6-59bf-471b-81e9-65f69a29fa82"],
Cell[781468, 18516, 828, 24, 49, "Output",ExpressionUUID->"4e8c9fa9-dfd2-4cc7-9b6e-48d5e0aae675"],
Cell[782299, 18542, 1442, 45, 58, "Output",ExpressionUUID->"91592a84-1ff5-4f94-a85b-961420514b7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[783778, 18592, 2714, 61, 216, "Input",ExpressionUUID->"ba5387fb-abe3-467e-9ae3-650b5b78d934"],
Cell[786495, 18655, 2672, 40, 33, "Output",ExpressionUUID->"e8e95668-4984-495d-bdcd-ec91835cd80e"],
Cell[789170, 18697, 8062, 194, 206, "Output",ExpressionUUID->"785920b7-ba67-4c73-8f18-af8669efba28"],
Cell[797235, 18893, 8371, 199, 206, "Output",ExpressionUUID->"c9875a1a-ec0c-476b-ace9-1a171e877293"],
Cell[805609, 19094, 10191, 221, 450, "Output",ExpressionUUID->"a75449c8-9740-4bde-866b-5b1355427ce1"],
Cell[815803, 19317, 3596, 67, 58, "Output",ExpressionUUID->"dad62b22-dee6-4145-81e0-5835766007b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[819436, 19389, 806, 21, 32, "Input",ExpressionUUID->"fb3de4f1-5619-4000-b4bb-3cfaa5563b1e"],
Cell[820245, 19412, 393, 9, 47, "Output",ExpressionUUID->"d53a3b3e-32b6-4730-b5eb-897a3eee5cd1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[820675, 19426, 6144, 152, 279, "Input",ExpressionUUID->"b460eaf9-77ba-4555-a349-2255e375bbaf"],
Cell[826822, 19580, 803, 17, 33, "Output",ExpressionUUID->"c0313f47-b462-4bd6-955a-d73102fbc724"],
Cell[827628, 19599, 2622, 75, 75, "Output",ExpressionUUID->"70b72202-3c44-4122-885c-7fa81313d7ba"],
Cell[830253, 19676, 1295, 33, 36, "Output",ExpressionUUID->"a15e98b4-8562-41e9-a109-e1a24a36aeea"],
Cell[831551, 19711, 1400, 33, 36, "Output",ExpressionUUID->"bfe7720c-83d3-44a0-8181-b89392396b69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[832988, 19749, 6179, 153, 282, "Input",ExpressionUUID->"bbc12927-e347-4a75-8e05-76b74efc3ef7"],
Cell[839170, 19904, 823, 18, 33, "Output",ExpressionUUID->"fc8637d1-e661-4aea-8b8e-081b6ca81741"],
Cell[839996, 19924, 2331, 66, 75, "Output",ExpressionUUID->"04d5c720-ddc5-4988-a7e2-0166bb404968"],
Cell[842330, 19992, 1216, 31, 36, "Output",ExpressionUUID->"53fba82c-e7d1-4f9e-9dc1-cb5cd2f1b31a"],
Cell[843549, 20025, 1321, 31, 36, "Output",ExpressionUUID->"ece80c15-9723-4de6-a5e1-dc33813089a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[844907, 20061, 289, 7, 29, "Input",ExpressionUUID->"70ecb97a-770b-4fe7-8318-0d032c72ca4e"],
Cell[845199, 20070, 1275, 35, 58, "Output",ExpressionUUID->"2f78daa3-45cf-41f0-abde-3a1effd8227b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[846511, 20110, 3024, 85, 325, "Input",ExpressionUUID->"a8928b79-7e1f-4c95-87aa-26baeb738771"],
Cell[849538, 20197, 670, 13, 49, "Output",ExpressionUUID->"94a4b633-3a6b-4df3-9004-4d4dbe5b693f"],
Cell[850211, 20212, 757, 17, 49, "Output",ExpressionUUID->"7a906073-c511-4330-8025-ecb9351613eb"],
Cell[850971, 20231, 1230, 34, 49, "Output",ExpressionUUID->"c4c4cbf2-e022-44f2-b1b9-4f4e87dc78d8"],
Cell[852204, 20267, 626, 10, 33, "Output",ExpressionUUID->"4ae4ef53-7a9e-483c-aea1-6cfde12cc4a8"],
Cell[852833, 20279, 980, 24, 49, "Output",ExpressionUUID->"216c6f76-5cbc-4adf-96a2-42b19d782a35"],
Cell[853816, 20305, 626, 10, 33, "Output",ExpressionUUID->"c618a4fc-d5cf-49c4-9aa4-d521de60966f"],
Cell[854445, 20317, 952, 23, 49, "Output",ExpressionUUID->"ca15e25d-6417-4371-8971-57e7aa9445ab"],
Cell[855400, 20342, 800, 16, 39, "Message",ExpressionUUID->"34cec88a-f1fc-424e-8b58-d38f69b63bf7"],
Cell[856203, 20360, 586, 9, 33, "Output",ExpressionUUID->"0628a06e-2542-4db0-980b-8bcaa4d88982"],
Cell[856792, 20371, 599, 13, 28, "Message",ExpressionUUID->"34abe2ef-a2ee-43ad-bff1-ab67640f824e"],
Cell[857394, 20386, 587, 9, 33, "Output",ExpressionUUID->"955a78e0-a066-468c-904c-2f7760f0371e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[858018, 20400, 3528, 92, 273, "Input",ExpressionUUID->"effed24d-96b5-4e78-8391-2508746e5cbe"],
Cell[861549, 20494, 1134, 26, 33, "Output",ExpressionUUID->"a89abb85-9730-403a-aeb1-b40fe9450199"],
Cell[862686, 20522, 1036, 26, 62, "Output",ExpressionUUID->"6518a37b-2e1b-4adc-9331-0e44cfe1bb68"],
Cell[863725, 20550, 2283, 58, 79, "Output",ExpressionUUID->"f7ce21a7-8cb6-4a06-a8c1-86d37049d76a"],
Cell[866011, 20610, 2283, 58, 79, "Output",ExpressionUUID->"8334c850-1d01-418e-b524-e6a858006771"],
Cell[868297, 20670, 1862, 45, 55, "Output",ExpressionUUID->"9c975603-6f5b-4161-982f-b29412dac406"],
Cell[870162, 20717, 886, 19, 33, "Output",ExpressionUUID->"1719b49b-d8bb-47f3-938a-d6e129daaa2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[871085, 20741, 3798, 86, 213, "Input",ExpressionUUID->"6d455989-8b3a-4c8a-8fb1-720d6e7449fc"],
Cell[874886, 20829, 972, 24, 33, "Output",ExpressionUUID->"ac0ec1e9-e407-4f2d-b507-9d24ad58bde6"],
Cell[875861, 20855, 876, 24, 62, "Output",ExpressionUUID->"0771ec22-550a-40fb-8019-bbe61c8920c5"],
Cell[876740, 20881, 673, 16, 49, "Output",ExpressionUUID->"c0bac172-cc5d-4856-a955-04210a7bf46b"],
Cell[877416, 20899, 674, 16, 49, "Output",ExpressionUUID->"55f59d3d-9110-439e-8914-b9ba6c49ace8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[878127, 20920, 3765, 82, 212, "Input",ExpressionUUID->"aaa6a32f-bdce-4f3b-856a-a9ab48520f34"],
Cell[881895, 21004, 998, 26, 50, "Output",ExpressionUUID->"e885b130-1b07-49ef-b570-bfcdc4376147"],
Cell[882896, 21032, 1591, 46, 59, "Output",ExpressionUUID->"33a3f571-db13-4d43-abbd-f77793ac33c8"],
Cell[884490, 21080, 644, 12, 33, "Output",ExpressionUUID->"715a9fbd-acfa-4825-863c-c844eb0ce2e0"],
Cell[885137, 21094, 6038, 166, 206, "Output",ExpressionUUID->"da248e5f-db61-413a-bf67-3c04003f8fe2"],
Cell[891178, 21262, 6345, 171, 206, "Output",ExpressionUUID->"1b76a9c3-f1d4-467d-819c-3e11697800bf"],
Cell[897526, 21435, 8224, 194, 450, "Output",ExpressionUUID->"d228ad0c-af4b-4531-a83d-242296b1eee7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[905787, 21634, 7859, 196, 381, "Input",ExpressionUUID->"2014604f-e999-49f2-b327-d55a1ae303d7"],
Cell[913649, 21832, 3244, 95, 81, "Output",ExpressionUUID->"fb1ae49a-4b0f-4c42-94a9-dab713857aae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[916930, 21932, 3543, 101, 118, "Input",ExpressionUUID->"db57165f-8dbe-4a1b-beca-171bcdd8f001"],
Cell[920476, 22035, 2145, 62, 58, "Output",ExpressionUUID->"fa123859-0289-4187-a33f-0a939b73cb8a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[922658, 22102, 5306, 158, 317, "Input",ExpressionUUID->"403aa1cc-df18-496e-a10d-7c5faa448efb"],
Cell[927967, 22262, 936, 26, 50, "Output",ExpressionUUID->"d9e055bc-4dd1-4370-a66c-2569e7fcb488"],
Cell[928906, 22290, 882, 24, 50, "Output",ExpressionUUID->"08ff2a73-d565-4443-a77f-f8adf403f63d"],
Cell[929791, 22316, 2046, 62, 92, "Output",ExpressionUUID->"ad7afcd9-0876-47e9-8529-1ac196a7a913"],
Cell[931840, 22380, 1012, 27, 52, "Output",ExpressionUUID->"c595de41-7e2d-43b2-aaa5-d294e9264e80"],
Cell[932855, 22409, 1102, 27, 52, "Output",ExpressionUUID->"6d149ff7-f198-42f8-8667-6a696912639d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[933994, 22441, 5533, 162, 337, "Input",ExpressionUUID->"038e047d-0615-4b78-a12f-0c63a7e10df7"],
Cell[939530, 22605, 884, 18, 49, "Output",ExpressionUUID->"3d1a516a-35d3-4882-9a96-6fdb13fe116f"],
Cell[940417, 22625, 882, 18, 49, "Output",ExpressionUUID->"6542703e-6b3f-420a-ad8e-0ac41b9f9fb2"],
Cell[941302, 22645, 1800, 47, 71, "Output",ExpressionUUID->"ba034217-085a-4168-ac25-c1c407b56b61"],
Cell[943105, 22694, 959, 20, 53, "Output",ExpressionUUID->"74c04c23-1156-4f4c-a101-46e59b3a2115"],
Cell[944067, 22716, 1002, 20, 53, "Output",ExpressionUUID->"5d7edfc1-1529-4f9c-9b09-08ffb2ac79ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[945106, 22741, 6051, 178, 378, "Input",ExpressionUUID->"514f4303-d882-4df9-8fad-ccbcf4f86408"],
Cell[951160, 22921, 1897, 48, 73, "Output",ExpressionUUID->"6747b484-082a-490a-8643-6eea22f61765"],
Cell[953060, 22971, 1899, 48, 73, "Output",ExpressionUUID->"2f3f47ea-7aff-4eec-81f3-165432ee000c"],
Cell[954962, 23021, 5640, 161, 217, "Output",ExpressionUUID->"4ddc1972-e695-4f32-b24d-f2152b58814e"],
Cell[960605, 23184, 852, 21, 57, "Output",ExpressionUUID->"675b8af6-92b5-4570-a893-94b4c96a7fa0"],
Cell[961460, 23207, 903, 22, 57, "Output",ExpressionUUID->"f907695a-cb56-40f6-8f54-3d717f585bbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[962400, 23234, 3970, 95, 213, "Input",ExpressionUUID->"a6e3e5c6-e041-402c-b937-9fd5ae32fec0"],
Cell[966373, 23331, 915, 23, 33, "Output",ExpressionUUID->"df9006cc-125b-4140-b245-a07c310b841c"],
Cell[967291, 23356, 1362, 40, 64, "Output",ExpressionUUID->"68a11436-b9bc-4bfc-af25-f7edbaf6bb9c"],
Cell[968656, 23398, 1036, 29, 51, "Output",ExpressionUUID->"00c77c42-d6f8-4ae7-aa04-ab75ed65e388"],
Cell[969695, 23429, 1036, 29, 51, "Output",ExpressionUUID->"395ec333-f36e-4f2e-941b-d897dd332a56"]
}, Open  ]],
Cell[CellGroupData[{
Cell[970768, 23463, 2611, 52, 89, "Input",ExpressionUUID->"a0022d1e-5d77-4133-bdfb-c0ba9396c7da"],
Cell[973382, 23517, 1714, 49, 53, "Output",ExpressionUUID->"8df14f63-79b0-4341-a30b-bad39358b91a"],
Cell[975099, 23568, 3160, 94, 147, "Output",ExpressionUUID->"93fc6ca2-a10f-4cf2-bf25-e41a8bb2d401"]
}, Open  ]],
Cell[CellGroupData[{
Cell[978296, 23667, 3615, 87, 216, "Input",ExpressionUUID->"dd042bd0-d1aa-4f3c-8560-d22b539be9f4"],
Cell[981914, 23756, 2766, 41, 33, "Output",ExpressionUUID->"feb9cf58-4868-45b7-b671-a5d70d4f82a5"],
Cell[984683, 23799, 6008, 134, 156, "Output",ExpressionUUID->"b2eae41a-5053-4039-81d0-c1a3ce31cb1c"],
Cell[990694, 23935, 6250, 138, 156, "Output",ExpressionUUID->"186e61be-8e5e-4cd9-9c23-c9e261df0628"],
Cell[996947, 24075, 11920, 271, 336, "Output",ExpressionUUID->"ee565794-6877-4898-8e7c-09fdc70ddc42"]
}, Open  ]],
Cell[1008882, 24349, 644, 19, 92, "Input",ExpressionUUID->"9b643ce3-aa43-4a04-b9ea-4899a3820c0f"],
Cell[CellGroupData[{
Cell[1009551, 24372, 8202, 209, 349, "Input",ExpressionUUID->"78c0f4ca-ae25-419d-b76c-5a0a9ab83c0c"],
Cell[1017756, 24583, 4059, 115, 126, "Output",ExpressionUUID->"e76257ac-8adc-48c1-a9d8-bad8525a8d33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1021852, 24703, 4327, 117, 142, "Input",ExpressionUUID->"5914d9f6-f930-42cf-a6bd-0295c9baa6ab"],
Cell[1026182, 24822, 4140, 114, 134, "Output",ExpressionUUID->"3a6092ee-9ea9-4a62-beba-a5f07edbb36c"]
}, Open  ]],
Cell[1030337, 24939, 177, 3, 29, "Input",ExpressionUUID->"97758225-c2f5-4091-a130-9b941ca63211"],
Cell[CellGroupData[{
Cell[1030539, 24946, 9943, 287, 586, "Input",ExpressionUUID->"126a441a-3565-460b-a2ca-25996162c207"],
Cell[1040485, 25235, 2971, 82, 98, "Output",ExpressionUUID->"4bd0dfac-f57d-4ebf-a0f7-08101eccef55"],
Cell[1043459, 25319, 1413, 39, 53, "Output",ExpressionUUID->"23749786-697e-48ae-91db-7072f8947e3a"],
Cell[1044875, 25360, 841, 20, 51, "Output",ExpressionUUID->"5a64e9f4-5069-4849-a79d-086ccc2ca75e"],
Cell[1045719, 25382, 841, 20, 51, "Output",ExpressionUUID->"bf85937c-714c-45a5-8f72-09a9e9c88ba7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1046597, 25407, 1300, 34, 95, "Input",ExpressionUUID->"8ab6c42e-6c9d-43e9-9c5c-9ce9a573251a"],
Cell[1047900, 25443, 521, 9, 33, "Output",ExpressionUUID->"4edec103-44c6-4ce3-b90e-4b72ab318860"],
Cell[1048424, 25454, 564, 11, 47, "Output",ExpressionUUID->"0a8ff7f0-1c52-429c-9516-634a7d63d777"],
Cell[1048991, 25467, 596, 12, 33, "Output",ExpressionUUID->"a6c6a9e9-1002-4474-8561-28c6044d5c49"],
Cell[1049590, 25481, 3032, 69, 239, "Output",ExpressionUUID->"e4d78b7e-1efe-42da-adaa-c30cd4e9799b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1052659, 25555, 9877, 287, 586, "Input",ExpressionUUID->"f55f2f5d-1245-487a-8064-e3a94f4674ea"],
Cell[1062539, 25844, 3646, 102, 143, "Output",ExpressionUUID->"0b93195c-abc3-4513-8e3d-f9cc8488089b"],
Cell[1066188, 25948, 1449, 40, 72, "Output",ExpressionUUID->"6992934d-c62e-4012-bff3-55f217fa4476"],
Cell[1067640, 25990, 796, 20, 51, "Output",ExpressionUUID->"7bd949a2-d1c8-47ad-a4af-d3818d042a99"],
Cell[1068439, 26012, 975, 25, 54, "Output",ExpressionUUID->"bca8fdef-ed83-4eff-9e95-ee51ae686c86"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1069451, 26042, 899, 27, 71, "Input",ExpressionUUID->"5967e82d-294b-49ee-863f-2c236d853529"],
Cell[1070353, 26071, 898, 23, 154, "Output",ExpressionUUID->"0bc6119f-7b3f-4a20-9fe7-c122c7b0e1bd"]
}, Open  ]],
Cell[1071266, 26097, 3647, 102, 309, "Input",ExpressionUUID->"9d9bb6c9-eeeb-43a5-af58-1f31845764df"],
Cell[CellGroupData[{
Cell[1074938, 26203, 2188, 59, 196, "Input",ExpressionUUID->"c8346299-38a5-4ca1-b5fa-7eb5d26773f8"],
Cell[1077129, 26264, 5313, 160, 142, "Output",ExpressionUUID->"1ed43b1b-c8e9-4aba-a289-13b238c1c558"],
Cell[1082445, 26426, 4967, 148, 142, "Output",ExpressionUUID->"b054b6f5-3a40-4799-8989-6a29b3cb51f1"],
Cell[1087415, 26576, 1719, 45, 33, "Output",ExpressionUUID->"64b679d2-928b-49af-9711-d700d75bd1cd"],
Cell[1089137, 26623, 3919, 121, 96, "Output",ExpressionUUID->"36429ca3-f844-4394-8192-32627aeb3623"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1093093, 26749, 1770, 53, 196, "Input",ExpressionUUID->"0cbe1341-d4af-4080-b77e-5212dd4b5c1d"],
Cell[1094866, 26804, 4868, 154, 142, "Output",ExpressionUUID->"ccb21ef5-aabb-4304-beaa-f8cb40181ee3"],
Cell[1099737, 26960, 4522, 142, 142, "Output",ExpressionUUID->"a91e03cb-ae4c-4add-92bc-f31f3de9459c"],
Cell[1104262, 27104, 1272, 39, 33, "Output",ExpressionUUID->"44f898dc-eeb5-4d74-b41c-18a30375ec5b"],
Cell[1105537, 27145, 3474, 115, 96, "Output",ExpressionUUID->"b9b8a136-9bd3-45e8-8cf3-d70bc0aa9187"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1109048, 27265, 1634, 50, 107, "Input",ExpressionUUID->"f5601b99-a387-4964-b1de-7c2e1c596001"],
Cell[1110685, 27317, 1223, 36, 33, "Output",ExpressionUUID->"dbda3697-a31f-4076-95b9-a41fa865c486"],
Cell[1111911, 27355, 1223, 36, 33, "Output",ExpressionUUID->"192cb37b-031d-40cc-804e-6d9a48e068d9"],
Cell[1113137, 27393, 2059, 65, 53, "Output",ExpressionUUID->"4016d2d9-3439-423a-840c-2372ae9127e3"]
}, Open  ]],
Cell[1115211, 27461, 7655, 194, 358, "Text",ExpressionUUID->"8d572e12-250f-4bef-a3d6-9c9e3f0c8720",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1122891, 27659, 1549, 46, 156, "Input",ExpressionUUID->"5582aa67-fef6-4e38-afcd-11db737a2356"],
Cell[1124443, 27707, 1369, 42, 55, "Output",ExpressionUUID->"7b5a93a1-ef58-4e84-85db-154766a11f21"],
Cell[1125815, 27751, 1279, 38, 55, "Output",ExpressionUUID->"27ac25a6-2607-4155-84b4-aa239517f05f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1127131, 27794, 502, 15, 32, "Input",ExpressionUUID->"1c1d0502-04e7-43f6-9066-ebcc5ca5bec0"],
Cell[1127636, 27811, 3009, 96, 98, "Output",ExpressionUUID->"6d48f39e-9fe4-45fe-9173-cee90906449a"]
}, Open  ]],
Cell[1130660, 27910, 1896, 58, 196, "Input",ExpressionUUID->"911f1cb6-ad72-4c29-997e-a7b2980dbb04"],
Cell[1132559, 27970, 1990, 60, 196, "Input",ExpressionUUID->"d4d61f03-b73b-4ecb-8c6b-25f4236e0d54"],
Cell[CellGroupData[{
Cell[1134574, 28034, 1755, 52, 107, "Input",ExpressionUUID->"99b3d397-0d31-44f2-9d8d-952c022c0d92"],
Cell[1136332, 28088, 2535, 82, 77, "Output",ExpressionUUID->"7f67d00b-1635-4a88-a543-b78632334af3"],
Cell[1138870, 28172, 2567, 84, 81, "Output",ExpressionUUID->"3425193b-86c1-4966-a13a-0aa7fcf467de"],
Cell[1141440, 28258, 4734, 153, 146, "Output",ExpressionUUID->"0b558055-e11f-4842-9d8f-d60680452296"]
}, Open  ]],
Cell[1146189, 28414, 5424, 125, 116, "Text",ExpressionUUID->"ce83f5aa-236c-4e9a-8fa5-b9d062d269d8",
 InitializationCell->True],
Cell[1151616, 28541, 1173, 32, 51, "Input",ExpressionUUID->"bf90c7c7-d9af-44cb-bf82-aa7edea63556"],
Cell[CellGroupData[{
Cell[1152814, 28577, 2325, 56, 195, "Input",ExpressionUUID->"50a24e15-32bf-4017-a4ac-6aa29177ca19"],
Cell[1155142, 28635, 2233, 33, 33, "Output",ExpressionUUID->"45074abf-40bb-4be0-8419-37aad1e6f8dc"],
Cell[1157378, 28670, 15445, 395, 394, "Output",ExpressionUUID->"090fe42b-a75a-4827-81e6-8ee3831235c4"],
Cell[1172826, 29067, 17631, 420, 442, "Output",ExpressionUUID->"d46fb0e7-209f-4af7-91c9-b2bdef107059"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1190494, 29492, 1941, 57, 238, "Input",ExpressionUUID->"76f7976a-38d9-4160-b3a0-95a3e002ebfb"],
Cell[1192438, 29551, 474, 8, 33, "Output",ExpressionUUID->"008ca62d-3446-4452-b9f7-322808ba7c15"],
Cell[1192915, 29561, 5349, 145, 259, "Output",ExpressionUUID->"7df7f886-34ab-4472-ae66-5fee8c8a74b1"],
Cell[1198267, 29708, 403, 6, 33, "Output",ExpressionUUID->"1309679d-7349-4119-ba71-0c9d44ebea25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1198707, 29719, 1100, 30, 54, "Input",ExpressionUUID->"2243662c-1052-4bd7-bdf8-768475876f16"],
Cell[1199810, 29751, 13957, 358, 399, "Output",ExpressionUUID->"28768656-4877-4f9e-9c03-ff8b88ac64e6"],
Cell[1213770, 30111, 13956, 358, 399, "Output",ExpressionUUID->"b7bf05a0-dc4f-4568-b4a8-796378cdef00"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1227775, 30475, 618, 10, 54, "Subsection",ExpressionUUID->"82daa309-cf85-4794-9357-618ebdfdca32"],
Cell[1228396, 30487, 1880, 58, 173, "Text",ExpressionUUID->"8cce385d-5c89-4b22-957b-29d507f679b0"],
Cell[CellGroupData[{
Cell[1230301, 30549, 6581, 169, 525, "Input",ExpressionUUID->"57a115b4-b308-4512-8d5b-fc9e2dfc77f8"],
Cell[1236885, 30720, 9185, 210, 166, "Output",ExpressionUUID->"b4322328-84ba-4169-bd3f-3ad7d39ffefc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1246107, 30935, 1846, 49, 157, "Input",ExpressionUUID->"948e49fe-4948-4df0-8352-8a0429ebbbfd"],
Cell[1247956, 30986, 2154, 39, 33, "Output",ExpressionUUID->"b7fe47cf-2a84-4703-9010-f023fc412bd9"],
Cell[1250113, 31027, 3555, 81, 99, "Output",ExpressionUUID->"f73593a6-05ed-4c45-9661-dc915bb382a8"]
}, Open  ]],
Cell[1253683, 31111, 1386, 23, 81, "Text",ExpressionUUID->"50f9a449-f358-41c6-b31e-2eee3c54d43c"],
Cell[CellGroupData[{
Cell[1255094, 31138, 824, 20, 195, "Input",ExpressionUUID->"002af834-fba6-4ab2-93d5-9256d405a43f"],
Cell[1255921, 31160, 248, 4, 33, "Output",ExpressionUUID->"b485a49b-677d-4e02-8270-22bd4d37397d"],
Cell[1256172, 31166, 248, 4, 33, "Output",ExpressionUUID->"b22026d6-637e-49db-9db0-84de470d3635"],
Cell[1256423, 31172, 248, 4, 33, "Output",ExpressionUUID->"03b21566-16e4-4bc6-8916-6dbb38032dec"],
Cell[1256674, 31178, 248, 4, 33, "Output",ExpressionUUID->"a0be9b4a-b270-4353-8b79-73caa108b26e"],
Cell[1256925, 31184, 248, 4, 33, "Output",ExpressionUUID->"e6a3ee2b-bf30-4332-b106-2abae690bb9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1257210, 31193, 1993, 52, 174, "Input",ExpressionUUID->"24934acf-6f49-4d6f-97e1-4b9a20f7a673"],
Cell[1259206, 31247, 3007, 58, 77, "Output",ExpressionUUID->"ff2f4c5e-b78f-48ca-acc0-a84ea82f9478"],
Cell[1262216, 31307, 3686, 74, 73, "Output",ExpressionUUID->"eefdf8f1-7b66-459f-a787-b19923eb0fcd"],
Cell[1265905, 31383, 2247, 33, 33, "Output",ExpressionUUID->"379a366d-4bf3-4dd0-9a09-17f3684ace2e"],
Cell[1268155, 31418, 5061, 108, 108, "Output",ExpressionUUID->"cc8138f9-a4e8-4610-a5db-6c043ae70971"],
Cell[1273219, 31528, 4112, 85, 67, "Output",ExpressionUUID->"130b8ecb-a24f-449c-9bbe-b3cccb31ece9"],
Cell[1277334, 31615, 5829, 130, 106, "Output",ExpressionUUID->"27ef2492-bec2-4eb6-a112-ef7eae7d2365"],
Cell[1283166, 31747, 7572, 174, 106, "Output",ExpressionUUID->"6b7037bb-a59e-4711-bb8a-240fb533852a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1290775, 31926, 309, 7, 29, "Input",ExpressionUUID->"7d6939c4-726e-4dac-99bf-3491ca862fd5"],
Cell[1291087, 31935, 7706, 182, 137, "Output",ExpressionUUID->"7d1c79e4-4a42-4642-b4e2-af1c44ec3101"]
}, Open  ]],
Cell[1298808, 32120, 14580, 374, 2347, "Text",ExpressionUUID->"c5688ec5-dbba-4596-8008-4aa90e75e41d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1313413, 32498, 4077, 93, 297, "Input",ExpressionUUID->"839adafb-18ce-4d85-a196-4c412fb527d8"],
Cell[1317493, 32593, 513, 11, 49, "Output",ExpressionUUID->"d5984c85-36de-4818-ad85-9d024d061384"],
Cell[1318009, 32606, 818, 22, 56, "Output",ExpressionUUID->"96dbbf01-ded1-4128-b96c-db0598b66b27"],
Cell[1318830, 32630, 503, 10, 33, "Output",ExpressionUUID->"7893bc6d-5884-4c7a-a5d3-cb7e436fb004"],
Cell[1319336, 32642, 1237, 32, 54, "Output",ExpressionUUID->"1e57ba35-b87a-43b3-a7da-8733796fbf5d"],
Cell[1320576, 32676, 1353, 35, 54, "Output",ExpressionUUID->"994b4b52-3d93-4908-8a73-86f3743469a7"],
Cell[1321932, 32713, 1720, 45, 97, "Output",ExpressionUUID->"cafdb181-5f8d-4c92-b40f-65ab80b7bff4"],
Cell[1323655, 32760, 808, 19, 54, "Output",ExpressionUUID->"7aafc298-5acc-4796-8ea6-1d2e1af0953a"]
}, Open  ]],
Cell[1324478, 32782, 3142, 81, 258, "Input",ExpressionUUID->"c6d9b1af-359d-4b26-85db-7f740ca24ca3"],
Cell[CellGroupData[{
Cell[1327645, 32867, 3667, 95, 282, "Input",ExpressionUUID->"22e54495-9e73-4bbf-8c20-e5f809d133ae"],
Cell[1331315, 32964, 823, 21, 33, "Output",ExpressionUUID->"4e8dc0f6-b642-45cb-acc3-6a7c06df4ac0"],
Cell[1332141, 32987, 699, 20, 64, "Output",ExpressionUUID->"7adc6e8d-e7e2-4c97-b9f7-69c91d58a83d"],
Cell[1332843, 33009, 1607, 49, 78, "Output",ExpressionUUID->"39b433bf-8e17-481b-851b-db431cd143a2"],
Cell[1334453, 33060, 348, 6, 33, "Output",ExpressionUUID->"a716f110-fa77-407f-95d0-ddae42a2ab4c"],
Cell[1334804, 33068, 350, 6, 33, "Output",ExpressionUUID->"db492504-52b1-47d1-b399-58e47d5a3324"],
Cell[1335157, 33076, 323, 5, 33, "Output",ExpressionUUID->"0c1c5306-7ec2-48f1-ba14-fe51aa3dccd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1335517, 33086, 2900, 65, 90, "Input",ExpressionUUID->"50b029ae-c04d-4b02-86db-cf381adbc4fa"],
Cell[1338420, 33153, 780, 23, 49, "Output",ExpressionUUID->"ed373b43-d95f-40c9-8113-f3d06c6932e8"],
Cell[1339203, 33178, 1394, 44, 58, "Output",ExpressionUUID->"04241a16-b350-419d-8394-3ae4576aa26b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1340634, 33227, 2714, 61, 216, "Input",ExpressionUUID->"72e35cdf-0d18-4872-837d-f989b07ffd0a"],
Cell[1343351, 33290, 2620, 39, 33, "Output",ExpressionUUID->"b4c1ff44-5756-48ea-b254-bcd6b5e250cf"],
Cell[1345974, 33331, 8012, 193, 206, "Output",ExpressionUUID->"08aa57ef-ddbe-4ea1-93cd-2a0ba1872dc2"],
Cell[1353989, 33526, 8324, 198, 206, "Output",ExpressionUUID->"00cead88-ec51-4d58-b61d-a9b5f800d2ef"],
Cell[1362316, 33726, 10144, 220, 423, "Output",ExpressionUUID->"0c5828fb-fafd-4b82-b41c-9afff002312c"],
Cell[1372463, 33948, 3545, 66, 58, "Output",ExpressionUUID->"b85a0637-cd90-4073-ba6e-38d38f82c362"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1376045, 34019, 806, 21, 32, "Input",ExpressionUUID->"b88b3145-8dc9-4eae-80d8-c862029bb8cf"],
Cell[1376854, 34042, 345, 8, 47, "Output",ExpressionUUID->"4d02ebdf-cd1a-43a2-8d9a-08044fb34c77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1377236, 34055, 6144, 152, 279, "Input",ExpressionUUID->"6868e226-8077-4e98-8586-0739ef5d37c3"],
Cell[1383383, 34209, 759, 17, 33, "Output",ExpressionUUID->"67c87030-e3b8-4534-9957-91f63fd3fd8d"],
Cell[1384145, 34228, 2582, 75, 75, "Output",ExpressionUUID->"d7f91da2-295a-4ec6-9125-6a088e4fe5d0"],
Cell[1386730, 34305, 1254, 33, 36, "Output",ExpressionUUID->"06036ca0-7fdf-4df0-9ba8-04a9ea74e246"],
Cell[1387987, 34340, 1357, 33, 36, "Output",ExpressionUUID->"7d8d26e0-a97e-422a-855b-0bbbeec28faa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1389381, 34378, 6179, 153, 282, "Input",ExpressionUUID->"2ecd15b4-cdb8-4e65-a5bb-c2d97812eb39"],
Cell[1395563, 34533, 780, 18, 33, "Output",ExpressionUUID->"1b5d40a4-0afb-45d7-b078-74b3a239416d"],
Cell[1396346, 34553, 2290, 66, 75, "Output",ExpressionUUID->"56c2033d-fec3-4f07-8278-b084111074b0"],
Cell[1398639, 34621, 1173, 31, 36, "Output",ExpressionUUID->"ab63a032-c525-48c3-b82c-dca4ea0865ae"],
Cell[1399815, 34654, 1280, 31, 36, "Output",ExpressionUUID->"4c75a5dd-2cc1-420b-8ae4-3c219e89742e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1401132, 34690, 289, 7, 29, "Input",ExpressionUUID->"a0d518aa-f568-4add-8f58-eeae726ce9f1"],
Cell[1401424, 34699, 1228, 34, 58, "Output",ExpressionUUID->"0c74c446-1a02-4576-957e-e947fd193d6d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1402689, 34738, 2917, 79, 325, "Input",ExpressionUUID->"34b6cb81-c15c-4789-be14-a1d5d8f6209c"],
Cell[1405609, 34819, 619, 12, 49, "Output",ExpressionUUID->"e652669b-c3ee-4350-b133-b773d9c47c82"],
Cell[1406231, 34833, 709, 16, 49, "Output",ExpressionUUID->"a75e0a1e-d8b7-4f59-b1d4-bf4ff5eafaf4"],
Cell[1406943, 34851, 1180, 33, 49, "Output",ExpressionUUID->"36021845-71bf-4efd-b4a7-574efc2e9400"],
Cell[1408126, 34886, 577, 9, 33, "Output",ExpressionUUID->"5776a5a9-77cf-4260-99c1-7e46acedaf8c"],
Cell[1408706, 34897, 931, 23, 49, "Output",ExpressionUUID->"7d806a89-e61d-485c-b5be-3ef56be303ec"],
Cell[1409640, 34922, 579, 9, 33, "Output",ExpressionUUID->"557496c4-057c-474d-aeb8-343a15a25cd8"],
Cell[1410222, 34933, 903, 22, 49, "Output",ExpressionUUID->"b084b866-11c9-4638-857a-61c146c418d1"],
Cell[1411128, 34957, 753, 15, 39, "Message",ExpressionUUID->"8c64034f-d61a-4568-8572-235bc9c759bf"],
Cell[1411884, 34974, 535, 8, 33, "Output",ExpressionUUID->"ca84807f-60be-41c1-b175-fc2dd5581c1e"],
Cell[1412422, 34984, 552, 12, 28, "Message",ExpressionUUID->"15fc8712-4520-465e-af5d-0ebc48098fb0"],
Cell[1412977, 34998, 538, 8, 33, "Output",ExpressionUUID->"fd63b0bc-3ef8-4729-9d7d-fe50bfacb221"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1413552, 35011, 3528, 92, 273, "Input",ExpressionUUID->"3f710ad7-2751-456a-997a-a435eaa62abe"],
Cell[1417083, 35105, 1086, 25, 33, "Output",ExpressionUUID->"97bf4274-a439-4f4b-a055-45b3b4bbe9b1"],
Cell[1418172, 35132, 988, 25, 62, "Output",ExpressionUUID->"584d81af-3a8c-47e0-b3b1-65fca92fe866"],
Cell[1419163, 35159, 2233, 57, 79, "Output",ExpressionUUID->"6efc2442-0eac-49dc-9e9a-b469f5af5825"],
Cell[1421399, 35218, 2233, 57, 79, "Output",ExpressionUUID->"a7627c02-b2c4-4a14-942b-4a7bfd4aa9ba"],
Cell[1423635, 35277, 1814, 44, 55, "Output",ExpressionUUID->"a14d67a9-c5b1-4ff2-9f5d-c4eb7ccca2fc"],
Cell[1425452, 35323, 838, 18, 33, "Output",ExpressionUUID->"f9f5a033-f374-42c9-9aaf-e1792c71267d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1426327, 35346, 3798, 86, 213, "Input",ExpressionUUID->"148e32b4-dc6d-4e25-bfe5-65b42cf0772d"],
Cell[1430128, 35434, 922, 23, 33, "Output",ExpressionUUID->"9885f666-7b94-4993-8809-ecabe36595fe"],
Cell[1431053, 35459, 822, 23, 62, "Output",ExpressionUUID->"16db0bae-70e6-44ce-a51d-60fd72cdee2d"],
Cell[1431878, 35484, 622, 15, 49, "Output",ExpressionUUID->"d4f685c2-4054-4ec6-9ff7-b54c1cdb089a"],
Cell[1432503, 35501, 624, 15, 49, "Output",ExpressionUUID->"8d6f0108-7e43-4ee4-912b-2d9bba1c2505"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1433164, 35521, 3765, 82, 212, "Input",ExpressionUUID->"3135a0ac-cd5b-405f-abdd-bb17d264bf55"],
Cell[1436932, 35605, 954, 26, 50, "Output",ExpressionUUID->"1bf55745-7ebb-41ba-b2c2-69ec777759d7"],
Cell[1437889, 35633, 1549, 46, 59, "Output",ExpressionUUID->"215462d0-85ca-4617-97cd-c7e245fd3efe"],
Cell[1439441, 35681, 600, 12, 33, "Output",ExpressionUUID->"ade23362-ebf5-4527-a372-b52929669e9b"],
Cell[1440044, 35695, 5994, 166, 206, "Output",ExpressionUUID->"b94f6478-0e0c-4292-ade5-6982c6fcf205"],
Cell[1446041, 35863, 6301, 171, 206, "Output",ExpressionUUID->"23a53f96-fd37-4c49-82cf-0451f6aeacbd"],
Cell[1452345, 36036, 8178, 194, 423, "Output",ExpressionUUID->"a0c99ace-44d7-4d36-8f23-199266cfb594"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1460560, 36235, 7859, 196, 381, "Input",ExpressionUUID->"4276989d-8e88-4b27-adaf-417dbf92065d"],
Cell[1468422, 36433, 3197, 94, 81, "Output",ExpressionUUID->"065f21fa-99f3-4778-af58-41fd693ac652"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1471656, 36532, 3543, 101, 118, "Input",ExpressionUUID->"3243cf3a-6721-4b39-b16c-2aed5cd004ed"],
Cell[1475202, 36635, 2098, 61, 58, "Output",ExpressionUUID->"dcbcef5f-93d1-4ad3-943f-a32c35ad8188"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1477337, 36701, 5306, 158, 317, "Input",ExpressionUUID->"9d603759-8ed7-4a32-91ff-e2376fd35d35"],
Cell[1482646, 36861, 893, 26, 50, "Output",ExpressionUUID->"9428f410-3610-4b96-852d-43c21cadf600"],
Cell[1483542, 36889, 840, 24, 50, "Output",ExpressionUUID->"5a06f646-f13d-4c3f-a438-a9e938ea1eca"],
Cell[1484385, 36915, 2004, 62, 92, "Output",ExpressionUUID->"2137b13c-0435-4d4d-8382-c82585003b64"],
Cell[1486392, 36979, 968, 27, 52, "Output",ExpressionUUID->"8fbf957d-f728-4b82-86cc-1ce7d01ac503"],
Cell[1487363, 37008, 1058, 27, 52, "Output",ExpressionUUID->"e8bf1d3a-6462-477d-9902-9a4cf38d7751"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1488458, 37040, 5533, 162, 337, "Input",ExpressionUUID->"5cee2649-b8f7-44fb-a553-c90de243a6dc"],
Cell[1493994, 37204, 838, 18, 49, "Output",ExpressionUUID->"9c63aa95-599d-4b7e-a8ff-cd2de0e54403"],
Cell[1494835, 37224, 838, 18, 49, "Output",ExpressionUUID->"afaa120a-67dd-4736-be87-8af692b0e289"],
Cell[1495676, 37244, 1756, 47, 71, "Output",ExpressionUUID->"271d5522-57cc-4f0f-a022-4848694297cf"],
Cell[1497435, 37293, 915, 20, 53, "Output",ExpressionUUID->"79befb53-7fde-4344-afd9-7e34cac168f3"],
Cell[1498353, 37315, 958, 20, 53, "Output",ExpressionUUID->"5dfa759d-4505-4889-87e5-bc5a4fe1e18e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1499348, 37340, 6051, 178, 378, "Input",ExpressionUUID->"aee487a7-8222-4e5e-86d3-aa49e2b101e9"],
Cell[1505402, 37520, 1849, 47, 73, "Output",ExpressionUUID->"ec5495a3-68d1-4e7e-9847-c9396cdb7357"],
Cell[1507254, 37569, 1851, 47, 73, "Output",ExpressionUUID->"5218aa99-7537-438f-bdb1-4f35b3bfa5ca"],
Cell[1509108, 37618, 5591, 160, 217, "Output",ExpressionUUID->"9b8a8353-7a5e-40b3-a369-61e7b7e45e4f"],
Cell[1514702, 37780, 804, 20, 57, "Output",ExpressionUUID->"bf1ed815-3e9c-4938-9c61-4b3e8e1eee34"],
Cell[1515509, 37802, 853, 21, 57, "Output",ExpressionUUID->"3584846a-2d28-4341-899c-f8281313ed89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1516399, 37828, 3970, 95, 213, "Input",ExpressionUUID->"44b87cad-f4ad-4395-8802-fe7b7af4636c"],
Cell[1520372, 37925, 872, 23, 33, "Output",ExpressionUUID->"59144e04-73ec-46c0-9e6a-fdf84c9db242"],
Cell[1521247, 37950, 1322, 40, 64, "Output",ExpressionUUID->"690b9587-df54-4036-9647-bacd52772e57"],
Cell[1522572, 37992, 992, 29, 51, "Output",ExpressionUUID->"c588d418-da90-4405-952d-c3d0ed46680e"],
Cell[1523567, 38023, 993, 29, 51, "Output",ExpressionUUID->"a2d7698d-1855-4df2-b639-880143970e4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1524597, 38057, 2611, 52, 89, "Input",ExpressionUUID->"0888aecc-1513-4e4b-a9bf-977fadf5c019"],
Cell[1527211, 38111, 1692, 49, 53, "Output",ExpressionUUID->"95a034ab-1d0c-44fe-91da-2a2932608499"],
Cell[1528906, 38162, 3140, 94, 147, "Output",ExpressionUUID->"93ea8c80-5915-4465-860e-2e2d54582adf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1532083, 38261, 3615, 87, 216, "Input",ExpressionUUID->"2be5abd4-4c81-413c-b842-bc9541bd9056"],
Cell[1535701, 38350, 2742, 41, 33, "Output",ExpressionUUID->"5f01982c-280e-43c5-92b2-8c34f8f4c24b"],
Cell[1538446, 38393, 5982, 134, 156, "Output",ExpressionUUID->"2990ac57-d0e1-42b2-b07c-4c196613eeb4"],
Cell[1544431, 38529, 6227, 138, 156, "Output",ExpressionUUID->"496bf3d7-8406-46a4-908b-bdf2dec7f001"],
Cell[1550661, 38669, 11396, 258, 392, "Output",ExpressionUUID->"121611ec-a7c8-4bdd-9691-6b3b5e9fe742"]
}, Open  ]],
Cell[1562072, 38930, 644, 19, 92, "Input",ExpressionUUID->"d18bdfa8-fffe-4c67-8af8-531300804b3d"],
Cell[CellGroupData[{
Cell[1562741, 38953, 8202, 209, 349, "Input",ExpressionUUID->"0e2643d1-468d-4d81-9b34-8b0ac91568ea"],
Cell[1570946, 39164, 4059, 115, 126, "Output",ExpressionUUID->"ca17d078-7a87-47c8-9208-8476fe381061"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1575042, 39284, 4327, 117, 142, "Input",ExpressionUUID->"d7b6cdab-8a6d-4c0a-b3b9-299b6ec3fe2e"],
Cell[1579372, 39403, 4140, 114, 134, "Output",ExpressionUUID->"08388162-e4ba-4834-b7f9-4c7e48b5037d"]
}, Open  ]],
Cell[1583527, 39520, 177, 3, 29, "Input",ExpressionUUID->"24a232fa-4bb4-4c52-a240-66ae21bc33c1"],
Cell[CellGroupData[{
Cell[1583729, 39527, 9943, 287, 586, "Input",ExpressionUUID->"4e634ccc-9a9e-41b0-b3a2-503c3c430c01"],
Cell[1593675, 39816, 2971, 82, 98, "Output",ExpressionUUID->"2ca7dad8-e904-4d81-856e-9260ab6f8aaa"],
Cell[1596649, 39900, 1413, 39, 53, "Output",ExpressionUUID->"ab0e957e-c98a-49b3-b703-20138f6dee6f"],
Cell[1598065, 39941, 841, 20, 51, "Output",ExpressionUUID->"e4b814c6-ffe5-4fc5-b0e7-332734dc2acf"],
Cell[1598909, 39963, 841, 20, 51, "Output",ExpressionUUID->"b21b5b53-ed04-43b1-adc8-f42e07ab549b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1599787, 39988, 1300, 34, 95, "Input",ExpressionUUID->"259fff40-0107-4062-be35-916546ba0c21"],
Cell[1601090, 40024, 521, 9, 33, "Output",ExpressionUUID->"374e5156-4824-4699-8cd6-460c7582698d"],
Cell[1601614, 40035, 564, 11, 47, "Output",ExpressionUUID->"916a1a2a-e9ac-45f5-bb5a-a226f61d5a5c"],
Cell[1602181, 40048, 596, 12, 33, "Output",ExpressionUUID->"da2f57fe-c85d-41fd-8919-2a508b97de31"],
Cell[1602780, 40062, 3032, 69, 239, "Output",ExpressionUUID->"3471034d-4015-472f-b97f-064676c391f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1605849, 40136, 9877, 287, 586, "Input",ExpressionUUID->"16d6ea4a-f451-4daf-9bba-bcc5871a8788"],
Cell[1615729, 40425, 3646, 102, 143, "Output",ExpressionUUID->"cb18e0c9-3905-43dc-ace3-72dec3a800b2"],
Cell[1619378, 40529, 1449, 40, 72, "Output",ExpressionUUID->"4fed43b7-8bff-4795-a8ef-452cd9e6e049"],
Cell[1620830, 40571, 796, 20, 51, "Output",ExpressionUUID->"5d126677-686e-42fb-9036-0a568c1cda3f"],
Cell[1621629, 40593, 975, 25, 54, "Output",ExpressionUUID->"b4581d40-e340-4f85-bc7b-99a00b1e3207"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1622641, 40623, 899, 27, 71, "Input",ExpressionUUID->"071894b5-67fb-4cc5-9650-d4fb346b2d3d"],
Cell[1623543, 40652, 898, 23, 154, "Output",ExpressionUUID->"92eb4e1c-0de2-42e4-81b2-72c06fd16ff8"]
}, Open  ]],
Cell[1624456, 40678, 3647, 102, 309, "Input",ExpressionUUID->"967bda4d-c983-4045-a579-06653842344f"],
Cell[CellGroupData[{
Cell[1628128, 40784, 2188, 59, 196, "Input",ExpressionUUID->"66056d32-6822-493a-8e65-02f22ae2b7ea"],
Cell[1630319, 40845, 5313, 160, 142, "Output",ExpressionUUID->"efa0795a-5081-4a27-867d-4844ef8e16d4"],
Cell[1635635, 41007, 4967, 148, 142, "Output",ExpressionUUID->"9464453f-f03d-4777-9358-ca1f40b177d8"],
Cell[1640605, 41157, 1719, 45, 33, "Output",ExpressionUUID->"e03294ad-c1ed-47d5-8386-74b79b8ece7d"],
Cell[1642327, 41204, 3919, 121, 96, "Output",ExpressionUUID->"1c9fbdf8-e0ae-4ed0-80e4-59ef6f19e7c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1646283, 41330, 1770, 53, 196, "Input",ExpressionUUID->"b739845a-3464-4bd5-8be4-716148667215"],
Cell[1648056, 41385, 4868, 154, 142, "Output",ExpressionUUID->"1b07de9e-c598-46e6-8c0d-9ecd7e111fec"],
Cell[1652927, 41541, 4522, 142, 142, "Output",ExpressionUUID->"81de73a7-41f6-480c-b977-3ca6711f0b95"],
Cell[1657452, 41685, 1272, 39, 33, "Output",ExpressionUUID->"7b03c0e0-a962-49ed-ace8-1248fefbbd90"],
Cell[1658727, 41726, 3474, 115, 96, "Output",ExpressionUUID->"5a8f92ed-ea09-4973-83cd-85901d65fb41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1662238, 41846, 1634, 50, 107, "Input",ExpressionUUID->"a44683be-e67c-468a-bf8b-e108432cd1a1"],
Cell[1663875, 41898, 1223, 36, 33, "Output",ExpressionUUID->"b67f4613-a52d-4187-be45-a3f91c67f0f1"],
Cell[1665101, 41936, 1223, 36, 33, "Output",ExpressionUUID->"9177009b-750c-40f5-9152-5a676fe17c3b"],
Cell[1666327, 41974, 2059, 65, 53, "Output",ExpressionUUID->"816dd44a-d7ca-4555-9082-232a34fbda4a"]
}, Open  ]],
Cell[1668401, 42042, 7655, 194, 358, "Text",ExpressionUUID->"12a74f15-0741-4e8b-869b-0870e85db117",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1676081, 42240, 1549, 46, 156, "Input",ExpressionUUID->"c5935310-3934-4087-a636-20d99a7261a4"],
Cell[1677633, 42288, 1369, 42, 55, "Output",ExpressionUUID->"8d4c42a2-040b-4a8b-9e11-020ba6b1999a"],
Cell[1679005, 42332, 1279, 38, 55, "Output",ExpressionUUID->"58b5889a-de41-4f21-8839-3ac08b8ba101"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1680321, 42375, 502, 15, 32, "Input",ExpressionUUID->"f81c1cc0-1833-470e-8c67-d924fd4cccd4"],
Cell[1680826, 42392, 3009, 96, 98, "Output",ExpressionUUID->"ebfbb3f8-ae7e-46b5-b4a9-9c4e8c206cde"]
}, Open  ]],
Cell[1683850, 42491, 1896, 58, 196, "Input",ExpressionUUID->"9828bfa3-0977-4444-bd35-bc73b06e98db"],
Cell[1685749, 42551, 1990, 60, 196, "Input",ExpressionUUID->"88f72eea-055d-4981-b90c-ee305f2a9f81"],
Cell[CellGroupData[{
Cell[1687764, 42615, 1755, 52, 107, "Input",ExpressionUUID->"3e24f080-d62c-4151-8083-9834548ff792"],
Cell[1689522, 42669, 2535, 82, 77, "Output",ExpressionUUID->"d47a7e83-2f2c-4242-8715-59c8af865d03"],
Cell[1692060, 42753, 2567, 84, 81, "Output",ExpressionUUID->"9774c946-0aab-4d5a-919f-1cd5b7647434"],
Cell[1694630, 42839, 4734, 153, 146, "Output",ExpressionUUID->"c2e0e5cd-23cd-43ec-bd73-a712a1558686"]
}, Open  ]],
Cell[1699379, 42995, 5424, 125, 116, "Text",ExpressionUUID->"0775221e-d233-460c-b961-077cb2c7ad19",
 InitializationCell->True],
Cell[1704806, 43122, 1173, 32, 51, "Input",ExpressionUUID->"55da7776-2f3b-40bd-807a-009e7fc86135"],
Cell[CellGroupData[{
Cell[1706004, 43158, 2325, 56, 195, "Input",ExpressionUUID->"f07b01ab-89b3-4846-b8c8-fa4dcecc2ae1"],
Cell[1708332, 43216, 2233, 33, 33, "Output",ExpressionUUID->"c5f0b90e-d3df-4fae-b23f-68a5e1866af4"],
Cell[1710568, 43251, 15445, 395, 394, "Output",ExpressionUUID->"832124f8-4e81-49ad-927b-40f856be8067"],
Cell[1726016, 43648, 17631, 420, 442, "Output",ExpressionUUID->"03e1d21e-d2bc-4b96-b59e-fb03e414714f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1743684, 44073, 1941, 57, 238, "Input",ExpressionUUID->"04460eec-1310-4856-915b-e79b7e7ebf76"],
Cell[1745628, 44132, 474, 8, 33, "Output",ExpressionUUID->"b6eb5134-81b8-4433-aa49-4e83c53a0167"],
Cell[1746105, 44142, 5349, 145, 259, "Output",ExpressionUUID->"d70244e0-d054-4f1b-8339-768f2c5af253"],
Cell[1751457, 44289, 403, 6, 33, "Output",ExpressionUUID->"ace22e38-eccf-4e4a-a1de-e5c5a23f2d28"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1751897, 44300, 1100, 30, 54, "Input",ExpressionUUID->"a1c7dd27-846d-4779-ad4d-2fbb5b799c37"],
Cell[1753000, 44332, 13957, 358, 399, "Output",ExpressionUUID->"068b1ef8-ed8d-463d-a166-ed57dd2f7aa0"],
Cell[1766960, 44692, 13956, 358, 399, "Output",ExpressionUUID->"eb6dacbd-dce2-49c8-a78b-ff20951a15bb"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

